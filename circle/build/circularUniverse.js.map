{"version":3,"file":"circularUniverse.js","sources":["../../../../commonNodeJS/master/dat/dat.gui.module.js","../../../../commonNodeJS/master/UpDownController.js","../../../../commonNodeJS/master/three.js","../../../../commonNodeJS/master/ScaleController.js","../../../../commonNodeJS/master/PositionController.js","../../../../commonNodeJS/master/dat.gui/CustomController/build/dat.gui.module.js","../../../../commonNodeJS/master/getPosition.js","../../../../commonNodeJS/master/loadFileNodeJS/index.js","../../../../commonNodeJS/master/loadScriptNodeJS/index.js","../../../../commonNodeJS/master/loadScriptNodeJS/loadScript.js","../../../../commonNodeJS/master/colorpicker/colorpicker.js","../../../../commonNodeJS/master/cookieNodeJS/index.js","../../../../commonNodeJS/master/cookieNodeJS/cookie.js","../../../../commonNodeJS/master/lang.js","../../../../commonNodeJS/master/createFullScreenSettings.js","../../../../commonNodeJS/master/SpriteText/SpriteText.js","../../../../commonNodeJS/master/StereoEffect/StereoEffect.js","../../../../commonNodeJS/master/controller.js","../../../../commonNodeJS/master/Options.js","../../../../commonNodeJS/master/player/player.js","../../../../commonNodeJS/master/myObject.js","../../../../commonNodeJS/master/getShaderMaterialPoints/getShaderMaterialPoints.js","../../../../commonNodeJS/master/myPoints/myPoints.js","../../../../commonNodeJS/master/DropdownMenu/index.js","../../../../commonNodeJS/master/DropdownMenu/dropdownMenu.js","../../../../commonNodeJS/master/canvasMenu/canvasMenu.js","../../../../commonNodeJS/master/clearThree.js","../../../../commonNodeJS/master/AxesHelper/AxesHelper.js","../../../../commonNodeJS/master/SpriteText/SpriteTextGui.js","../../../../commonNodeJS/master/AxesHelper/AxesHelperGui.js","../../../../commonNodeJS/master/OrbitControls/OrbitControlsGui.js","../../../../commonNodeJS/master/dat/dat.module.js","../../../../commonNodeJS/master/functionsFolder.js","../../../../commonNodeJS/master/guiSelectPoint/guiSelectPoint.js","../../../../commonNodeJS/master/MoveGroupGui.js","../../../../commonNodeJS/master/CameraGui.js","../../../../commonNodeJS/master/folderPoint.js","../../../../commonNodeJS/master/frustumPoints/frustumPoints.js","../../../../commonNodeJS/master/pointLight.js","../../../../commonNodeJS/master/ProgressBar/ProgressBar.js","../../../../commonNodeJS/master/intersections/intersections.js","../../../../commonNodeJS/master/treeView/treeView.js","../../../../commonNodeJS/master/myThree/myThree.js","../../../../commonNodeJS/master/myMath/matrix/matrix.js","../../../../commonNodeJS/master/myMath/myMath.js","../../../../commonNodeJS/master/nD/nD.js","../../../../commonNodeJS/master/HuperSphere/huperSphere.js","../../universe.js","../circularUniverse.js"],"sourcesContent":["/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, {\r\n        passive: bool\r\n      });\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step, newBool) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    _this2.newBool = newBool;\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown, newBool);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      if (!_this.newBool) e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4], arguments[5]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","/**\r\n * custom controller, allow to user to change a value step by step.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nvar UpDownController = {\r\n\r\n\t/**\r\n\t * adds new button into controller\r\n\t * @param {string} innerHTML button name\r\n\t * @param {object} [options] the following options are available\r\n\t * @param {String} [options.title] title of the button\r\n\t * @param {Event} [options.onclick] onclick event\r\n\t * @param {Event} [options.onWheel] onWheel event\r\n\t */\r\n\taddButton: function ( innerHTML, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\tvar button = document.createElement( 'span' );\r\n\t\tbutton.innerHTML = innerHTML;\r\n\t\tif ( options.title !== undefined )\r\n\t\t\tbutton.title = options.title;\r\n\t\tif ( options.onclick !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\tbutton.onclick = options.onclick;\r\n\r\n\t\t}\r\n\t\tif ( options.onwheel !== undefined ) {\r\n\r\n\t\t\tbutton.style.cursor = 'n-resize';\r\n\r\n\t\t\t//https://learn.javascript.ru/mousewheel\r\n\t\t\tif ( button.addEventListener ) {\r\n\t\t\t\tif ( 'onwheel' in document ) {\r\n\t\t\t\t\t// IE9+, FF17+, Ch31+\r\n\t\t\t\t\tbutton.addEventListener( \"wheel\", onWheel, {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tpassive: true//https://web.dev/i18n/ru/uses-passive-event-listeners/\r\n\t\t\t\t\t\r\n\t\t\t\t\t} );\r\n\t\t\t\t} else if ( 'onmousewheel' in document ) {\r\n\t\t\t\t\t// устаревший вариант события\r\n\t\t\t\t\tbutton.addEventListener( \"mousewheel\", onWheel );\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Firefox < 17\r\n\t\t\t\t\tbutton.addEventListener( \"MozMousePixelScroll\", onWheel );\r\n\t\t\t\t}\r\n\t\t\t} else { // IE8-\r\n\t\t\t\tbutton.attachEvent( \"onmousewheel\", onWheel );\r\n\t\t\t}\r\n\r\n\t\t\tfunction onWheel( e ) {\r\n\t\t\t\te = e || window.event;\r\n\r\n\t\t\t\t// wheelDelta не дает возможность узнать количество пикселей\r\n\t\t\t\tvar delta = e.deltaY || e.detail || e.wheelDelta;\r\n\t\t\t\toptions.onwheel( delta );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tbutton.style.margin = '0px 2px';\r\n\t\treturn button;\r\n\r\n\t},\r\n\r\n}\r\n\r\nexport default UpDownController;\r\n","/**\r\n * three class for [THREE]{@link https://github.com/anhr/three.js} and [dat.GUI(...)]{@link https://github.com/anhr/dat.gui} variables.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/*если импортировать THREE, то при \"npm run build\" получу ошибку\r\n * (babel plugin) ReferenceError: Unknown plugin \"external-helpers\" specified in \"base\" at 1, attempted to resolve relative to \r\n//import * as THREE from 'https://threejs.org/build/three.module.js';\r\n//import * as THREE from '../../../../../three.js/dev/build/three.module.min.js';\r\n//import * as THREE from '../../three.js/dev/build/three.module.js';\r\n//import * as THREE from '../../three.js/dev/src/Three.js';\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.js';\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.min.js';\r\n*/\r\n\r\nvar _THREE, _dat, _Three;\r\n\r\nclass Three {\r\n\r\n\t/**\r\n\t * class for [THREE]{@link https://github.com/anhr/three.js} and [dat]{@link https://github.com/dataarts/dat.gui} instances.\r\n\t * */\r\n\tconstructor() {}\r\n\t/**\r\n\t * set [THREE]{@link https://github.com/anhr/three.js}\r\n\t */\r\n\tset THREE( THREE ) {\r\n\r\n\t\tif ( _THREE ) {\r\n\r\n\t\t\tif ( !Object.is( THREE, _THREE ) )\r\n\t\t\t\tconsole.error( 'three: duplicate THREE. Please use one instance of the THREE library.' )\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t_THREE = THREE;\r\n\t\t_Three = this;\r\n\r\n\t\tconst //BufferGeometry = THREE.BufferGeometry,\r\n\t\t\tFloat32BufferAttribute = THREE.Float32BufferAttribute,\r\n\t\t\tLine3 = THREE.Line3,\r\n\t\t\tPlane = THREE.Plane,\r\n\t\t\tTriangle = THREE.Triangle,\r\n\t\t\tVector3 = THREE.Vector3;\r\n\r\n\t\tfunction ConvexHull() {\r\n\r\n\t\t\tconst Visible = 0;\r\n\t\t\tconst Deleted = 1;\r\n\r\n\t\t\tconst _v1 = new Vector3();\r\n\t\t\tconst _line3 = new Line3();\r\n\t\t\tconst _plane = new Plane();\r\n\t\t\tconst _closestPoint = new Vector3();\r\n\t\t\tconst _triangle = new Triangle();\r\n\r\n\t\t\tclass ConvexHull {\r\n\r\n\t\t\t\tconstructor() {\r\n\r\n\t\t\t\t\tthis.tolerance = - 1;\r\n\r\n\t\t\t\t\tthis.faces = []; // the generated faces of the convex hull\r\n\t\t\t\t\tthis.newFaces = []; // this array holds the faces that are generated within a single iteration\r\n\r\n\t\t\t\t\t// the vertex lists work as follows:\r\n\t\t\t\t\t//\r\n\t\t\t\t\t// let 'a' and 'b' be 'Face' instances\r\n\t\t\t\t\t// let 'v' be points wrapped as instance of 'Vertex'\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//     [v, v, ..., v, v, v, ...]\r\n\t\t\t\t\t//      ^             ^\r\n\t\t\t\t\t//      |             |\r\n\t\t\t\t\t//  a.outside     b.outside\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.assigned = new VertexList();\r\n\t\t\t\t\tthis.unassigned = new VertexList();\r\n\r\n\t\t\t\t\tthis.vertices = []; \t// vertices of the hull (internal representation of given geometry data)\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetFromPoints( points ) {\r\n\r\n\t\t\t\t\tif ( Array.isArray( points ) !== true ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.ConvexHull: Points parameter is not an array.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( points.length < 4 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.ConvexHull: The algorithm needs at least four points.' );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.makeEmpty();\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = points.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tthis.vertices.push( new VertexNode( points[i] ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.compute();\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetFromObject( object ) {\r\n\r\n\t\t\t\t\tconst points = [];\r\n\r\n\t\t\t\t\tobject.updateMatrixWorld( true );\r\n\r\n\t\t\t\t\tobject.traverse( function ( node ) {\r\n\r\n\t\t\t\t\t\tconst geometry = node.geometry;\r\n\r\n\t\t\t\t\t\tif ( geometry !== undefined ) {\r\n\r\n\t\t\t\t\t\t\tif ( geometry.isGeometry ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( 'THREE.ConvexHull no longer supports Geometry. Use THREE.BufferGeometry instead.' );\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t} else if ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\t\t\t\t\tconst attribute = geometry.attributes.position;\r\n\r\n\t\t\t\t\t\t\t\tif ( attribute !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tfor ( let i = 0, l = attribute.count; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst point = new Vector3();\r\n\r\n\t\t\t\t\t\t\t\t\t\tpoint.fromBufferAttribute( attribute, i ).applyMatrix4( node.matrixWorld );\r\n\r\n\t\t\t\t\t\t\t\t\t\tpoints.push( point );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\treturn this.setFromPoints( points );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcontainsPoint( point ) {\r\n\r\n\t\t\t\t\tconst faces = this.faces;\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = faces.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst face = faces[i];\r\n\r\n\t\t\t\t\t\t// compute signed distance and check on what half space the point lies\r\n\r\n\t\t\t\t\t\tif ( face.distanceToPoint( point ) > this.tolerance ) return false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tintersectRay( ray, target ) {\r\n\r\n\t\t\t\t\t// based on \"Fast Ray-Convex Polyhedron Intersection\"  by Eric Haines, GRAPHICS GEMS II\r\n\r\n\t\t\t\t\tconst faces = this.faces;\r\n\r\n\t\t\t\t\tlet tNear = - Infinity;\r\n\t\t\t\t\tlet tFar = Infinity;\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = faces.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst face = faces[i];\r\n\r\n\t\t\t\t\t\t// interpret faces as planes for the further computation\r\n\r\n\t\t\t\t\t\tconst vN = face.distanceToPoint( ray.origin );\r\n\t\t\t\t\t\tconst vD = face.normal.dot( ray.direction );\r\n\r\n\t\t\t\t\t\t// if the origin is on the positive side of a plane (so the plane can \"see\" the origin) and\r\n\t\t\t\t\t\t// the ray is turned away or parallel to the plane, there is no intersection\r\n\r\n\t\t\t\t\t\tif ( vN > 0 && vD >= 0 ) return null;\r\n\r\n\t\t\t\t\t\t// compute the distance from the ray’s origin to the intersection with the plane\r\n\r\n\t\t\t\t\t\tconst t = ( vD !== 0 ) ? ( - vN / vD ) : 0;\r\n\r\n\t\t\t\t\t\t// only proceed if the distance is positive. a negative distance means the intersection point\r\n\t\t\t\t\t\t// lies \"behind\" the origin\r\n\r\n\t\t\t\t\t\tif ( t <= 0 ) continue;\r\n\r\n\t\t\t\t\t\t// now categorized plane as front-facing or back-facing\r\n\r\n\t\t\t\t\t\tif ( vD > 0 ) {\r\n\r\n\t\t\t\t\t\t\t//  plane faces away from the ray, so this plane is a back-face\r\n\r\n\t\t\t\t\t\t\ttFar = Math.min( t, tFar );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// front-face\r\n\r\n\t\t\t\t\t\t\ttNear = Math.max( t, tNear );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( tNear > tFar ) {\r\n\r\n\t\t\t\t\t\t\t// if tNear ever is greater than tFar, the ray must miss the convex hull\r\n\r\n\t\t\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// evaluate intersection point\r\n\r\n\t\t\t\t\t// always try tNear first since its the closer intersection point\r\n\r\n\t\t\t\t\tif ( tNear !== - Infinity ) {\r\n\r\n\t\t\t\t\t\tray.at( tNear, target );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tray.at( tFar, target );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn target;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tintersectsRay( ray ) {\r\n\r\n\t\t\t\t\treturn this.intersectRay( ray, _v1 ) !== null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmakeEmpty() {\r\n\r\n\t\t\t\t\tthis.faces = [];\r\n\t\t\t\t\tthis.vertices = [];\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Adds a vertex to the 'assigned' list of vertices and assigns it to the given face\r\n\r\n\t\t\t\taddVertexToFace( vertex, face ) {\r\n\r\n\t\t\t\t\tvertex.face = face;\r\n\r\n\t\t\t\t\tif ( face.outside === null ) {\r\n\r\n\t\t\t\t\t\tthis.assigned.append( vertex );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis.assigned.insertBefore( face.outside, vertex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tface.outside = vertex;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes a vertex from the 'assigned' list of vertices and from the given face\r\n\r\n\t\t\t\tremoveVertexFromFace( vertex, face ) {\r\n\r\n\t\t\t\t\tif ( vertex === face.outside ) {\r\n\r\n\t\t\t\t\t\t// fix face.outside link\r\n\r\n\t\t\t\t\t\tif ( vertex.next !== null && vertex.next.face === face ) {\r\n\r\n\t\t\t\t\t\t\t// face has at least 2 outside vertices, move the 'outside' reference\r\n\r\n\t\t\t\t\t\t\tface.outside = vertex.next;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// vertex was the only outside vertex that face had\r\n\r\n\t\t\t\t\t\t\tface.outside = null;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.assigned.remove( vertex );\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes all the visible vertices that a given face is able to see which are stored in the 'assigned' vertext list\r\n\r\n\t\t\t\tremoveAllVerticesFromFace( face ) {\r\n\r\n\t\t\t\t\tif ( face.outside !== null ) {\r\n\r\n\t\t\t\t\t\t// reference to the first and last vertex of this face\r\n\r\n\t\t\t\t\t\tconst start = face.outside;\r\n\t\t\t\t\t\tlet end = face.outside;\r\n\r\n\t\t\t\t\t\twhile ( end.next !== null && end.next.face === face ) {\r\n\r\n\t\t\t\t\t\t\tend = end.next;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.assigned.removeSubList( start, end );\r\n\r\n\t\t\t\t\t\t// fix references\r\n\r\n\t\t\t\t\t\tstart.prev = end.next = null;\r\n\t\t\t\t\t\tface.outside = null;\r\n\r\n\t\t\t\t\t\treturn start;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes all the visible vertices that 'face' is able to see\r\n\r\n\t\t\t\tdeleteFaceVertices( face, absorbingFace ) {\r\n\r\n\t\t\t\t\tconst faceVertices = this.removeAllVerticesFromFace( face );\r\n\r\n\t\t\t\t\tif ( faceVertices !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( absorbingFace === undefined ) {\r\n\r\n\t\t\t\t\t\t\t// mark the vertices to be reassigned to some other face\r\n\r\n\t\t\t\t\t\t\tthis.unassigned.appendChain( faceVertices );\r\n\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// if there's an absorbing face try to assign as many vertices as possible to it\r\n\r\n\t\t\t\t\t\t\tlet vertex = faceVertices;\r\n\r\n\t\t\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\t\t\t// we need to buffer the subsequent vertex at this point because the 'vertex.next' reference\r\n\t\t\t\t\t\t\t\t// will be changed by upcoming method calls\r\n\r\n\t\t\t\t\t\t\t\tconst nextVertex = vertex.next;\r\n\r\n\t\t\t\t\t\t\t\tconst distance = absorbingFace.distanceToPoint( vertex.point );\r\n\r\n\t\t\t\t\t\t\t\t// check if 'vertex' is able to see 'absorbingFace'\r\n\r\n\t\t\t\t\t\t\t\tif ( distance > this.tolerance ) {\r\n\r\n\t\t\t\t\t\t\t\t\tthis.addVertexToFace( vertex, absorbingFace );\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tthis.unassigned.append( vertex );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t// now assign next vertex\r\n\r\n\t\t\t\t\t\t\t\tvertex = nextVertex;\r\n\r\n\t\t\t\t\t\t\t} while ( vertex !== null );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Reassigns as many vertices as possible from the unassigned list to the new faces\r\n\r\n\t\t\t\tresolveUnassignedPoints( newFaces ) {\r\n\r\n\t\t\t\t\tif ( this.unassigned.isEmpty() === false ) {\r\n\r\n\t\t\t\t\t\tlet vertex = this.unassigned.first();\r\n\r\n\t\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\t\t// buffer 'next' reference, see .deleteFaceVertices()\r\n\r\n\t\t\t\t\t\t\tconst nextVertex = vertex.next;\r\n\r\n\t\t\t\t\t\t\tlet maxDistance = this.tolerance;\r\n\r\n\t\t\t\t\t\t\tlet maxFace = null;\r\n\r\n\t\t\t\t\t\t\tfor ( let i = 0; i < newFaces.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tconst face = newFaces[i];\r\n\r\n\t\t\t\t\t\t\t\tif ( face.mark === Visible ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst distance = face.distanceToPoint( vertex.point );\r\n\r\n\t\t\t\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\t\t\t\tmaxFace = face;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif ( maxDistance > 1000 * this.tolerance ) break;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// 'maxFace' can be null e.g. if there are identical vertices\r\n\r\n\t\t\t\t\t\t\tif ( maxFace !== null ) {\r\n\r\n\t\t\t\t\t\t\t\tthis.addVertexToFace( vertex, maxFace );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvertex = nextVertex;\r\n\r\n\t\t\t\t\t\t} while ( vertex !== null );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Computes the extremes of a simplex which will be the initial hull\r\n\r\n\t\t\t\tcomputeExtremes() {\r\n\r\n\t\t\t\t\tconst min = new Vector3();\r\n\t\t\t\t\tconst max = new Vector3();\r\n\r\n\t\t\t\t\tconst minVertices = [];\r\n\t\t\t\t\tconst maxVertices = [];\r\n\r\n\t\t\t\t\t// initially assume that the first vertex is the min/max\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < 3; i++ ) {\r\n\r\n\t\t\t\t\t\tminVertices[i] = maxVertices[i] = this.vertices[0];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmin.copy( this.vertices[0].point );\r\n\t\t\t\t\tmax.copy( this.vertices[0].point );\r\n\r\n\t\t\t\t\t// compute the min/max vertex on all six directions\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = this.vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst vertex = this.vertices[i];\r\n\t\t\t\t\t\tconst point = vertex.point;\r\n\r\n\t\t\t\t\t\t// update the min coordinates\r\n\r\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( point.getComponent( j ) < min.getComponent( j ) ) {\r\n\r\n\t\t\t\t\t\t\t\tmin.setComponent( j, point.getComponent( j ) );\r\n\t\t\t\t\t\t\t\tminVertices[j] = vertex;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// update the max coordinates\r\n\r\n\t\t\t\t\t\tfor ( let j = 0; j < 3; j++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( point.getComponent( j ) > max.getComponent( j ) ) {\r\n\r\n\t\t\t\t\t\t\t\tmax.setComponent( j, point.getComponent( j ) );\r\n\t\t\t\t\t\t\t\tmaxVertices[j] = vertex;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// use min/max vectors to compute an optimal epsilon\r\n\r\n\t\t\t\t\tthis.tolerance = 3 * Number.EPSILON * (\r\n\t\t\t\t\t\tMath.max( Math.abs( min.x ), Math.abs( max.x ) ) +\r\n\t\t\t\t\t\tMath.max( Math.abs( min.y ), Math.abs( max.y ) ) +\r\n\t\t\t\t\t\tMath.max( Math.abs( min.z ), Math.abs( max.z ) )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\treturn { min: minVertices, max: maxVertices };\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Computes the initial simplex assigning to its faces all the points\r\n\t\t\t\t// that are candidates to form part of the hull\r\n\r\n\t\t\t\tcomputeInitialHull() {\r\n\r\n\t\t\t\t\tconst vertices = this.vertices;\r\n\t\t\t\t\tconst extremes = this.computeExtremes();\r\n\t\t\t\t\tconst min = extremes.min;\r\n\t\t\t\t\tconst max = extremes.max;\r\n\r\n\t\t\t\t\t// 1. Find the two vertices 'v0' and 'v1' with the greatest 1d separation\r\n\t\t\t\t\t// (max.x - min.x)\r\n\t\t\t\t\t// (max.y - min.y)\r\n\t\t\t\t\t// (max.z - min.z)\r\n\r\n\t\t\t\t\tlet maxDistance = 0;\r\n\t\t\t\t\tlet index = 0;\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < 3; i++ ) {\r\n\r\n\t\t\t\t\t\tconst distance = max[i].point.getComponent( i ) - min[i].point.getComponent( i );\r\n\r\n\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\tindex = i;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst v0 = min[index];\r\n\t\t\t\t\tconst v1 = max[index];\r\n\t\t\t\t\tlet v2;\r\n\t\t\t\t\tlet v3;\r\n\r\n\t\t\t\t\t// 2. The next vertex 'v2' is the one farthest to the line formed by 'v0' and 'v1'\r\n\r\n\t\t\t\t\tmaxDistance = 0;\r\n\t\t\t\t\t_line3.set( v0.point, v1.point );\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = this.vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst vertex = vertices[i];\r\n\r\n\t\t\t\t\t\tif ( vertex !== v0 && vertex !== v1 ) {\r\n\r\n\t\t\t\t\t\t\t_line3.closestPointToPoint( vertex.point, true, _closestPoint );\r\n\r\n\t\t\t\t\t\t\tconst distance = _closestPoint.distanceToSquared( vertex.point );\r\n\r\n\t\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\t\tv2 = vertex;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 3. The next vertex 'v3' is the one farthest to the plane 'v0', 'v1', 'v2'\r\n\r\n\t\t\t\t\tmaxDistance = - 1;\r\n\t\t\t\t\t_plane.setFromCoplanarPoints( v0.point, v1.point, v2.point );\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = this.vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst vertex = vertices[i];\r\n\r\n\t\t\t\t\t\tif ( vertex !== v0 && vertex !== v1 && vertex !== v2 ) {\r\n\r\n\t\t\t\t\t\t\tconst distance = Math.abs( _plane.distanceToPoint( vertex.point ) );\r\n\r\n\t\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\t\tv3 = vertex;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst faces = [];\r\n\r\n\t\t\t\t\tif ( _plane.distanceToPoint( v3.point ) < 0 ) {\r\n\r\n\t\t\t\t\t\t// the face is not able to see the point so 'plane.normal' is pointing outside the tetrahedron\r\n\r\n\t\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\t\tFace.create( v0, v1, v2 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v1, v0 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v2, v1 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v0, v2 )\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t// set the twin edge\r\n\r\n\t\t\t\t\t\tfor ( let i = 0; i < 3; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst j = ( i + 1 ) % 3;\r\n\r\n\t\t\t\t\t\t\t// join face[ i ] i > 0, with the first face\r\n\r\n\t\t\t\t\t\t\tfaces[i + 1].getEdge( 2 ).setTwin( faces[0].getEdge( j ) );\r\n\r\n\t\t\t\t\t\t\t// join face[ i ] with face[ i + 1 ], 1 <= i <= 3\r\n\r\n\t\t\t\t\t\t\tfaces[i + 1].getEdge( 1 ).setTwin( faces[j + 1].getEdge( 0 ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// the face is able to see the point so 'plane.normal' is pointing inside the tetrahedron\r\n\r\n\t\t\t\t\t\tfaces.push(\r\n\t\t\t\t\t\t\tFace.create( v0, v2, v1 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v0, v1 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v1, v2 ),\r\n\t\t\t\t\t\t\tFace.create( v3, v2, v0 )\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t// set the twin edge\r\n\r\n\t\t\t\t\t\tfor ( let i = 0; i < 3; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst j = ( i + 1 ) % 3;\r\n\r\n\t\t\t\t\t\t\t// join face[ i ] i > 0, with the first face\r\n\r\n\t\t\t\t\t\t\tfaces[i + 1].getEdge( 2 ).setTwin( faces[0].getEdge( ( 3 - i ) % 3 ) );\r\n\r\n\t\t\t\t\t\t\t// join face[ i ] with face[ i + 1 ]\r\n\r\n\t\t\t\t\t\t\tfaces[i + 1].getEdge( 0 ).setTwin( faces[j + 1].getEdge( 1 ) );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// the initial hull is the tetrahedron\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < 4; i++ ) {\r\n\r\n\t\t\t\t\t\tthis.faces.push( faces[i] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// initial assignment of vertices to the faces of the tetrahedron\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tconst vertex = vertices[i];\r\n\r\n\t\t\t\t\t\tif ( vertex !== v0 && vertex !== v1 && vertex !== v2 && vertex !== v3 ) {\r\n\r\n\t\t\t\t\t\t\tmaxDistance = this.tolerance;\r\n\t\t\t\t\t\t\tlet maxFace = null;\r\n\r\n\t\t\t\t\t\t\tfor ( let j = 0; j < 4; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\tconst distance = this.faces[j].distanceToPoint( vertex.point );\r\n\r\n\t\t\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\t\t\tmaxFace = this.faces[j];\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( maxFace !== null ) {\r\n\r\n\t\t\t\t\t\t\t\tthis.addVertexToFace( vertex, maxFace );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes inactive faces\r\n\r\n\t\t\t\treindexFaces() {\r\n\r\n\t\t\t\t\tconst activeFaces = [];\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < this.faces.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst face = this.faces[i];\r\n\r\n\t\t\t\t\t\tif ( face.mark === Visible ) {\r\n\r\n\t\t\t\t\t\t\tactiveFaces.push( face );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.faces = activeFaces;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Finds the next vertex to create faces with the current hull\r\n\r\n\t\t\t\tnextVertexToAdd() {\r\n\r\n\t\t\t\t\t// if the 'assigned' list of vertices is empty, no vertices are left. return with 'undefined'\r\n\r\n\t\t\t\t\tif ( this.assigned.isEmpty() === false ) {\r\n\r\n\t\t\t\t\t\tlet eyeVertex, maxDistance = 0;\r\n\r\n\t\t\t\t\t\t// grap the first available face and start with the first visible vertex of that face\r\n\r\n\t\t\t\t\t\tconst eyeFace = this.assigned.first().face;\r\n\t\t\t\t\t\tlet vertex = eyeFace.outside;\r\n\r\n\t\t\t\t\t\t// now calculate the farthest vertex that face can see\r\n\r\n\t\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\t\tconst distance = eyeFace.distanceToPoint( vertex.point );\r\n\r\n\t\t\t\t\t\t\tif ( distance > maxDistance ) {\r\n\r\n\t\t\t\t\t\t\t\tmaxDistance = distance;\r\n\t\t\t\t\t\t\t\teyeVertex = vertex;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tvertex = vertex.next;\r\n\r\n\t\t\t\t\t\t} while ( vertex !== null && vertex.face === eyeFace );\r\n\r\n\t\t\t\t\t\treturn eyeVertex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Computes a chain of half edges in CCW order called the 'horizon'.\r\n\t\t\t\t// For an edge to be part of the horizon it must join a face that can see\r\n\t\t\t\t// 'eyePoint' and a face that cannot see 'eyePoint'.\r\n\r\n\t\t\t\tcomputeHorizon( eyePoint, crossEdge, face, horizon ) {\r\n\r\n\t\t\t\t\t// moves face's vertices to the 'unassigned' vertex list\r\n\r\n\t\t\t\t\tthis.deleteFaceVertices( face );\r\n\r\n\t\t\t\t\tface.mark = Deleted;\r\n\r\n\t\t\t\t\tlet edge;\r\n\r\n\t\t\t\t\tif ( crossEdge === null ) {\r\n\r\n\t\t\t\t\t\tedge = crossEdge = face.getEdge( 0 );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// start from the next edge since 'crossEdge' was already analyzed\r\n\t\t\t\t\t\t// (actually 'crossEdge.twin' was the edge who called this method recursively)\r\n\r\n\t\t\t\t\t\tedge = crossEdge.next;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\tconst twinEdge = edge.twin;\r\n\t\t\t\t\t\tconst oppositeFace = twinEdge.face;\r\n\r\n\t\t\t\t\t\tif ( oppositeFace.mark === Visible ) {\r\n\r\n\t\t\t\t\t\t\tif ( oppositeFace.distanceToPoint( eyePoint ) > this.tolerance ) {\r\n\r\n\t\t\t\t\t\t\t\t// the opposite face can see the vertex, so proceed with next edge\r\n\r\n\t\t\t\t\t\t\t\tthis.computeHorizon( eyePoint, twinEdge, oppositeFace, horizon );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t// the opposite face can't see the vertex, so this edge is part of the horizon\r\n\r\n\t\t\t\t\t\t\t\thorizon.push( edge );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tedge = edge.next;\r\n\r\n\t\t\t\t\t} while ( edge !== crossEdge );\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Creates a face with the vertices 'eyeVertex.point', 'horizonEdge.tail' and 'horizonEdge.head' in CCW order\r\n\r\n\t\t\t\taddAdjoiningFace( eyeVertex, horizonEdge ) {\r\n\r\n\t\t\t\t\t// all the half edges are created in ccw order thus the face is always pointing outside the hull\r\n\r\n\t\t\t\t\tconst face = Face.create( eyeVertex, horizonEdge.tail(), horizonEdge.head() );\r\n\r\n\t\t\t\t\tthis.faces.push( face );\r\n\r\n\t\t\t\t\t// join face.getEdge( - 1 ) with the horizon's opposite edge face.getEdge( - 1 ) = face.getEdge( 2 )\r\n\r\n\t\t\t\t\tface.getEdge( - 1 ).setTwin( horizonEdge.twin );\r\n\r\n\t\t\t\t\treturn face.getEdge( 0 ); // the half edge whose vertex is the eyeVertex\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//  Adds 'horizon.length' faces to the hull, each face will be linked with the\r\n\t\t\t\t//  horizon opposite face and the face on the left/right\r\n\r\n\t\t\t\taddNewFaces( eyeVertex, horizon ) {\r\n\r\n\t\t\t\t\tthis.newFaces = [];\r\n\r\n\t\t\t\t\tlet firstSideEdge = null;\r\n\t\t\t\t\tlet previousSideEdge = null;\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < horizon.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst horizonEdge = horizon[i];\r\n\r\n\t\t\t\t\t\t// returns the right side edge\r\n\r\n\t\t\t\t\t\tconst sideEdge = this.addAdjoiningFace( eyeVertex, horizonEdge );\r\n\r\n\t\t\t\t\t\tif ( firstSideEdge === null ) {\r\n\r\n\t\t\t\t\t\t\tfirstSideEdge = sideEdge;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// joins face.getEdge( 1 ) with previousFace.getEdge( 0 )\r\n\r\n\t\t\t\t\t\t\tsideEdge.next.setTwin( previousSideEdge );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tthis.newFaces.push( sideEdge.face );\r\n\t\t\t\t\t\tpreviousSideEdge = sideEdge;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// perform final join of new faces\r\n\r\n\t\t\t\t\tfirstSideEdge.next.setTwin( previousSideEdge );\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Adds a vertex to the hull\r\n\r\n\t\t\t\taddVertexToHull( eyeVertex ) {\r\n\r\n\t\t\t\t\tconst horizon = [];\r\n\r\n\t\t\t\t\tthis.unassigned.clear();\r\n\r\n\t\t\t\t\t// remove 'eyeVertex' from 'eyeVertex.face' so that it can't be added to the 'unassigned' vertex list\r\n\r\n\t\t\t\t\tthis.removeVertexFromFace( eyeVertex, eyeVertex.face );\r\n\r\n\t\t\t\t\tthis.computeHorizon( eyeVertex.point, null, eyeVertex.face, horizon );\r\n\r\n\t\t\t\t\tthis.addNewFaces( eyeVertex, horizon );\r\n\r\n\t\t\t\t\t// reassign 'unassigned' vertices to the new faces\r\n\r\n\t\t\t\t\tthis.resolveUnassignedPoints( this.newFaces );\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcleanup() {\r\n\r\n\t\t\t\t\tthis.assigned.clear();\r\n\t\t\t\t\tthis.unassigned.clear();\r\n\t\t\t\t\tthis.newFaces = [];\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcompute() {\r\n\r\n\t\t\t\t\tlet vertex;\r\n\r\n\t\t\t\t\tthis.computeInitialHull();\r\n\r\n\t\t\t\t\t// add all available vertices gradually to the hull\r\n\r\n\t\t\t\t\twhile ( ( vertex = this.nextVertexToAdd() ) !== undefined ) {\r\n\r\n\t\t\t\t\t\tthis.addVertexToHull( vertex );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.reindexFaces();\r\n\r\n\t\t\t\t\tthis.cleanup();\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.ConvexHull = ConvexHull;\r\n\r\n\t\t\t//\r\n\r\n\t\t\tclass Face {\r\n\r\n\t\t\t\tconstructor() {\r\n\r\n\t\t\t\t\tthis.normal = new Vector3();\r\n\t\t\t\t\tthis.midpoint = new Vector3();\r\n\t\t\t\t\tthis.area = 0;\r\n\r\n\t\t\t\t\tthis.constant = 0; // signed distance from face to the origin\r\n\t\t\t\t\tthis.outside = null; // reference to a vertex in a vertex list this face can see\r\n\t\t\t\t\tthis.mark = Visible;\r\n\t\t\t\t\tthis.edge = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tstatic create( a, b, c ) {\r\n\r\n\t\t\t\t\tconst face = new Face();\r\n\r\n\t\t\t\t\tconst e0 = new HalfEdge( a, face );\r\n\t\t\t\t\tconst e1 = new HalfEdge( b, face );\r\n\t\t\t\t\tconst e2 = new HalfEdge( c, face );\r\n\r\n\t\t\t\t\t// join edges\r\n\r\n\t\t\t\t\te0.next = e2.prev = e1;\r\n\t\t\t\t\te1.next = e0.prev = e2;\r\n\t\t\t\t\te2.next = e1.prev = e0;\r\n\r\n\t\t\t\t\t// main half edge reference\r\n\r\n\t\t\t\t\tface.edge = e0;\r\n\r\n\t\t\t\t\treturn face.compute();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgetEdge( i ) {\r\n\r\n\t\t\t\t\tlet edge = this.edge;\r\n\r\n\t\t\t\t\twhile ( i > 0 ) {\r\n\r\n\t\t\t\t\t\tedge = edge.next;\r\n\t\t\t\t\t\ti--;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\twhile ( i < 0 ) {\r\n\r\n\t\t\t\t\t\tedge = edge.prev;\r\n\t\t\t\t\t\ti++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn edge;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcompute() {\r\n\r\n\t\t\t\t\tconst a = this.edge.tail();\r\n\t\t\t\t\tconst b = this.edge.head();\r\n\t\t\t\t\tconst c = this.edge.next.head();\r\n\r\n\t\t\t\t\t_triangle.set( a.point, b.point, c.point );\r\n\r\n\t\t\t\t\t_triangle.getNormal( this.normal );\r\n\t\t\t\t\t_triangle.getMidpoint( this.midpoint );\r\n\t\t\t\t\tthis.area = _triangle.getArea();\r\n\r\n\t\t\t\t\tthis.constant = this.normal.dot( this.midpoint );\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdistanceToPoint( point ) {\r\n\r\n\t\t\t\t\treturn this.normal.dot( point ) - this.constant;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Entity for a Doubly-Connected Edge List (DCEL).\r\n\r\n\t\t\tclass HalfEdge {\r\n\r\n\r\n\t\t\t\tconstructor( vertex, face ) {\r\n\r\n\t\t\t\t\tthis.vertex = vertex;\r\n\t\t\t\t\tthis.prev = null;\r\n\t\t\t\t\tthis.next = null;\r\n\t\t\t\t\tthis.twin = null;\r\n\t\t\t\t\tthis.face = face;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\thead() {\r\n\r\n\t\t\t\t\treturn this.vertex;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttail() {\r\n\r\n\t\t\t\t\treturn this.prev ? this.prev.vertex : null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlength() {\r\n\r\n\t\t\t\t\tconst head = this.head();\r\n\t\t\t\t\tconst tail = this.tail();\r\n\r\n\t\t\t\t\tif ( tail !== null ) {\r\n\r\n\t\t\t\t\t\treturn tail.point.distanceTo( head.point );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn - 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlengthSquared() {\r\n\r\n\t\t\t\t\tconst head = this.head();\r\n\t\t\t\t\tconst tail = this.tail();\r\n\r\n\t\t\t\t\tif ( tail !== null ) {\r\n\r\n\t\t\t\t\t\treturn tail.point.distanceToSquared( head.point );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn - 1;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetTwin( edge ) {\r\n\r\n\t\t\t\t\tthis.twin = edge;\r\n\t\t\t\t\tedge.twin = this;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// A vertex as a double linked list node.\r\n\r\n\t\t\tclass VertexNode {\r\n\r\n\t\t\t\tconstructor( point ) {\r\n\r\n\t\t\t\t\tthis.point = point;\r\n\t\t\t\t\tthis.prev = null;\r\n\t\t\t\t\tthis.next = null;\r\n\t\t\t\t\tthis.face = null; // the face that is able to see this vertex\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// A double linked list that contains vertex nodes.\r\n\r\n\t\t\tclass VertexList {\r\n\r\n\t\t\t\tconstructor() {\r\n\r\n\t\t\t\t\tthis.head = null;\r\n\t\t\t\t\tthis.tail = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfirst() {\r\n\r\n\t\t\t\t\treturn this.head;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlast() {\r\n\r\n\t\t\t\t\treturn this.tail;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tclear() {\r\n\r\n\t\t\t\t\tthis.head = this.tail = null;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Inserts a vertex before the target vertex\r\n\r\n\t\t\t\tinsertBefore( target, vertex ) {\r\n\r\n\t\t\t\t\tvertex.prev = target.prev;\r\n\t\t\t\t\tvertex.next = target;\r\n\r\n\t\t\t\t\tif ( vertex.prev === null ) {\r\n\r\n\t\t\t\t\t\tthis.head = vertex;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvertex.prev.next = vertex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttarget.prev = vertex;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Inserts a vertex after the target vertex\r\n\r\n\t\t\t\tinsertAfter( target, vertex ) {\r\n\r\n\t\t\t\t\tvertex.prev = target;\r\n\t\t\t\t\tvertex.next = target.next;\r\n\r\n\t\t\t\t\tif ( vertex.next === null ) {\r\n\r\n\t\t\t\t\t\tthis.tail = vertex;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvertex.next.prev = vertex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttarget.next = vertex;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Appends a vertex to the end of the linked list\r\n\r\n\t\t\t\tappend( vertex ) {\r\n\r\n\t\t\t\t\tif ( this.head === null ) {\r\n\r\n\t\t\t\t\t\tthis.head = vertex;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis.tail.next = vertex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvertex.prev = this.tail;\r\n\t\t\t\t\tvertex.next = null; // the tail has no subsequent vertex\r\n\r\n\t\t\t\t\tthis.tail = vertex;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Appends a chain of vertices where 'vertex' is the head.\r\n\r\n\t\t\t\tappendChain( vertex ) {\r\n\r\n\t\t\t\t\tif ( this.head === null ) {\r\n\r\n\t\t\t\t\t\tthis.head = vertex;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tthis.tail.next = vertex;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvertex.prev = this.tail;\r\n\r\n\t\t\t\t\t// ensure that the 'tail' reference points to the last vertex of the chain\r\n\r\n\t\t\t\t\twhile ( vertex.next !== null ) {\r\n\r\n\t\t\t\t\t\tvertex = vertex.next;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.tail = vertex;\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes a vertex from the linked list\r\n\r\n\t\t\t\tremove( vertex ) {\r\n\r\n\t\t\t\t\tif ( vertex.prev === null ) {\r\n\r\n\t\t\t\t\t\tthis.head = vertex.next;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvertex.prev.next = vertex.next;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( vertex.next === null ) {\r\n\r\n\t\t\t\t\t\tthis.tail = vertex.prev;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvertex.next.prev = vertex.prev;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Removes a list of vertices whose 'head' is 'a' and whose 'tail' is b\r\n\r\n\t\t\t\tremoveSubList( a, b ) {\r\n\r\n\t\t\t\t\tif ( a.prev === null ) {\r\n\r\n\t\t\t\t\t\tthis.head = b.next;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\ta.prev.next = b.next;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( b.next === null ) {\r\n\r\n\t\t\t\t\t\tthis.tail = a.prev;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tb.next.prev = a.prev;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tisEmpty() {\r\n\r\n\t\t\t\t\treturn this.head === null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tthis.ConvexHull = new ConvexHull().ConvexHull;\r\n\r\n/*\r\n\t\timport { Vector3 } from '../math/Vector3.js';\r\n\t\timport { Vector2 } from '../math/Vector2.js';\r\n\t\timport { Box3 } from '../math/Box3.js';\r\n\t\timport { EventDispatcher } from './EventDispatcher.js';\r\n\t\timport { BufferAttribute, Float32BufferAttribute, Uint16BufferAttribute, Uint32BufferAttribute } from './BufferAttribute.js';\r\n\t\timport { Sphere } from '../math/Sphere.js';\r\n\t\timport { Object3D } from './Object3D.js';\r\n\t\timport { Matrix4 } from '../math/Matrix4.js';\r\n\t\timport { Matrix3 } from '../math/Matrix3.js';\r\n\t\timport * as MathUtils from '../math/MathUtils.js';\r\n\t\timport { arrayMax } from '../utils.js';\r\n*/\r\n\t\tconst Vector2 = three.THREE.Vector2,\r\n\t\t\tBox3 = three.THREE.Box3,\r\n\r\n\t\t\tBufferAttribute = three.THREE.BufferAttribute,\r\n\t\t\tUint16BufferAttribute = three.THREE.Uint16BufferAttribute,\r\n\t\t\tUint32BufferAttribute = three.THREE.Uint32BufferAttribute,\r\n\r\n\t\t\tSphere = three.THREE.Sphere,\r\n\t\t\tObject3D = three.THREE.Object3D,\r\n\t\t\tMatrix4 = three.THREE.Matrix4,\r\n\t\t\tMatrix3 = three.THREE.Matrix3,\r\n\t\t\tarrayMax = three.THREE.arrayMax,\r\n\t\t\tMathUtils = three.THREE.MathUtils;\r\n\r\n\t\t/**\r\n\t\t * https://github.com/mrdoob/eventdispatcher.js/\r\n\t\t */\r\n\r\n\t\tclass EventDispatcher {\r\n\r\n\t\t\taddEventListener( type, listener ) {\r\n\r\n\t\t\t\tif ( this._listeners === undefined ) this._listeners = {};\r\n\r\n\t\t\t\tconst listeners = this._listeners;\r\n\r\n\t\t\t\tif ( listeners[type] === undefined ) {\r\n\r\n\t\t\t\t\tlisteners[type] = [];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( listeners[type].indexOf( listener ) === - 1 ) {\r\n\r\n\t\t\t\t\tlisteners[type].push( listener );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\thasEventListener( type, listener ) {\r\n\r\n\t\t\t\tif ( this._listeners === undefined ) return false;\r\n\r\n\t\t\t\tconst listeners = this._listeners;\r\n\r\n\t\t\t\treturn listeners[type] !== undefined && listeners[type].indexOf( listener ) !== - 1;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tremoveEventListener( type, listener ) {\r\n\r\n\t\t\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\t\t\tconst listeners = this._listeners;\r\n\t\t\t\tconst listenerArray = listeners[type];\r\n\r\n\t\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\t\tconst index = listenerArray.indexOf( listener );\r\n\r\n\t\t\t\t\tif ( index !== - 1 ) {\r\n\r\n\t\t\t\t\t\tlistenerArray.splice( index, 1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdispatchEvent( event ) {\r\n\r\n\t\t\t\tif ( this._listeners === undefined ) return;\r\n\r\n\t\t\t\tconst listeners = this._listeners;\r\n\t\t\t\tconst listenerArray = listeners[event.type];\r\n\r\n\t\t\t\tif ( listenerArray !== undefined ) {\r\n\r\n\t\t\t\t\tevent.target = this;\r\n\r\n\t\t\t\t\t// Make a copy, in case listeners are removed while iterating.\r\n\t\t\t\t\tconst array = listenerArray.slice( 0 );\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = array.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tarray[i].call( this, event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tevent.target = null;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tlet _id = 0;\r\n\r\n\t\tconst _m1 = /*@__PURE__*/ new Matrix4();\r\n\t\tconst _obj = /*@__PURE__*/ new Object3D();\r\n\t\tconst _offset = /*@__PURE__*/ new Vector3();\r\n\t\tconst _box = /*@__PURE__*/ new Box3();\r\n\t\tconst _boxMorphTargets = /*@__PURE__*/ new Box3();\r\n\t\tconst _vector = /*@__PURE__*/ new Vector3();\r\n\r\n\t\t//Не могу брать BufferGeometry из three.THREE потому что тогда получу ошибку\r\n\t\t//Uncaught TypeError: Class constructor BufferGeometry cannot be invoked without 'new'\r\n\t\t//если буду использовать библиотеку 'myThree/build/myThree.module.js'\r\n\t\tclass BufferGeometry extends EventDispatcher {\r\n\r\n\t\t\tconstructor() {\r\n\r\n\t\t\t\tsuper();\r\n\r\n\t\t\t\tObject.defineProperty( this, 'id', { value: _id++ } );\r\n\r\n\t\t\t\tthis.uuid = MathUtils.generateUUID();\r\n\r\n\t\t\t\tthis.name = '';\r\n\t\t\t\tthis.type = 'BufferGeometry';\r\n\r\n\t\t\t\tthis.index = null;\r\n\t\t\t\tthis.attributes = {};\r\n\r\n\t\t\t\tthis.morphAttributes = {};\r\n\t\t\t\tthis.morphTargetsRelative = false;\r\n\r\n\t\t\t\tthis.groups = [];\r\n\r\n\t\t\t\tthis.boundingBox = null;\r\n\t\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t\tthis.drawRange = { start: 0, count: Infinity };\r\n\r\n\t\t\t\tthis.userData = {};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgetIndex() {\r\n\r\n\t\t\t\treturn this.index;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetIndex( index ) {\r\n\r\n\t\t\t\tif ( Array.isArray( index ) ) {\r\n\r\n\t\t\t\t\tthis.index = new ( arrayMax( index ) > 65535 ? Uint32BufferAttribute : Uint16BufferAttribute )( index, 1 );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.index = index;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgetAttribute( name ) {\r\n\r\n\t\t\t\treturn this.attributes[name];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetAttribute( name, attribute ) {\r\n\r\n\t\t\t\tthis.attributes[name] = attribute;\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdeleteAttribute( name ) {\r\n\r\n\t\t\t\tdelete this.attributes[name];\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\thasAttribute( name ) {\r\n\r\n\t\t\t\treturn this.attributes[name] !== undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\taddGroup( start, count, materialIndex = 0 ) {\r\n\r\n\t\t\t\tthis.groups.push( {\r\n\r\n\t\t\t\t\tstart: start,\r\n\t\t\t\t\tcount: count,\r\n\t\t\t\t\tmaterialIndex: materialIndex\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tclearGroups() {\r\n\r\n\t\t\t\tthis.groups = [];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetDrawRange( start, count ) {\r\n\r\n\t\t\t\tthis.drawRange.start = start;\r\n\t\t\t\tthis.drawRange.count = count;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tapplyMatrix4( matrix ) {\r\n\r\n\t\t\t\tconst position = this.attributes.position;\r\n\r\n\t\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\t\tposition.applyMatrix4( matrix );\r\n\r\n\t\t\t\t\tposition.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst normal = this.attributes.normal;\r\n\r\n\t\t\t\tif ( normal !== undefined ) {\r\n\r\n\t\t\t\t\tconst normalMatrix = new Matrix3().getNormalMatrix( matrix );\r\n\r\n\t\t\t\t\tnormal.applyNormalMatrix( normalMatrix );\r\n\r\n\t\t\t\t\tnormal.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tangent = this.attributes.tangent;\r\n\r\n\t\t\t\tif ( tangent !== undefined ) {\r\n\r\n\t\t\t\t\ttangent.transformDirection( matrix );\r\n\r\n\t\t\t\t\ttangent.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( this.boundingBox !== null ) {\r\n\r\n\t\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( this.boundingSphere !== null ) {\r\n\r\n\t\t\t\t\tthis.computeBoundingSphere();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tapplyQuaternion( q ) {\r\n\r\n\t\t\t\t_m1.makeRotationFromQuaternion( q );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\trotateX( angle ) {\r\n\r\n\t\t\t\t// rotate geometry around world x-axis\r\n\r\n\t\t\t\t_m1.makeRotationX( angle );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\trotateY( angle ) {\r\n\r\n\t\t\t\t// rotate geometry around world y-axis\r\n\r\n\t\t\t\t_m1.makeRotationY( angle );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\trotateZ( angle ) {\r\n\r\n\t\t\t\t// rotate geometry around world z-axis\r\n\r\n\t\t\t\t_m1.makeRotationZ( angle );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttranslate( x, y, z ) {\r\n\r\n\t\t\t\t// translate geometry\r\n\r\n\t\t\t\t_m1.makeTranslation( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscale( x, y, z ) {\r\n\r\n\t\t\t\t// scale geometry\r\n\r\n\t\t\t\t_m1.makeScale( x, y, z );\r\n\r\n\t\t\t\tthis.applyMatrix4( _m1 );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tlookAt( vector ) {\r\n\r\n\t\t\t\t_obj.lookAt( vector );\r\n\r\n\t\t\t\t_obj.updateMatrix();\r\n\r\n\t\t\t\tthis.applyMatrix4( _obj.matrix );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcenter() {\r\n\r\n\t\t\t\tthis.computeBoundingBox();\r\n\r\n\t\t\t\tthis.boundingBox.getCenter( _offset ).negate();\r\n\r\n\t\t\t\tthis.translate( _offset.x, _offset.y, _offset.z );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsetFromPoints( points ) {\r\n\r\n\t\t\t\tconst position = [];\r\n\r\n\t\t\t\tfor ( let i = 0, l = points.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\tconst point = points[i];\r\n\t\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( position, 3 ) );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcomputeBoundingBox() {\r\n\r\n\t\t\t\tif ( this.boundingBox === null ) {\r\n\r\n\t\t\t\t\tthis.boundingBox = new Box3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst position = this.attributes.position;\r\n\t\t\t\tconst morphAttributesPosition = this.morphAttributes.position;\r\n\r\n\t\t\t\tif ( position && position.isGLBufferAttribute ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\r\n\r\n\t\t\t\t\tthis.boundingBox.set(\r\n\t\t\t\t\t\tnew Vector3( - Infinity, - Infinity, - Infinity ),\r\n\t\t\t\t\t\tnew Vector3( + Infinity, + Infinity, + Infinity )\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( position !== undefined ) {\r\n\r\n\t\t\t\t\tthis.boundingBox.setFromBufferAttribute( position );\r\n\r\n\t\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst morphAttribute = morphAttributesPosition[i];\r\n\t\t\t\t\t\t\t_box.setFromBufferAttribute( morphAttribute );\r\n\r\n\t\t\t\t\t\t\tif ( this.morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t\t_vector.addVectors( this.boundingBox.min, _box.min );\r\n\t\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\r\n\r\n\t\t\t\t\t\t\t\t_vector.addVectors( this.boundingBox.max, _box.max );\r\n\t\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _vector );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.min );\r\n\t\t\t\t\t\t\t\tthis.boundingBox.expandByPoint( _box.max );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tthis.boundingBox.makeEmpty();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( isNaN( this.boundingBox.min.x ) || isNaN( this.boundingBox.min.y ) || isNaN( this.boundingBox.min.z ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcomputeBoundingSphere() {\r\n\r\n\t\t\t\tif ( this.boundingSphere === null ) {\r\n\r\n\t\t\t\t\tthis.boundingSphere = new Sphere();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst position = this.attributes.position;\r\n\t\t\t\tconst morphAttributesPosition = this.morphAttributes.position;\r\n\r\n\t\t\t\tif ( position && position.isGLBufferAttribute ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set \"mesh.frustumCulled\" to \"false\".', this );\r\n\r\n\t\t\t\t\tthis.boundingSphere.set( new Vector3(), Infinity );\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( position ) {\r\n\r\n\t\t\t\t\t// first, find the center of the bounding sphere\r\n\r\n\t\t\t\t\tconst center = this.boundingSphere.center;\r\n\r\n\t\t\t\t\t_box.setFromBufferAttribute( position );\r\n\r\n\t\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst morphAttribute = morphAttributesPosition[i];\r\n\t\t\t\t\t\t\t_boxMorphTargets.setFromBufferAttribute( morphAttribute );\r\n\r\n\t\t\t\t\t\t\tif ( this.morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t\t_vector.addVectors( _box.min, _boxMorphTargets.min );\r\n\t\t\t\t\t\t\t\t_box.expandByPoint( _vector );\r\n\r\n\t\t\t\t\t\t\t\t_vector.addVectors( _box.max, _boxMorphTargets.max );\r\n\t\t\t\t\t\t\t\t_box.expandByPoint( _vector );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.min );\r\n\t\t\t\t\t\t\t\t_box.expandByPoint( _boxMorphTargets.max );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t_box.getCenter( center );\r\n\r\n\t\t\t\t\t// second, try to find a boundingSphere with a radius smaller than the\r\n\t\t\t\t\t// boundingSphere of the boundingBox: sqrt(3) smaller in the best case\r\n\r\n\t\t\t\t\tlet maxRadiusSq = 0;\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = position.count; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\t_vector.fromBufferAttribute( position, i );\r\n\r\n\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// process morph attributes if present\r\n\r\n\t\t\t\t\tif ( morphAttributesPosition ) {\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = morphAttributesPosition.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst morphAttribute = morphAttributesPosition[i];\r\n\t\t\t\t\t\t\tconst morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t\t\t\t\tfor ( let j = 0, jl = morphAttribute.count; j < jl; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\t_vector.fromBufferAttribute( morphAttribute, j );\r\n\r\n\t\t\t\t\t\t\t\tif ( morphTargetsRelative ) {\r\n\r\n\t\t\t\t\t\t\t\t\t_offset.fromBufferAttribute( position, j );\r\n\t\t\t\t\t\t\t\t\t_vector.add( _offset );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tmaxRadiusSq = Math.max( maxRadiusSq, center.distanceToSquared( _vector ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.boundingSphere.radius = Math.sqrt( maxRadiusSq );\r\n\r\n\t\t\t\t\tif ( isNaN( this.boundingSphere.radius ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.', this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcomputeTangents() {\r\n\r\n\t\t\t\tconst index = this.index;\r\n\t\t\t\tconst attributes = this.attributes;\r\n\r\n\t\t\t\t// based on http://www.terathon.com/code/tangent.html\r\n\t\t\t\t// (per vertex tangents)\r\n\r\n\t\t\t\tif ( index === null ||\r\n\t\t\t\t\tattributes.position === undefined ||\r\n\t\t\t\t\tattributes.normal === undefined ||\r\n\t\t\t\t\tattributes.uv === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst indices = index.array;\r\n\t\t\t\tconst positions = attributes.position.array;\r\n\t\t\t\tconst normals = attributes.normal.array;\r\n\t\t\t\tconst uvs = attributes.uv.array;\r\n\r\n\t\t\t\tconst nVertices = positions.length / 3;\r\n\r\n\t\t\t\tif ( attributes.tangent === undefined ) {\r\n\r\n\t\t\t\t\tthis.setAttribute( 'tangent', new BufferAttribute( new Float32Array( 4 * nVertices ), 4 ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tangents = attributes.tangent.array;\r\n\r\n\t\t\t\tconst tan1 = [], tan2 = [];\r\n\r\n\t\t\t\tfor ( let i = 0; i < nVertices; i++ ) {\r\n\r\n\t\t\t\t\ttan1[i] = new Vector3();\r\n\t\t\t\t\ttan2[i] = new Vector3();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst vA = new Vector3(),\r\n\t\t\t\t\tvB = new Vector3(),\r\n\t\t\t\t\tvC = new Vector3(),\r\n\r\n\t\t\t\t\tuvA = new Vector2(),\r\n\t\t\t\t\tuvB = new Vector2(),\r\n\t\t\t\t\tuvC = new Vector2(),\r\n\r\n\t\t\t\t\tsdir = new Vector3(),\r\n\t\t\t\t\ttdir = new Vector3();\r\n\r\n\t\t\t\tfunction handleTriangle( a, b, c ) {\r\n\r\n\t\t\t\t\tvA.fromArray( positions, a * 3 );\r\n\t\t\t\t\tvB.fromArray( positions, b * 3 );\r\n\t\t\t\t\tvC.fromArray( positions, c * 3 );\r\n\r\n\t\t\t\t\tuvA.fromArray( uvs, a * 2 );\r\n\t\t\t\t\tuvB.fromArray( uvs, b * 2 );\r\n\t\t\t\t\tuvC.fromArray( uvs, c * 2 );\r\n\r\n\t\t\t\t\tvB.sub( vA );\r\n\t\t\t\t\tvC.sub( vA );\r\n\r\n\t\t\t\t\tuvB.sub( uvA );\r\n\t\t\t\t\tuvC.sub( uvA );\r\n\r\n\t\t\t\t\tconst r = 1.0 / ( uvB.x * uvC.y - uvC.x * uvB.y );\r\n\r\n\t\t\t\t\t// silently ignore degenerate uv triangles having coincident or colinear vertices\r\n\r\n\t\t\t\t\tif ( !isFinite( r ) ) return;\r\n\r\n\t\t\t\t\tsdir.copy( vB ).multiplyScalar( uvC.y ).addScaledVector( vC, - uvB.y ).multiplyScalar( r );\r\n\t\t\t\t\ttdir.copy( vC ).multiplyScalar( uvB.x ).addScaledVector( vB, - uvC.x ).multiplyScalar( r );\r\n\r\n\t\t\t\t\ttan1[a].add( sdir );\r\n\t\t\t\t\ttan1[b].add( sdir );\r\n\t\t\t\t\ttan1[c].add( sdir );\r\n\r\n\t\t\t\t\ttan2[a].add( tdir );\r\n\t\t\t\t\ttan2[b].add( tdir );\r\n\t\t\t\t\ttan2[c].add( tdir );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet groups = this.groups;\r\n\r\n\t\t\t\tif ( groups.length === 0 ) {\r\n\r\n\t\t\t\t\tgroups = [{\r\n\t\t\t\t\t\tstart: 0,\r\n\t\t\t\t\t\tcount: indices.length\r\n\t\t\t\t\t}];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; ++i ) {\r\n\r\n\t\t\t\t\tconst group = groups[i];\r\n\r\n\t\t\t\t\tconst start = group.start;\r\n\t\t\t\t\tconst count = group.count;\r\n\r\n\t\t\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\thandleTriangle(\r\n\t\t\t\t\t\t\tindices[j + 0],\r\n\t\t\t\t\t\t\tindices[j + 1],\r\n\t\t\t\t\t\t\tindices[j + 2]\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tmp = new Vector3(), tmp2 = new Vector3();\r\n\t\t\t\tconst n = new Vector3(), n2 = new Vector3();\r\n\r\n\t\t\t\tfunction handleVertex( v ) {\r\n\r\n\t\t\t\t\tn.fromArray( normals, v * 3 );\r\n\t\t\t\t\tn2.copy( n );\r\n\r\n\t\t\t\t\tconst t = tan1[v];\r\n\r\n\t\t\t\t\t// Gram-Schmidt orthogonalize\r\n\r\n\t\t\t\t\ttmp.copy( t );\r\n\t\t\t\t\ttmp.sub( n.multiplyScalar( n.dot( t ) ) ).normalize();\r\n\r\n\t\t\t\t\t// Calculate handedness\r\n\r\n\t\t\t\t\ttmp2.crossVectors( n2, t );\r\n\t\t\t\t\tconst test = tmp2.dot( tan2[v] );\r\n\t\t\t\t\tconst w = ( test < 0.0 ) ? - 1.0 : 1.0;\r\n\r\n\t\t\t\t\ttangents[v * 4] = tmp.x;\r\n\t\t\t\t\ttangents[v * 4 + 1] = tmp.y;\r\n\t\t\t\t\ttangents[v * 4 + 2] = tmp.z;\r\n\t\t\t\t\ttangents[v * 4 + 3] = w;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor ( let i = 0, il = groups.length; i < il; ++i ) {\r\n\r\n\t\t\t\t\tconst group = groups[i];\r\n\r\n\t\t\t\t\tconst start = group.start;\r\n\t\t\t\t\tconst count = group.count;\r\n\r\n\t\t\t\t\tfor ( let j = start, jl = start + count; j < jl; j += 3 ) {\r\n\r\n\t\t\t\t\t\thandleVertex( indices[j + 0] );\r\n\t\t\t\t\t\thandleVertex( indices[j + 1] );\r\n\t\t\t\t\t\thandleVertex( indices[j + 2] );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcomputeVertexNormals() {\r\n\r\n\t\t\t\tconst index = this.index;\r\n\t\t\t\tconst positionAttribute = this.getAttribute( 'position' );\r\n\r\n\t\t\t\tif ( positionAttribute !== undefined ) {\r\n\r\n\t\t\t\t\tlet normalAttribute = this.getAttribute( 'normal' );\r\n\r\n\t\t\t\t\tif ( normalAttribute === undefined ) {\r\n\r\n\t\t\t\t\t\tnormalAttribute = new BufferAttribute( new Float32Array( positionAttribute.count * 3 ), 3 );\r\n\t\t\t\t\t\tthis.setAttribute( 'normal', normalAttribute );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// reset existing normals to zero\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = normalAttribute.count; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( i, 0, 0, 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst pA = new Vector3(), pB = new Vector3(), pC = new Vector3();\r\n\t\t\t\t\tconst nA = new Vector3(), nB = new Vector3(), nC = new Vector3();\r\n\t\t\t\t\tconst cb = new Vector3(), ab = new Vector3();\r\n\r\n\t\t\t\t\t// indexed elements\r\n\r\n\t\t\t\t\tif ( index ) {\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = index.count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tconst vA = index.getX( i + 0 );\r\n\t\t\t\t\t\t\tconst vB = index.getX( i + 1 );\r\n\t\t\t\t\t\t\tconst vC = index.getX( i + 2 );\r\n\r\n\t\t\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, vA );\r\n\t\t\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, vB );\r\n\t\t\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, vC );\r\n\r\n\t\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\t\tnA.fromBufferAttribute( normalAttribute, vA );\r\n\t\t\t\t\t\t\tnB.fromBufferAttribute( normalAttribute, vB );\r\n\t\t\t\t\t\t\tnC.fromBufferAttribute( normalAttribute, vC );\r\n\r\n\t\t\t\t\t\t\tnA.add( cb );\r\n\t\t\t\t\t\t\tnB.add( cb );\r\n\t\t\t\t\t\t\tnC.add( cb );\r\n\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( vA, nA.x, nA.y, nA.z );\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( vB, nB.x, nB.y, nB.z );\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( vC, nC.x, nC.y, nC.z );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t// non-indexed elements (unconnected triangle soup)\r\n\r\n\t\t\t\t\t\tfor ( let i = 0, il = positionAttribute.count; i < il; i += 3 ) {\r\n\r\n\t\t\t\t\t\t\tpA.fromBufferAttribute( positionAttribute, i + 0 );\r\n\t\t\t\t\t\t\tpB.fromBufferAttribute( positionAttribute, i + 1 );\r\n\t\t\t\t\t\t\tpC.fromBufferAttribute( positionAttribute, i + 2 );\r\n\r\n\t\t\t\t\t\t\tcb.subVectors( pC, pB );\r\n\t\t\t\t\t\t\tab.subVectors( pA, pB );\r\n\t\t\t\t\t\t\tcb.cross( ab );\r\n\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( i + 0, cb.x, cb.y, cb.z );\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( i + 1, cb.x, cb.y, cb.z );\r\n\t\t\t\t\t\t\tnormalAttribute.setXYZ( i + 2, cb.x, cb.y, cb.z );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.normalizeNormals();\r\n\r\n\t\t\t\t\tnormalAttribute.needsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tmerge( geometry, offset ) {\r\n\r\n\t\t\t\tif ( !( geometry && geometry.isBufferGeometry ) ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.', geometry );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( offset === undefined ) {\r\n\r\n\t\t\t\t\toffset = 0;\r\n\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t'THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. '\r\n\t\t\t\t\t\t+ 'Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge.'\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst attributes = this.attributes;\r\n\r\n\t\t\t\tfor ( const key in attributes ) {\r\n\r\n\t\t\t\t\tif ( geometry.attributes[key] === undefined ) continue;\r\n\r\n\t\t\t\t\tconst attribute1 = attributes[key];\r\n\t\t\t\t\tconst attributeArray1 = attribute1.array;\r\n\r\n\t\t\t\t\tconst attribute2 = geometry.attributes[key];\r\n\t\t\t\t\tconst attributeArray2 = attribute2.array;\r\n\r\n\t\t\t\t\tconst attributeOffset = attribute2.itemSize * offset;\r\n\t\t\t\t\tconst length = Math.min( attributeArray2.length, attributeArray1.length - attributeOffset );\r\n\r\n\t\t\t\t\tfor ( let i = 0, j = attributeOffset; i < length; i++ , j++ ) {\r\n\r\n\t\t\t\t\t\tattributeArray1[j] = attributeArray2[i];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnormalizeNormals() {\r\n\r\n\t\t\t\tconst normals = this.attributes.normal;\r\n\r\n\t\t\t\tfor ( let i = 0, il = normals.count; i < il; i++ ) {\r\n\r\n\t\t\t\t\t_vector.fromBufferAttribute( normals, i );\r\n\r\n\t\t\t\t\t_vector.normalize();\r\n\r\n\t\t\t\t\tnormals.setXYZ( i, _vector.x, _vector.y, _vector.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttoNonIndexed() {\r\n\r\n\t\t\t\tfunction convertBufferAttribute( attribute, indices ) {\r\n\r\n\t\t\t\t\tconst array = attribute.array;\r\n\t\t\t\t\tconst itemSize = attribute.itemSize;\r\n\t\t\t\t\tconst normalized = attribute.normalized;\r\n\r\n\t\t\t\t\tconst array2 = new array.constructor( indices.length * itemSize );\r\n\r\n\t\t\t\t\tlet index = 0, index2 = 0;\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = indices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tif ( attribute.isInterleavedBufferAttribute ) {\r\n\r\n\t\t\t\t\t\t\tindex = indices[i] * attribute.data.stride + attribute.offset;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tindex = indices[i] * itemSize;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfor ( let j = 0; j < itemSize; j++ ) {\r\n\r\n\t\t\t\t\t\t\tarray2[index2++] = array[index++];\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn new BufferAttribute( array2, itemSize, normalized );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tif ( this.index === null ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed.' );\r\n\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst geometry2 = new BufferGeometry();\r\n\r\n\t\t\t\tconst indices = this.index.array;\r\n\t\t\t\tconst attributes = this.attributes;\r\n\r\n\t\t\t\t// attributes\r\n\r\n\t\t\t\tfor ( const name in attributes ) {\r\n\r\n\t\t\t\t\tconst attribute = attributes[name];\r\n\r\n\t\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\r\n\r\n\t\t\t\t\tgeometry2.setAttribute( name, newAttribute );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// morph attributes\r\n\r\n\t\t\t\tconst morphAttributes = this.morphAttributes;\r\n\r\n\t\t\t\tfor ( const name in morphAttributes ) {\r\n\r\n\t\t\t\t\tconst morphArray = [];\r\n\t\t\t\t\tconst morphAttribute = morphAttributes[name]; // morphAttribute: array of Float32BufferAttributes\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\tconst attribute = morphAttribute[i];\r\n\r\n\t\t\t\t\t\tconst newAttribute = convertBufferAttribute( attribute, indices );\r\n\r\n\t\t\t\t\t\tmorphArray.push( newAttribute );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tgeometry2.morphAttributes[name] = morphArray;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgeometry2.morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t\t// groups\r\n\r\n\t\t\t\tconst groups = this.groups;\r\n\r\n\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\tconst group = groups[i];\r\n\t\t\t\t\tgeometry2.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn geometry2;\r\n\r\n\t\t\t}\r\n\r\n\t\t\ttoJSON() {\r\n\r\n\t\t\t\tconst data = {\r\n\t\t\t\t\tmetadata: {\r\n\t\t\t\t\t\tversion: 4.5,\r\n\t\t\t\t\t\ttype: 'BufferGeometry',\r\n\t\t\t\t\t\tgenerator: 'BufferGeometry.toJSON'\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// standard BufferGeometry serialization\r\n\r\n\t\t\t\tdata.uuid = this.uuid;\r\n\t\t\t\tdata.type = this.type;\r\n\t\t\t\tif ( this.name !== '' ) data.name = this.name;\r\n\t\t\t\tif ( Object.keys( this.userData ).length > 0 ) data.userData = this.userData;\r\n\r\n\t\t\t\tif ( this.parameters !== undefined ) {\r\n\r\n\t\t\t\t\tconst parameters = this.parameters;\r\n\r\n\t\t\t\t\tfor ( const key in parameters ) {\r\n\r\n\t\t\t\t\t\tif ( parameters[key] !== undefined ) data[key] = parameters[key];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn data;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// for simplicity the code assumes attributes are not shared across geometries, see #15811\r\n\r\n\t\t\t\tdata.data = { attributes: {} };\r\n\r\n\t\t\t\tconst index = this.index;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tdata.data.index = {\r\n\t\t\t\t\t\ttype: index.array.constructor.name,\r\n\t\t\t\t\t\tarray: Array.prototype.slice.call( index.array )\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst attributes = this.attributes;\r\n\r\n\t\t\t\tfor ( const key in attributes ) {\r\n\r\n\t\t\t\t\tconst attribute = attributes[key];\r\n\r\n\t\t\t\t\tdata.data.attributes[key] = attribute.toJSON( data.data );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst morphAttributes = {};\r\n\t\t\t\tlet hasMorphAttributes = false;\r\n\r\n\t\t\t\tfor ( const key in this.morphAttributes ) {\r\n\r\n\t\t\t\t\tconst attributeArray = this.morphAttributes[key];\r\n\r\n\t\t\t\t\tconst array = [];\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = attributeArray.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\tconst attribute = attributeArray[i];\r\n\r\n\t\t\t\t\t\tarray.push( attribute.toJSON( data.data ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( array.length > 0 ) {\r\n\r\n\t\t\t\t\t\tmorphAttributes[key] = array;\r\n\r\n\t\t\t\t\t\thasMorphAttributes = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( hasMorphAttributes ) {\r\n\r\n\t\t\t\t\tdata.data.morphAttributes = morphAttributes;\r\n\t\t\t\t\tdata.data.morphTargetsRelative = this.morphTargetsRelative;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst groups = this.groups;\r\n\r\n\t\t\t\tif ( groups.length > 0 ) {\r\n\r\n\t\t\t\t\tdata.data.groups = JSON.parse( JSON.stringify( groups ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst boundingSphere = this.boundingSphere;\r\n\r\n\t\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\t\tdata.data.boundingSphere = {\r\n\t\t\t\t\t\tcenter: boundingSphere.center.toArray(),\r\n\t\t\t\t\t\tradius: boundingSphere.radius\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn data;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tclone() {\r\n\r\n\t\t\t\treturn new this.constructor().copy( this );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcopy( source ) {\r\n\r\n\t\t\t\t// reset\r\n\r\n\t\t\t\tthis.index = null;\r\n\t\t\t\tthis.attributes = {};\r\n\t\t\t\tthis.morphAttributes = {};\r\n\t\t\t\tthis.groups = [];\r\n\t\t\t\tthis.boundingBox = null;\r\n\t\t\t\tthis.boundingSphere = null;\r\n\r\n\t\t\t\t// used for storing cloned, shared data\r\n\r\n\t\t\t\tconst data = {};\r\n\r\n\t\t\t\t// name\r\n\r\n\t\t\t\tthis.name = source.name;\r\n\r\n\t\t\t\t// index\r\n\r\n\t\t\t\tconst index = source.index;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tthis.setIndex( index.clone( data ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// attributes\r\n\r\n\t\t\t\tconst attributes = source.attributes;\r\n\r\n\t\t\t\tfor ( const name in attributes ) {\r\n\r\n\t\t\t\t\tconst attribute = attributes[name];\r\n\t\t\t\t\tthis.setAttribute( name, attribute.clone( data ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// morph attributes\r\n\r\n\t\t\t\tconst morphAttributes = source.morphAttributes;\r\n\r\n\t\t\t\tfor ( const name in morphAttributes ) {\r\n\r\n\t\t\t\t\tconst array = [];\r\n\t\t\t\t\tconst morphAttribute = morphAttributes[name]; // morphAttribute: array of Float32BufferAttributes\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = morphAttribute.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\tarray.push( morphAttribute[i].clone( data ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.morphAttributes[name] = array;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.morphTargetsRelative = source.morphTargetsRelative;\r\n\r\n\t\t\t\t// groups\r\n\r\n\t\t\t\tconst groups = source.groups;\r\n\r\n\t\t\t\tfor ( let i = 0, l = groups.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\tconst group = groups[i];\r\n\t\t\t\t\tthis.addGroup( group.start, group.count, group.materialIndex );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// bounding box\r\n\r\n\t\t\t\tconst boundingBox = source.boundingBox;\r\n\r\n\t\t\t\tif ( boundingBox !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingBox = boundingBox.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// bounding sphere\r\n\r\n\t\t\t\tconst boundingSphere = source.boundingSphere;\r\n\r\n\t\t\t\tif ( boundingSphere !== null ) {\r\n\r\n\t\t\t\t\tthis.boundingSphere = boundingSphere.clone();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// draw range\r\n\r\n\t\t\t\tthis.drawRange.start = source.drawRange.start;\r\n\t\t\t\tthis.drawRange.count = source.drawRange.count;\r\n\r\n\t\t\t\t// user data\r\n\r\n\t\t\t\tthis.userData = source.userData;\r\n\r\n\t\t\t\t// geometry generator parameters\r\n\r\n\t\t\t\tif ( source.parameters !== undefined ) this.parameters = Object.assign( {}, source.parameters );\r\n\r\n\t\t\t\treturn this;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdispose() {\r\n\r\n\t\t\t\tthis.dispatchEvent( { type: 'dispose' } );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tBufferGeometry.prototype.isBufferGeometry = true;\r\n\t\t/*\r\n\t\timport {\r\n\t\t\tBufferGeometry,\r\n\t\t\tFloat32BufferAttribute\r\n\t\t} from '../../../build/three.module.js';\r\n\t\t*/\r\n\t\t//import { ConvexHull } from '../math/ConvexHull.js';\r\n\t\t//ConvexGeometry\r\n\r\n\t\tclass ConvexGeometry extends BufferGeometry {\r\n\r\n\t\t\tconstructor( points ) {\r\n\r\n\t\t\t\tsuper();\r\n\r\n\t\t\t\t// buffers\r\n\r\n\t\t\t\tconst vertices = [];\r\n\t\t\t\tconst normals = [];\r\n\r\n\t\t\t\tif ( ConvexHull === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'THREE.ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull' );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst convexHull = new _Three.ConvexHull().setFromPoints( points );\r\n\r\n\t\t\t\t// generate vertices and normals\r\n\r\n\t\t\t\tconst faces = convexHull.faces;\r\n\r\n\t\t\t\tfor ( let i = 0; i < faces.length; i++ ) {\r\n\r\n\t\t\t\t\tconst face = faces[i];\r\n\t\t\t\t\tlet edge = face.edge;\r\n\r\n\t\t\t\t\t// we move along a doubly-connected edge list to access all face points (see HalfEdge docs)\r\n\r\n\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\tconst point = edge.head().point;\r\n\r\n\t\t\t\t\t\tvertices.push( point.x, point.y, point.z );\r\n\t\t\t\t\t\tnormals.push( face.normal.x, face.normal.y, face.normal.z );\r\n\r\n\t\t\t\t\t\tedge = edge.next;\r\n\r\n\t\t\t\t\t} while ( edge !== face.edge );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// build geometry\r\n\r\n\t\t\t\tthis.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\r\n\t\t\t\tthis.setAttribute( 'normal', new Float32BufferAttribute( normals, 3 ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tthis.ConvexGeometry = ConvexGeometry;\r\n\r\n\t\tconst //EventDispatcher = three.THREE.EventDispatcher,\r\n\t\t\tMOUSE = three.THREE.MOUSE,\r\n\t\t\tQuaternion = three.THREE.Quaternion,\r\n\t\t\tSpherical = three.THREE.Spherical,\r\n\t\t\tTOUCH = three.THREE.TOUCH;\r\n//\t\t\tVector2 = three.THREE.Vector2,\r\n//\t\t\tVector3 = three.THREE.Vector3;\r\n\r\n\t\t// This set of controls performs orbiting, dollying (zooming), and panning.\r\n\t\t// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n\t\t//\r\n\t\t//    Orbit - left mouse / touch: one-finger move\r\n\t\t//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\r\n\t\t//    Pan - right mouse, or left mouse + ctrl/meta/shiftKey, or arrow keys / touch: two-finger move\r\n\r\n\t\tconst _changeEvent = { type: 'change' };\r\n\t\tconst _startEvent = { type: 'start' };\r\n\t\tconst _endEvent = { type: 'end' };\r\n\r\n\t\tclass OrbitControls extends EventDispatcher {\r\n\r\n\t\t\tconstructor( object, domElement ) {\r\n\r\n\t\t\t\tsuper();\r\n\r\n\t\t\t\tif ( domElement === undefined ) console.warn( 'THREE.OrbitControls: The second parameter \"domElement\" is now mandatory.' );\r\n\t\t\t\tif ( domElement === document ) console.error( 'THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead.' );\r\n\r\n\t\t\t\tthis.object = object;\r\n\t\t\t\tthis.domElement = domElement;\r\n\t\t\t\tthis.domElement.style.touchAction = 'none'; // disable touch scroll\r\n\r\n\t\t\t\t// Set to false to disable this control\r\n\t\t\t\tthis.enabled = true;\r\n\r\n\t\t\t\t// \"target\" sets the location of focus, where the object orbits around\r\n\t\t\t\tthis.target = new Vector3();\r\n\r\n\t\t\t\t// How far you can dolly in and out ( PerspectiveCamera only )\r\n\t\t\t\tthis.minDistance = 0;\r\n\t\t\t\tthis.maxDistance = Infinity;\r\n\r\n\t\t\t\t// How far you can zoom in and out ( OrthographicCamera only )\r\n\t\t\t\tthis.minZoom = 0;\r\n\t\t\t\tthis.maxZoom = Infinity;\r\n\r\n\t\t\t\t// How far you can orbit vertically, upper and lower limits.\r\n\t\t\t\t// Range is 0 to Math.PI radians.\r\n\t\t\t\tthis.minPolarAngle = 0; // radians\r\n\t\t\t\tthis.maxPolarAngle = Math.PI; // radians\r\n\r\n\t\t\t\t// How far you can orbit horizontally, upper and lower limits.\r\n\t\t\t\t// If set, the interval [ min, max ] must be a sub-interval of [ - 2 PI, 2 PI ], with ( max - min < 2 PI )\r\n\t\t\t\tthis.minAzimuthAngle = - Infinity; // radians\r\n\t\t\t\tthis.maxAzimuthAngle = Infinity; // radians\r\n\r\n\t\t\t\t// Set to true to enable damping (inertia)\r\n\t\t\t\t// If damping is enabled, you must call controls.update() in your animation loop\r\n\t\t\t\tthis.enableDamping = false;\r\n\t\t\t\tthis.dampingFactor = 0.05;\r\n\r\n\t\t\t\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\r\n\t\t\t\t// Set to false to disable zooming\r\n\t\t\t\tthis.enableZoom = true;\r\n\t\t\t\tthis.zoomSpeed = 1.0;\r\n\r\n\t\t\t\t// Set to false to disable rotating\r\n\t\t\t\tthis.enableRotate = true;\r\n\t\t\t\tthis.rotateSpeed = 1.0;\r\n\r\n\t\t\t\t// Set to false to disable panning\r\n\t\t\t\tthis.enablePan = true;\r\n\t\t\t\tthis.panSpeed = 1.0;\r\n\t\t\t\tthis.screenSpacePanning = true; // if false, pan orthogonal to world-space direction camera.up\r\n\t\t\t\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\r\n\r\n\t\t\t\t// Set to true to automatically rotate around the target\r\n\t\t\t\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n\t\t\t\tthis.autoRotate = false;\r\n\t\t\t\tthis.autoRotateSpeed = 2.0; // 30 seconds per orbit when fps is 60\r\n\r\n\t\t\t\t// The four arrow keys\r\n\t\t\t\tthis.keys = { LEFT: 'ArrowLeft', UP: 'ArrowUp', RIGHT: 'ArrowRight', BOTTOM: 'ArrowDown' };\r\n\r\n\t\t\t\t// Mouse buttons\r\n\t\t\t\tthis.mouseButtons = { LEFT: MOUSE.ROTATE, MIDDLE: MOUSE.DOLLY, RIGHT: MOUSE.PAN };\r\n\r\n\t\t\t\t// Touch fingers\r\n\t\t\t\tthis.touches = { ONE: TOUCH.ROTATE, TWO: TOUCH.DOLLY_PAN };\r\n\r\n\t\t\t\t// for reset\r\n\t\t\t\tthis.target0 = this.target.clone();\r\n\t\t\t\tthis.position0 = this.object.position.clone();\r\n\t\t\t\tthis.zoom0 = this.object.zoom;\r\n\r\n\t\t\t\t// the target DOM element for key events\r\n\t\t\t\tthis._domElementKeyEvents = null;\r\n\r\n\t\t\t\t//\r\n\t\t\t\t// public methods\r\n\t\t\t\t//\r\n\r\n\t\t\t\tthis.getPolarAngle = function () {\r\n\r\n\t\t\t\t\treturn spherical.phi;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.getAzimuthalAngle = function () {\r\n\r\n\t\t\t\t\treturn spherical.theta;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.getDistance = function () {\r\n\r\n\t\t\t\t\treturn this.object.position.distanceTo( this.target );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.listenToKeyEvents = function ( domElement ) {\r\n\r\n\t\t\t\t\tdomElement.addEventListener( 'keydown', onKeyDown );\r\n\t\t\t\t\tthis._domElementKeyEvents = domElement;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.saveState = function () {\r\n\r\n\t\t\t\t\tscope.target0.copy( scope.target );\r\n\t\t\t\t\tscope.position0.copy( scope.object.position );\r\n\t\t\t\t\tscope.zoom0 = scope.object.zoom;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tthis.reset = function () {\r\n\r\n\t\t\t\t\tscope.target.copy( scope.target0 );\r\n\t\t\t\t\tscope.object.position.copy( scope.position0 );\r\n\t\t\t\t\tscope.object.zoom = scope.zoom0;\r\n\r\n\t\t\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\t\t\tscope.dispatchEvent( _changeEvent );\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// this method is exposed, but perhaps it would be better if we can make it private...\r\n\t\t\t\tthis.update = function () {\r\n\r\n\t\t\t\t\tconst offset = new Vector3();\r\n\r\n\t\t\t\t\t// so camera.up is the orbit axis\r\n\t\t\t\t\tconst quat = new Quaternion().setFromUnitVectors( object.up, new Vector3( 0, 1, 0 ) );\r\n\t\t\t\t\tconst quatInverse = quat.clone().invert();\r\n\r\n\t\t\t\t\tconst lastPosition = new Vector3();\r\n\t\t\t\t\tconst lastQuaternion = new Quaternion();\r\n\r\n\t\t\t\t\tconst twoPI = 2 * Math.PI;\r\n\r\n\t\t\t\t\treturn function update() {\r\n\r\n\t\t\t\t\t\tconst position = scope.object.position;\r\n\r\n\t\t\t\t\t\toffset.copy( position ).sub( scope.target );\r\n\r\n\t\t\t\t\t\t// rotate offset to \"y-axis-is-up\" space\r\n\t\t\t\t\t\toffset.applyQuaternion( quat );\r\n\r\n\t\t\t\t\t\t// angle from z-axis around y-axis\r\n\t\t\t\t\t\tspherical.setFromVector3( offset );\r\n\r\n\t\t\t\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\r\n\r\n\t\t\t\t\t\t\trotateLeft( getAutoRotationAngle() );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( scope.enableDamping ) {\r\n\r\n\t\t\t\t\t\t\tspherical.theta += sphericalDelta.theta * scope.dampingFactor;\r\n\t\t\t\t\t\t\tspherical.phi += sphericalDelta.phi * scope.dampingFactor;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tspherical.theta += sphericalDelta.theta;\r\n\t\t\t\t\t\t\tspherical.phi += sphericalDelta.phi;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// restrict theta to be between desired limits\r\n\r\n\t\t\t\t\t\tlet min = scope.minAzimuthAngle;\r\n\t\t\t\t\t\tlet max = scope.maxAzimuthAngle;\r\n\r\n\t\t\t\t\t\tif ( isFinite( min ) && isFinite( max ) ) {\r\n\r\n\t\t\t\t\t\t\tif ( min < - Math.PI ) min += twoPI; else if ( min > Math.PI ) min -= twoPI;\r\n\r\n\t\t\t\t\t\t\tif ( max < - Math.PI ) max += twoPI; else if ( max > Math.PI ) max -= twoPI;\r\n\r\n\t\t\t\t\t\t\tif ( min <= max ) {\r\n\r\n\t\t\t\t\t\t\t\tspherical.theta = Math.max( min, Math.min( max, spherical.theta ) );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tspherical.theta = ( spherical.theta > ( min + max ) / 2 ) ?\r\n\t\t\t\t\t\t\t\t\tMath.max( min, spherical.theta ) :\r\n\t\t\t\t\t\t\t\t\tMath.min( max, spherical.theta );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// restrict phi to be between desired limits\r\n\t\t\t\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\r\n\r\n\t\t\t\t\t\tspherical.makeSafe();\r\n\r\n\r\n\t\t\t\t\t\tspherical.radius *= scale;\r\n\r\n\t\t\t\t\t\t// restrict radius to be between desired limits\r\n\t\t\t\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\r\n\r\n\t\t\t\t\t\t// move target to panned location\r\n\r\n\t\t\t\t\t\tif ( scope.enableDamping === true ) {\r\n\r\n\t\t\t\t\t\t\tscope.target.addScaledVector( panOffset, scope.dampingFactor );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tscope.target.add( panOffset );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\toffset.setFromSpherical( spherical );\r\n\r\n\t\t\t\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\r\n\t\t\t\t\t\toffset.applyQuaternion( quatInverse );\r\n\r\n\t\t\t\t\t\tposition.copy( scope.target ).add( offset );\r\n\r\n\t\t\t\t\t\tscope.object.lookAt( scope.target );\r\n\r\n\t\t\t\t\t\tif ( scope.enableDamping === true ) {\r\n\r\n\t\t\t\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\r\n\t\t\t\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\r\n\r\n\t\t\t\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tsphericalDelta.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\t\t\tpanOffset.set( 0, 0, 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tscale = 1;\r\n\r\n\t\t\t\t\t\t// update condition is:\r\n\t\t\t\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\r\n\t\t\t\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\r\n\t\t\t\t\t\tif ( zoomChanged ||\r\n\t\t\t\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\r\n\t\t\t\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\r\n\r\n\t\t\t\t\t\t\tscope.dispatchEvent( _changeEvent );\r\n\r\n\t\t\t\t\t\t\tlastPosition.copy( scope.object.position );\r\n\t\t\t\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\r\n\t\t\t\t\t\t\tzoomChanged = false;\r\n\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}();\r\n\r\n\t\t\t\tthis.dispose = function () {\r\n\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu );\r\n\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'pointerdown', onPointerDown );\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'pointercancel', onPointerCancel );\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel );\r\n\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\r\n\t\t\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\r\n\t\t\t\t\tif ( scope._domElementKeyEvents !== null ) {\r\n\r\n\t\t\t\t\t\tscope._domElementKeyEvents.removeEventListener( 'keydown', onKeyDown );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\t//\r\n\t\t\t\t// internals\r\n\t\t\t\t//\r\n\r\n\t\t\t\tconst scope = this;\r\n\r\n\t\t\t\tconst STATE = {\r\n\t\t\t\t\tNONE: - 1,\r\n\t\t\t\t\tROTATE: 0,\r\n\t\t\t\t\tDOLLY: 1,\r\n\t\t\t\t\tPAN: 2,\r\n\t\t\t\t\tTOUCH_ROTATE: 3,\r\n\t\t\t\t\tTOUCH_PAN: 4,\r\n\t\t\t\t\tTOUCH_DOLLY_PAN: 5,\r\n\t\t\t\t\tTOUCH_DOLLY_ROTATE: 6\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet state = STATE.NONE;\r\n\r\n\t\t\t\tconst EPS = 0.000001;\r\n\r\n\t\t\t\t// current position in spherical coordinates\r\n\t\t\t\tconst spherical = new Spherical();\r\n\t\t\t\tconst sphericalDelta = new Spherical();\r\n\r\n\t\t\t\tlet scale = 1;\r\n\t\t\t\tconst panOffset = new Vector3();\r\n\t\t\t\tlet zoomChanged = false;\r\n\r\n\t\t\t\tconst rotateStart = new Vector2();\r\n\t\t\t\tconst rotateEnd = new Vector2();\r\n\t\t\t\tconst rotateDelta = new Vector2();\r\n\r\n\t\t\t\tconst panStart = new Vector2();\r\n\t\t\t\tconst panEnd = new Vector2();\r\n\t\t\t\tconst panDelta = new Vector2();\r\n\r\n\t\t\t\tconst dollyStart = new Vector2();\r\n\t\t\t\tconst dollyEnd = new Vector2();\r\n\t\t\t\tconst dollyDelta = new Vector2();\r\n\r\n\t\t\t\tconst pointers = [];\r\n\t\t\t\tconst pointerPositions = {};\r\n\r\n\t\t\t\tfunction getAutoRotationAngle() {\r\n\r\n\t\t\t\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction getZoomScale() {\r\n\r\n\t\t\t\t\treturn Math.pow( 0.95, scope.zoomSpeed );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction rotateLeft( angle ) {\r\n\r\n\t\t\t\t\tsphericalDelta.theta -= angle;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction rotateUp( angle ) {\r\n\r\n\t\t\t\t\tsphericalDelta.phi -= angle;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst panLeft = function () {\r\n\r\n\t\t\t\t\tconst v = new Vector3();\r\n\r\n\t\t\t\t\treturn function panLeft( distance, objectMatrix ) {\r\n\r\n\t\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\r\n\t\t\t\t\t\tv.multiplyScalar( - distance );\r\n\r\n\t\t\t\t\t\tpanOffset.add( v );\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}();\r\n\r\n\t\t\t\tconst panUp = function () {\r\n\r\n\t\t\t\t\tconst v = new Vector3();\r\n\r\n\t\t\t\t\treturn function panUp( distance, objectMatrix ) {\r\n\r\n\t\t\t\t\t\tif ( scope.screenSpacePanning === true ) {\r\n\r\n\t\t\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\r\n\t\t\t\t\t\t\tv.crossVectors( scope.object.up, v );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tv.multiplyScalar( distance );\r\n\r\n\t\t\t\t\t\tpanOffset.add( v );\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}();\r\n\r\n\t\t\t\t// deltaX and deltaY are in pixels; right and down are positive\r\n\t\t\t\tconst pan = function () {\r\n\r\n\t\t\t\t\tconst offset = new Vector3();\r\n\r\n\t\t\t\t\treturn function pan( deltaX, deltaY ) {\r\n\r\n\t\t\t\t\t\tconst element = scope.domElement;\r\n\r\n\t\t\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\t\t\t\t\t// perspective\r\n\t\t\t\t\t\t\tconst position = scope.object.position;\r\n\t\t\t\t\t\t\toffset.copy( position ).sub( scope.target );\r\n\t\t\t\t\t\t\tlet targetDistance = offset.length();\r\n\r\n\t\t\t\t\t\t\t// half of the fov is center to top of screen\r\n\t\t\t\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\r\n\r\n\t\t\t\t\t\t\t// we use only clientHeight here so aspect ratio does not distort speed\r\n\t\t\t\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\r\n\t\t\t\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t\t\t\t// orthographic\r\n\t\t\t\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\r\n\t\t\t\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// camera neither orthographic nor perspective\r\n\t\t\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls encountered an unknown camera type - pan disabled.' );\r\n\t\t\t\t\t\t\tscope.enablePan = false;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t}();\r\n\r\n\t\t\t\tfunction dollyOut( dollyScale ) {\r\n\r\n\t\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\t\t\t\tscale /= dollyScale;\r\n\r\n\t\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\r\n\t\t\t\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\t\t\t\tzoomChanged = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\t\t\t\tscope.enableZoom = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction dollyIn( dollyScale ) {\r\n\r\n\t\t\t\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\t\t\t\tscale *= dollyScale;\r\n\r\n\t\t\t\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\r\n\t\t\t\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\t\t\t\tzoomChanged = true;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'WARNING: OrbitControls encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\t\t\t\tscope.enableZoom = false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\t// event callbacks - update the object state\r\n\t\t\t\t//\r\n\r\n\t\t\t\tfunction handleMouseDownRotate( event ) {\r\n\r\n\t\t\t\t\trotateStart.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseDownDolly( event ) {\r\n\r\n\t\t\t\t\tdollyStart.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseDownPan( event ) {\r\n\r\n\t\t\t\t\tpanStart.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseMoveRotate( event ) {\r\n\r\n\t\t\t\t\trotateEnd.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\r\n\r\n\t\t\t\t\tconst element = scope.domElement;\r\n\r\n\t\t\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\r\n\r\n\t\t\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\r\n\r\n\t\t\t\t\trotateStart.copy( rotateEnd );\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseMoveDolly( event ) {\r\n\r\n\t\t\t\t\tdollyEnd.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\r\n\r\n\t\t\t\t\tif ( dollyDelta.y > 0 ) {\r\n\r\n\t\t\t\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t\t\t\t} else if ( dollyDelta.y < 0 ) {\r\n\r\n\t\t\t\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseMovePan( event ) {\r\n\r\n\t\t\t\t\tpanEnd.set( event.clientX, event.clientY );\r\n\r\n\t\t\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\r\n\r\n\t\t\t\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\t\t\t\tpanStart.copy( panEnd );\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseUp( /*event*/ ) {\r\n\r\n\t\t\t\t\t// no-op\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleMouseWheel( event ) {\r\n\r\n\t\t\t\t\tif ( event.deltaY < 0 ) {\r\n\r\n\t\t\t\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t\t\t\t} else if ( event.deltaY > 0 ) {\r\n\r\n\t\t\t\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleKeyDown( event ) {\r\n\r\n\t\t\t\t\tlet needsUpdate = false;\r\n\r\n\t\t\t\t\tswitch ( event.code ) {\r\n\r\n\t\t\t\t\t\tcase scope.keys.UP:\r\n\t\t\t\t\t\t\tpan( 0, scope.keyPanSpeed );\r\n\t\t\t\t\t\t\tneedsUpdate = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase scope.keys.BOTTOM:\r\n\t\t\t\t\t\t\tpan( 0, - scope.keyPanSpeed );\r\n\t\t\t\t\t\t\tneedsUpdate = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase scope.keys.LEFT:\r\n\t\t\t\t\t\t\tpan( scope.keyPanSpeed, 0 );\r\n\t\t\t\t\t\t\tneedsUpdate = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase scope.keys.RIGHT:\r\n\t\t\t\t\t\t\tpan( - scope.keyPanSpeed, 0 );\r\n\t\t\t\t\t\t\tneedsUpdate = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( needsUpdate ) {\r\n\r\n\t\t\t\t\t\t// prevent the browser from scrolling on cursor keys\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchStartRotate() {\r\n\r\n\t\t\t\t\tif ( pointers.length === 1 ) {\r\n\r\n\t\t\t\t\t\trotateStart.set( pointers[0].pageX, pointers[0].pageY );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst x = 0.5 * ( pointers[0].pageX + pointers[1].pageX );\r\n\t\t\t\t\t\tconst y = 0.5 * ( pointers[0].pageY + pointers[1].pageY );\r\n\r\n\t\t\t\t\t\trotateStart.set( x, y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchStartPan() {\r\n\r\n\t\t\t\t\tif ( pointers.length === 1 ) {\r\n\r\n\t\t\t\t\t\tpanStart.set( pointers[0].pageX, pointers[0].pageY );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst x = 0.5 * ( pointers[0].pageX + pointers[1].pageX );\r\n\t\t\t\t\t\tconst y = 0.5 * ( pointers[0].pageY + pointers[1].pageY );\r\n\r\n\t\t\t\t\t\tpanStart.set( x, y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchStartDolly() {\r\n\r\n\t\t\t\t\tconst dx = pointers[0].pageX - pointers[1].pageX;\r\n\t\t\t\t\tconst dy = pointers[0].pageY - pointers[1].pageY;\r\n\r\n\t\t\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\t\t\t\tdollyStart.set( 0, distance );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchStartDollyPan() {\r\n\r\n\t\t\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\r\n\r\n\t\t\t\t\tif ( scope.enablePan ) handleTouchStartPan();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchStartDollyRotate() {\r\n\r\n\t\t\t\t\tif ( scope.enableZoom ) handleTouchStartDolly();\r\n\r\n\t\t\t\t\tif ( scope.enableRotate ) handleTouchStartRotate();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchMoveRotate( event ) {\r\n\r\n\t\t\t\t\tif ( pointers.length == 1 ) {\r\n\r\n\t\t\t\t\t\trotateEnd.set( event.pageX, event.pageY );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst position = getSecondPointerPosition( event );\r\n\r\n\t\t\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\r\n\t\t\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\r\n\r\n\t\t\t\t\t\trotateEnd.set( x, y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trotateDelta.subVectors( rotateEnd, rotateStart ).multiplyScalar( scope.rotateSpeed );\r\n\r\n\t\t\t\t\tconst element = scope.domElement;\r\n\r\n\t\t\t\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientHeight ); // yes, height\r\n\r\n\t\t\t\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight );\r\n\r\n\t\t\t\t\trotateStart.copy( rotateEnd );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchMovePan( event ) {\r\n\r\n\t\t\t\t\tif ( pointers.length === 1 ) {\r\n\r\n\t\t\t\t\t\tpanEnd.set( event.pageX, event.pageY );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst position = getSecondPointerPosition( event );\r\n\r\n\t\t\t\t\t\tconst x = 0.5 * ( event.pageX + position.x );\r\n\t\t\t\t\t\tconst y = 0.5 * ( event.pageY + position.y );\r\n\r\n\t\t\t\t\t\tpanEnd.set( x, y );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tpanDelta.subVectors( panEnd, panStart ).multiplyScalar( scope.panSpeed );\r\n\r\n\t\t\t\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\t\t\t\tpanStart.copy( panEnd );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchMoveDolly( event ) {\r\n\r\n\t\t\t\t\tconst position = getSecondPointerPosition( event );\r\n\r\n\t\t\t\t\tconst dx = event.pageX - position.x;\r\n\t\t\t\t\tconst dy = event.pageY - position.y;\r\n\r\n\t\t\t\t\tconst distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\t\t\t\tdollyEnd.set( 0, distance );\r\n\r\n\t\t\t\t\tdollyDelta.set( 0, Math.pow( dollyEnd.y / dollyStart.y, scope.zoomSpeed ) );\r\n\r\n\t\t\t\t\tdollyOut( dollyDelta.y );\r\n\r\n\t\t\t\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchMoveDollyPan( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\r\n\r\n\t\t\t\t\tif ( scope.enablePan ) handleTouchMovePan( event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchMoveDollyRotate( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enableZoom ) handleTouchMoveDolly( event );\r\n\r\n\t\t\t\t\tif ( scope.enableRotate ) handleTouchMoveRotate( event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction handleTouchEnd( /*event*/ ) {\r\n\r\n\t\t\t\t\t// no-op\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\t// event handlers - FSM: listen for events and reset state\r\n\t\t\t\t//\r\n\r\n\t\t\t\tfunction onPointerDown( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\t\t\t\tif ( pointers.length === 0 ) {\r\n\r\n\t\t\t\t\t\tscope.domElement.setPointerCapture( event.pointerId );\r\n\r\n\t\t\t\t\t\tscope.domElement.addEventListener( 'pointermove', onPointerMove );\r\n\t\t\t\t\t\tscope.domElement.addEventListener( 'pointerup', onPointerUp );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\taddPointer( event );\r\n\r\n\t\t\t\t\tif ( event.pointerType === 'touch' ) {\r\n\r\n\t\t\t\t\t\tonTouchStart( event );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tonMouseDown( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onPointerMove( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\t\t\t\tif ( event.pointerType === 'touch' ) {\r\n\r\n\t\t\t\t\t\tonTouchMove( event );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tonMouseMove( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onPointerUp( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\t\t\t\tif ( event.pointerType === 'touch' ) {\r\n\r\n\t\t\t\t\t\tonTouchEnd();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tonMouseUp( event );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tremovePointer( event );\r\n\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tif ( pointers.length === 0 ) {\r\n\r\n\t\t\t\t\t\tscope.domElement.releasePointerCapture( event.pointerId );\r\n\r\n\t\t\t\t\t\tscope.domElement.removeEventListener( 'pointermove', onPointerMove );\r\n\t\t\t\t\t\tscope.domElement.removeEventListener( 'pointerup', onPointerUp );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onPointerCancel( event ) {\r\n\r\n\t\t\t\t\tremovePointer( event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onMouseDown( event ) {\r\n\r\n\t\t\t\t\tlet mouseAction;\r\n\r\n\t\t\t\t\tswitch ( event.button ) {\r\n\r\n\t\t\t\t\t\tcase 0:\r\n\r\n\t\t\t\t\t\t\tmouseAction = scope.mouseButtons.LEFT;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 1:\r\n\r\n\t\t\t\t\t\t\tmouseAction = scope.mouseButtons.MIDDLE;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 2:\r\n\r\n\t\t\t\t\t\t\tmouseAction = scope.mouseButtons.RIGHT;\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tmouseAction = - 1;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tswitch ( mouseAction ) {\r\n\r\n\t\t\t\t\t\tcase MOUSE.DOLLY:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleMouseDownDolly( event );\r\n\r\n\t\t\t\t\t\t\tstate = STATE.DOLLY;\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase MOUSE.ROTATE:\r\n\r\n\t\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\t\thandleMouseDownPan( event );\r\n\r\n\t\t\t\t\t\t\t\tstate = STATE.PAN;\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\t\thandleMouseDownRotate( event );\r\n\r\n\t\t\t\t\t\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase MOUSE.PAN:\r\n\r\n\t\t\t\t\t\t\tif ( event.ctrlKey || event.metaKey || event.shiftKey ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\t\thandleMouseDownRotate( event );\r\n\r\n\t\t\t\t\t\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\t\thandleMouseDownPan( event );\r\n\r\n\t\t\t\t\t\t\t\tstate = STATE.PAN;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\t\t\t\tscope.dispatchEvent( _startEvent );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onMouseMove( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\t\t\t\tswitch ( state ) {\r\n\r\n\t\t\t\t\t\tcase STATE.ROTATE:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleMouseMoveRotate( event );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase STATE.DOLLY:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleMouseMoveDolly( event );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase STATE.PAN:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleMouseMovePan( event );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onMouseUp( event ) {\r\n\r\n\t\t\t\t\thandleMouseUp( event );\r\n\r\n\t\t\t\t\tscope.dispatchEvent( _endEvent );\r\n\r\n\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onMouseWheel( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\r\n\r\n\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t\tscope.dispatchEvent( _startEvent );\r\n\r\n\t\t\t\t\thandleMouseWheel( event );\r\n\r\n\t\t\t\t\tscope.dispatchEvent( _endEvent );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onKeyDown( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false || scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\thandleKeyDown( event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onTouchStart( event ) {\r\n\r\n\t\t\t\t\ttrackPointer( event );\r\n\r\n\t\t\t\t\tswitch ( pointers.length ) {\r\n\r\n\t\t\t\t\t\tcase 1:\r\n\r\n\t\t\t\t\t\t\tswitch ( scope.touches.ONE ) {\r\n\r\n\t\t\t\t\t\t\t\tcase TOUCH.ROTATE:\r\n\r\n\t\t\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\t\t\thandleTouchStartRotate();\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.TOUCH_ROTATE;\r\n\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase TOUCH.PAN:\r\n\r\n\t\t\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\t\t\thandleTouchStartPan();\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.TOUCH_PAN;\r\n\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 2:\r\n\r\n\t\t\t\t\t\t\tswitch ( scope.touches.TWO ) {\r\n\r\n\t\t\t\t\t\t\t\tcase TOUCH.DOLLY_PAN:\r\n\r\n\t\t\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\t\t\thandleTouchStartDollyPan();\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_PAN;\r\n\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase TOUCH.DOLLY_ROTATE:\r\n\r\n\t\t\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\t\t\thandleTouchStartDollyRotate();\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.TOUCH_DOLLY_ROTATE;\r\n\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\t\t\t\tscope.dispatchEvent( _startEvent );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onTouchMove( event ) {\r\n\r\n\t\t\t\t\ttrackPointer( event );\r\n\r\n\t\t\t\t\tswitch ( state ) {\r\n\r\n\t\t\t\t\t\tcase STATE.TOUCH_ROTATE:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleTouchMoveRotate( event );\r\n\r\n\t\t\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase STATE.TOUCH_PAN:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleTouchMovePan( event );\r\n\r\n\t\t\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase STATE.TOUCH_DOLLY_PAN:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enablePan === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleTouchMoveDollyPan( event );\r\n\r\n\t\t\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase STATE.TOUCH_DOLLY_ROTATE:\r\n\r\n\t\t\t\t\t\t\tif ( scope.enableZoom === false && scope.enableRotate === false ) return;\r\n\r\n\t\t\t\t\t\t\thandleTouchMoveDollyRotate( event );\r\n\r\n\t\t\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onTouchEnd( event ) {\r\n\r\n\t\t\t\t\thandleTouchEnd( event );\r\n\r\n\t\t\t\t\tscope.dispatchEvent( _endEvent );\r\n\r\n\t\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction onContextMenu( event ) {\r\n\r\n\t\t\t\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction addPointer( event ) {\r\n\r\n\t\t\t\t\tpointers.push( event );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction removePointer( event ) {\r\n\r\n\t\t\t\t\tdelete pointerPositions[event.pointerId];\r\n\r\n\t\t\t\t\tfor ( let i = 0; i < pointers.length; i++ ) {\r\n\r\n\t\t\t\t\t\tif ( pointers[i].pointerId == event.pointerId ) {\r\n\r\n\t\t\t\t\t\t\tpointers.splice( i, 1 );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction trackPointer( event ) {\r\n\r\n\t\t\t\t\tlet position = pointerPositions[event.pointerId];\r\n\r\n\t\t\t\t\tif ( position === undefined ) {\r\n\r\n\t\t\t\t\t\tposition = new Vector2();\r\n\t\t\t\t\t\tpointerPositions[event.pointerId] = position;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tposition.set( event.pageX, event.pageY );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction getSecondPointerPosition( event ) {\r\n\r\n\t\t\t\t\tconst pointer = ( event.pointerId === pointers[0].pointerId ) ? pointers[1] : pointers[0];\r\n\r\n\t\t\t\t\treturn pointerPositions[pointer.pointerId];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tscope.domElement.addEventListener( 'contextmenu', onContextMenu );\r\n\r\n\t\t\t\tscope.domElement.addEventListener( 'pointerdown', onPointerDown );\r\n\t\t\t\tscope.domElement.addEventListener( 'pointercancel', onPointerCancel );\r\n\t\t\t\tscope.domElement.addEventListener( 'wheel', onMouseWheel, { passive: false } );\r\n\r\n\t\t\t\t// force an update at start\r\n\r\n\t\t\t\tthis.update();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tthis.OrbitControls = OrbitControls;\r\n\r\n/*\r\n\t\t// This set of controls performs orbiting, dollying (zooming), and panning.\r\n\t\t// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n\t\t// This is very similar to OrbitControls, another set of touch behavior\r\n\t\t//\r\n\t\t//    Orbit - right mouse, or left mouse + ctrl/meta/shiftKey / touch: two-finger rotate\r\n\t\t//    Zoom - middle mouse, or mousewheel / touch: two-finger spread or squish\r\n\t\t//    Pan - left mouse, or arrow keys / touch: one-finger move\r\n\t\r\n\t\tclass MapControls extends OrbitControls {\r\n\t\r\n\t\t\tconstructor( object, domElement ) {\r\n\t\r\n\t\t\t\tsuper( object, domElement );\r\n\t\r\n\t\t\t\tthis.screenSpacePanning = false; // pan orthogonal to world-space direction camera.up\r\n\t\r\n\t\t\t\tthis.mouseButtons.LEFT = MOUSE.PAN;\r\n\t\t\t\tthis.mouseButtons.RIGHT = MOUSE.ROTATE;\r\n\t\r\n\t\t\t\tthis.touches.ONE = TOUCH.PAN;\r\n\t\t\t\tthis.touches.TWO = TOUCH.DOLLY_ROTATE;\r\n\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n*/\r\n\r\n\t}\r\n\t/**\r\n\t * get [THREE]{@link https://github.com/anhr/three.js}\r\n\t */\r\n\tget THREE() {\r\n\r\n\t\tif ( _THREE === undefined )\r\n\t\t\tconsole.error( 'three: invalid _THREE = ' + _THREE + '. Call three.THREE = THREE first.' );\r\n\t\treturn _THREE;\r\n\r\n\t}\r\n\t/**\r\n\t * set [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t */\r\n\tset dat( dat ) {\r\n\r\n\t\tif ( _dat ) {\r\n\r\n\t\t\tif ( !Object.is( dat, _dat ) )\r\n\t\t\t\tconsole.error( 'three: duplicate dat. Please use one instance of the dat library.' )\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t_dat = dat;\r\n\r\n\t}\r\n\t/**\r\n\t * get [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t */\r\n\tget dat() {\r\n\r\n/*Неверно срабатывает когда dat не импортирован\r\n\t\tif ( _dat === undefined && !boSetDat )\r\n\t\t\tconsole.error( 'three: invalid _dat = ' + _dat + '. Call three.dat = dat first.' );\r\n*/\t\t\t\r\n\t\treturn _dat;\r\n\r\n\t}\r\n\r\n}\r\n\r\nvar three;\r\nwindow.__myThree__ = window.__myThree__ || {};\r\nif ( window.__myThree__.three ) {\r\n\r\n\t//сюда попадает если использовать './commonNodeJS/master/player/build/player.module.js'\r\n\tthree = window.__myThree__.three;\r\n\r\n} else {\r\n\r\n\tthree = new Three();\r\n\tthree.isThree = function(){ return _THREE; }\r\n\twindow.__myThree__.three = three;\r\n\r\n}\r\n\r\nexport default three;","/**\r\n * @module ScaleController\r\n * @description is dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { controllers } from './dat/dat.gui.module.js';\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\n\r\nimport UpDownController from './UpDownController.js';\r\n\r\nimport three from './three.js'\r\n\r\nclass ScaleController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t* @callback onclick\r\n\t* @param {ScaleController} customController this controller\r\n\t* @param {Function} action action( value, zoom ) function for multiply or divide value to zoom\r\n\t*/\r\n\r\n\t/**\r\n\t * @description dat.GUI graphical user interface controller for control of the scale of threejs 3D object\r\n\t * @param {onclick} onclick Called whenever user has clicked this controller.\r\n\t * @param {object} [options] the following options are available:\r\n\t * @param {object} [options.settings] settings.\r\n\t * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t * @example \r\n//Add new ScaleController to the dat.GUI folder\r\nfolder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\tvar zoom = customController.controller.getValue();\r\n\r\n\t//Scale a THREE.Mesh object\r\n\tmesh.scale.x = action( mesh.scale.x, zoom );\r\n\tmesh.scale.y = action( mesh.scale.y, zoom );\r\n\tmesh.scale.z = action( mesh.scale.z, zoom );\r\n\tmesh.needsUpdate = true;\r\n\r\n},\r\n\t{\r\n\r\n\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t} ) );\r\n\t */\r\n\tconstructor( onclick, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {};\r\n\t\toptions.settings.zoomMultiplier = options.settings.zoomMultiplier || 1.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\tmultiplier: options.settings.zoomMultiplier,//1.1\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Zoom\r\n\t\t\t\t\tzoom: 'Zoom',\r\n\t\t\t\t\tin: 'in',\r\n\t\t\t\t\tout: 'out',\r\n\t\t\t\t\twheelZoom: 'Scroll the mouse wheel to zoom',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Zoom\r\n\t\t\t\t\t\tlang.zoom = 'Изменить';\r\n\t\t\t\t\t\tlang.in = 'увеличить';\r\n\t\t\t\t\t\tlang.out = 'уменьшить';\r\n\t\t\t\t\t\tlang.wheelZoom = 'Прокрутите колесико мыши для изменения масштаба';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {},\r\n\t\t\t\t\taddButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.zoomLabel = addButton( lang.zoom, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelZoom,//Scroll the mouse wheel to zoom\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tif ( delta > 0 )\r\n\t\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\telse value /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.in,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue *= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.out,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclick( customController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\t\tvalue /= zoom;\r\n\t\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'multiplier', 1.1, 10, 0.1, options.newBool );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default ScaleController;\r\n\r\n/**\r\n * dat.GUI graphical user interface controllers for manipulate or multiplication of the object's property\r\n * @param {GUI} folder folder for new controllers\r\n * @param {Object} object The object to be manipulated\r\n * @param {String} property The name of the property to be manipulated\r\n * @param {function( value )} onChange Callback function that take the new  property of the object\r\n * @param {Object} [options] the following options are available\r\n * @param {object} [options.settings] settings.\r\n * @param {number} [options.settings.zoomMultiplier] control value. Default is 1.1\r\n * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n * @param {String} [options.text] object's property name. Default is property name.\r\n * @param {String} [options.textTitle] object's property title. Default is not title,\r\n */\r\nfunction ScaleControllers( folder, object, property, onChange, options ) {\r\n\r\n\toptions = options || {};\r\n\tconst dat = three.dat;\r\n\tvar scaleController = folder.add( new ScaleController( function ( customController, action ) {\r\n\r\n\t\tvar value = action( controller.getValue(), scaleController.getValue() );\r\n\t\tcontroller.setValue( value );\r\n\t\tonChange( value );\r\n\r\n\t},\r\n\t\t{\r\n\r\n\t\t\tgetLanguageCode: options.getLanguageCode,\r\n\t\t\tsettings: options.settings,\r\n\r\n\t\t} ) ).onChange( function ( value ) { scaleController.zoomMultiplier = value; } );\r\n\tvar controller = dat.controllerZeroStep( folder, object, property, function ( value ) { onChange( value ); } );\r\n\tif ( options.text )\r\n\t\tdat.controllerNameAndTitle( controller, options.text, options.textTitle );\r\n\r\n}\r\nexport { ScaleControllers };\r\n","/**\r\n * PositionController is dat.GUI graphical user interface controller for control of the position of threejs 3D object\r\n * \r\n * @see {@link https://threejs.org/} about threejs\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.GUI\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { controllers } from './dat/dat.gui.module.js';\r\n//import { controllers } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\n\r\nimport UpDownController from './UpDownController.js';\r\n\r\nclass PositionController extends controllers.CustomController {\r\n\r\n\t/**\r\n\t * dat.GUI graphical user interface for control of the position of threejs 3D object.\r\n\t * Base class <a href=\"../../dat.gui/CustomController/src/dat/controllers/CustomController.js\" target=\"_blank\">CustomController</a>\r\n\t * @extends controllers.CustomController.\r\n\t * @param {Event} onclickController\r\n\t * @param {object} [options={}] the following options are available:\r\n\t * @param {number} [options.settings={}] time settings.\r\n\t * @param {number} [options.settings.offset=0.1] offset.\r\n\t * @param {number} [options.min=0.1] Minimal offset.\r\n\t * @param {number} [options.max=10] Maximal offset.\r\n\t * @param {number} [options.step=0.1] step of offset.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t */\r\n\tconstructor( onclickController, options ) {\r\n\r\n\t\toptions = options || {};\r\n\t\toptions.settings = options.settings || {}; \r\n\t\tvar settings = options.settings; \r\n\r\n\t\tif ( options.min === undefined ) options.min = 0.1;\r\n\t\tif ( options.max === undefined ) options.max = 10;\r\n\t\tif ( settings.offset === undefined ) settings.offset = 0.1;\r\n\t\tif ( options.step === undefined ) options.step = 0.1;\r\n\r\n\t\tsuper( {\r\n\r\n\t\t\toffset: settings.offset,\r\n\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tvar lang = {\r\n\r\n\t\t\t\t\t//Position\r\n\t\t\t\t\toffset: 'Offset',\r\n\t\t\t\t\tadd: 'add',\r\n\t\t\t\t\tsubtract: 'subtract',\r\n\t\t\t\t\twheelPosition: 'Scroll the mouse wheel to change the position',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tvar _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t\t: options.getLanguageCode();\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t//Position\r\n\t\t\t\t\t\tlang.offset = 'Сдвиг';\r\n\t\t\t\t\t\tlang.add = 'добавить';\r\n\t\t\t\t\t\tlang.subtract = 'вычесть';\r\n\t\t\t\t\t\tlang.wheelPosition = 'Прокрутите колесико мыши для изменения позиции';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\r\n\t\t\t\tvar buttons = {}, addButton = UpDownController.addButton;\r\n\t\t\t\tbuttons.Label = addButton( lang.offset, {\r\n\r\n\t\t\t\t\ttitle: lang.wheelPosition,\r\n\t\t\t\t\tonwheel: function ( delta ) {\r\n\r\n\t\t\t\t\t\tvar shift = customController.controller.getValue();\r\n\t\t\t\t\t\tonclickController( delta > 0 ? shift : - shift );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.in = addButton( '↑', {\r\n\r\n\t\t\t\t\ttitle: lang.add,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tbuttons.out = addButton( '↓', {\r\n\r\n\t\t\t\t\ttitle: lang.subtract,\r\n\t\t\t\t\tonclick: function () {\r\n\r\n\t\t\t\t\t\tonclickController( - customController.controller.getValue() );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn buttons;\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'offset', options.min, options.max, options.step );\r\n\t\tif ( this.property === undefined )\r\n\t\t\tconsole.error( 'init() returns ' + this.property );\r\n\r\n\t}\r\n\r\n}\r\nexport default PositionController;","/**\r\n * dat-gui JavaScript Controller Library\r\n * http://code.google.com/p/dat-gui\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nfunction ___$insertStyle(css) {\r\n  if (!css) {\r\n    return;\r\n  }\r\n  if (typeof window === 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var style = document.createElement('style');\r\n\r\n  style.setAttribute('type', 'text/css');\r\n  style.innerHTML = css;\r\n  document.head.appendChild(style);\r\n\r\n  return css;\r\n}\r\n\r\nfunction colorToString (color, forceCSSHex) {\r\n  var colorFormat = color.__state.conversionName.toString();\r\n  var r = Math.round(color.r);\r\n  var g = Math.round(color.g);\r\n  var b = Math.round(color.b);\r\n  var a = color.a;\r\n  var h = Math.round(color.h);\r\n  var s = color.s.toFixed(1);\r\n  var v = color.v.toFixed(1);\r\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\r\n    var str = color.hex.toString(16);\r\n    while (str.length < 6) {\r\n      str = '0' + str;\r\n    }\r\n    return '#' + str;\r\n  } else if (colorFormat === 'CSS_RGB') {\r\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\r\n  } else if (colorFormat === 'CSS_RGBA') {\r\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\r\n  } else if (colorFormat === 'HEX') {\r\n    return '0x' + color.hex.toString(16);\r\n  } else if (colorFormat === 'RGB_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ']';\r\n  } else if (colorFormat === 'RGBA_ARRAY') {\r\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\r\n  } else if (colorFormat === 'RGB_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\r\n  } else if (colorFormat === 'RGBA_OBJ') {\r\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\r\n  } else if (colorFormat === 'HSV_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\r\n  } else if (colorFormat === 'HSVA_OBJ') {\r\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\r\n  }\r\n  return 'unknown format';\r\n}\r\n\r\nvar ARR_EACH = Array.prototype.forEach;\r\nvar ARR_SLICE = Array.prototype.slice;\r\nvar Common = {\r\n  BREAK: {},\r\n  extend: function extend(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (!this.isUndefined(obj[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  defaults: function defaults(target) {\r\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\r\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\r\n      keys.forEach(function (key) {\r\n        if (this.isUndefined(target[key])) {\r\n          target[key] = obj[key];\r\n        }\r\n      }.bind(this));\r\n    }, this);\r\n    return target;\r\n  },\r\n  compose: function compose() {\r\n    var toCall = ARR_SLICE.call(arguments);\r\n    return function () {\r\n      var args = ARR_SLICE.call(arguments);\r\n      for (var i = toCall.length - 1; i >= 0; i--) {\r\n        args = [toCall[i].apply(this, args)];\r\n      }\r\n      return args[0];\r\n    };\r\n  },\r\n  each: function each(obj, itr, scope) {\r\n    if (!obj) {\r\n      return;\r\n    }\r\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\r\n      obj.forEach(itr, scope);\r\n    } else if (obj.length === obj.length + 0) {\r\n      var key = void 0;\r\n      var l = void 0;\r\n      for (key = 0, l = obj.length; key < l; key++) {\r\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    } else {\r\n      for (var _key in obj) {\r\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  },\r\n  defer: function defer(fnc) {\r\n    setTimeout(fnc, 0);\r\n  },\r\n  debounce: function debounce(func, threshold, callImmediately) {\r\n    var timeout = void 0;\r\n    return function () {\r\n      var obj = this;\r\n      var args = arguments;\r\n      function delayed() {\r\n        timeout = null;\r\n        if (!callImmediately) func.apply(obj, args);\r\n      }\r\n      var callNow = callImmediately || !timeout;\r\n      clearTimeout(timeout);\r\n      timeout = setTimeout(delayed, threshold);\r\n      if (callNow) {\r\n        func.apply(obj, args);\r\n      }\r\n    };\r\n  },\r\n  toArray: function toArray(obj) {\r\n    if (obj.toArray) return obj.toArray();\r\n    return ARR_SLICE.call(obj);\r\n  },\r\n  isUndefined: function isUndefined(obj) {\r\n    return obj === undefined;\r\n  },\r\n  isNull: function isNull(obj) {\r\n    return obj === null;\r\n  },\r\n  isNaN: function (_isNaN) {\r\n    function isNaN(_x) {\r\n      return _isNaN.apply(this, arguments);\r\n    }\r\n    isNaN.toString = function () {\r\n      return _isNaN.toString();\r\n    };\r\n    return isNaN;\r\n  }(function (obj) {\r\n    return isNaN(obj);\r\n  }),\r\n  isArray: Array.isArray || function (obj) {\r\n    return obj.constructor === Array;\r\n  },\r\n  isObject: function isObject(obj) {\r\n    return obj === Object(obj);\r\n  },\r\n  isNumber: function isNumber(obj) {\r\n    return obj === obj + 0;\r\n  },\r\n  isString: function isString(obj) {\r\n    return obj === obj + '';\r\n  },\r\n  isBoolean: function isBoolean(obj) {\r\n    return obj === false || obj === true;\r\n  },\r\n  isFunction: function isFunction(obj) {\r\n    return Object.prototype.toString.call(obj) === '[object Function]';\r\n  }\r\n};\r\n\r\nvar INTERPRETATIONS = [\r\n{\r\n  litmus: Common.isString,\r\n  conversions: {\r\n    THREE_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    SIX_CHAR_HEX: {\r\n      read: function read(original) {\r\n        var test = original.match(/^#([A-F0-9]{6})$/i);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'HEX',\r\n          hex: parseInt('0x' + test[1].toString(), 0)\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGB: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3])\r\n        };\r\n      },\r\n      write: colorToString\r\n    },\r\n    CSS_RGBA: {\r\n      read: function read(original) {\r\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\r\n        if (test === null) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: parseFloat(test[1]),\r\n          g: parseFloat(test[2]),\r\n          b: parseFloat(test[3]),\r\n          a: parseFloat(test[4])\r\n        };\r\n      },\r\n      write: colorToString\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isNumber,\r\n  conversions: {\r\n    HEX: {\r\n      read: function read(original) {\r\n        return {\r\n          space: 'HEX',\r\n          hex: original,\r\n          conversionName: 'HEX'\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return color.hex;\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isArray,\r\n  conversions: {\r\n    RGB_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 3) {\r\n          return false;\r\n        }\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b];\r\n      }\r\n    },\r\n    RGBA_ARRAY: {\r\n      read: function read(original) {\r\n        if (original.length !== 4) return false;\r\n        return {\r\n          space: 'RGB',\r\n          r: original[0],\r\n          g: original[1],\r\n          b: original[2],\r\n          a: original[3]\r\n        };\r\n      },\r\n      write: function write(color) {\r\n        return [color.r, color.g, color.b, color.a];\r\n      }\r\n    }\r\n  }\r\n},\r\n{\r\n  litmus: Common.isObject,\r\n  conversions: {\r\n    RGBA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    RGB_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\r\n          return {\r\n            space: 'RGB',\r\n            r: original.r,\r\n            g: original.g,\r\n            b: original.b\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          r: color.r,\r\n          g: color.g,\r\n          b: color.b\r\n        };\r\n      }\r\n    },\r\n    HSVA_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v,\r\n            a: original.a\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v,\r\n          a: color.a\r\n        };\r\n      }\r\n    },\r\n    HSV_OBJ: {\r\n      read: function read(original) {\r\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\r\n          return {\r\n            space: 'HSV',\r\n            h: original.h,\r\n            s: original.s,\r\n            v: original.v\r\n          };\r\n        }\r\n        return false;\r\n      },\r\n      write: function write(color) {\r\n        return {\r\n          h: color.h,\r\n          s: color.s,\r\n          v: color.v\r\n        };\r\n      }\r\n    }\r\n  }\r\n}];\r\nvar result = void 0;\r\nvar toReturn = void 0;\r\nvar interpret = function interpret() {\r\n  toReturn = false;\r\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\r\n  Common.each(INTERPRETATIONS, function (family) {\r\n    if (family.litmus(original)) {\r\n      Common.each(family.conversions, function (conversion, conversionName) {\r\n        result = conversion.read(original);\r\n        if (toReturn === false && result !== false) {\r\n          toReturn = result;\r\n          result.conversionName = conversionName;\r\n          result.conversion = conversion;\r\n          return Common.BREAK;\r\n        }\r\n      });\r\n      return Common.BREAK;\r\n    }\r\n  });\r\n  return toReturn;\r\n};\r\n\r\nvar tmpComponent = void 0;\r\nvar ColorMath = {\r\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\r\n    var hi = Math.floor(h / 60) % 6;\r\n    var f = h / 60 - Math.floor(h / 60);\r\n    var p = v * (1.0 - s);\r\n    var q = v * (1.0 - f * s);\r\n    var t = v * (1.0 - (1.0 - f) * s);\r\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\r\n    return {\r\n      r: c[0] * 255,\r\n      g: c[1] * 255,\r\n      b: c[2] * 255\r\n    };\r\n  },\r\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\r\n    var min = Math.min(r, g, b);\r\n    var max = Math.max(r, g, b);\r\n    var delta = max - min;\r\n    var h = void 0;\r\n    var s = void 0;\r\n    if (max !== 0) {\r\n      s = delta / max;\r\n    } else {\r\n      return {\r\n        h: NaN,\r\n        s: 0,\r\n        v: 0\r\n      };\r\n    }\r\n    if (r === max) {\r\n      h = (g - b) / delta;\r\n    } else if (g === max) {\r\n      h = 2 + (b - r) / delta;\r\n    } else {\r\n      h = 4 + (r - g) / delta;\r\n    }\r\n    h /= 6;\r\n    if (h < 0) {\r\n      h += 1;\r\n    }\r\n    return {\r\n      h: h * 360,\r\n      s: s,\r\n      v: max / 255\r\n    };\r\n  },\r\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\r\n    var hex = this.hex_with_component(0, 2, r);\r\n    hex = this.hex_with_component(hex, 1, g);\r\n    hex = this.hex_with_component(hex, 0, b);\r\n    return hex;\r\n  },\r\n  component_from_hex: function component_from_hex(hex, componentIndex) {\r\n    return hex >> componentIndex * 8 & 0xFF;\r\n  },\r\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\r\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\r\n  }\r\n};\r\n\r\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\r\n  return typeof obj;\r\n} : function (obj) {\r\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar classCallCheck = function (instance, Constructor) {\r\n  if (!(instance instanceof Constructor)) {\r\n    throw new TypeError(\"Cannot call a class as a function\");\r\n  }\r\n};\r\n\r\nvar createClass = function () {\r\n  function defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n      var descriptor = props[i];\r\n      descriptor.enumerable = descriptor.enumerable || false;\r\n      descriptor.configurable = true;\r\n      if (\"value\" in descriptor) descriptor.writable = true;\r\n      Object.defineProperty(target, descriptor.key, descriptor);\r\n    }\r\n  }\r\n\r\n  return function (Constructor, protoProps, staticProps) {\r\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\r\n    if (staticProps) defineProperties(Constructor, staticProps);\r\n    return Constructor;\r\n  };\r\n}();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar get = function get(object, property, receiver) {\r\n  if (object === null) object = Function.prototype;\r\n  var desc = Object.getOwnPropertyDescriptor(object, property);\r\n\r\n  if (desc === undefined) {\r\n    var parent = Object.getPrototypeOf(object);\r\n\r\n    if (parent === null) {\r\n      return undefined;\r\n    } else {\r\n      return get(parent, property, receiver);\r\n    }\r\n  } else if (\"value\" in desc) {\r\n    return desc.value;\r\n  } else {\r\n    var getter = desc.get;\r\n\r\n    if (getter === undefined) {\r\n      return undefined;\r\n    }\r\n\r\n    return getter.call(receiver);\r\n  }\r\n};\r\n\r\nvar inherits = function (subClass, superClass) {\r\n  if (typeof superClass !== \"function\" && superClass !== null) {\r\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\r\n  }\r\n\r\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\r\n    constructor: {\r\n      value: subClass,\r\n      enumerable: false,\r\n      writable: true,\r\n      configurable: true\r\n    }\r\n  });\r\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar possibleConstructorReturn = function (self, call) {\r\n  if (!self) {\r\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\r\n  }\r\n\r\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\r\n};\r\n\r\nvar Color = function () {\r\n  function Color() {\r\n    classCallCheck(this, Color);\r\n    this.__state = interpret.apply(this, arguments);\r\n    if (this.__state === false) {\r\n      throw new Error('Failed to interpret color arguments');\r\n    }\r\n    this.__state.a = this.__state.a || 1;\r\n  }\r\n  createClass(Color, [{\r\n    key: 'toString',\r\n    value: function toString() {\r\n      return colorToString(this);\r\n    }\r\n  }, {\r\n    key: 'toHexString',\r\n    value: function toHexString() {\r\n      return colorToString(this, true);\r\n    }\r\n  }, {\r\n    key: 'toOriginal',\r\n    value: function toOriginal() {\r\n      return this.__state.conversion.write(this);\r\n    }\r\n  }]);\r\n  return Color;\r\n}();\r\nfunction defineRGBComponent(target, component, componentHexIndex) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'RGB') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateRGB(this, component, componentHexIndex);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'RGB') {\r\n        Color.recalculateRGB(this, component, componentHexIndex);\r\n        this.__state.space = 'RGB';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nfunction defineHSVComponent(target, component) {\r\n  Object.defineProperty(target, component, {\r\n    get: function get$$1() {\r\n      if (this.__state.space === 'HSV') {\r\n        return this.__state[component];\r\n      }\r\n      Color.recalculateHSV(this);\r\n      return this.__state[component];\r\n    },\r\n    set: function set$$1(v) {\r\n      if (this.__state.space !== 'HSV') {\r\n        Color.recalculateHSV(this);\r\n        this.__state.space = 'HSV';\r\n      }\r\n      this.__state[component] = v;\r\n    }\r\n  });\r\n}\r\nColor.recalculateRGB = function (color, component, componentHexIndex) {\r\n  if (color.__state.space === 'HEX') {\r\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\r\n  } else if (color.__state.space === 'HSV') {\r\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\r\n  } else {\r\n    throw new Error('Corrupted color state');\r\n  }\r\n};\r\nColor.recalculateHSV = function (color) {\r\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\r\n  Common.extend(color.__state, {\r\n    s: result.s,\r\n    v: result.v\r\n  });\r\n  if (!Common.isNaN(result.h)) {\r\n    color.__state.h = result.h;\r\n  } else if (Common.isUndefined(color.__state.h)) {\r\n    color.__state.h = 0;\r\n  }\r\n};\r\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\r\ndefineRGBComponent(Color.prototype, 'r', 2);\r\ndefineRGBComponent(Color.prototype, 'g', 1);\r\ndefineRGBComponent(Color.prototype, 'b', 0);\r\ndefineHSVComponent(Color.prototype, 'h');\r\ndefineHSVComponent(Color.prototype, 's');\r\ndefineHSVComponent(Color.prototype, 'v');\r\nObject.defineProperty(Color.prototype, 'a', {\r\n  get: function get$$1() {\r\n    return this.__state.a;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.a = v;\r\n  }\r\n});\r\nObject.defineProperty(Color.prototype, 'hex', {\r\n  get: function get$$1() {\r\n    if (!this.__state.space !== 'HEX') {\r\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\r\n    }\r\n    return this.__state.hex;\r\n  },\r\n  set: function set$$1(v) {\r\n    this.__state.space = 'HEX';\r\n    this.__state.hex = v;\r\n  }\r\n});\r\n\r\nvar Controller = function () {\r\n  function Controller(object, property) {\r\n    classCallCheck(this, Controller);\r\n    this.initialValue = object[property];\r\n    this.domElement = document.createElement('div');\r\n    this.object = object;\r\n    this.property = property;\r\n    this.__onChange = undefined;\r\n    this.__onFinishChange = undefined;\r\n  }\r\n  createClass(Controller, [{\r\n    key: 'onChange',\r\n    value: function onChange(fnc) {\r\n      this.__onChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'onFinishChange',\r\n    value: function onFinishChange(fnc) {\r\n      this.__onFinishChange = fnc;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'setValue',\r\n    value: function setValue(newValue) {\r\n      this.object[this.property] = newValue;\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this, newValue);\r\n      }\r\n      this.updateDisplay();\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'getValue',\r\n    value: function getValue() {\r\n      return this.object[this.property];\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'isModified',\r\n    value: function isModified() {\r\n      return this.initialValue !== this.getValue();\r\n    }\r\n  }]);\r\n  return Controller;\r\n}();\r\n\r\nvar EVENT_MAP = {\r\n  HTMLEvents: ['change'],\r\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\r\n  KeyboardEvents: ['keydown']\r\n};\r\nvar EVENT_MAP_INV = {};\r\nCommon.each(EVENT_MAP, function (v, k) {\r\n  Common.each(v, function (e) {\r\n    EVENT_MAP_INV[e] = k;\r\n  });\r\n});\r\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\r\nfunction cssValueToPixels(val) {\r\n  if (val === '0' || Common.isUndefined(val)) {\r\n    return 0;\r\n  }\r\n  var match = val.match(CSS_VALUE_PIXELS);\r\n  if (!Common.isNull(match)) {\r\n    return parseFloat(match[1]);\r\n  }\r\n  return 0;\r\n}\r\nvar dom = {\r\n  makeSelectable: function makeSelectable(elem, selectable) {\r\n    if (elem === undefined || elem.style === undefined) return;\r\n    elem.onselectstart = selectable ? function () {\r\n      return false;\r\n    } : function () {};\r\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\r\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\r\n    elem.unselectable = selectable ? 'on' : 'off';\r\n  },\r\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\r\n    var vertical = vert;\r\n    var horizontal = hor;\r\n    if (Common.isUndefined(horizontal)) {\r\n      horizontal = true;\r\n    }\r\n    if (Common.isUndefined(vertical)) {\r\n      vertical = true;\r\n    }\r\n    elem.style.position = 'absolute';\r\n    if (horizontal) {\r\n      elem.style.left = 0;\r\n      elem.style.right = 0;\r\n    }\r\n    if (vertical) {\r\n      elem.style.top = 0;\r\n      elem.style.bottom = 0;\r\n    }\r\n  },\r\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\r\n    var params = pars || {};\r\n    var className = EVENT_MAP_INV[eventType];\r\n    if (!className) {\r\n      throw new Error('Event type ' + eventType + ' not supported.');\r\n    }\r\n    var evt = document.createEvent(className);\r\n    switch (className) {\r\n      case 'MouseEvents':\r\n        {\r\n          var clientX = params.x || params.clientX || 0;\r\n          var clientY = params.y || params.clientY || 0;\r\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0,\r\n          0,\r\n          clientX,\r\n          clientY,\r\n          false, false, false, false, 0, null);\r\n          break;\r\n        }\r\n      case 'KeyboardEvents':\r\n        {\r\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\r\n          Common.defaults(params, {\r\n            cancelable: true,\r\n            ctrlKey: false,\r\n            altKey: false,\r\n            shiftKey: false,\r\n            metaKey: false,\r\n            keyCode: undefined,\r\n            charCode: undefined\r\n          });\r\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\r\n          break;\r\n        }\r\n      default:\r\n        {\r\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\r\n          break;\r\n        }\r\n    }\r\n    Common.defaults(evt, aux);\r\n    elem.dispatchEvent(evt);\r\n  },\r\n  bind: function bind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.addEventListener) {\r\n      elem.addEventListener(event, func, {\r\n        passive: bool\r\n      });\r\n    } else if (elem.attachEvent) {\r\n      elem.attachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  unbind: function unbind(elem, event, func, newBool) {\r\n    var bool = newBool || false;\r\n    if (elem.removeEventListener) {\r\n      elem.removeEventListener(event, func, bool);\r\n    } else if (elem.detachEvent) {\r\n      elem.detachEvent('on' + event, func);\r\n    }\r\n    return dom;\r\n  },\r\n  addClass: function addClass(elem, className) {\r\n    if (elem.className === undefined) {\r\n      elem.className = className;\r\n    } else if (elem.className !== className) {\r\n      var classes = elem.className.split(/ +/);\r\n      if (classes.indexOf(className) === -1) {\r\n        classes.push(className);\r\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\r\n      }\r\n    }\r\n    return dom;\r\n  },\r\n  removeClass: function removeClass(elem, className) {\r\n    if (className) {\r\n      if (elem.className === className) {\r\n        elem.removeAttribute('class');\r\n      } else {\r\n        var classes = elem.className.split(/ +/);\r\n        var index = classes.indexOf(className);\r\n        if (index !== -1) {\r\n          classes.splice(index, 1);\r\n          elem.className = classes.join(' ');\r\n        }\r\n      }\r\n    } else {\r\n      elem.className = undefined;\r\n    }\r\n    return dom;\r\n  },\r\n  hasClass: function hasClass(elem, className) {\r\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\r\n  },\r\n  getWidth: function getWidth(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\r\n  },\r\n  getHeight: function getHeight(elem) {\r\n    var style = getComputedStyle(elem);\r\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\r\n  },\r\n  getOffset: function getOffset(el) {\r\n    var elem = el;\r\n    var offset = { left: 0, top: 0 };\r\n    if (elem.offsetParent) {\r\n      do {\r\n        offset.left += elem.offsetLeft;\r\n        offset.top += elem.offsetTop;\r\n        elem = elem.offsetParent;\r\n      } while (elem);\r\n    }\r\n    return offset;\r\n  },\r\n  isActive: function isActive(elem) {\r\n    return elem === document.activeElement && (elem.type || elem.href);\r\n  }\r\n};\r\n\r\nvar BooleanController = function (_Controller) {\r\n  inherits(BooleanController, _Controller);\r\n  function BooleanController(object, property) {\r\n    classCallCheck(this, BooleanController);\r\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__prev = _this2.getValue();\r\n    _this2.__checkbox = document.createElement('input');\r\n    _this2.__checkbox.setAttribute('type', 'checkbox');\r\n    function onChange() {\r\n      _this.setValue(!_this.__prev);\r\n    }\r\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\r\n    _this2.domElement.appendChild(_this2.__checkbox);\r\n    _this2.updateDisplay();\r\n    return _this2;\r\n  }\r\n  createClass(BooleanController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      this.__prev = this.getValue();\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (this.getValue() === true) {\r\n        this.__checkbox.setAttribute('checked', 'checked');\r\n        this.__checkbox.checked = true;\r\n        this.__prev = true;\r\n      } else {\r\n        this.__checkbox.checked = false;\r\n        this.__prev = false;\r\n      }\r\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return BooleanController;\r\n}(Controller);\r\n\r\nvar OptionController = function (_Controller) {\r\n  inherits(OptionController, _Controller);\r\n  function OptionController(object, property, opts) {\r\n    classCallCheck(this, OptionController);\r\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\r\n    var options = opts;\r\n    var _this = _this2;\r\n    _this2.__select = document.createElement('select');\r\n    if (Common.isArray(options)) {\r\n      var map = {};\r\n      Common.each(options, function (element) {\r\n        map[element] = element;\r\n      });\r\n      options = map;\r\n    }\r\n    Common.each(options, function (value, key) {\r\n      var opt = document.createElement('option');\r\n      opt.innerHTML = key;\r\n      opt.setAttribute('value', value);\r\n      _this.__select.appendChild(opt);\r\n    });\r\n    _this2.updateDisplay();\r\n    dom.bind(_this2.__select, 'change', function () {\r\n      var desiredValue = this.options[this.selectedIndex].value;\r\n      _this.setValue(desiredValue);\r\n    });\r\n    _this2.domElement.appendChild(_this2.__select);\r\n    return _this2;\r\n  }\r\n  createClass(OptionController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n      return toReturn;\r\n    }\r\n  }, {\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (dom.isActive(this.__select)) return this;\r\n      this.__select.value = this.getValue();\r\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return OptionController;\r\n}(Controller);\r\n\r\nvar StringController = function (_Controller) {\r\n  inherits(StringController, _Controller);\r\n  function StringController(object, property) {\r\n    classCallCheck(this, StringController);\r\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\r\n    var _this = _this2;\r\n    function onChange() {\r\n      _this.setValue(_this.__input.value);\r\n    }\r\n    function onBlur() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'keyup', onChange);\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        this.blur();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(StringController, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      if (!dom.isActive(this.__input)) {\r\n        this.__input.value = this.getValue();\r\n      }\r\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return StringController;\r\n}(Controller);\r\n\r\nfunction numDecimals(x) {\r\n  var _x = x.toString();\r\n  if (_x.indexOf('.') > -1) {\r\n    return _x.length - _x.indexOf('.') - 1;\r\n  }\r\n  return 0;\r\n}\r\nvar NumberController = function (_Controller) {\r\n  inherits(NumberController, _Controller);\r\n  function NumberController(object, property, params) {\r\n    classCallCheck(this, NumberController);\r\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\r\n    var _params = params || {};\r\n    _this.__min = _params.min;\r\n    _this.__max = _params.max;\r\n    _this.__step = _params.step;\r\n    if (Common.isUndefined(_this.__step)) {\r\n      if (_this.initialValue === 0) {\r\n        _this.__impliedStep = 1;\r\n      } else {\r\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\r\n      }\r\n    } else {\r\n      _this.__impliedStep = _this.__step;\r\n    }\r\n    _this.__precision = numDecimals(_this.__impliedStep);\r\n    return _this;\r\n  }\r\n  createClass(NumberController, [{\r\n    key: 'setValue',\r\n    value: function setValue(v) {\r\n      var _v = v;\r\n      if (this.__min !== undefined && _v < this.__min) {\r\n        _v = this.__min;\r\n      } else if (this.__max !== undefined && _v > this.__max) {\r\n        _v = this.__max;\r\n      }\r\n      if (this.__step !== undefined && _v % this.__step !== 0) {\r\n        _v = Math.round(_v / this.__step) * this.__step;\r\n      }\r\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\r\n    }\r\n  }, {\r\n    key: 'min',\r\n    value: function min(minValue) {\r\n      this.__min = minValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'max',\r\n    value: function max(maxValue) {\r\n      this.__max = maxValue;\r\n      return this;\r\n    }\r\n  }, {\r\n    key: 'step',\r\n    value: function step(stepValue) {\r\n      this.__step = stepValue;\r\n      this.__impliedStep = stepValue;\r\n      this.__precision = numDecimals(stepValue);\r\n      return this;\r\n    }\r\n  }]);\r\n  return NumberController;\r\n}(Controller);\r\n\r\nfunction roundToDecimal(value, decimals) {\r\n  var tenTo = Math.pow(10, decimals);\r\n  return Math.round(value * tenTo) / tenTo;\r\n}\r\nvar NumberControllerBox = function (_NumberController) {\r\n  inherits(NumberControllerBox, _NumberController);\r\n  function NumberControllerBox(object, property, params) {\r\n    classCallCheck(this, NumberControllerBox);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\r\n    _this2.__truncationSuspended = false;\r\n    var _this = _this2;\r\n    var prevY = void 0;\r\n    function onChange() {\r\n      var attempted = parseFloat(_this.__input.value);\r\n      if (!Common.isNaN(attempted)) {\r\n        _this.setValue(attempted);\r\n      }\r\n    }\r\n    function onFinish() {\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onBlur() {\r\n      onFinish();\r\n    }\r\n    function onMouseDrag(e) {\r\n      var diff = prevY - e.clientY;\r\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\r\n      prevY = e.clientY;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      onFinish();\r\n    }\r\n    function onMouseDown(e) {\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      prevY = e.clientY;\r\n    }\r\n    _this2.__input = document.createElement('input');\r\n    _this2.__input.setAttribute('type', 'text');\r\n    dom.bind(_this2.__input, 'change', onChange);\r\n    dom.bind(_this2.__input, 'blur', onBlur);\r\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\r\n    dom.bind(_this2.__input, 'keydown', function (e) {\r\n      if (e.keyCode === 13) {\r\n        _this.__truncationSuspended = true;\r\n        this.blur();\r\n        _this.__truncationSuspended = false;\r\n        onFinish();\r\n      }\r\n    });\r\n    _this2.updateDisplay();\r\n    _this2.domElement.appendChild(_this2.__input);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerBox, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\r\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerBox;\r\n}(NumberController);\r\n\r\nfunction map(v, i1, i2, o1, o2) {\r\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\r\n}\r\nvar NumberControllerSlider = function (_NumberController) {\r\n  inherits(NumberControllerSlider, _NumberController);\r\n  function NumberControllerSlider(object, property, min, max, step, newBool) {\r\n    classCallCheck(this, NumberControllerSlider);\r\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, { min: min, max: max, step: step }));\r\n    var _this = _this2;\r\n    _this2.__background = document.createElement('div');\r\n    _this2.__foreground = document.createElement('div');\r\n    _this2.newBool = newBool;\r\n    dom.bind(_this2.__background, 'mousedown', onMouseDown, newBool);\r\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\r\n    dom.addClass(_this2.__background, 'slider');\r\n    dom.addClass(_this2.__foreground, 'slider-fg');\r\n    function onMouseDown(e) {\r\n      document.activeElement.blur();\r\n      dom.bind(window, 'mousemove', onMouseDrag);\r\n      dom.bind(window, 'mouseup', onMouseUp);\r\n      onMouseDrag(e);\r\n    }\r\n    function onMouseDrag(e) {\r\n      if (!_this.newBool) e.preventDefault();\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n      return false;\r\n    }\r\n    function onMouseUp() {\r\n      dom.unbind(window, 'mousemove', onMouseDrag);\r\n      dom.unbind(window, 'mouseup', onMouseUp);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    function onTouchStart(e) {\r\n      if (e.touches.length !== 1) {\r\n        return;\r\n      }\r\n      dom.bind(window, 'touchmove', onTouchMove);\r\n      dom.bind(window, 'touchend', onTouchEnd);\r\n      onTouchMove(e);\r\n    }\r\n    function onTouchMove(e) {\r\n      var clientX = e.touches[0].clientX;\r\n      var bgRect = _this.__background.getBoundingClientRect();\r\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\r\n    }\r\n    function onTouchEnd() {\r\n      dom.unbind(window, 'touchmove', onTouchMove);\r\n      dom.unbind(window, 'touchend', onTouchEnd);\r\n      if (_this.__onFinishChange) {\r\n        _this.__onFinishChange.call(_this, _this.getValue());\r\n      }\r\n    }\r\n    _this2.updateDisplay();\r\n    _this2.__background.appendChild(_this2.__foreground);\r\n    _this2.domElement.appendChild(_this2.__background);\r\n    return _this2;\r\n  }\r\n  createClass(NumberControllerSlider, [{\r\n    key: 'updateDisplay',\r\n    value: function updateDisplay() {\r\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\r\n      this.__foreground.style.width = pct * 100 + '%';\r\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\r\n    }\r\n  }]);\r\n  return NumberControllerSlider;\r\n}(NumberController);\r\n\r\nvar FunctionController = function (_Controller) {\r\n  inherits(FunctionController, _Controller);\r\n  function FunctionController(object, property, text) {\r\n    classCallCheck(this, FunctionController);\r\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\r\n    var _this = _this2;\r\n    _this2.__button = document.createElement('div');\r\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\r\n    dom.bind(_this2.__button, 'click', function (e) {\r\n      e.preventDefault();\r\n      _this.fire();\r\n      return false;\r\n    });\r\n    dom.addClass(_this2.__button, 'button');\r\n    _this2.domElement.appendChild(_this2.__button);\r\n    return _this2;\r\n  }\r\n  createClass(FunctionController, [{\r\n    key: 'fire',\r\n    value: function fire() {\r\n      if (this.__onChange) {\r\n        this.__onChange.call(this);\r\n      }\r\n      this.getValue().call(this.object);\r\n      if (this.__onFinishChange) {\r\n        this.__onFinishChange.call(this, this.getValue());\r\n      }\r\n    }\r\n  }]);\r\n  return FunctionController;\r\n}(Controller);\r\n\r\nvar ColorController = function (_Controller) {\r\n    inherits(ColorController, _Controller);\r\n    function ColorController(object, property) {\r\n        classCallCheck(this, ColorController);\r\n        var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\r\n        _this2.__color = new Color(_this2.getValue());\r\n        _this2.__temp = new Color(0);\r\n        var _this = _this2;\r\n        _this2.domElement = document.createElement('div');\r\n        dom.makeSelectable(_this2.domElement, false);\r\n        _this2.__selector = document.createElement('div');\r\n        _this2.__selector.className = 'selector';\r\n        _this2.__saturation_field = document.createElement('div');\r\n        _this2.__saturation_field.className = 'saturation-field';\r\n        _this2.__field_knob = document.createElement('div');\r\n        _this2.__field_knob.className = 'field-knob';\r\n        _this2.__field_knob_border = '2px solid ';\r\n        _this2.__hue_knob = document.createElement('div');\r\n        _this2.__hue_knob.className = 'hue-knob';\r\n        _this2.__hue_field = document.createElement('div');\r\n        _this2.__hue_field.className = 'hue-field';\r\n        _this2.__input = document.createElement('input');\r\n        _this2.__input.type = 'text';\r\n        _this2.__input_textShadow = '0 1px 1px ';\r\n        dom.bind(_this2.__input, 'keydown', function (e) {\r\n            if (e.keyCode === 13) {\r\n                onBlur.call(this);\r\n            }\r\n        });\r\n        dom.bind(_this2.__input, 'blur', onBlur);\r\n        dom.bind(_this2.__selector, 'mousedown', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'mouseup', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        dom.bind(_this2.__selector, 'touchstart', function ()        {\r\n            dom.addClass(this, 'drag').bind(window, 'touchend', function ()        {\r\n                dom.removeClass(_this.__selector, 'drag');\r\n            });\r\n        });\r\n        var valueField = document.createElement('div');\r\n        Common.extend(_this2.__selector.style, {\r\n            width: '122px',\r\n            height: '102px',\r\n            padding: '3px',\r\n            backgroundColor: '#222',\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\r\n        });\r\n        Common.extend(_this2.__field_knob.style, {\r\n            position: 'absolute',\r\n            width: '12px',\r\n            height: '12px',\r\n            border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\r\n            boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\r\n            borderRadius: '12px',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__hue_knob.style, {\r\n            position: 'absolute',\r\n            width: '15px',\r\n            height: '2px',\r\n            borderRight: '4px solid #fff',\r\n            zIndex: 1\r\n        });\r\n        Common.extend(_this2.__saturation_field.style, {\r\n            width: '100px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            marginRight: '3px',\r\n            display: 'inline-block',\r\n            cursor: 'pointer'\r\n        });\r\n        Common.extend(valueField.style, {\r\n            width: '100%',\r\n            height: '100%',\r\n            background: 'none'\r\n        });\r\n        linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\r\n        Common.extend(_this2.__hue_field.style, {\r\n            width: '15px',\r\n            height: '100px',\r\n            border: '1px solid #555',\r\n            cursor: 'ns-resize',\r\n            position: 'absolute',\r\n            top: '3px',\r\n            right: '3px'\r\n        });\r\n        hueGradient(_this2.__hue_field);\r\n        Common.extend(_this2.__input.style, {\r\n            outline: 'none',\r\n            textAlign: 'center',\r\n            color: '#fff',\r\n            border: 0,\r\n            fontWeight: 'bold',\r\n            textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\r\n        });\r\n        dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\r\n        dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\r\n        dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\r\n        dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\r\n        function fieldDown(e) {\r\n            setSV(e);\r\n            dom.bind(window, 'mousemove', setSV);\r\n            dom.bind(window, 'touchmove', setSV);\r\n            dom.bind(window, 'mouseup', fieldUpSV);\r\n            dom.bind(window, 'touchend', fieldUpSV);\r\n        }\r\n        function fieldDownH(e) {\r\n            setH(e);\r\n            dom.bind(window, 'mousemove', setH);\r\n            dom.bind(window, 'touchmove', setH);\r\n            dom.bind(window, 'mouseup', fieldUpH);\r\n            dom.bind(window, 'touchend', fieldUpH);\r\n        }\r\n        function fieldUpSV() {\r\n            dom.unbind(window, 'mousemove', setSV);\r\n            dom.unbind(window, 'touchmove', setSV);\r\n            dom.unbind(window, 'mouseup', fieldUpSV);\r\n            dom.unbind(window, 'touchend', fieldUpSV);\r\n            onFinish();\r\n        }\r\n        function fieldUpH() {\r\n            dom.unbind(window, 'mousemove', setH);\r\n            dom.unbind(window, 'touchmove', setH);\r\n            dom.unbind(window, 'mouseup', fieldUpH);\r\n            dom.unbind(window, 'touchend', fieldUpH);\r\n            onFinish();\r\n        }\r\n        function onBlur() {\r\n            var i = interpret(this.value);\r\n            if (i !== false) {\r\n                _this.__color.__state = i;\r\n                _this.setValue(_this.__color.toOriginal());\r\n            } else {\r\n                this.value = _this.__color.toString();\r\n            }\r\n        }\r\n        function onFinish() {\r\n            if (_this.__onFinishChange) {\r\n                _this.__onFinishChange.call(_this, _this.__color.toOriginal());\r\n            }\r\n        }\r\n        _this2.__saturation_field.appendChild(valueField);\r\n        _this2.__selector.appendChild(_this2.__field_knob);\r\n        _this2.__selector.appendChild(_this2.__saturation_field);\r\n        _this2.__selector.appendChild(_this2.__hue_field);\r\n        _this2.__hue_field.appendChild(_this2.__hue_knob);\r\n        _this2.domElement.appendChild(_this2.__input);\r\n        _this2.domElement.appendChild(_this2.__selector);\r\n        _this2.updateDisplay();\r\n        function setSV(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__saturation_field.getBoundingClientRect();\r\n            var _ref = e.touches && e.touches[0] || e,\r\n                clientX = _ref.clientX,\r\n                clientY = _ref.clientY;\r\n            var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\r\n            var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (v > 1) {\r\n                v = 1;\r\n            } else if (v < 0) {\r\n                v = 0;\r\n            }\r\n            if (s > 1) {\r\n                s = 1;\r\n            } else if (s < 0) {\r\n                s = 0;\r\n            }\r\n            _this.__color.v = v;\r\n            _this.__color.s = s;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        function setH(e) {\r\n            if (e.type.indexOf('touch') === -1) {\r\n                e.preventDefault();\r\n            }\r\n            var fieldRect = _this.__hue_field.getBoundingClientRect();\r\n            var _ref2 = e.touches && e.touches[0] || e,\r\n                clientY = _ref2.clientY;\r\n            var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\r\n            if (h > 1) {\r\n                h = 1;\r\n            } else if (h < 0) {\r\n                h = 0;\r\n            }\r\n            _this.__color.h = h * 360;\r\n            _this.setValue(_this.__color.toOriginal());\r\n            return false;\r\n        }\r\n        return _this2;\r\n    }\r\n    createClass(ColorController, [{\r\n        key: 'updateDisplay',\r\n        value: function updateDisplay() {\r\n            var i = interpret(this.getValue());\r\n            if (i !== false) {\r\n                var mismatch = false;\r\n                Common.each(Color.COMPONENTS, function (component) {\r\n                    if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\r\n                        mismatch = true;\r\n                        return {};\r\n                    }\r\n                }, this);\r\n                if (mismatch) {\r\n                    Common.extend(this.__color.__state, i);\r\n                }\r\n            }\r\n            Common.extend(this.__temp.__state, this.__color.__state);\r\n            this.__temp.a = 1;\r\n            var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\r\n            var _flip = 255 - flip;\r\n            Common.extend(this.__field_knob.style, {\r\n                marginLeft: 100 * this.__color.s - 7 + 'px',\r\n                marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\r\n                backgroundColor: this.__temp.toHexString(),\r\n                border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\r\n            });\r\n            this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\r\n            this.__temp.s = 1;\r\n            this.__temp.v = 1;\r\n            linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\r\n            this.__input.value = this.__color.toString();\r\n            Common.extend(this.__input.style, {\r\n                backgroundColor: this.__color.toHexString(),\r\n                color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\r\n                textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\r\n            });\r\n        }\r\n    }]);\r\n    return ColorController;\r\n}(Controller);\r\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\r\nfunction linearGradient(elem, x, a, b) {\r\n    elem.style.background = '';\r\n    Common.each(vendors, function (vendor) {\r\n        elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\r\n    });\r\n}\r\nfunction hueGradient(elem) {\r\n    elem.style.background = '';\r\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\r\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\r\n}\r\n\r\nvar ControllerFactory = function ControllerFactory(object, property) {\r\n  var initialValue = object[property];\r\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\r\n    return new OptionController(object, property, arguments[2]);\r\n  }\r\n  if (Common.isNumber(initialValue)) {\r\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\r\n      if (Common.isNumber(arguments[4])) {\r\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4], arguments[5]);\r\n      }\r\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\r\n    }\r\n    if (Common.isNumber(arguments[4])) {\r\n      return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3], step: arguments[4] });\r\n    }\r\n    return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\r\n  }\r\n  if (Common.isString(initialValue)) {\r\n    return new StringController(object, property);\r\n  }\r\n  if (Common.isFunction(initialValue)) {\r\n    return new FunctionController(object, property, '');\r\n  }\r\n  if (Common.isBoolean(initialValue)) {\r\n    return new BooleanController(object, property);\r\n  }\r\n  return null;\r\n};\r\n\r\nvar CustomController = function (_Controller) {\r\n  inherits(CustomController, _Controller);\r\n  function CustomController(object, property) {\r\n    classCallCheck(this, CustomController);\r\n    var _this = possibleConstructorReturn(this, (CustomController.__proto__ || Object.getPrototypeOf(CustomController)).call(this, object, property));\r\n    _this.arguments = {\r\n      object: object, property: property, opts: Array.prototype.slice.call(arguments, 2)\r\n    };\r\n    if (object.property) _this.property = object.property(_this);\r\n    return _this;\r\n  }\r\n  createClass(CustomController, [{\r\n    key: 'controller',\r\n    set: function set$$1(newController) {\r\n      this._controller = newController;\r\n    },\r\n    get: function get$$1() {\r\n      return this._controller;\r\n    }\r\n  }]);\r\n  return CustomController;\r\n}(Controller);\r\n\r\nvar css = {\r\n  load: function load(url, indoc) {\r\n    var doc = indoc || document;\r\n    var link = doc.createElement('link');\r\n    link.type = 'text/css';\r\n    link.rel = 'stylesheet';\r\n    link.href = url;\r\n    doc.getElementsByTagName('head')[0].appendChild(link);\r\n  },\r\n  inject: function inject(cssContent, indoc) {\r\n    var doc = indoc || document;\r\n    var injected = document.createElement('style');\r\n    injected.type = 'text/css';\r\n    injected.innerHTML = cssContent;\r\n    var head = doc.getElementsByTagName('head')[0];\r\n    try {\r\n      head.appendChild(injected);\r\n    } catch (e) {\r\n    }\r\n  }\r\n};\r\n\r\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\r\n\r\nfunction requestAnimationFrame(callback) {\r\n  setTimeout(callback, 1000 / 60);\r\n}\r\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\r\n\r\nvar CenteredDiv = function () {\r\n  function CenteredDiv() {\r\n    classCallCheck(this, CenteredDiv);\r\n    this.backgroundElement = document.createElement('div');\r\n    Common.extend(this.backgroundElement.style, {\r\n      backgroundColor: 'rgba(0,0,0,0.8)',\r\n      top: 0,\r\n      left: 0,\r\n      display: 'none',\r\n      zIndex: '1000',\r\n      opacity: 0,\r\n      WebkitTransition: 'opacity 0.2s linear',\r\n      transition: 'opacity 0.2s linear'\r\n    });\r\n    dom.makeFullscreen(this.backgroundElement);\r\n    this.backgroundElement.style.position = 'fixed';\r\n    this.domElement = document.createElement('div');\r\n    Common.extend(this.domElement.style, {\r\n      position: 'fixed',\r\n      display: 'none',\r\n      zIndex: '1001',\r\n      opacity: 0,\r\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\r\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\r\n    });\r\n    document.body.appendChild(this.backgroundElement);\r\n    document.body.appendChild(this.domElement);\r\n    var _this = this;\r\n    dom.bind(this.backgroundElement, 'click', function () {\r\n      _this.hide();\r\n    });\r\n  }\r\n  createClass(CenteredDiv, [{\r\n    key: 'show',\r\n    value: function show() {\r\n      var _this = this;\r\n      this.backgroundElement.style.display = 'block';\r\n      this.domElement.style.display = 'block';\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n      this.layout();\r\n      Common.defer(function () {\r\n        _this.backgroundElement.style.opacity = 1;\r\n        _this.domElement.style.opacity = 1;\r\n        _this.domElement.style.webkitTransform = 'scale(1)';\r\n      });\r\n    }\r\n  }, {\r\n    key: 'hide',\r\n    value: function hide() {\r\n      var _this = this;\r\n      var hide = function hide() {\r\n        _this.domElement.style.display = 'none';\r\n        _this.backgroundElement.style.display = 'none';\r\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\r\n        dom.unbind(_this.domElement, 'transitionend', hide);\r\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\r\n      };\r\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\r\n      dom.bind(this.domElement, 'transitionend', hide);\r\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\r\n      this.backgroundElement.style.opacity = 0;\r\n      this.domElement.style.opacity = 0;\r\n      this.domElement.style.webkitTransform = 'scale(1.1)';\r\n    }\r\n  }, {\r\n    key: 'layout',\r\n    value: function layout() {\r\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\r\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\r\n    }\r\n  }]);\r\n  return CenteredDiv;\r\n}();\r\n\r\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\r\n\r\ncss.inject(styleSheet);\r\nvar CSS_NAMESPACE = 'dg';\r\nvar HIDE_KEY_CODE = 72;\r\nvar CLOSE_BUTTON_HEIGHT = 20;\r\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\r\nvar SUPPORTS_LOCAL_STORAGE = function () {\r\n  try {\r\n    return !!window.localStorage;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}();\r\nvar SAVE_DIALOGUE = void 0;\r\nvar autoPlaceVirgin = true;\r\nvar autoPlaceContainer = void 0;\r\nvar hide = false;\r\nvar hideableGuis = [];\r\nvar GUI = function GUI(pars) {\r\n  var _this = this;\r\n  var params = pars || {};\r\n  this.domElement = document.createElement('div');\r\n  this.__ul = document.createElement('ul');\r\n  this.domElement.appendChild(this.__ul);\r\n  dom.addClass(this.domElement, CSS_NAMESPACE);\r\n  this.__folders = {};\r\n  this.__controllers = [];\r\n  this.__rememberedObjects = [];\r\n  this.__rememberedObjectIndecesToControllers = [];\r\n  this.__listening = [];\r\n  params = Common.defaults(params, {\r\n    closeOnTop: false,\r\n    autoPlace: true,\r\n    width: GUI.DEFAULT_WIDTH\r\n  });\r\n  params = Common.defaults(params, {\r\n    resizable: params.autoPlace,\r\n    hideable: params.autoPlace\r\n  });\r\n  if (!Common.isUndefined(params.load)) {\r\n    if (params.preset) {\r\n      params.load.preset = params.preset;\r\n    }\r\n  } else {\r\n    params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\r\n  }\r\n  if (Common.isUndefined(params.parent) && params.hideable) {\r\n    hideableGuis.push(this);\r\n  }\r\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\r\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\r\n    params.scrollable = true;\r\n  }\r\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\r\n  var saveToLocalStorage = void 0;\r\n  var titleRow = void 0;\r\n  Object.defineProperties(this,\r\n  {\r\n    parent: {\r\n      get: function get$$1() {\r\n        return params.parent;\r\n      }\r\n    },\r\n    scrollable: {\r\n      get: function get$$1() {\r\n        return params.scrollable;\r\n      }\r\n    },\r\n    autoPlace: {\r\n      get: function get$$1() {\r\n        return params.autoPlace;\r\n      }\r\n    },\r\n    closeOnTop: {\r\n      get: function get$$1() {\r\n        return params.closeOnTop;\r\n      }\r\n    },\r\n    preset: {\r\n      get: function get$$1() {\r\n        if (_this.parent) {\r\n          return _this.getRoot().preset;\r\n        }\r\n        return params.load.preset;\r\n      },\r\n      set: function set$$1(v) {\r\n        if (_this.parent) {\r\n          _this.getRoot().preset = v;\r\n        } else {\r\n          params.load.preset = v;\r\n        }\r\n        setPresetSelectIndex(this);\r\n        _this.revert();\r\n      }\r\n    },\r\n    width: {\r\n      get: function get$$1() {\r\n        return params.width;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.width = v;\r\n        setWidth(_this, v);\r\n      }\r\n    },\r\n    name: {\r\n      get: function get$$1() {\r\n        return params.name;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.name = v;\r\n        if (titleRow) {\r\n          titleRow.innerHTML = params.name;\r\n        }\r\n      }\r\n    },\r\n    closed: {\r\n      get: function get$$1() {\r\n        return params.closed;\r\n      },\r\n      set: function set$$1(v) {\r\n        params.closed = v;\r\n        if (params.closed) {\r\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        } else {\r\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\r\n        }\r\n        this.onResize();\r\n        if (_this.__closeButton) {\r\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\r\n        }\r\n      }\r\n    },\r\n    load: {\r\n      get: function get$$1() {\r\n        return params.load;\r\n      }\r\n    },\r\n    useLocalStorage: {\r\n      get: function get$$1() {\r\n        return useLocalStorage;\r\n      },\r\n      set: function set$$1(bool) {\r\n        if (SUPPORTS_LOCAL_STORAGE) {\r\n          useLocalStorage = bool;\r\n          if (bool) {\r\n            dom.bind(window, 'unload', saveToLocalStorage);\r\n          } else {\r\n            dom.unbind(window, 'unload', saveToLocalStorage);\r\n          }\r\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\r\n        }\r\n      }\r\n    }\r\n  });\r\n  if (Common.isUndefined(params.parent)) {\r\n    this.closed = params.closed || false;\r\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\r\n    dom.makeSelectable(this.domElement, false);\r\n    if (SUPPORTS_LOCAL_STORAGE) {\r\n      if (useLocalStorage) {\r\n        _this.useLocalStorage = true;\r\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\r\n        if (savedGui) {\r\n          params.load = JSON.parse(savedGui);\r\n        }\r\n      }\r\n    }\r\n    this.__closeButton = document.createElement('div');\r\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\r\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\r\n    if (params.closeOnTop) {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\r\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\r\n    } else {\r\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\r\n      this.domElement.appendChild(this.__closeButton);\r\n    }\r\n    dom.bind(this.__closeButton, 'click', function () {\r\n      _this.closed = !_this.closed;\r\n    });\r\n  } else {\r\n    if (params.closed === undefined) {\r\n      params.closed = true;\r\n    }\r\n    var titleRowName = document.createTextNode(params.name);\r\n    dom.addClass(titleRowName, 'controller-name');\r\n    titleRow = addRow(_this, titleRowName);\r\n    var onClickTitle = function onClickTitle(e) {\r\n      e.preventDefault();\r\n      _this.closed = !_this.closed;\r\n      return false;\r\n    };\r\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\r\n    dom.addClass(titleRow, 'title');\r\n    dom.bind(titleRow, 'click', onClickTitle);\r\n    if (!params.closed) {\r\n      this.closed = false;\r\n    }\r\n  }\r\n  if (params.autoPlace) {\r\n    if (Common.isUndefined(params.parent)) {\r\n      if (autoPlaceVirgin) {\r\n        autoPlaceContainer = document.createElement('div');\r\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\r\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\r\n        document.body.appendChild(autoPlaceContainer);\r\n        autoPlaceVirgin = false;\r\n      }\r\n      autoPlaceContainer.appendChild(this.domElement);\r\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\r\n    }\r\n    if (!this.parent) {\r\n      setWidth(_this, params.width);\r\n    }\r\n  }\r\n  this.__resizeHandler = function () {\r\n    _this.onResizeDebounced();\r\n  };\r\n  dom.bind(window, 'resize', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\r\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\r\n  this.onResize();\r\n  if (params.resizable) {\r\n    addResizeHandle(this);\r\n  }\r\n  saveToLocalStorage = function saveToLocalStorage() {\r\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\r\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\r\n    }\r\n  };\r\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\r\n  function resetWidth() {\r\n    var root = _this.getRoot();\r\n    root.width += 1;\r\n    Common.defer(function () {\r\n      root.width -= 1;\r\n    });\r\n  }\r\n  if (!params.parent) {\r\n    resetWidth();\r\n  }\r\n};\r\nGUI.toggleHide = function () {\r\n  hide = !hide;\r\n  Common.each(hideableGuis, function (gui) {\r\n    gui.domElement.style.display = hide ? 'none' : '';\r\n  });\r\n};\r\nGUI.CLASS_AUTO_PLACE = 'a';\r\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\r\nGUI.CLASS_MAIN = 'main';\r\nGUI.CLASS_CONTROLLER_ROW = 'cr';\r\nGUI.CLASS_TOO_TALL = 'taller-than-window';\r\nGUI.CLASS_CLOSED = 'closed';\r\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\r\nGUI.CLASS_CLOSE_TOP = 'close-top';\r\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\r\nGUI.CLASS_DRAG = 'drag';\r\nGUI.DEFAULT_WIDTH = 245;\r\nGUI.TEXT_CLOSED = 'Close Controls';\r\nGUI.TEXT_OPEN = 'Open Controls';\r\nGUI._keydownHandler = function (e) {\r\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\r\n    GUI.toggleHide();\r\n  }\r\n};\r\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\r\nCommon.extend(GUI.prototype,\r\n{\r\n  add: function add(object, property) {\r\n    return _add(this, object, property, {\r\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\r\n    });\r\n  },\r\n  addColor: function addColor(object, property) {\r\n    return _add(this, object, property, {\r\n      color: true\r\n    });\r\n  },\r\n  remove: function remove(controller) {\r\n    this.__ul.removeChild(controller.__li);\r\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\r\n    var _this = this;\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  destroy: function destroy() {\r\n    if (this.parent) {\r\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\r\n    }\r\n    if (this.autoPlace) {\r\n      autoPlaceContainer.removeChild(this.domElement);\r\n    }\r\n    var _this = this;\r\n    Common.each(this.__folders, function (subfolder) {\r\n      _this.removeFolder(subfolder);\r\n    });\r\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\r\n    removeListeners(this);\r\n  },\r\n  addFolder: function addFolder(name) {\r\n    if (this.__folders[name] !== undefined) {\r\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\r\n    }\r\n    var newGuiParams = { name: name, parent: this };\r\n    newGuiParams.autoPlace = this.autoPlace;\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[name]) {\r\n      newGuiParams.closed = this.load.folders[name].closed;\r\n      newGuiParams.load = this.load.folders[name];\r\n    }\r\n    var gui = new GUI(newGuiParams);\r\n    this.__folders[name] = gui;\r\n    var li = addRow(this, gui.domElement);\r\n    dom.addClass(li, 'folder');\r\n    return gui;\r\n  },\r\n  removeFolder: function removeFolder(folder) {\r\n    this.__ul.removeChild(folder.domElement.parentElement);\r\n    delete this.__folders[folder.name];\r\n    if (this.load &&\r\n    this.load.folders &&\r\n    this.load.folders[folder.name]) {\r\n      delete this.load.folders[folder.name];\r\n    }\r\n    removeListeners(folder);\r\n    var _this = this;\r\n    Common.each(folder.__folders, function (subfolder) {\r\n      folder.removeFolder(subfolder);\r\n    });\r\n    Common.defer(function () {\r\n      _this.onResize();\r\n    });\r\n  },\r\n  open: function open() {\r\n    this.closed = false;\r\n  },\r\n  close: function close() {\r\n    this.closed = true;\r\n  },\r\n  hide: function hide() {\r\n    this.domElement.style.display = 'none';\r\n  },\r\n  show: function show() {\r\n    this.domElement.style.display = '';\r\n  },\r\n  onResize: function onResize() {\r\n    var root = this.getRoot();\r\n    if (root.scrollable) {\r\n      var top = dom.getOffset(root.__ul).top;\r\n      var h = 0;\r\n      Common.each(root.__ul.childNodes, function (node) {\r\n        if (!(root.autoPlace && node === root.__save_row)) {\r\n          h += dom.getHeight(node);\r\n        }\r\n      });\r\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\r\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\r\n      } else {\r\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\r\n        root.__ul.style.height = 'auto';\r\n      }\r\n    }\r\n    if (root.__resize_handle) {\r\n      Common.defer(function () {\r\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\r\n      });\r\n    }\r\n    if (root.__closeButton) {\r\n      root.__closeButton.style.width = root.width + 'px';\r\n    }\r\n  },\r\n  onResizeDebounced: Common.debounce(function () {\r\n    this.onResize();\r\n  }, 50),\r\n  remember: function remember() {\r\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\r\n      SAVE_DIALOGUE = new CenteredDiv();\r\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\r\n    }\r\n    if (this.parent) {\r\n      throw new Error('You can only call remember on a top level GUI.');\r\n    }\r\n    var _this = this;\r\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\r\n      if (_this.__rememberedObjects.length === 0) {\r\n        addSaveMenu(_this);\r\n      }\r\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\r\n        _this.__rememberedObjects.push(object);\r\n      }\r\n    });\r\n    if (this.autoPlace) {\r\n      setWidth(this, this.width);\r\n    }\r\n  },\r\n  getRoot: function getRoot() {\r\n    var gui = this;\r\n    while (gui.parent) {\r\n      gui = gui.parent;\r\n    }\r\n    return gui;\r\n  },\r\n  getSaveObject: function getSaveObject() {\r\n    var toReturn = this.load;\r\n    toReturn.closed = this.closed;\r\n    if (this.__rememberedObjects.length > 0) {\r\n      toReturn.preset = this.preset;\r\n      if (!toReturn.remembered) {\r\n        toReturn.remembered = {};\r\n      }\r\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\r\n    }\r\n    toReturn.folders = {};\r\n    Common.each(this.__folders, function (element, key) {\r\n      toReturn.folders[key] = element.getSaveObject();\r\n    });\r\n    return toReturn;\r\n  },\r\n  save: function save() {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n    }\r\n    this.load.remembered[this.preset] = getCurrentPreset(this);\r\n    markPresetModified(this, false);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  saveAs: function saveAs(presetName) {\r\n    if (!this.load.remembered) {\r\n      this.load.remembered = {};\r\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\r\n    }\r\n    this.load.remembered[presetName] = getCurrentPreset(this);\r\n    this.preset = presetName;\r\n    addPresetOption(this, presetName, true);\r\n    this.saveToLocalStorageIfPossible();\r\n  },\r\n  revert: function revert(gui) {\r\n    Common.each(this.__controllers, function (controller) {\r\n      if (!this.getRoot().load.remembered) {\r\n        controller.setValue(controller.initialValue);\r\n      } else {\r\n        recallSavedValue(gui || this.getRoot(), controller);\r\n      }\r\n      if (controller.__onFinishChange) {\r\n        controller.__onFinishChange.call(controller, controller.getValue());\r\n      }\r\n    }, this);\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.revert(folder);\r\n    });\r\n    if (!gui) {\r\n      markPresetModified(this.getRoot(), false);\r\n    }\r\n  },\r\n  listen: function listen(controller) {\r\n    var init = this.__listening.length === 0;\r\n    this.__listening.push(controller);\r\n    if (init) {\r\n      updateDisplays(this.__listening);\r\n    }\r\n  },\r\n  updateDisplay: function updateDisplay() {\r\n    Common.each(this.__controllers, function (controller) {\r\n      controller.updateDisplay();\r\n    });\r\n    Common.each(this.__folders, function (folder) {\r\n      folder.updateDisplay();\r\n    });\r\n  }\r\n});\r\nfunction addRow(gui, newDom, liBefore) {\r\n  var li = document.createElement('li');\r\n  if (newDom) {\r\n    li.appendChild(newDom);\r\n  }\r\n  if (liBefore) {\r\n    gui.__ul.insertBefore(li, liBefore);\r\n  } else {\r\n    gui.__ul.appendChild(li);\r\n  }\r\n  gui.onResize();\r\n  return li;\r\n}\r\nfunction removeListeners(gui) {\r\n  dom.unbind(window, 'resize', gui.__resizeHandler);\r\n  if (gui.saveToLocalStorageIfPossible) {\r\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\r\n  }\r\n}\r\nfunction markPresetModified(gui, modified) {\r\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\r\n  if (modified) {\r\n    opt.innerHTML = opt.value + '*';\r\n  } else {\r\n    opt.innerHTML = opt.value;\r\n  }\r\n}\r\nfunction augmentController(gui, li, controller) {\r\n  controller.__li = li;\r\n  controller.__gui = gui;\r\n  Common.extend(controller,                                   {\r\n    options: function options(_options) {\r\n      if (arguments.length > 1) {\r\n        var nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: nextSibling,\r\n          factoryArgs: [Common.toArray(arguments)]\r\n        });\r\n      }\r\n      if (Common.isArray(_options) || Common.isObject(_options)) {\r\n        var _nextSibling = controller.__li.nextElementSibling;\r\n        controller.remove();\r\n        return _add(gui, controller.object, controller.property, {\r\n          before: _nextSibling,\r\n          factoryArgs: [_options]\r\n        });\r\n      }\r\n    },\r\n    name: function name(_name) {\r\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\r\n      return controller;\r\n    },\r\n    listen: function listen() {\r\n      controller.__gui.listen(controller);\r\n      return controller;\r\n    },\r\n    remove: function remove() {\r\n      controller.__gui.remove(controller);\r\n      return controller;\r\n    }\r\n  });\r\n  if (controller instanceof NumberControllerSlider) {\r\n    var box = new NumberControllerBox(controller.object, controller.property, { min: controller.__min, max: controller.__max, step: controller.__step });\r\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\r\n      var pc = controller[method];\r\n      var pb = box[method];\r\n      controller[method] = box[method] = function () {\r\n        var args = Array.prototype.slice.call(arguments);\r\n        pb.apply(box, args);\r\n        return pc.apply(controller, args);\r\n      };\r\n    });\r\n    dom.addClass(li, 'has-slider');\r\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\r\n  } else if (controller instanceof NumberControllerBox) {\r\n    var r = function r(returned) {\r\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\r\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\r\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\r\n        controller.remove();\r\n        var newController = _add(gui, controller.object, controller.property, {\r\n          before: controller.__li.nextElementSibling,\r\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\r\n        });\r\n        newController.name(oldName);\r\n        if (wasListening) newController.listen();\r\n        return newController;\r\n      }\r\n      return returned;\r\n    };\r\n    controller.min = Common.compose(r, controller.min);\r\n    controller.max = Common.compose(r, controller.max);\r\n  } else if (controller instanceof BooleanController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__checkbox, 'click');\r\n    });\r\n    dom.bind(controller.__checkbox, 'click', function (e) {\r\n      e.stopPropagation();\r\n    });\r\n  } else if (controller instanceof FunctionController) {\r\n    dom.bind(li, 'click', function () {\r\n      dom.fakeEvent(controller.__button, 'click');\r\n    });\r\n    dom.bind(li, 'mouseover', function () {\r\n      dom.addClass(controller.__button, 'hover');\r\n    });\r\n    dom.bind(li, 'mouseout', function () {\r\n      dom.removeClass(controller.__button, 'hover');\r\n    });\r\n  } else if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n    controller.updateDisplay = Common.compose(function (val) {\r\n      li.style.borderLeftColor = controller.__color.toString();\r\n      return val;\r\n    }, controller.updateDisplay);\r\n    controller.updateDisplay();\r\n  }\r\n  controller.setValue = Common.compose(function (val) {\r\n    if (gui.getRoot().__preset_select && controller.isModified()) {\r\n      markPresetModified(gui.getRoot(), true);\r\n    }\r\n    return val;\r\n  }, controller.setValue);\r\n}\r\nfunction recallSavedValue(gui, controller) {\r\n  var root = gui.getRoot();\r\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\r\n  if (matchedIndex !== -1) {\r\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\r\n    if (controllerMap === undefined) {\r\n      controllerMap = {};\r\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\r\n    }\r\n    controllerMap[controller.property] = controller;\r\n    if (root.load && root.load.remembered) {\r\n      var presetMap = root.load.remembered;\r\n      var preset = void 0;\r\n      if (presetMap[gui.preset]) {\r\n        preset = presetMap[gui.preset];\r\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\r\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\r\n      } else {\r\n        return;\r\n      }\r\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\r\n        var value = preset[matchedIndex][controller.property];\r\n        controller.initialValue = value;\r\n        controller.setValue(value);\r\n      }\r\n    }\r\n  }\r\n}\r\nfunction _add(gui, object, property, params) {\r\n  var customObject;\r\n  if (object.arguments) {\r\n    customObject = object;\r\n    object = customObject.arguments.object;\r\n    property = customObject.arguments.property;\r\n    params = {\r\n      factoryArgs: customObject.arguments.opts\r\n    };\r\n  }\r\n  if (customObject === undefined && object[property] === undefined) {\r\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\r\n  }\r\n  var controller = void 0;\r\n  if (params.color) {\r\n    controller = new ColorController(object, property);\r\n  } else if (customObject !== undefined && typeof customObject.property === \"string\") {\r\n    controller = customObject;\r\n  } else {\r\n    var factoryArgs = [object, property].concat(params.factoryArgs);\r\n    controller = ControllerFactory.apply(gui, factoryArgs);\r\n  }\r\n  if (controller === null) controller = customObject;else if (customObject !== undefined) customObject.controller = controller;\r\n  if (params.before instanceof Controller) {\r\n    params.before = params.before.__li;\r\n  }\r\n  recallSavedValue(gui, controller);\r\n  dom.addClass(controller.domElement, 'c');\r\n  var name = document.createElement('span');\r\n  dom.addClass(name, 'property-name');\r\n  if (customObject !== undefined && _typeof(customObject.property) === \"object\") {\r\n    for (var propertyName in customObject.property) {\r\n      name.appendChild(customObject.property[propertyName]);\r\n    }\r\n  } else name.innerHTML = controller.property;\r\n  var container = document.createElement('div');\r\n  container.appendChild(name);\r\n  container.appendChild(controller.domElement);\r\n  var li = addRow(gui, container, params.before);\r\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\r\n  if (controller instanceof ColorController) {\r\n    dom.addClass(li, 'color');\r\n  } else {\r\n    dom.addClass(li, _typeof(controller.getValue()));\r\n  }\r\n  augmentController(gui, li, controller);\r\n  gui.__controllers.push(controller);\r\n  return controller;\r\n}\r\nfunction getLocalStorageHash(gui, key) {\r\n  return document.location.href + '.' + key;\r\n}\r\nfunction addPresetOption(gui, name, setSelected) {\r\n  var opt = document.createElement('option');\r\n  opt.innerHTML = name;\r\n  opt.value = name;\r\n  gui.__preset_select.appendChild(opt);\r\n  if (setSelected) {\r\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\r\n  }\r\n}\r\nfunction showHideExplain(gui, explain) {\r\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\r\n}\r\nfunction addSaveMenu(gui) {\r\n  var div = gui.__save_row = document.createElement('li');\r\n  dom.addClass(gui.domElement, 'has-save');\r\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\r\n  dom.addClass(div, 'save-row');\r\n  var gears = document.createElement('span');\r\n  gears.innerHTML = '&nbsp;';\r\n  dom.addClass(gears, 'button gears');\r\n  var button = document.createElement('span');\r\n  button.innerHTML = 'Save';\r\n  dom.addClass(button, 'button');\r\n  dom.addClass(button, 'save');\r\n  var button2 = document.createElement('span');\r\n  button2.innerHTML = 'New';\r\n  dom.addClass(button2, 'button');\r\n  dom.addClass(button2, 'save-as');\r\n  var button3 = document.createElement('span');\r\n  button3.innerHTML = 'Revert';\r\n  dom.addClass(button3, 'button');\r\n  dom.addClass(button3, 'revert');\r\n  var select = gui.__preset_select = document.createElement('select');\r\n  if (gui.load && gui.load.remembered) {\r\n    Common.each(gui.load.remembered, function (value, key) {\r\n      addPresetOption(gui, key, key === gui.preset);\r\n    });\r\n  } else {\r\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\r\n  }\r\n  dom.bind(select, 'change', function () {\r\n    for (var index = 0; index < gui.__preset_select.length; index++) {\r\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\r\n    }\r\n    gui.preset = this.value;\r\n  });\r\n  div.appendChild(select);\r\n  div.appendChild(gears);\r\n  div.appendChild(button);\r\n  div.appendChild(button2);\r\n  div.appendChild(button3);\r\n  if (SUPPORTS_LOCAL_STORAGE) {\r\n    var explain = document.getElementById('dg-local-explain');\r\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\r\n    var saveLocally = document.getElementById('dg-save-locally');\r\n    saveLocally.style.display = 'block';\r\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\r\n      localStorageCheckBox.setAttribute('checked', 'checked');\r\n    }\r\n    showHideExplain(gui, explain);\r\n    dom.bind(localStorageCheckBox, 'change', function () {\r\n      gui.useLocalStorage = !gui.useLocalStorage;\r\n      showHideExplain(gui, explain);\r\n    });\r\n  }\r\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\r\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\r\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\r\n      SAVE_DIALOGUE.hide();\r\n    }\r\n  });\r\n  dom.bind(gears, 'click', function () {\r\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\r\n    SAVE_DIALOGUE.show();\r\n    newConstructorTextArea.focus();\r\n    newConstructorTextArea.select();\r\n  });\r\n  dom.bind(button, 'click', function () {\r\n    gui.save();\r\n  });\r\n  dom.bind(button2, 'click', function () {\r\n    var presetName = prompt('Enter a new preset name.');\r\n    if (presetName) {\r\n      gui.saveAs(presetName);\r\n    }\r\n  });\r\n  dom.bind(button3, 'click', function () {\r\n    gui.revert();\r\n  });\r\n}\r\nfunction addResizeHandle(gui) {\r\n  var pmouseX = void 0;\r\n  gui.__resize_handle = document.createElement('div');\r\n  Common.extend(gui.__resize_handle.style, {\r\n    width: '6px',\r\n    marginLeft: '-3px',\r\n    height: '200px',\r\n    cursor: 'ew-resize',\r\n    position: 'absolute'\r\n  });\r\n  function drag(e) {\r\n    e.preventDefault();\r\n    gui.width += pmouseX - e.clientX;\r\n    gui.onResize();\r\n    pmouseX = e.clientX;\r\n    return false;\r\n  }\r\n  function dragStop() {\r\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.unbind(window, 'mousemove', drag);\r\n    dom.unbind(window, 'mouseup', dragStop);\r\n  }\r\n  function dragStart(e) {\r\n    e.preventDefault();\r\n    pmouseX = e.clientX;\r\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\r\n    dom.bind(window, 'mousemove', drag);\r\n    dom.bind(window, 'mouseup', dragStop);\r\n    return false;\r\n  }\r\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\r\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\r\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\r\n}\r\nfunction setWidth(gui, w) {\r\n  gui.domElement.style.width = w + 'px';\r\n  if (gui.__save_row && gui.autoPlace) {\r\n    gui.__save_row.style.width = w + 'px';\r\n  }\r\n  if (gui.__closeButton) {\r\n    gui.__closeButton.style.width = w + 'px';\r\n  }\r\n}\r\nfunction getCurrentPreset(gui, useInitialValues) {\r\n  var toReturn = {};\r\n  Common.each(gui.__rememberedObjects, function (val, index) {\r\n    var savedValues = {};\r\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\r\n    Common.each(controllerMap, function (controller, property) {\r\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\r\n    });\r\n    toReturn[index] = savedValues;\r\n  });\r\n  return toReturn;\r\n}\r\nfunction setPresetSelectIndex(gui) {\r\n  for (var index = 0; index < gui.__preset_select.length; index++) {\r\n    if (gui.__preset_select[index].value === gui.preset) {\r\n      gui.__preset_select.selectedIndex = index;\r\n    }\r\n  }\r\n}\r\nfunction updateDisplays(controllerArray) {\r\n  if (controllerArray.length !== 0) {\r\n    requestAnimationFrame$1.call(window, function () {\r\n      updateDisplays(controllerArray);\r\n    });\r\n  }\r\n  Common.each(controllerArray, function (c) {\r\n    c.updateDisplay();\r\n  });\r\n}\r\n\r\nvar color = {\r\n  Color: Color,\r\n  math: ColorMath,\r\n  interpret: interpret\r\n};\r\nvar controllers = {\r\n  Controller: Controller,\r\n  BooleanController: BooleanController,\r\n  OptionController: OptionController,\r\n  StringController: StringController,\r\n  NumberController: NumberController,\r\n  NumberControllerBox: NumberControllerBox,\r\n  NumberControllerSlider: NumberControllerSlider,\r\n  FunctionController: FunctionController,\r\n  ColorController: ColorController,\r\n  CustomController: CustomController\r\n};\r\nvar dom$1 = { dom: dom };\r\nvar gui = { GUI: GUI };\r\nvar GUI$1 = GUI;\r\nvar index = {\r\n  color: color,\r\n  controllers: controllers,\r\n  dom: dom$1,\r\n  gui: gui,\r\n  GUI: GUI$1\r\n};\r\n\r\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\r\nexport default index;\r\n//# sourceMappingURL=dat.gui.module.js.map\r\n","/**\r\n * get position functions library\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport three from './three.js'\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nexport function getObjectLocalPosition( object, index ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tconst attributesPosition = object.geometry.attributes.position,\r\n\t\tposition = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\tposition.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets position of the vector in world coordinates, taking into account the position, scale and rotation of the 3D object\r\n * @param {THREE.Object3D} object\r\n * @param {THREE.Vector3} pos local position\r\n * @returns world position \r\n */\r\nexport function getWorldPosition( object, pos ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tvar position = pos.clone();\r\n\r\n\t/*\r\n\t\t//https://stackoverflow.com/questions/11495089/how-to-get-the-absolute-position-of-a-vertex-in-three-js\r\n\t\t//Неудачная попытка вычислить абсолютную позицию точки\r\n\t\tobject.updateMatrixWorld();\r\n\t\tposition.applyMatrix4( object.matrixWorld );\r\n\t*/\r\n\tfunction getPosition( object, pos ) {\r\n\r\n\t\tvar position = new THREE.Vector3(),\r\n\t\t\tpositionAngle = new THREE.Vector3();\r\n\t\tposition = pos.clone();\r\n\t\tposition.multiply( object.scale );\r\n\r\n\t\t//rotation\r\n\t\tpositionAngle.copy( position );\r\n\t\tpositionAngle.applyEuler( object.rotation );\r\n\t\tposition.x = positionAngle.x;\r\n\t\tposition.y = positionAngle.y;\r\n\t\tposition.z = positionAngle.z;\r\n\r\n\t\tposition.add( object.position );\r\n\t\treturn position;\r\n\r\n\t}\r\n\tdo {\r\n\r\n\t\tposition = getPosition( object, position );\r\n\t\tobject = object.parent;\r\n\r\n\t} while ( object && object.parent );\r\n\treturn position;\r\n\r\n}\r\n\r\n/**\r\n * gets the position from the geometry.attributes.position of the object in world coordinates.\r\n * @param {THREE.Mesh} object\r\n * @param {number} index index of position in the object.geometry.attributes.position\r\n * @returns position\r\n */\r\nexport function getObjectPosition( object, index ) {\r\n\r\n\tif ( index === -1 )\r\n\t\treturn undefined;\r\n\tif ( index === undefined )\r\n\t\treturn object.position;\r\n\treturn getWorldPosition( object, getObjectLocalPosition( object, index ) )\r\n\r\n}\r\n\r\n","/**\r\n * node.js version of the synchronous download of the file.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//The myRequest is cross-browser XMLHttpRequest wrapper.\r\nfunction myRequest( options ) {\r\n\r\n\tthis.loadXMLDoc = function () {\r\n\t\tvar req;\r\n\r\n\t\tif ( window.XMLHttpRequest ) {\r\n\t\t\treq = new XMLHttpRequest();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"new XMLHttpRequest() failed!\"\r\n\t\t}\r\n\t\telse if ( window.ActiveXObject ) {\r\n\t\t\treq = this.NewActiveXObject();\r\n\t\t\tif ( !req )\r\n\t\t\t\tthrow \"NewActiveXObject() failed!\"\r\n\t\t}\r\n\t\telse throw \"myRequest.loadXMLDoc(...) failed!\";\r\n\t\treturn req;\r\n\t}\r\n\r\n\tthis.NewActiveXObject = function () {\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.6.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP.3.0\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Msxml2.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\ttry { return new ActiveXObject( \"Microsoft.XMLHTTP\" ); }\r\n\t\tcatch ( e ) { }\r\n\t\tErrorMessage( 'This browser does not support XMLHttpRequest. Probably, your security settings do not allow Web sites to use ActiveX controls installed on your computer. Refresh your Web page to find out the current status of your Web page or enable the \"Initialize and script ActiveX controls not marked as safe\" and \"Run Active X controls and plug-ins\" of the Security settings of the Internet zone of your browser.' );\r\n\t\treturn null;\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStart = function ( onreadystatechange, async ) {\r\n\r\n\t\tthis.XMLHttpRequestStop();//For compatibility with IE Windows Phone\r\n\r\n\t\tthis.req.onreadystatechange = onreadystatechange;\r\n\r\n\t\t//ATTENTION!!! do not works in IE\r\n\t\tif ( \"onerror\" in this.req ) {\r\n\t\t\tthis.req.onerror = function ( event ) {\r\n\t\t\t\tErrorMessage( \"XMLHttpRequest error. url: \" + this.url, false, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.XMLHttpRequestReStart( async );\r\n\t}\r\n\r\n\tthis.getUrl = function () {\r\n\t\t\r\n\t\tif ( ( typeof this.url == 'undefined' ) || ( this.url == null ) ) {\r\n\r\n\t\t\t//непонятно зачем это засунул\r\n//\t\t\tthis.url = \"XMLHttpRequest.xml\";\r\n\t\t\t\r\n\t\t\tErrorMessage( 'XMLHttpRequest: Invalid url: ' + this.url );\r\n\t\t\t\r\n\t\t}\r\n\t\treturn this.url + ( this.params ? this.params : \"\" );\r\n\t\t\r\n\t}\r\n\r\n\tthis.XMLHttpRequestReStart = function ( async ) {\r\n\t\ttry {\r\n\t\t\tif ( typeof async == 'undefined' )\r\n\t\t\t\tasync = true;\r\n\t\t\tthis.req.open( \"GET\", this.getUrl(), async );\r\n\t\t\tif ( async ) {\r\n\t\t\t\tvar timeout = ( 60 + 30 ) * 1000;//Внимание!!! Задержка должна быть больше CSocketWaitEvent::WaitResponse\r\n\t\t\t\tif ( \"timeout\" in this.req )//for IE6\r\n\t\t\t\t\tthis.req.timeout = timeout;\r\n\t\t\t\tif ( \"ontimeout\" in this.req )\r\n\t\t\t\t\tthis.req.ontimeout = function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\telse {//for Safari, IE6\r\n\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\tthis.timeout_id_SendReq = setTimeout( function () {\r\n\t\t\t\t\t\tErrorMessage( 'XMLHttpRequest timeout 2', false, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t, timeout );\r\n\t\t\t\t\t//console.log(\"setTimeout this.req.timeout_id_SendReq = \" + this.req.timeout_id_SendReq);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.req.send( null );\r\n\t\t} catch ( e ) {\r\n\t\t\tErrorMessage( e.message + \" url: \" + this.url, false, false );\r\n\t\t}\r\n\t}\r\n\r\n\tthis.XMLHttpRequestStop = function () {\r\n\t\t//console.log(\"XMLHttpRequestStop(...)\");\r\n\t\tif ( this.req == null )\r\n\t\t\treturn;\r\n\t\tthis.req.abort();\r\n\t}\r\n\r\n\tthis.ProcessReqChange = function ( processStatus200 ) {\r\n\t\tvar req = this.req;\r\n\t\tif ( ( typeof isIE === 'undefined' ) || !isIE ) {\r\n\t\t\t//console.log(\"processReqChange(); req.statusText: \" + req.statusText + \". req.status = \" + req.status + \". req.readyState = \" + req.readyState + \". req.responseText: \" + req.responseText);\r\n\t\t}\r\n\t\t// only if req shows \"complete\"\r\n\t\t//http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp\r\n\t\t//http://xmlhttprequest.ru/w3c\r\n\t\tswitch ( req.readyState ) {\r\n\t\t\tcase 4://request finished and response is ready\r\n\t\t\t\t{\r\n\t\t\t\t\tif ( typeof req.status == \"unknown\" ) {//IE5 timeout\r\n\t\t\t\t\t\tconsoleError( 'typeof XMLHttpRequest status == \"unknown\"' );\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//Я не могу вставлять switch один в другой\r\n\t\t\t\t\tif ( req.status == 200 )//OK)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tclearTimeout( this.timeout_id_SendReq );\r\n\t\t\t\t\t\treturn processStatus200( this );\r\n\t\t\t\t\t}//200://OK\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tErrorMessage( \"Invalid XMLHttpRequest status : \" + req.status + \" url: \" + this.url );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 1://server connection established\r\n\t\t\tcase 2://request received\r\n\t\t\tcase 3://processing request\r\n\t\t\t\tbreak;\r\n\t\t\t//\t\tcase 404:\r\n\t\t\tcase 0://request not initialized\r\n\t\t\tdefault:\r\n\t\t\t\tthrow \"processReqChange(); req.readyState = \" + req.readyState;\r\n\t\t\t\tbreak;\r\n\t\t}//switch(req.readyState)\r\n\t\treturn true;\r\n\t}\r\n\r\n\tthis.processStatus200Error = function () {\r\n\t\tvar error = this.GetElementText( 'error', true );\r\n\t\tif ( error ) {\r\n\t\t\tErrorMessage( error );\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.GetElementText = function ( tagName, noDisplayErrorMessage ) {\r\n\t\tvar xmlhttp = this.req;\r\n\t\tif ( !xmlhttp.responseXML ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); xmlhttp.responseXML is null.\\nxmlhttp.responseText:\\n' + xmlhttp.responseText );\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tvar element = xmlhttp.responseXML.getElementsByTagName( tagName );\r\n\r\n\t\t//ATTENTION!!! For IE set the content-type m_HttpResponse.SetContentType(\"text/xml\");\r\n\r\n\t\tif ( element.length == 0 ) {\r\n\t\t\tif ( noDisplayErrorMessage != true )\r\n\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, \"' + tagName + '\"); element.length == ' + element.length );\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tvar text = \"\";\r\n\t\tfor ( var i = 0; i < element.length; i++ ) {\r\n\t\t\tif ( typeof ( element[i].textContent ) == 'undefined' ) {\r\n\t\t\t\tif ( typeof ( element[i].text ) == 'undefined' ) {\r\n\t\t\t\t\tErrorMessage( 'GetXMLElementText(xmlhttp, ' + tagName + '); element[' + i + '].text) == undefined' );\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t\tif ( text != \"\" )\r\n\t\t\t\t\ttext += \" \";\r\n\t\t\t\ttext += element[i].text;//IE\r\n\t\t\t}\r\n\t\t\telse text += element[i].textContent;//Chrome\r\n\t\t}\r\n\t\treturn text;\r\n\t}\r\n\r\n\tif ( options.data ) {\r\n\t\tthis.req = options.data.req;\r\n\t\tthis.url = options.data.url;\r\n\t\tthis.params = options.data.params;\r\n\t} else {\r\n\t\ttry {\r\n\t\t\tthis.req = this.loadXMLDoc();\r\n\t\t} catch ( e ) {\r\n\t\t\tvar message;\r\n\t\t\tif ( typeof e.message == 'undefined' )\r\n\t\t\t\tmessage = e;\r\n\t\t\telse message = e.message;\r\n\t\t\tErrorMessage( \"Your browser is too old and is not compatible with our site.\\n\\n\"\r\n\t\t\t\t+ window.navigator.appName + \" \" + window.navigator.appVersion + \"\\n\\n\" + message );\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif ( !this.req ) {\r\n\t\tconsoleError( \"Invalid myRequest.req: \" + this.req );\r\n\t\treturn;\r\n\t}\r\n\r\n\tfunction ErrorMessage( error ) {\r\n\r\n\t\tconsole.error( error );\r\n\t\toptions.onerror( error );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Load file synchronously\r\n * @param {string} url URL of an external file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured.\r\n * @param {boolean} [options.async=false] true - load file asynchronously. You can use <b>async</b> method instead.\r\n * @returns {string} file content\r\n * @example\r\n * \r\n\t//Simplest example.\r\n\tdocument.getElementById( \"elID\" ).innerHTML = loadFile.sync('element.html');\r\n *\r\n * @example\r\n *\r\n\t//onload, onerror events.\r\n\tdocument.getElementById( \"elID\").innerHTML = loadFile.sync( 'element.html',\r\n\t{\r\n\t\tonload: function ( response ) {\r\n\r\n\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\tconsole.log( str );\r\n\r\n\t\t},\r\n\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\tconsole.error( str );\r\n\r\n\t\t},\r\n\t}, );\r\n */\r\nfunction sync( url, options ) {\r\n\r\n\toptions = options || {};\r\n\tif (options.async === true) console.warn('Load file asynchronously is deprecated. Please use fetch.');\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\r\n\tvar response,\r\n\t\trequest = new myRequest( options );\r\n\trequest.url = url;\r\n\trequest.XMLHttpRequestStart(\r\n\r\n\t\tfunction () {//onreadystatechange\r\n\r\n\t\t\trequest.ProcessReqChange( function ( myRequest ) {//processStatus200\r\n\r\n\t\t\t\tif ( myRequest.processStatus200Error() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tresponse = myRequest.req.responseText;\r\n\t\t\t\t//console.log( 'loadFile.sync.onload() ' + url );\r\n\t\t\t\toptions.onload( response, url );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t, options.async === undefined ? false : true//Synchronous mode\r\n\r\n\t);\r\n\t//console.log( 'sync(' + url + ')' );\r\n\treturn response;\r\n\r\n}\r\n/**\r\n * Load file asynchronously\r\n * @param {string} url URL of an external file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured.\r\n * @returns {string} file content\r\n * @example\r\n * \r\n\t//Simplest example.\r\n\tdocument.getElementById( \"elID\" ).innerHTML = loadFile.sync('element.html');\r\n *\r\n * @example\r\n *\r\n\t//onload, onerror events.\r\n\tdocument.getElementById( \"elID\").innerHTML = loadFile.async( 'element.html',\r\n\t{\r\n\t\tonload: function ( response ) {\r\n\r\n\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\tconsole.log( str );\r\n\r\n\t\t},\r\n\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\tconsole.error( str );\r\n\r\n\t\t},\r\n\t}, );\r\n */\r\nfunction async(url, options) {\r\n\r\n\toptions.async = true;\r\n\tsync(url, options);\r\n\r\n}\r\n\r\n/**\r\n * display a text to HTML\r\n * @param {string} str source text\r\n * @returns {string} escaped text\r\n */\r\nfunction escapeHtml( str ) {\r\n\r\n\treturn str.replace( /[&<>\"'\\/]/g, function ( s ) {\r\n\r\n\t\tvar entityMap = {\r\n\r\n\t\t\t\"&\": \"&amp;\",\r\n\t\t\t\"<\": \"&lt;\",\r\n\t\t\t\">\": \"&gt;\",\r\n\t\t\t'\"': '&quot;',\r\n\t\t\t\"'\": '&#39;',\r\n\t\t\t\"/\": '&#x2F;'\r\n\r\n\t\t};\r\n\r\n\t\treturn entityMap[s];\r\n\r\n\t} );\r\n}\r\n\r\nexport { sync, async, escapeHtml };\r\n","/**\r\n * node.js version of the load JavaScript file\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * Thanks to:\r\n *http://javascript.ru/forum/events/21439-dinamicheskaya-zagruzka-skriptov.html\r\n *https://learn.javascript.ru/onload-onerror\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//Please download https://github.com/anhr/loadFileNodeJS into ../loadFileNodeJS folder\r\nimport { sync as loadFileSync, escapeHtml } from '../loadFileNodeJS/index.js';\r\n\r\n/**\r\n * @callback onerror\r\n * @param {string} str - error details\r\n */\r\n\r\n/**\r\n * Synchronous load JavaScript file\r\n * @param {string} src URL of an external script file.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerror} [options.onerror] function ( str ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object|string}[options.tag] The script's tag attributes (Object) or tag type (string). Optional.\r\n * Available tag types:\r\n *\t'style' - load a style file (.css extension)\r\n * @param {string} [options.tag.name] tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n *\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.sync( 'sync.js' );\r\n\r\n * @example\r\n * \r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.sync( 'sync.js',\r\n\t\t{\r\n\t\t\tonload: function ( response ) {\r\n\r\n\t\t\t\tvar str = 'file has been loaded successfully';\r\n\t\t\t\tconsole.log( str );\r\n\r\n\t\t\t},\r\n\t\t\tonerror: function ( str, e ) {\r\n\r\n\t\t\t\telSync2Res.style.color = 'red';\r\n\r\n\t\t\t},\r\n\t\t\tappendTo: document.getElementById( \"appendto\" ),\r\n\t\t},\r\n\t);\r\n *\r\n * @example\r\n *\r\n\t//Append style into head node.\r\n\tloadScript.sync( \"controls.css\",\r\n\t{\r\n\t\t//style rel=\"stylesheet\"\r\n\t\ttag: {\r\n\r\n\t\t\tname: 'style',\r\n\t\t\tattribute: {\r\n\r\n\t\t\t\tname: 'rel',\r\n\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n */\r\nfunction sync( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.onload = options.onload || function () { };\r\n\toptions.onerror = options.onerror || function () { };\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[0];\r\n\r\n\tif ( isScriptExists( options.appendTo, src ) ) {\r\n\r\n\t\toptions.onload();\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tvar error,\r\n\t\t\toptionsItem = {\r\n\r\n\t\t\t\tappendTo: options.appendTo,\r\n\t\t\t\ttag: options.tag,\r\n\t\t\t\tonload: function ( response, url ) {\r\n\t\t\t\t\r\n\t\t\t\t\tconsole.log( 'loadScript.sync.onload: ' + url );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tonerror: function ( str ) {\r\n\r\n\t\t\t\t\toptions.onerror( str );\r\n\t\t\t\t\terror = str;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t};\r\n\t\tfor ( var i = 0; i < src.length; i++ ) {\r\n\r\n\t\t\tvar item = src[ i ];\r\n\t\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\t\tscript.setAttribute( \"id\", item );\r\n\t\t\t\tscript.innerHTML = loadFileSync( item, optionsItem );\r\n\r\n\t\t\t}, optionsItem );\r\n\t\t\tif ( error !== undefined )\r\n\t\t\t\tbreak;\r\n\r\n\t\t};\r\n\t\tif ( error === undefined )\r\n\t\t\toptions.onload();\r\n\r\n\t} else loadScriptBase( function ( script ) {\r\n\r\n\t\tscript.setAttribute( \"id\", src );\r\n\t\tscript.innerHTML = loadFileSync( src, options );\r\n\r\n\t}, options );\r\n\r\n}\r\n\r\n/**\r\n * @callback onerrorasync\r\n * @param {string} str - error details\r\n * @param {Object} e - event\r\n */\r\n\r\n/**\r\n * Asynchronous load JavaScript file\r\n * @param {string|string[]} src URL of an external script file or array of the script file names.\r\n * @param {Object} [options] the following options are available.\r\n * @param {Function} [options.onload] function () The onload event occurs when a script has been loaded. Optional.\r\n * @param {onerrorasync} [options.onerror] function ( str, e ) The onerror event occurs when an error has been occured. Optional.\r\n * @param {string}[options.appendTo] The node to which the new script will be append. Optional. Default is head node\r\n * @param {Object}[options.tag] The script's tag attributes. Optional.\r\n * @param {string} options.tag.name tag name. Default is 'script'\r\n * @param {Object} [options.tag.attribute] tag attribute. Optional.\r\n * @param {string} options.tag.attribute.name attribute name. Default is 'type'\r\n * @param {string} options.tag.attribute.value attribute value. Default is 'text/javascript'\r\n*\r\n * @example\r\n * \r\n\t//Simplest example. Append script into head node.\r\n\tloadScript.async( \"JavaScript.js);\r\n * \r\n * @example\r\n *\r\n\t//onload, onerror events. Append script into \"appendto\" element\r\n\tloadScript.async( \"JavaScript.js\",\r\n\t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \t\tappendTo: document.getElementById( \"appendto\" ),\r\n \r\n \t}\r\n \r\n  );\r\n *\r\n * @example\r\n *\r\n\t//loading of array of JavaScript files. Append script into head node.\r\n\tloadScript.async( [\r\n \t\t\"JavaScript1.js\",\r\n \t\t\"JavaScript2.js\",\r\n \t],\r\n \t{\r\n \t\tonload: function () {\r\n \r\n \t\t\tvar str = 'file has been loaded successfully';\r\n \t\t\tconsole.log( str );\r\n \r\n \t\t},\r\n \t\tonerror: function ( str, e ) {\r\n \r\n \t\t\tconsole.error( str );\r\n \r\n \t\t},\r\n \r\n \t}\r\n \r\n  );\r\n */\r\nfunction async( src, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.appendTo = options.appendTo || document.getElementsByTagName( 'head' )[ 0 ];\r\n\toptions.onload = options.onload || function () {};\r\n\r\n\tvar isrc;\r\n\r\n\tfunction async( srcAsync ) {\r\n\r\n\t\tfunction next() {\r\n\r\n\t\t\tif ( src instanceof Array && ( isrc < ( src.length - 1 ) ) ) {\r\n\r\n\t\t\t\tisrc++;\r\n\t\t\t\tasync( src[isrc] );\r\n\r\n\t\t\t} else options.onload();\r\n\r\n\t\t}\r\n\r\n\t\tif ( isScriptExists( options.appendTo, srcAsync, options.onload ) ) {\r\n\r\n\t\t\tnext();\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tloadScriptBase( function ( script ) {\r\n\r\n\t\t\tscript.setAttribute( \"id\", srcAsync );\r\n\r\n\t\t\tfunction _onload() {\r\n\r\n\t\t\t\tconsole.log( 'loadScript.async.onload() ' + srcAsync );\r\n\t\t\t\tif ( options.onload !== undefined ) {\r\n\r\n\t\t\t\t\tnext();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( script.readyState && ! script.onload ) {\r\n\r\n\t\t\t\t// IE, Opera\r\n\t\t\t\tscript.onreadystatechange = function () {\r\n\r\n\t\t\t\t\tif ( script.readyState == \"complete\" ) {\r\n\r\n\t\t\t\t\t\tif ( options.onload !== undefined ) options.onload();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( script.readyState == \"loaded\" ) {\r\n\r\n\t\t\t\t\t\tsetTimeout( options.onload, 0 );\r\n\r\n\t\t\t\t\t\tthis.onreadystatechange = null;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// Rest\r\n\t\t\t\tscript.onload = _onload;\r\n\r\n\t\t\t\tscript.onerror = function ( e ) {\r\n\r\n\t\t\t\t\tvar str = 'loadScript: \"' + this.src + '\" failed';\r\n\t\t\t\t\tif ( options.onerror !== undefined )\r\n\t\t\t\t\t\toptions.onerror( str, e );\r\n\t\t\t\t\tconsole.error( str );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscript.src = srcAsync;\r\n\r\n\t\t}, options );\r\n\r\n\t}\r\n\r\n\tif ( src instanceof Array ) {\r\n\r\n\t\tisrc = 0;\r\n\t\tasync( src[ isrc ] );\r\n\r\n\t} else async( src );\r\n\r\n}\r\n\r\nfunction loadScriptBase( callback, options ) {\r\n\r\n\toptions.tag = options.tag || {};\r\n\tif ( typeof options.tag === \"string\" ) {\r\n\r\n\t\tswitch ( options.tag ) {\r\n\r\n\t\t\tcase 'style':\r\n\t\t\t\toptions.tag = {\r\n\r\n\t\t\t\t\tname: 'style',\r\n\t\t\t\t\tattribute: {\r\n\r\n\t\t\t\t\t\tname: 'rel',\r\n\t\t\t\t\t\tvalue: 'stylesheet',\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: console.error( 'Invalid options.tag: ' + options.tag );\r\n\t\t\t\treturn;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\toptions.tag.name = options.tag.name || 'script';\r\n\tvar script = document.createElement( options.tag.name );\r\n\r\n\toptions.tag.attribute = options.tag.attribute || {};\r\n\toptions.tag.attribute.name = options.tag.attribute.name || \"type\";\r\n\toptions.tag.attribute.value = options.tag.attribute.value || 'text/javascript';\r\n\tscript.setAttribute( options.tag.attribute.name, options.tag.attribute.value );\r\n\r\n\tcallback( script );\r\n\toptions.appendTo.appendChild( script );\r\n\r\n}\r\n\r\nfunction isScriptExists( elParent, srcAsync, onload ) {\r\n\r\n\tvar scripts = elParent.querySelectorAll( 'script' );\r\n\tfor ( var i = 0; i < scripts.length; i++ ) {\r\n\r\n\t\tvar child = scripts[i];\r\n\t\tif ( child.id === srcAsync ) {\r\n\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\treturn false;\r\n\r\n}\r\n\r\nexport { async, sync, escapeHtml };\r\n","﻿/**\r\n * node.js version of download of the scripts.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * Copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { sync, async } from './index.js';\r\n\r\nvar loadScript = {\r\n\r\n\tsync: sync,\r\n\tasync: async,\r\n\r\n}\r\nexport default loadScript;\r\n","/**\r\n * @module ColorPicker\r\n * @description Pure JavaScript color picker.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * Thanks to https://github.com/DavidDurman/FlexiColorPicker\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n */\r\n\r\n\r\nimport loadScript from '../loadScriptNodeJS/loadScript.js';\r\n//import loadScript from 'https://raw.githack.com/anhr/commonNodeJS/master/loadScriptNodeJS/loadScript.js';\r\n\r\nimport three from '../three.js'\r\n\r\nconst optionsStyle = {\r\n\r\n\ttag: 'style'\r\n\r\n}\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\nconst currentScriptPath = getCurrentScriptPath();\r\n\r\nloadScript.sync( currentScriptPath + '/colorpicker.css', optionsStyle );\r\n\r\nconst type = ( window.SVGAngle || document.implementation.hasFeature( \"http://www.w3.org/TR/SVG11/feature#BasicStructure\", \"1.1\" ) ? \"SVG\" : \"VML\" ),\r\n\tsvgNS = 'http://www.w3.org/2000/svg';\r\nvar uniqID = 0;\r\n\r\nclass ColorPicker {\r\n\r\n\t/**Pure JavaScript color picker.\r\n\t * @class\r\n\t * @see [FlexiColorPicker]{@link https://github.com/DavidDurman/FlexiColorPicker}\r\n\t * */\r\n\tconstructor() {\r\n\r\n\t\tconst _this = this;\r\n\t\t/**\r\n\t\t * enumeration of available palettes.\r\n\t\t * @readonly\r\n\t\t * @enum {number}\r\n\t\t */\r\n\t\tthis.paletteIndexes = {\r\n\r\n\t\t\t/** <a href=\"../Example/index.html#BGYW\" target=\"_blank\">blue, green, yellow, white</a> palette. This is the default palette*/\r\n\t\t\tBGYW: 0,\r\n\t\t\t/** <a href=\"../Example/index.html#Monochrome\" target=\"_blank\">monochrome</a> palette */\r\n\t\t\tmonochrome: 1,\r\n\t\t\t/** <a href=\"../Example/index.html#Bidirectional\" target=\"_blank\">red, black, green</a> palette */\r\n\t\t\tbidirectional: 2,//\r\n\t\t\t/** <a href=\"../Example/index.html#rainbow\" target=\"_blank\">rainbow</a> palette */\r\n\t\t\trainbow: 3,\r\n\r\n\t\t}\r\n\r\n\t\tfunction CreateSVGElement( el, attrs, children ) {\r\n\r\n\t\t\tel = document.createElementNS( svgNS, el );\r\n\t\t\tfor ( var key in attrs )\r\n\t\t\t\tel.setAttribute( key, attrs[key] );\r\n\t\t\tif ( Object.prototype.toString.call( children ) != '[object Array]' ) children = [children];\r\n\t\t\tvar i = 0, len = ( children[0] && children.length ) || 0;\r\n\t\t\tfor ( ; i < len; i++ )\r\n\t\t\t\tel.appendChild( children[i] );\r\n\t\t\treturn el;\r\n\t\t}\r\n\r\n//\t\tvar boCreated = false;\r\n\t\t/**\r\n\t\t * @callback callback\r\n\t\t * @description Called whenever the color is changed provided chosen color in RGB HEX format. See options.sliderIndicator.callback param of the create method.\r\n\t\t * @param {object} c color\r\n\t\t * @param {string} c.hex A hexadecimal color is specified with: #RRGGBB, where the RR (red), GG (green) and BB (blue)\r\n\t\t * <pre>\r\n\t\t * hexadecimal integers specify the components of the color. All values must be between 00 and FF.\r\n\t\t * Example #00ff00\r\n\t\t * </pre>\r\n\t\t * @param {number} c.r red of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} c.g green of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} c.b blue of RGB color value. Must be between 0 and 255.\r\n\t\t * @param {number} percent position of the mouse pointer in the percents. See details in options.direction param\r\n\t\t */\r\n\r\n\t\t/**\r\n\t\t * @callback onError\r\n\t\t * @param {string} message error message\r\n\t\t */\r\n\r\n\t\t/**\r\n\t\t * creates an instance of ColorPicker\r\n\t\t * @param {string|HTMLElement} elSliderWrapper id of the ColorPicker element or ColorPicker element\r\n\t\t * @param {object} [options] followed options is availablee\r\n\t\t * @param {paletteIndexes|object[]|Palette} [options.palette] Palette index or palette array or Palette. The following indexes are available:\r\n\t\t * <pre>\r\n\t\t * <a href=\"../Example/index.html#BGYW\" target=\"_blank\">ColorPicker.paletteIndexes.BGYW</a>: 0 - blue, green, yellow, white palette.\r\n\t\t * <a href=\"../Example/index.html#Monochrome\" target=\"_blank\">ColorPicker.paletteIndexes.monochrome</a>: 1,\r\n\t\t * <a href=\"../Example/index.html#Bidirectional\" target=\"_blank\">ColorPicker.paletteIndexes.bidirectional</a>: 2,//red, black, green\r\n\t\t * <a href=\"../Example/index.html#rainbow\" target=\"_blank\">ColorPicker.paletteIndexes.rainbow</a>: 3,\r\n\t\t * Default is paletteIndexes.BGYW index.\r\n\t\t * Example of palette array:\r\n\t\t[\r\n\t\t\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t\t\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t\t\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n\t\t]\r\n\t\t * Palette see function Palette( options ) for details\r\n\t\t * </pre>\r\n\t\t * @param {object} [options.orientation] orientation of the element. Available \"horizontal\" or \"vertical\" orientation\r\n\t\t * @param {object} [options.direction] true - position of the mouse pointer relative left side for 'horizontal' slider\r\n\t\t * or bottom side for 'vertical' slider in the percents.\r\n\t\t * <p>\r\n\t\t * false - position of the mouse pointer relative right side for 'horizontal' slider\r\n\t\t * or relative top side for 'vertical' slider in the percents.\r\n\t\t * </p>\r\n\t\t * Default is true.\r\n\t\t * @param {object} [options.style] style statements\r\n\t\t * @param {object} [options.style.width] width of the element. Default is 200px for options.orientation = \"horizontal\"\r\n\t\t * and 30px for options.orientation = \"vertical\".\r\n\t\t * @param {object} [options.style.height] height of the element. Default is 30px for options.orientation = \"horizontal\"\r\n\t\t * and 200px for options.orientation = \"vertical\".\r\n\t\t * @param {string} [options.style.border] elSliderWrapper border. Example: '1px solid black'\r\n\t\t * @param {object} [options.sliderIndicator] adds a slider-indicator element for choose by mouse a color from palette.\r\n\t\t * Default is undefuned\r\n\t\t * @param {callback} [options.sliderIndicator.callback] Called whenever the color is changed provided chosen color in RGB HEX format.\r\n\t\t * @param {number} [options.sliderIndicator.value] Initial position of the slider indicator in percent. Default is 0.\r\n\t\t * @param {onError} [options.onError] Called whenever an error has occurred.\r\n\t\t * @param {boolean} [options.duplicate] true - allow to create two or more palettes on your web page.\r\n\t\t */\r\n\t\tthis.create = function( elSliderWrapper, options ) {\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\toptions.orientation = options.orientation || 'horizontal';\r\n\r\n\t\t\tfunction isHorizontal() { return options.orientation === \"horizontal\"; }\r\n\r\n\t\t\tif ( options.direction === undefined )\r\n\t\t\t\toptions.direction = true;\r\n\t\t\toptions.style = options.style || {};\r\n\t\t\t//\t\toptions.style.width = options.style.width || ( isHorizontal() ? '200px' : '30px' );\r\n\t\t\toptions.style.width = options.style.width || ( isHorizontal() ? 200 : 30 );\r\n\t\t\toptions.style.height = options.style.height || ( isHorizontal() ? 30 : 200 );\r\n\r\n\t\t\toptions.onError = options.onError || function () { }\r\n\r\n\t\t\tif ( elSliderWrapper instanceof HTMLElement !== true ) {\r\n\r\n\t\t\t\tif ( typeof elSliderWrapper !== \"string\" ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\telSliderWrapper = document.getElementById( elSliderWrapper );\r\n\t\t\t\tif ( elSliderWrapper === null ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create: invalid elSliderWrapper = ' + elSliderWrapper );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\telSliderWrapper.classList.add( 'slider-wrapper' );\r\n\t\t\tfor ( var style in options.style ) {\r\n\r\n\t\t\t\telSliderWrapper.style[style] = options.style[style];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst palette = options.palette instanceof this.palette ? options.palette : new this.palette( options );\r\n\t\t\tvar slide;\r\n\t\t\tfunction getSlideHeight() {\r\n\r\n\t\t\t\tif ( typeof options.style.height === \"string\" )\r\n\t\t\t\t\treturn parseInt( options.style.height );\r\n\t\t\t\treturn options.style.height;\r\n\r\n\t\t\t}\r\n\t\t\tfunction getSlideWidth() { return slide.clientWidth; }\r\n\t\t\t/**\r\n\t\t\t * sets color from palette\r\n\t\t\t * @param {number} value coordinate of color from palette in percent\r\n\t\t\t * @param {number} position coordinate of color from palette\r\n\t\t\t */\r\n\t\t\tfunction setValue( value, position ) {\r\n\r\n\t\t\t\tif ( slideIndicator === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Set value of this instance of the ColorPicker is impossible because options.sliderIndicator is not defined.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst c = palette.hsv2rgb( value );\r\n\t\t\t\tif ( c === undefined ) {\r\n\r\n\t\t\t\t\tconsole.error( 'ColorPicker.setValue: invalud c = ' + c );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvalue = c.percent;\r\n\t\t\t\tif ( position === undefined )\r\n\t\t\t\t\tposition = isHorizontal() ?\r\n\t\t\t\t\t\t( getSlideWidth() * value ) / 100 :\r\n\t\t\t\t\t\tgetSlideHeight() - ( getSlideHeight() * ( options.direction ? value : 100 - value ) ) / 100;\r\n\t\t\t\tpositionIndicators( position );\r\n\t\t\t\tif ( options.sliderIndicator.callback !== undefined ) {\r\n\r\n\t\t\t\t\t//console.warn( 'callback: ' + c.percent + ' percent c.hex = ' + c.hex );\r\n\t\t\t\t\toptions.sliderIndicator.callback( c );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar slideIndicator;\r\n\t\t\tif ( options.sliderIndicator !== undefined ) {\r\n\r\n\t\t\t\tslideIndicator = document.createElement( 'div' );\r\n\t\t\t\tslideIndicator.className = 'slider-indicator';\r\n\t\t\t\tif ( isHorizontal() )\r\n\t\t\t\t\tslideIndicator.style.width = '10px';\r\n\t\t\t\telse slideIndicator.style.height = '10px';\r\n\t\t\t\telSliderWrapper.appendChild( slideIndicator );\r\n\t\t\t\tslideIndicator.style.pointerEvents = 'none';\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Helper to position indicators.\r\n\t\t\t * @param {number} position Coordinates of the mouse cursor in the slide area.\r\n\t\t\t */\r\n\t\t\tfunction positionIndicators( position ) {\r\n\r\n\t\t\t\tif ( slideIndicator === undefined )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\t\t\tif ( ( position < 0 ) || ( position > getSlideWidth() ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tslideIndicator.style.top = '0px';\r\n\t\t\t\t\tslideIndicator.style.left = ( ( options.direction ? position : getSlideWidth() - position ) - slideIndicator.offsetWidth / 2 ) + 'px';\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( ( position < 0 ) || ( position > getSlideHeight() ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ColorPicker.positionIndicators: Invalid position = ' + position );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tslideIndicator.style.left = '0px';\r\n\t\t\t\t\tslideIndicator.style.top = ( position - slideIndicator.offsetHeight / 2 ) + 'px';\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tif ( type == 'SVG' ) {\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tconst linearGradient = 'linearGradient';\r\n\t\t\t\t\tslide = CreateSVGElement( 'svg', {\r\n//\t\t\t\t\t\txmlns: 'http://www.w3.org/2000/svg',\r\n\t\t\t\t\t\txmlns: svgNS,\r\n\t\t\t\t\t\tversion: '1.1',\r\n\t\t\t\t\t\twidth: isHorizontal() ? '100%' : options.style.width,\r\n\t\t\t\t\t\theight: options.style.height,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\tCreateSVGElement( 'defs', {},\r\n\t\t\t\t\t\t\t\tCreateSVGElement( linearGradient, {\r\n\r\n\t\t\t\t\t\t\t\t\tid: 'gradient-hsv-' + uniqID,\r\n\t\t\t\t\t\t\t\t\tx1: isHorizontal() && options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\ty1: !isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\tx2: isHorizontal() && !options.direction ? '100%' : '0%',\r\n\t\t\t\t\t\t\t\t\ty2: !isHorizontal() && options.direction ? '100%' : '0%',\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tpalette.getPalette()\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\tCreateSVGElement( 'rect', { x: '0', y: '0', width: '100%', height: '100%', fill: 'url(#gradient-hsv-' + uniqID + ')' } )\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\t\t\tslide.style.cursor = isHorizontal() ? 'e-resize' : 's-resize';\r\n\t\t\t\t\t\tslideIndicator.style.cursor = slide.style.cursor;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\t//I can not get \r\n\t\t\t\t\t// slide.querySelector( linearGradient );\r\n\t\t\t\t\t//in Safari 5.1.7 browser for Windows\r\n\t\t\t\t\t//Instead I see the error message:\r\n\t\t\t\t\t// 'null' is not an object( evaluating 'hsvGradient.id = 'gradient - hsv - ' + uniqID' )\r\n\t\t\t\t\tconsole.error( 'Create SVG element failed! ' + e.message );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\telSliderWrapper.appendChild( slide );\r\n\t\t\t\telSliderWrapper.style.height = getSlideHeight() + 'px';\r\n\r\n\t\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\t\tif ( isHorizontal() )\r\n\t\t\t\t\t\tslideIndicator.style.height = ( parseInt( options.style.height ) - 2 ) + 'px';\r\n\t\t\t\t\telse slideIndicator.style.width = ( parseInt( options.style.width ) - 2 ) + 'px';\r\n\r\n\t\t\t\t\toptions.sliderIndicator.value = options.sliderIndicator.value || 0;\r\n\t\t\t\t\tsetValue( options.sliderIndicator.value );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tuniqID++;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconsole.error( 'Under constraction' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction mouseMove( mouse ) {\r\n\r\n\t\t\t\t//for IE\r\n\t\t\t\tmouse.x = parseInt( mouse.x );\r\n\t\t\t\tmouse.y = parseInt( mouse.y );\r\n\r\n\t\t\t\tvar position, size, value;\r\n\t\t\t\tif ( isHorizontal() ) {\r\n\r\n\t\t\t\t\tposition = mouse.x;\r\n\t\t\t\t\tsize = getSlideWidth() - 1;\r\n\r\n\t\t\t\t\tif ( position >= getSlideWidth() )\r\n\t\t\t\t\t\tposition = size;\r\n\t\t\t\t\tvalue = ( position * 100 ) / size;\r\n\t\t\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\t\t\tvalue = 100 - value;\r\n\t\t\t\t\t\tposition = size - position;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tposition = mouse.y;\r\n\t\t\t\t\tsize = getSlideHeight() - 1;\r\n\r\n\t\t\t\t\tif ( position >= getSlideHeight() )\r\n\t\t\t\t\t\tposition = size;\r\n\t\t\t\t\tvalue = ( 1 - position / size ) * 100;\r\n\t\t\t\t\tif ( !options.direction ) {\r\n\r\n\t\t\t\t\t\tvalue = 100 - value;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetValue( value, position );\r\n\r\n\t\t\t}\r\n\t\t\tif ( slideIndicator !== undefined ) {\r\n\r\n\t\t\t\tvar mouseout = false;\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Return click event handler for the slider.\r\n\t\t\t\t * Sets picker background color and calls options.sliderIndicator.callback if provided.\r\n\t\t\t\t */\r\n\t\t\t\tfunction slideListener() {\r\n\r\n\t\t\t\t\treturn function ( evt ) {\r\n\r\n\t\t\t\t\t\tif ( mouseout )\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\tevt = evt || window.event;\r\n\r\n\t\t\t\t\t\t/**\r\n\t\t\t\t\t\t * Return mouse position relative to the element el.\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tfunction mousePosition( evt ) {\r\n\t\t\t\t\t\t\t// IE:\r\n\t\t\t\t\t\t\tif ( window.event && window.event.contentOverflow !== undefined ) {\r\n\t\t\t\t\t\t\t\treturn { x: window.event.offsetX, y: window.event.offsetY };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Webkit:\r\n\t\t\t\t\t\t\tif ( evt.offsetX !== undefined && evt.offsetY !== undefined ) {\r\n\t\t\t\t\t\t\t\treturn { x: evt.offsetX, y: evt.offsetY };\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t// Firefox:\r\n\t\t\t\t\t\t\tvar wrapper = evt.target.parentNode.parentNode;\r\n\t\t\t\t\t\t\treturn { x: evt.layerX - wrapper.offsetLeft, y: evt.layerY - wrapper.offsetTop };\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tmouseMove( mousePosition( evt ) );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tfunction addEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ( element.attachEvent ) {\r\n\r\n\t\t\t\t\t\telement.attachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t} else if ( element.addEventListener ) {\r\n\r\n\t\t\t\t\t\telement.addEventListener( event, listener, false );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\taddEventListener( slide, 'click', slideListener() );\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * @callback listener\r\n\t\t\t\t*/\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * Enable drag&drop color selection.\r\n\t\t\t\t * @param {object} ctx ColorPicker instance.\r\n\t\t\t\t * @param {listener} listener Function that will be called whenever mouse is dragged over the element with event object as argument.\r\n\t\t\t\t */\r\n\t\t\t\tfunction enableDragging( ctx, listener ) {\r\n\r\n\t\t\t\t\tvar element = slide;\r\n\r\n\t\t\t\t\t//Touchscreen support\r\n\r\n\t\t\t\t\taddEventListener( element, 'touchstart', function ( evt ) { } );\r\n\t\t\t\t\taddEventListener( element, 'touchmove', function ( evt ) {\r\n\r\n\t\t\t\t\t\tevt.preventDefault();\r\n\r\n\t\t\t\t\t\tvar rect = evt.srcElement.getBoundingClientRect(),\r\n\t\t\t\t\t\t\tx = ( evt.touches[0].clientX - rect.left ),\r\n\t\t\t\t\t\t\ty = ( evt.touches[0].clientY - rect.top );\r\n\t\t\t\t\t\tif ( x < 0 ) x = 0;\r\n\t\t\t\t\t\tif ( y < 0 ) y = 0;\r\n\t\t\t\t\t\tmouseMove( { x: x, y: y } );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\taddEventListener( element, 'touchend', function ( evt ) {\r\n\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t//mouse support\r\n\t\t\t\t\taddEventListener( element, 'mousedown', function ( evt ) {\r\n\r\n\t\t\t\t\t\tconst mouseup = 'mouseup', mousemove = 'mousemove';\r\n\t\t\t\t\t\tfunction onMouseUp() {\r\n\r\n\t\t\t\t\t\t\t//console.warn( mouseup );\r\n\t\t\t\t\t\t\tfunction removeEventListener( element, event, listener ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( element === null )\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\tif ( element.detachEvent ) {\r\n\r\n\t\t\t\t\t\t\t\t\telement.detachEvent( 'on' + event, listener );\r\n\r\n\t\t\t\t\t\t\t\t} else if ( element.removeEventListener ) {\r\n\r\n\t\t\t\t\t\t\t\t\telement.removeEventListener( event, listener, false );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tremoveEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\t\t\tremoveEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taddEventListener( window, mouseup, onMouseUp );\r\n\t\t\t\t\t\taddEventListener( window, mousemove, listener );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\taddEventListener( element, 'mouseout', function ( evt ) { mouseout = true; } );\r\n\t\t\t\t\taddEventListener( element, 'mouseover', function ( evt ) { mouseout = false; } );\r\n\t\t\t\t}\r\n\t\t\t\tenableDragging( this, slideListener() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\r\n\t\t\t\tsetValue: setValue,\r\n\r\n\t\t\t};\r\n\t\t}\r\n\t\t/**\r\n\t\t * create palette\r\n\t\t * @param {object} [options] the following options are available\r\n\t\t * @param {paletteIndexes|object[]} [options.palette] Palette index or palette array. The following indexes are available:\r\n\t\t * <pre>\r\n\t\t * paletteIndexes.BGYW: 0 - blue, green, yellow, white palette.\r\n\t\t * paletteIndexes.monochrome: 1,\r\n\t\t * paletteIndexes.bidirectional: 2,//red, black, green\r\n\t\t * paletteIndexes.rainbow: 3,\r\n\t\t * Default is paletteIndexes.BGYW index.\r\n\t\t * Example of palette array:\r\n\t\t[\r\n\t\t\t{ percent: 0, r: 0, g: 0, b: 0, },\r\n\t\t\t{ percent: 10, r: 0xff, g: 255, b: 0xff, },\r\n\t\t\t{ percent: 100, r: 0xff, g: 255, b: 0xff, },\r\n\t\t]\r\n\t\t* </pre>\r\n\t\t*/\r\n\t\tthis.palette = function( options ) {\r\n\r\n\r\n\t\t\tfunction paletteitem( percent, r, g, b ) {\r\n\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tpercent: percent,\r\n\t\t\t\t\tr: r,\r\n\t\t\t\t\tg: g,\r\n\t\t\t\t\tb: b,\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\toptions = options || {};\r\n\t\t\tif ( options.palette === undefined )\r\n\t\t\t\toptions.palette = _this.paletteIndexes.BGYW;\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * @returns Index of palette.\r\n\t\t\t * <pre>\r\n\t\t\t * 0 - <a href=\"../Example/index.html#BGYW\" target=\"_blank\">BGYW</a>\r\n\t\t\t * 1 - <a href=\"../Example/index.html#Monochrome\" target=\"_blank\">monochrome</a>\r\n\t\t\t * 2 - <a href=\"../Example/index.html#Bidirectional\" target=\"_blank\">bidirectional</a>\r\n\t\t\t * 3 - <a href=\"../Example/index.html#rainbow\" target=\"_blank\">rainbow</a>\r\n\t\t\t * </pre>\r\n\t\t\t * */\r\n\t\t\tthis.getPaletteIndex = function () { return options.palette; }\r\n\r\n\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0xFF ),//blue\r\n\t\t\t\tnew paletteitem( 33, 0x00, 0xFF, 0x00 ),//green\r\n\t\t\t\tnew paletteitem( 66, 0xFF, 0xFF, 0x00 ),//yellow\r\n\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t];\r\n\t\t\tswitch ( typeof options.palette ) {\r\n\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tswitch ( options.palette ) {\r\n\r\n\t\t\t\t\t\tcase _this.paletteIndexes.BGYW:\r\n\t\t\t\t\t\t\tbreak;//default palette\r\n\t\t\t\t\t\tcase _this.paletteIndexes.monochrome:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0x00, 0x00, 0x00 ),//blach\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0xFF, 0xFF, 0xFF ),//white\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase _this.paletteIndexes.bidirectional:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x30, 0x30 ),//red\r\n\t\t\t\t\t\t\t\tnew paletteitem( 50, 0x30, 0x30, 0x30 ),//gray\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0x30, 0xFF, 0x30 ),//green\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase _this.paletteIndexes.rainbow:\r\n\t\t\t\t\t\t\tvar arrayPalette = [\r\n\r\n\t\t\t\t\t\t\t\tnew paletteitem( 0, 0xff, 0x32, 0x32 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 16, 0xfc, 0xf5, 0x28 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 32, 0x28, 0xfc, 0x28 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 50, 0x28, 0xfc, 0xf8 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 66, 0x27, 0x2e, 0xf9 ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 82, 0xff, 0x28, 0xfb ),\r\n\t\t\t\t\t\t\t\tnew paletteitem( 100, 0xff, 0x32, 0x32 ),\r\n\r\n\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: console.error( 'ColorPicker.create.Palette: invalid options.palette = ' + options.palette );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"object\":\r\n\t\t\t\t\tif ( Array.isArray( options.palette ) ) {\r\n\r\n\t\t\t\t\t\t//Custom palette\r\n\t\t\t\t\t\tarrayPalette = options.palette;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tvar message = 'invalid options.palette = ' + options.palette;\r\n\t\t\t\t\tconsole.error( 'ColorPicker.create.Palette: ' + message );\r\n\t\t\t\t\toptions.onError( message );\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t* @returns true\r\n\t\t\t*/\r\n\t\t\tthis.isPalette = function () { return true; }\r\n\t\t\t/**\r\n\t\t\t* @returns {object[]} palette array\r\n\t\t\t*/\r\n\t\t\tthis.getPalette = function () {\r\n\r\n\t\t\t\tconst palette = [];\r\n\t\t\t\tarrayPalette.forEach( function ( item ) {\r\n\r\n\t\t\t\t\tpalette.unshift( CreateSVGElement( 'stop', {\r\n\r\n\t\t\t\t\t\toffset: ( 100 - item.percent ) + '%', 'stop-color': '#'\r\n\t\t\t\t\t\t\t//Thanks to https://stackoverflow.com/a/13240395/5175935\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.r ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.g ).toString( 16 ) ) ).slice( -2 ).toUpperCase()\r\n\t\t\t\t\t\t\t+ ( \"0\" + ( Number( item.b ).toString( 16 ) ) ).slice( -2 ).toUpperCase(),\r\n\t\t\t\t\t\t'stop-opacity': '1'\r\n\r\n\t\t\t\t\t} ) );\r\n\r\n\t\t\t\t} );\r\n\t\t\t\treturn palette;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t* converts a percent or value from min to max  to object with r, g, b, hex and percent.\r\n\t\t\t* @param {number} stringPercent coordinate of color from palette in percent or value from min to max\r\n\t\t\t* @param {number} [min] min stringPercent.\r\n\t\t\t* @param {number} [max] max stringPercent.\r\n\t\t\t* @returns {object} object with r, g, b, hex and percent\r\n\t\t\t*/\r\n\t\t\tthis.hsv2rgb = function ( stringPercent, min, max ) {\r\n\r\n\t\t\t\tvar percent = parseFloat( stringPercent );\r\n\t\t\t\tif ( isNaN( percent ) ) {\r\n\r\n\t\t\t\t\t//Сюда попадает из http://localhost/anhr/egocentricUniverse/master/Examples/3D.html\r\n\t\t\t\t\t//Когда вместо случайного выбора вершин задаю их вручную и при этом не указываю координату w вершины\r\n\t\t\t\t\tpercent = max;\r\n/*\t\t\t\t\t\r\n\t\t\t\t\tconsole.error( 'ColorPicker.palette.hsv2rgb: stringPercent = ' + stringPercent );\r\n\t\t\t\t\treturn;\r\n*/\t \r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif ( min !== undefined && max !== undefined )\r\n\t\t\t\t\tpercent = ( 100 / ( max - min ) ) * ( percent - min );\r\n\t\t\t\tvar lastPalette = arrayPalette[arrayPalette.length - 1];\r\n\t\t\t\tif ( lastPalette.percent !== 100 ) {\r\n\r\n\t\t\t\t\t//not compatible with Safari for Windows\r\n\t\t\t\t\t//var lastItem = Object.assign( {}, arrayPalette[arrayPalette.length - 1] );\r\n\r\n\t\t\t\t\tconst lastItem = {};\r\n\t\t\t\t\tObject.keys( lastPalette ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tlastItem[key] = lastPalette[key];\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tlastItem.percent = 100;\r\n\t\t\t\t\tarrayPalette.push( lastItem );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar itemPrev;\r\n\t\t\t\tfor ( var i = 0; i < arrayPalette.length; i++ ) {\r\n\r\n\t\t\t\t\tconst item = arrayPalette[i];\r\n\t\t\t\t\tif ( itemPrev === undefined )\r\n\t\t\t\t\t\titemPrev = item;\r\n\t\t\t\t\tif ( ( ( percent >= itemPrev.percent ) && ( percent <= item.percent ) ) ) {\r\n\r\n\t\t\t\t\t\tfunction color( percentPrev, prev, percentItem, item ) {\r\n\r\n\t\t\t\t\t\t\tvar percentD = percentItem - percentPrev;\r\n\t\t\t\t\t\t\tif ( percentD === 0 )\r\n\t\t\t\t\t\t\t\treturn prev;\r\n\t\t\t\t\t\t\treturn Math.round( prev + ( ( item - prev ) / percentD ) * ( percent - percentPrev ) );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst r = color( itemPrev.percent, itemPrev.r, item.percent, item.r ),\r\n\t\t\t\t\t\t\tg = color( itemPrev.percent, itemPrev.g, item.percent, item.g ),\r\n\t\t\t\t\t\t\tb = color( itemPrev.percent, itemPrev.b, item.percent, item.b );\r\n\t\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\t\tr: r,\r\n\t\t\t\t\t\t\tg: g,\r\n\t\t\t\t\t\t\tb: b,\r\n\t\t\t\t\t\t\thex: \"#\" + ( 16777216 | b | ( g << 8 ) | ( r << 16 ) ).toString( 16 ).slice( 1 ),\r\n\t\t\t\t\t\t\tpercent: percent\r\n\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\titemPrev = item;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( options.onError !== undefined )\r\n\t\t\t\t\toptions.onError( 'Invalid color value of the ColorPicker: ' + stringPercent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t* converts a value in percentages to color.\r\n\t\t\t* @param {number} value coordinate of color from palette in percent. Default value range from 0 to 100.\r\n\t\t\t* @param {number} [min] minimal value\r\n\t\t\t* @param {number} [max] maximal value\r\n\t\t\t* @returns {THREE.Color} [color]{@link https://threejs.org/docs/index.html?q=Colo#api/en/math/Color}\r\n\t\t\t*/\r\n\t\t\tthis.toColor = function ( value, min, max ) {\r\n\r\n\t\t\t\tconst THREE = three.THREE;\r\n\t\t\t\tif ( value instanceof THREE.Color )\r\n\t\t\t\t\treturn value;\r\n\t\t\t\tvar c = this.hsv2rgb( value, min, max );\r\n\t\t\t\tif ( c === undefined )\r\n\t\t\t\t\tc = { r: 255, g: 255, b: 255 }\r\n\t\t\t\treturn new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\r\n\t\t\t}\r\n\r\n//\t\t\tboCreated = true;\r\n\r\n\t\t}\r\n\t}\r\n}\r\nColorPicker = new ColorPicker();\r\nexport default ColorPicker;\r\n","/**\r\n * @module cookie\r\n * @description node.js version of the cookie.\r\n * Cookies let you store user information in web pages.\r\n * @see {@link https://www.w3schools.com/js/js_cookies.asp}\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nexport { isEnabled, set, setObject, get, getObject, copyObject, remove, defaultCookie };\r\n\r\n/**\r\n * Is the cookie enabled in your web browser?\r\n * @returns {boolean} true if cookie enabled\r\n * \r\n * @example\r\n\tvar isCookieEnabled = cookie.isEnabled('age', 25);\r\n */\r\nfunction isEnabled() {\r\n\r\n\treturn navigator.cookieEnabled;\r\n\t//Enable cookie\r\n\t//Chrome: Settings/Show advanced settings.../Privacy/Content settings.../Cookies/Allow local data to be set\r\n\r\n}\r\n\r\n/**\r\n * Set a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} value cookie value.\r\n * @param {Date} [cookie_date] expiry date (in UTC time). Optional.\r\n * @example\r\n\tcookie.set('age', 25);\r\n */\r\nfunction set( name, value, cookie_date ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\tvalue = value.toString();\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tif ( cookie_date === undefined ) {\r\n\r\n\t\tcookie_date = new Date();  // Curent date and time\r\n\t\tcookie_date.setTime( cookie_date.getTime() + 1000 * 60 * 60 * 24 * 365 );//expiry date is one year\r\n\r\n\t}\r\n\tdocument.cookie = name + \"=\" + value + ( ( typeof settings == 'undefined' ) ? '' : settings ) + \"; expires=\" + cookie_date.toGMTString();\r\n\tif ( document.cookie === '' )\r\n\t\tconsole.error( 'document.cookie is empty' );\r\n\r\n}\r\n\r\n/**\r\n * sets an object into cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} object an object for saving into cookie.\r\n */\r\nfunction setObject( name, object ) {\r\n\r\n\tset( name, JSON.stringify( object ) );\r\n\r\n};\r\n\r\n/**\r\n * Get a cookie.\r\n * @param {string} name cookie name.\r\n * @param {any} [defaultValue] cookie default value. Optional.\r\n * @returns {string} cookie value or defaultValue if cookie was not found.\r\n * @example\r\n\tvar age = cookie.get('age', 25);\r\n */\r\nfunction get( name, defaultValue ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar results = document.cookie.match( '(^|;) ?' + name + '=([^;]*)(;|$)' );\r\n\r\n\tif ( results ) {\r\n\t\t\r\n\t\tconst result = results[2], type = typeof defaultValue;\r\n\t\treturn type === \"number\" ?//number\r\n\t\t\t\tresult % 1 === 0 ? parseInt(result) : parseFloat(result) :\r\n\t\t\ttype === \"boolean\" ?//boolean\r\n\t\t\t\tresult === 'true' ? true : false :\r\n\t\t\tunescape( result );//string\r\n\r\n\t}\r\n\tif ( typeof defaultValue == 'undefined' )\r\n\t\treturn '';\r\n\treturn defaultValue;\r\n\r\n}\r\n\r\n/**\r\n * gets an object from cookie.\r\n * @param {string} name name of the object.\r\n * @param {Object} options load an object from cookie into options.\r\n * @param {Object} [optionsDefault=options] copy to options this default object if named object is not exists in the cookie.\r\n */\r\nfunction getObject( name, options, optionsDefault ) {\r\n\r\n\t//uncompatible with ND build\r\n\t//optionsDefault ||= options;\r\n\t\r\n\tif (optionsDefault === undefined) optionsDefault = options;\r\n\tnew defaultCookie().getObject( name, options, copyObject( name, optionsDefault ) );\r\n\r\n};\r\n\r\n/**\r\n * gets an object from cookie and returns a copy of object.\r\n * @param {string} name name of the object.\r\n * @param {Object} objectDefault copy to options this default object if named object is not exists in the cookie.\r\n * @returns copy of object from cookie.\r\n */\r\nfunction copyObject( name, objectDefault ) {\r\n\r\n\treturn JSON.parse( get( name, JSON.stringify( objectDefault ) ) );\r\n\r\n}\r\n\r\n/**\r\n * Remove cookie\r\n * @param {string} name cookie name.\r\n */\r\nfunction remove( name ) {\r\n\r\n\tif ( !isEnabled() ) {\r\n\r\n\t\tconsoleCookieEnabled();\r\n\t\treturn;\r\n\r\n\t}\r\n\t//http://ruseller.com/lessons.php?rub=28&id=593\r\n\tvar cookie_date = new Date();\r\n\tcookie_date.setTime( cookie_date.getTime() - 1 );\r\n\tdocument.cookie = name += \"=; expires=\" + cookie_date.toGMTString();\r\n\r\n}\r\n\r\nfunction consoleCookieEnabled() {\r\n\r\n\tconsole.error( 'navigator.cookieEnabled = ' + navigator.cookieEnabled );\r\n\r\n}\r\n\r\n/**\r\n * Default cookie is not saving settings\r\n * @param {any} name is not using\r\n */\r\nclass defaultCookie {\r\n\r\n\tconstructor(name) {\r\n\t\t/**\r\n\t\t * Default cookie is not loading settings\r\n\t\t * @param {any} defaultValue\r\n\t\t * @returns defaultValue\r\n\t\t */\r\n\t\tthis.get = function (defaultValue) {\r\n\r\n\t\t\treturn defaultValue;\r\n\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Default cookie is not saving settings\r\n\t\t */\r\n\t\tthis.set = function () {\r\n\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Default cookie is not loading objects\r\n\t\t * @param {string} name is not using\r\n\t\t * @param {any} options load an object from optionsDefault into options\r\n\t\t * @param {Object} optionsDefault source object\r\n\t\t */\r\n\t\tthis.getObject = function (name, options, optionsDefault) {\r\n\r\n\t\t\tif (!optionsDefault)\r\n\t\t\t\treturn;//object's settings is not saving\r\n\t\t\tObject.keys(optionsDefault).forEach(function (key) {\r\n\r\n\t\t\t\t//I cannot modify options[key] if optionsDefault is read only and options[key] is not copy of optionsDefault[key]\r\n\t\t\t\t//options[key] = optionsDefault[key];\r\n\t\t\t\t//copy key\r\n\t\t\t\tvar option = optionsDefault[key];\r\n\t\t\t\tif ((option !== undefined) && (typeof option !== 'function'))\r\n\t\t\t\t\toptions[key] = JSON.parse(JSON.stringify(option));\r\n\r\n\t\t\t});\r\n\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * copy and returns an object from objectDefault\r\n\t\t * @param {string} name is not using\r\n\t\t * @param {any} objectDefault source object\r\n\t\t */\r\n\t\tthis.copyObject = function (name, objectDefault) {\r\n\r\n\t\t\treturn JSON.parse(JSON.stringify(objectDefault));\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Default cookie is not saving object's settings\r\n\t\t */\r\n\t\tthis.setObject = function () {\r\n\r\n\t\t};\r\n\r\n\t\tthis.isTrue = function (defaultValue) {\r\n\r\n\t\t\treturn defaultValue;\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n};\r\n","﻿/**\r\n * node.js version of the cookie.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport * as cookie from './index.js';\r\nexport default cookie;","/**\r\n * @module Localization.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/**\r\n * returns the \"primary language\" subtag of the version of the browser.\r\n * See the \"Syntax\" paragraph of RFC 4646 https://tools.ietf.org/html/rfc4646#section-2.1 for details.\r\n */\r\nexport function getLanguageCode() {\r\n\r\n\t//returns the language version of the browser.\r\n\tfunction _getLocale() {\r\n\r\n\t\tif ( !navigator ) {\r\n\r\n\t\t\tconsole.error( \"getLocale() failed! !navigator\" );\r\n\t\t\treturn \"\";\r\n\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t( navigator.languages !== undefined )\r\n\t\t\t&& ( typeof navigator.languages !== 'unknown' )//for IE6\r\n\t\t\t&& ( navigator.languages.length > 0 )\r\n\t\t)\r\n\t\t\treturn navigator.languages[0];//Chrome\r\n\r\n\t\t//IE\r\n\t\tif ( navigator.language ) {\r\n\r\n\t\t\treturn navigator.language;\r\n\r\n\t\t} else if ( navigator.browserLanguage ) {\r\n\r\n\t\t\treturn navigator.browserLanguage;\r\n\r\n\t\t} else if ( navigator.systemLanguage ) {\r\n\r\n\t\t\treturn navigator.systemLanguage;\r\n\r\n\t\t} else if ( navigator.userLanguage ) {\r\n\r\n\t\t\treturn navigator.userLanguage;\r\n\r\n\t\t}\r\n\r\n\t\tconsole.error( \"getLocale() failed!\" );\r\n\t\treturn \"\";\r\n\r\n\t}\r\n\r\n\treturn _getLocale().toLowerCase().match( /([a-z]+)(?:-([a-z]+))?/ )[1];\r\n\r\n};\r\n\r\n","/**\r\n * @module CreateFullScreenSettings\r\n * @description creates functions for resize of the canvas to fullscreen and restore to default size.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n//import StereoEffect from 'https://raw.githack.com/anhr/commonNodeJS/master/StereoEffect/StereoEffect.js';\r\nimport StereoEffect from './StereoEffect/StereoEffect.js';\r\n\r\n/**\r\n * @callback onFullScreenToggle\r\n * @param {boolean} fullScreen false - full screen mode of the canvas.\r\n */\r\n\r\n/**\r\n * @class creates functions for resize of the canvas to fullscreen and restore to default size.\r\n * @param {THREE} THREE [THREE]{@link https://threejs.org/}\r\n * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {object} options the following options are available:\r\n * @param {CanvasMenu} [options.canvasMenu] <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>\r\n * @param {StereoEffect} [options.stereoEffect] <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a> instance.\r\n * @param {object} [options.fullScreen] followed fullScreen methods available:\r\n * @param {onFullScreenToggle} [options.fullScreen.onFullScreenToggle] user toggled fullscreen mode of the canvas.\r\n */\r\nfunction CreateFullScreenSettings( THREE, renderer, camera, options ) {\r\n\r\n\tvar fullScreen = false, canvasMenu, stereoEffect;\r\n\r\n\toptions.fullScreen = options.fullScreen || {};\r\n\tif ( options.canvasMenu ) canvasMenu = options.canvasMenu;\r\n\tif ( options.stereoEffect ) stereoEffect = options.stereoEffect;\r\n\trenderer.setSize( renderer.domElement.width, renderer.domElement.height );\r\n\r\n\tvar style;\r\n\r\n\t/**\r\n\t * @returns <b>true</b> if <b>canvas</b> is full screen.\r\n\t */\r\n\tthis.isFullScreen = function () { return fullScreen; }\r\n\t/**\r\n\t * @param {StereoEffect} _stereoEffect <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t */\r\n\tthis.setStereoEffect = function ( _stereoEffect ) { stereoEffect = _stereoEffect; }\r\n\t/**\r\n\t * Sets the full screen of the canvas.\r\n\t * @param {boolean} [fullScreen=false] false - full screen of the canvas.\r\n\t * @param {boolean} [boTimeout=false] true - set fullScreen after 0 msec timeout.\r\n\t */\r\n\tthis.setFullScreen = function ( fs = false, boTimeout = false ) {\r\n\r\n\t\tsetTimeout( function () {\r\n\r\n\t\t\t//Если на веб странице один MyThree то по умолчанию он на всю страницу.\r\n\t\t\t//Если на веб странице больше одного MyThree то по умолчанию все MyThree не на всю страницу.\r\n\t\t\t//В противном случае если несколько MyThree на всю страницу то они будут накладываться друг на друга \r\n\t\t\t//между ними произойдет путаница\r\n\t\t\tif ( boTimeout && options.fullScreen.arrayContainersLength && ( options.fullScreen.arrayContainersLength() > 1 ) )\r\n\t\t\t\tfs = true;\r\n\t\t\tconst size = new THREE.Vector2();\r\n\t\t\trenderer.getSize( size );\r\n\t\t\tfullScreen = fs;\r\n\t\t\tif ( fullScreen ) {\r\n\r\n\t\t\t\tif ( style !== undefined ) {\r\n\r\n\t\t\t\t\t//restore size of the canvas\r\n\t\t\t\t\trenderer.setSize( style.sizeOriginal.x, style.sizeOriginal.y );\r\n\t\t\t\t\trenderer.domElement.style.position = style.position;\r\n\t\t\t\t\trenderer.domElement.style.left = style.left;\r\n\t\t\t\t\trenderer.domElement.style.top = style.top;\r\n\t\t\t\t\trenderer.domElement.style.width = style.width;\r\n\t\t\t\t\trenderer.domElement.style.height = style.height;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( style === undefined ) {\r\n\r\n\t\t\t\t\tstyle = {\r\n\r\n\t\t\t\t\t\tsizeOriginal: new THREE.Vector2(),\r\n\t\t\t\t\t\tposition: renderer.domElement.style.position,\r\n\t\t\t\t\t\tleft: renderer.domElement.style.left,\r\n\t\t\t\t\t\ttop: renderer.domElement.style.top,\r\n\t\t\t\t\t\twidth: renderer.domElement.style.width,\r\n\t\t\t\t\t\theight: renderer.domElement.style.height,\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\trenderer.getSize( style.sizeOriginal );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Full screen of the canvas\r\n\t\t\t\trenderer.setSize( window.innerWidth, window.innerHeight );\r\n\t\t\t\trenderer.domElement.style.position = 'fixed';\r\n\t\t\t\trenderer.domElement.style.left = 0;\r\n\t\t\t\trenderer.domElement.style.top = 0;\r\n\t\t\t\trenderer.domElement.style.width = '100%';\r\n\t\t\t\trenderer.domElement.style.height = '100%';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.fullScreen.onFullScreenToggle !== undefined ) options.fullScreen.onFullScreenToggle( fullScreen );\r\n\r\n\t\t\tcamera.aspect = size.x / size.y;\r\n\t\t\tcamera.updateProjectionMatrix();\r\n\t\t\tfullScreen = !fullScreen;\r\n\t\t\tif ( canvasMenu && canvasMenu.setFullScreenButton ) canvasMenu.setFullScreenButton( fullScreen );\r\n\t\t\tCreateFullScreenSettings.RendererSetSize( renderer, options.canvasMenu );\r\n\r\n\t\t}, 0 );\r\n\r\n\t}\r\n\t/**\r\n\t * User has clicked the \"Full Screen\" button on the <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>.\r\n\t * @event\r\n\t */\r\n\tthis.onclick = function () {\r\n\r\n\t\tif (\r\n\t\t\t( stereoEffect !== undefined )\r\n\t\t\t&& ( parseInt( stereoEffect.settings.spatialMultiplex ) !== StereoEffect.spatialMultiplexsIndexs.Mono )\r\n\t\t) {\r\n\r\n\t\t\tstereoEffect.settings.spatialMultiplex = StereoEffect.spatialMultiplexsIndexs.Mono;\r\n\r\n\t\t}\r\n\r\n\t\tthis.setFullScreen( fullScreen );\r\n\t\treturn fullScreen;\r\n\r\n\t}\r\n\r\n}\r\n/** @namespace\r\n * @description set size of renderer.\r\n * @param {THREE.WebGLRenderer} renderer [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}.\r\n * @param {CanvasMenu} canvasMenu <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>\r\n */\r\nCreateFullScreenSettings.RendererSetSize = function ( renderer, canvasMenu ){\r\n\r\n\tif ( renderer.setSizeOld )\r\n\t\treturn;\r\n\t\t\r\n\trenderer.setSizeOld = renderer.setSize;\r\n\trenderer.setSize = function ( width, height, updateStyle ) {\r\n\r\n\t\trenderer.setSizeOld( width, height, updateStyle );\r\n\t\tconst elCanvas = renderer.domElement, elContainer = elCanvas.parentElement;\r\n\r\n\t\tsetTimeout( function () {\r\n\r\n\t\t\telContainer.style.height = elCanvas.style.height;\r\n\t\t\telContainer.style.width = elCanvas.style.width;\r\n\t\t\telContainer.style.left = elCanvas.style.left;\r\n\t\t\telContainer.style.top = elCanvas.style.top;\r\n\t\t\telContainer.style.position = elCanvas.style.position;\r\n\t\t\tif ( canvasMenu ) canvasMenu.setSize( width, height );\r\n\r\n\t\t}, 0 );\r\n\r\n\t};\r\n\r\n}\r\nexport default CreateFullScreenSettings;","/**\r\n * @module SpriteText\r\n * @description A sprite based text component. Text that always faces towards the camera.\r\n * @see {@link https://threejs.org/docs/index.html#api/en/objects/Sprite|THREE.Sprite}\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n//var THREE;\r\nimport three from '../three.js'\r\n\r\n/**\r\n * A sprite based text component.\r\n * @param {string|number} text The text to be displayed on the sprite. You can include a multiline text separated by \"\\r\\n\".\r\n * @param {THREE.Vector3} [position=new THREE.Vector3()] Position of the text.\r\n * @param {options} [options={}] the following options are available\r\n * @param {string} [options.name] Name of the <b>SpriteText</b> instance.\r\n * @param {THREE.Group} [options.group] Parent group of the SpriteText with common options.\r\n * See {@link https://github.com/anhr/SpriteText#groupuserdataoptionsspritetext---common-options-for-the-group-of-the-spritetext|common options for the group of the SpriteText}.\r\n * Default is undefined.\r\n * @param {number} [options.textHeight=0.04] The height of the text.\r\n * @param {number} [options.fov] Camera frustum vertical field of view, from bottom to top of view, in degrees.\r\n * {@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera.fov|PerspectiveCamera.fov}\r\n * Set the fov option as camera.fov if you want to see text size is independent from camera.fov. The text height will be calculated as textHeight = fov * textHeight / 50\r\n * Default is undefined.\r\n * @param {boolean} [options.sizeAttenuation=false] Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.)\r\n * See {@link https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation|SpriteMaterial.sizeAttenuation}\r\n * @param {number} [options.rotation=0] The rotation of the sprite in radians.\r\n * See {@link https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.rotation|SpriteMaterial.rotation}\r\n * @param {string} [options.fontFace='Arial'] CSS font-family - specifies the font of the text.\r\n * @param {string[]} [options.fontFaces] array of fontFaces. Example ['Arial', 'Verdana', 'Times'].\r\n * @param {string} [options.fontColor='rgba(255, 255, 255, 1)'] RGBA object or RGB object or HEX value.\r\n *\tExamples 'rgba(0, 0, 255, 0.5)', '#00FF00'.\r\n * @param {boolean} [options.bold=false] CSS font-weight. Equivalent of 700.\r\n * @param {boolean} [options.italic=false] CSS font-style.\r\n * @param {string} [options.fontProperties] Other font properties. The font property uses the same syntax as the CSS font property.\r\n * \tDefault is empty string. Example \"900\", \"oblique lighter\".\r\n * @param {options} [options.rect={}] rectangle around the text.\r\n * @param {boolean} [options.rect.displayRect=false] true - the rectangle around the text is visible.\r\n * @param {string} [options.rect.backgroundColor='rgba(0, 0, 0, 0)' - black transparent] background color. RGBA object or RGB object or HEX value\r\n * <pre>\r\n * \tExamples 'rgba(0, 0, 255, 0.5)', '#00FF00'.\r\n * </pre>\r\n * @param {string} [options.rect.borderColor] border color. RGBA object or RGB object or HEX value. Default is same as options.fontColor 'rgba(255, 255, 255, 1)' - white.\r\n * @param {number} [options.rect.borderThickness=0 is invisible border] border thickness.\r\n * @param {number} [options.rect.borderRadius=0 is no radius] border corners radius.\r\n * @param {THREE.Vector2|object} [options.center] If <b>center.x</b> and <b>center.y</b> is defined, then it the text's anchor point.\r\n * <pre>\r\n * See {@link https://threejs.org/docs/index.html#api/en/objects/Sprite.center|Sprite.center}\r\n * \tA value of (0.5, 0.5) corresponds to the midpoint of the text.\r\n * \tA value of (0, 0) corresponds to the left lower corner of the text.\r\n * \tA value of (0, 1) corresponds to the left upper corner of the text.\r\n * \t\r\n * Otherwise, the center is calculated so that the text is always inside the canvas.\r\n * Please define <b>center.camera</b> and <b>center.canvas</b> for it. See below for details.\r\n * \r\n * If <b>options.center</b> is not defined, center is left upper corner: <b>new THREE.Vector2( 0, 1 )</b>\r\n * </pre>\r\n * @param {THREE.PerspectiveCamera} [center.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {HTMLElement} [center.canvas] <b>canvas</b> element.\r\n * @see Thanks to {@link https://github.com/vasturiano/three-spritetext|three-spritetext}\r\n */\r\nexport function SpriteText( text, position,\toptions = {} ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\r\n\tposition = position || new THREE.Vector3( 0, 0, 0 );\r\n\r\n\tconst sprite = new THREE.Sprite( new THREE.SpriteMaterial( {\r\n\r\n\t\tmap: new THREE.Texture(),\r\n\t\tsizeAttenuation: options.sizeAttenuation !== undefined ? options.sizeAttenuation :\r\n\t\t\tfalse,//The size of the sprite is not attenuated by the camera depth. (Perspective camera only.)\r\n\r\n\t} ) );\r\n\tconst canvas = document.createElement( 'canvas' );\r\n\tsprite.material.map.minFilter = THREE.LinearFilter;\r\n\tconst fontSize = 90;\r\n\tconst context = canvas.getContext( '2d' );\r\n\r\n\tif ( options.name ) sprite.name = options.name;\r\n\r\n\tsprite.userData.update = function ( /*optionsUpdate*/ ) {\r\n\r\n\t\tconst optionsUpdate = {};\r\n\t\tif ( sprite.parent )\r\n\t\t\tupdateOptions( sprite.parent, optionsUpdate );\r\n\t\telse if ( options.group )\r\n\t\t\tupdateOptions( options.group, optionsUpdate );\r\n\t\tvar textHeight = options.textHeight || optionsUpdate.textHeight || 0.04;\r\n\t\tconst fov = options.fov || optionsUpdate.fov,\r\n\t\t\tsizeAttenuation = options.sizeAttenuation || optionsUpdate.sizeAttenuation || false,\r\n\t\t\trotation = options.rotation || optionsUpdate.rotation || 0,\r\n\t\t\tfontFace = options.fontFace || optionsUpdate.fontFace || 'Arial',\r\n\t\t\tbold = options.bold || optionsUpdate.bold || false,\r\n\t\t\titalic = options.italic || optionsUpdate.italic || false,\r\n\t\t\tfontProperties = options.fontProperties || optionsUpdate.fontProperties || '',\r\n\t\t\trect = options.rect || optionsUpdate.rect || {},\r\n\t\t\tcolor = 'rgba(255, 255, 255, 1)',\r\n\t\t\tfontColor = options.fontColor || optionsUpdate.fontColor || color,\r\n\t\t\tcenter = SpriteText.getCenter( options.center || optionsUpdate.center, position );\r\n\t\t\t\r\n\t\tif ( fov !== undefined )\r\n\t\t\ttextHeight = fov * textHeight / 50;\r\n\r\n\t\trect.displayRect = rect.displayRect || false;\r\n\t\tconst borderThickness = rect.borderThickness ? rect.borderThickness : 5,\r\n\t\t\tfont = `${fontProperties}${bold ? 'bold ' : ''}${italic ? 'italic ' : ''}${fontSize}px ${fontFace}`;\r\n\r\n\t\tcontext.font = font;\r\n\r\n\t\tvar width = 0, linesCount = 1,\r\n\t\t\tlines;\r\n\t\tif ( typeof text === 'string' ) {\r\n\r\n\t\t\tlinesCount = 0;\r\n\t\t\tlines = text.split( /\\r\\n|\\r|\\n/ );\r\n\t\t\tlines.forEach( function ( line ) {\r\n\r\n\t\t\t\tvar lineWidth = context.measureText( line ).width;\r\n\t\t\t\tif ( width < lineWidth )\r\n\t\t\t\t\twidth = lineWidth;\r\n\t\t\t\tlinesCount += 1;\r\n\r\n\t\t\t} );\r\n\r\n\t\t} else width = context.measureText( text ).width;\r\n\r\n\t\twidth += borderThickness * 2;\r\n\r\n\t\tconst textWidth = width;\r\n\t\tcanvas.width = textWidth;\r\n\t\tcanvas.height = fontSize * linesCount + borderThickness * 2;\r\n\r\n\t\tcontext.font = font;\r\n\r\n\t\t//Rect\r\n\t\t//Thanks to http://stemkoski.github.io/Three.js/Sprite-Text-Labels.html\r\n\t\tif ( rect.displayRect ) {\r\n\r\n\t\t\t// background color\r\n\t\t\tcontext.fillStyle = rect.backgroundColor ? rect.backgroundColor : 'rgba(0, 0, 0, 1)';\r\n\r\n\t\t\t// border color\r\n\t\t\tcontext.strokeStyle = rect.borderColor ? rect.borderColor : fontColor;\r\n\r\n\t\t\tcontext.lineWidth = borderThickness;\r\n\r\n\t\t\t// function for drawing rounded rectangles\r\n\t\t\tfunction roundRect( ctx, x, y, w, h, r ) {\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo( x + r, y );\r\n\t\t\t\tctx.lineTo( x + w - r, y );\r\n\t\t\t\tctx.quadraticCurveTo( x + w, y, x + w, y + r );\r\n\t\t\t\tctx.lineTo( x + w, y + h - r );\r\n\t\t\t\tctx.quadraticCurveTo( x + w, y + h, x + w - r, y + h );\r\n\t\t\t\tctx.lineTo( x + r, y + h );\r\n\t\t\t\tctx.quadraticCurveTo( x, y + h, x, y + h - r );\r\n\t\t\t\tctx.lineTo( x, y + r );\r\n\t\t\t\tctx.quadraticCurveTo( x, y, x + r, y );\r\n\t\t\t\tctx.closePath();\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.stroke();\r\n\r\n\t\t\t}\r\n\t\t\troundRect( context,\r\n\t\t\t\tborderThickness / 2,\r\n\t\t\t\tborderThickness / 2,\r\n\t\t\t\tcanvas.width - borderThickness,\r\n\t\t\t\tcanvas.height - borderThickness,\r\n\t\t\t\trect.borderRadius === undefined ? 0 : rect.borderRadius\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tcontext.fillStyle = fontColor;\r\n\t\tcontext.textBaseline = 'bottom';\r\n\t\tif ( linesCount > 1 ) {\r\n\t\t\tfor ( var i = 0; i < lines.length; i++ ) {\r\n\r\n\t\t\t\tconst line = lines[i];\r\n\t\t\t\tcontext.fillText( line, borderThickness, canvas.height - ( ( lines.length - i - 1 ) * fontSize ) - borderThickness );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else context.fillText( text, borderThickness, canvas.height - borderThickness );\r\n\r\n\t\t// Inject canvas into sprite\r\n\t\tsprite.material.map.image = canvas;\r\n\t\tsprite.material.map.needsUpdate = true;\r\n\r\n\t\tconst th = textHeight * linesCount;// * angleDistance;\r\n\t\tsprite.scale.set( th * canvas.width / canvas.height, th );\r\n\t\tsprite.position.copy( position );\r\n\t\tsprite.center = center;\r\n\r\n\t\t//size attenuation. Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.) Default is false.\r\n\t\t//See https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation\r\n\t\tsprite.material.sizeAttenuation = sizeAttenuation;\r\n\r\n\t\tsprite.material.rotation = rotation;\r\n\t\tsprite.material.needsUpdate = true;\r\n\r\n\t};\r\n\tsprite.userData.update();\r\n\r\n\tsprite.userData.updateText = function ( _text ) {\r\n\r\n\t\ttext = _text;\r\n\t\tconst options = {}\r\n\t\tupdateOptions( sprite.parent, options );\r\n\t\tsprite.userData.update( options );\r\n\r\n\t}\r\n\tif ( options.group ) options.group.add( sprite );\r\n\telse if ( three.group ) three.group.add( sprite );\r\n\telse if ( three.scene ) three.scene.add( sprite );\r\n\r\n\tsprite.userData.optionsSpriteText = options;\r\n\r\n\treturn sprite;\r\n\r\n};\r\n\r\n/**\r\n * @namespace\r\n * @description Returns {@link https://threejs.org/docs/index.html#api/en/objects/Sprite.center|center}\r\n * @param {THREE.Vector2|object} center If <b>center.x</b> and <b>center.y</b> is defined, then it the text's anchor point.\r\n * <pre>\r\n * Otherwise, the center is calculated so that the text is always inside the canvas.\r\n * Please define <b>center.camera</b> and <b>center.canvas</b> for it. See below for details.\r\n * </pre>\r\n * @param {THREE.PerspectiveCamera} [center.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n * @param {HTMLElement} [center.canvas] <b>canvas</b> element.\r\n * @param {THREE.Vector3} [position] Position of the text. Uses only if <b>center.camera</b> and <b>center.canvas</b> is defined\r\n * @returns center. If <b>center</b> is not defined, returns the left upper corner: <b>new THREE.Vector2( 0, 1 )</b>;\r\n */\r\nSpriteText.getCenter = function ( center = {}, position ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tconst canvas = center.canvas ? center.canvas : undefined;\r\n\t/**\r\n\t * Converting World coordinates to Screen coordinates\r\n\t * https://stackoverflow.com/questions/11586527/converting-world-coordinates-to-screen-coordinates-in-three-js-using-projection\r\n\t */\r\n\tfunction worldToScreen() {\r\n\r\n\t\tconst width = canvas.width, height = canvas.height,\r\n\t\t\twidthHalf = width / 2, heightHalf = height / 2;\r\n//\t\t\tpos = position.clone();\r\n\t\tconst pos = new THREE.Vector3().copy( position );\r\n\t\tpos.project( center.camera );\r\n\t\tpos.x = ( pos.x * widthHalf ) + widthHalf;\r\n\t\tpos.y = - ( pos.y * heightHalf ) + heightHalf;\r\n\t\treturn pos;\r\n\r\n\t}\r\n\tconst screenPos = center.canvas ? worldToScreen() : undefined;\r\n\treturn center instanceof THREE.Vector2 ||\r\n\t\t( ( typeof center === \"object\" ) && ( center.x !== undefined ) && ( center.y !== undefined )//При копироваении и при чтении из cockie THREE.Vector2 превращается в Object{x: x, y: y}\r\n\t\t) ? center : screenPos ?\r\n\t\t\tnew THREE.Vector2( screenPos.x < ( canvas.width / 2 ) ? 0 : 1, screenPos.y < ( canvas.height / 2 ) ? 1 : 0 ) :\r\n\t\t\tnew THREE.Vector2( 0, 1 );//Default is left upper corner\r\n\r\n}\r\n\r\nfunction updateOptions( group, options ) {\r\n\r\n\tif ( group.userData.optionsSpriteText )\r\n\t\tObject.keys( group.userData.optionsSpriteText ).forEach( function ( key ) {\r\n\r\n\t\t\tif ( options[key] === undefined )//Child options have more priority before parent options\r\n\t\t\t\toptions[key] = group.userData.optionsSpriteText[key];\r\n\r\n\t\t} );\r\n\twhile ( group.parent ) {\r\n\r\n\t\tgroup = group.parent;\r\n\t\tupdateOptions( group, options );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @namespace\r\n * @description Call <b>SpriteText.updateSpriteTextGroup</b> if you want to update of the <b>options</b> of all <a href=\"module-SpriteText.html\" target=\"_blank\">SpriteText</a>, added in to <b>group</b> and all <b>child groups</b>.\r\n * @param {THREE.Group|THREE.Scene} group [group]{@link https://threejs.org/docs/index.html?q=gr#api/en/objects/Group} or [scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the <b>SpriteText</b> and of all <b>child groups</b> of the <b>SpriteText</b> for which these settings will have an effect.\r\n * @example\r\n<script>\r\n\toptionsSpriteText = {\r\n\r\n\t\ttextHeight: 0.1,\r\n\t\tsizeAttenuation: false,\r\n\r\n\t}\r\n\tconst fSpriteTextAll = SpriteTextGui( scene, options, {\r\n\r\n\t\tsettings: { zoomMultiplier: 1.5, },\r\n\t\toptions: optionsSpriteText\r\n\r\n\t} );\r\n\r\n\t//Change of the text height\r\n\toptionsSpriteText.textHeight = 0.2;\r\n\r\n\t//update of the options of all SpriteText, added in to group and all child groups\r\n\tSpriteText.updateSpriteTextGroup( group );\r\n\r\n\t//To do something...\r\n\r\n\t//Restore options.textHeight to 0.1\r\n\tfSpriteTextAll.userData.restore();\r\n</script>\r\n*/\r\nSpriteText.updateSpriteTextGroup = function( group ) {\r\n\r\n\tconst THREE = three.THREE;\r\n\tgroup.children.forEach( function ( spriteItem ) {\r\n\r\n\t\tif ( spriteItem instanceof THREE.Sprite ) {\r\n\r\n\t\t\tif ( spriteItem.userData.update !== undefined )\r\n\t\t\t\tspriteItem.userData.update();\r\n\r\n\t\t} //else if ( spriteItem instanceof THREE.Group )\r\n\t\t\tSpriteText.updateSpriteTextGroup( spriteItem );\r\n\r\n\t} );\r\n\r\n}\r\n","/**\r\n * @module StereoEffect\r\n * @description Uses dual PerspectiveCameras for Parallax Barrier effects.\r\n * @see About {@link https://en.wikipedia.org/wiki/Parallax_barrier|Parallax barrier}.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n * @author {@link http://alteredqualia.com/|alteredq}\r\n * @author {@link http://mrdoob.com/|mrdoob}\r\n * @author {@link http://aleksandarrodic.com/|arodic}\r\n * @author {@link http://fonserbc.github.io/|fonserbc}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport three from '../three.js'\r\n\r\nimport PositionController from '../PositionController.js';\r\n//import PositionController from 'https://raw.githack.com/anhr/commonNodeJS/master/PositionController.js';\r\n\r\nimport CreateFullScreenSettings from '../createFullScreenSettings.js';\r\nimport Options from '../Options.js'\r\n\r\nclass StereoEffect {\r\n\r\n\t/**\r\n\t * @class\r\n\t * Uses dual PerspectiveCameras for [Parallax Barrier]{@link https://en.wikipedia.org/wiki/Parallax_barrier} effects.\r\n\t * @param {THREE.WebGLRenderer} renderer {@link https://threejs.org/docs/#api/en/renderers/WebGLRenderer|WebGL renderer}\r\n\t * @param {Options} [options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n\t * <pre>\r\n\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|Syntax} paragraph of RFC 4646 for details.\r\n\t * </pre>\r\n\t * @param {Object} [options.lang] Object with localized language values.\r\n\t * @param {boolean} [options.dat.cookie] false - do not save to cookie the StereoEffects  settings\r\n\t * @param {string} [options.dat.cookieName] Name of the cookie is \"StereoEffect\" + options.dat.cookieName.\r\n\t * @param {boolean|Object} [options.stereoEffect] false - do not create a <b>StereoEffect</b> instance.\r\n\t * <p>Or:</p>\r\n\t * @param {number} [options.stereoEffect.spatialMultiplex=spatialMultiplexsIndexs.Mono] spatial multiplex\r\n\t * <pre>\r\n\t * See {@link https://en.wikipedia.org/wiki/DVB_3D-TV|DVB 3D-TV} for details\r\n\t * \tAvailable values\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.Mono - no stereo effacts\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.SbS - 'Side by side' format just put the left and right images one next to the other.\r\n\t * \t\t\tSee https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side for dretails\r\n\t *\r\n\t * \t\tspatialMultiplexsIndexs.TaB - 'Top and bottom' format put left and right images one above the other.\r\n\t * \t\t\tSee //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom for details\r\n\t *\r\n\t * \tExample - options.stereoEffect.spatialMultiplex: StereoEffect.spatialMultiplexsIndexs.Mono\r\n\t * </pre>\r\n\t * @param {THREE.PerspectiveCamera} [options.stereoEffect.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}. Use the <b>camera</b> key if you want control cameras focus.\r\n\t * @param {Float} [options.stereoEffect.far=10] Camera frustum far plane. The <b>far</b> key uses for correct calculation default values of Eye separation.\r\n\t * See <b>far</b> parameter of the [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.far}\r\n\t * @param {Float} [options.stereoEffect.eyeSep=( new THREE.StereoCamera().eyeSep / 10 ) * options.stereoEffect.far] Eye separation.\r\n\t * See [StereoCamera.eyeSep]{@link https://threejs.org/docs/index.html?q=StereoCamera#api/en/cameras/StereoCamera.eyeSep}.\r\n\t * @param {Float} [options.stereoEffect.stereoAspect=1] [THREE.StereoCamera.aspect]{@link https://threejs.org/docs/index.html?q=StereoCamera#api/en/cameras/StereoCamera.aspect}. Camera frustum aspect ratio.\r\n\t * @param {boolean} [options.stereoEffect.rememberSize] true - remember default size of the canvas. Resize of the canvas to full screen for stereo mode and restore to default size if no stereo effacts.\r\n\t * @param {HTMLElement} [options.stereoEffect.elParent] parent of the canvas.\r\n\t * Use only if you use {@link https://threejs.org/docs/index.html#api/en/core/Raycaster|THREE.Raycaster} (working out what objects in the 3d space the mouse is over)\r\n\t * and your canvas is not full screen.\r\n\t */\r\n\tconstructor( renderer, options = new Options() ) {\r\n\r\n\t\tif ( !renderer ) {\r\n\r\n\t\t\tconsole.error( 'StereoEffect: renderer = ' + renderer );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\toptions = new Options( options );\r\n\r\n\t\t}\r\n\t\tif ( options.stereoEffect === false ) return;\r\n\r\n\t\tif( options.dat.gui ) options.dat.mouseenter = false;//true - мышка находится над gui или canvasMenu\r\n\t\t\t\t//В этом случае не надо обрабатывать событие elContainer 'pointerdown'\r\n\t\t\t\t//по которому выбирается точка на canvas.\r\n\t\t\t\t//В противном случае если пользователь щелкнет на gui, то он может случайно выбрать точку на canvas.\r\n\t\t\t\t//Тогда открывается папка Meshes и все органы управления сдвигаются вниз. Это неудобно.\r\n\t\t\t\t//И вообще нехорошо когда выбирается точка когда пользователь не хочет это делать.\r\n\r\n\t\tconst THREE = three.THREE;\r\n\t\tassign();\r\n\r\n\t\tif ( !options.stereoEffect ) options.stereoEffect = {};\r\n\r\n\t\tconst settings = options.stereoEffect;\r\n\t\t/**\r\n\t\t * See <b>options.stereoEffect</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t * */\r\n\t\tthis.settings = settings;\r\n\t\t/**\r\n\t\t * See <b>options</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t * */\r\n\t\tthis.options = options;\r\n\r\n\t\toptions.stereoEffect = this;\r\n\r\n\t\t//Убрал spatialMultiplex: settings.spatialMultiplex !== undefined ? settings.spatialMultiplex : spatialMultiplexsIndexs.Mono,//SbS,\r\n\t\t//из const optionsDefault\r\n\t\t//Потому что будет ошибка \r\n\t\t//THREE.StereoEffect.render: Invalid \"Spatial  multiplex\" parameter: NaN\r\n\t\t//если в приложении не используется StereoEffect.gui\r\n\t\t//и не определен settings.spatialMultiplex\r\n\t\tif ( settings.spatialMultiplex === undefined ) settings.spatialMultiplex = spatialMultiplexsIndexs.Mono;//SbS\r\n\r\n\t\tsettings.stereo = new THREE.StereoCamera();\r\n\t\tsettings.stereo.aspect = settings.stereoAspect || 1;//0.5;\r\n\t\tif ( settings.far === undefined )\r\n\t\t\tsettings.far = new THREE.PerspectiveCamera().focus;\r\n\t\tsettings.focus = settings.camera === undefined ? new THREE.PerspectiveCamera().focus :\r\n\t\t\tnew THREE.Vector3().distanceTo( settings.camera.position );\r\n\t\tsettings.zeroParallax = 0;\r\n\t\tsettings.eyeSep = settings.eyeSep || ( new THREE.StereoCamera().eyeSep / 10 ) * settings.far;\r\n\t\tif ( settings.camera !== undefined )\r\n\t\t\tsettings.camera.focus = settings.focus;\r\n\r\n\t\t/**\r\n\t\t * Sets eye separation.\r\n\t\t * @param {any} eyeSep See <b>options.stereoEffect.eyeSep</b> parameter of the <b>StereoEffect</b> class above.\r\n\t\t */\r\n\t\tthis.setEyeSeparation = function ( eyeSep ) {\r\n\r\n\t\t\tsettings.stereo.eyeSep = eyeSep;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setEyeSeparation( settings.eyeSep );\r\n\r\n\t\t/**\r\n\t\t * Convert mouse position to renderer coordinates.\r\n\t\t * @returns <pre>\r\n\t\t * {\r\n\t\t *\r\n\t\t *\tgetMousePosition:function\r\n\t\t *\r\n\t\t * }\r\n\t\t * </pre>\r\n\t\t */\r\n\t\tthis.getRendererSize = function () {\r\n\r\n\t\t\treturn Options.raycaster.EventListeners.getRendererSize( renderer, settings.elParent );\r\n\r\n\t\t};\r\n\t\tvar fullScreenSettings;\r\n\t\tvar spatialMultiplexCur;\r\n\t\t/**\r\n\t\t * Render a scene or another type of object using a camera.\r\n\t\t * @see [WebGLRenderer.render]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer.render}\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera}.\r\n\t\t */\r\n\t\tthis.render = function ( scene, camera ) {\r\n\r\n\t\t\tconst spatialMultiplex = parseInt( settings.spatialMultiplex );\r\n\r\n\t\t\tif ( settings.rememberSize && !fullScreenSettings ) {\r\n\r\n\t\t\t\tif ( _canvasMenu && _canvasMenu.getFullScreenSettings )\r\n\t\t\t\t\tfullScreenSettings = _canvasMenu.getFullScreenSettings( this );\r\n\t\t\t\telse fullScreenSettings = new CreateFullScreenSettings( THREE, renderer, camera,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcanvasMenu: _canvasMenu,\r\n\t\t\t\t\t\tstereoEffect: this,\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscene.updateMatrixWorld();\r\n\r\n\t\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\r\n\r\n\t\t\tconst size = new THREE.Vector2();\r\n\t\t\trenderer.getSize( size );\r\n\r\n\t\t\tif ( renderer.autoClear ) renderer.clear();\r\n\t\t\trenderer.setScissorTest( true );\r\n\r\n\t\t\tvar xL, yL, widthL, heightL,\r\n\t\t\t\txR, yR, widthR, heightR;\r\n\t\t\tconst parallax = settings.zeroParallax;\r\n\t\t\tfunction setMultiplex( stereoEffect ) {\r\n\r\n\t\t\t\tif ( !fullScreenSettings || ( spatialMultiplexCur === spatialMultiplex ) )\r\n\t\t\t\t\treturn false;\r\n\t\t\t\tspatialMultiplexCur = spatialMultiplex;\r\n\t\t\t\tif ( stereoEffect.setControllerSpatialMultiplex ) stereoEffect.setControllerSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\telse if ( stereoEffect.setSpatialMultiplex ) stereoEffect.setSpatialMultiplex( spatialMultiplex );\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\t\t\tfunction setFullScreen( fullScreen, stereoEffect ) {\r\n\r\n\t\t\t\tif ( setMultiplex( stereoEffect ) )\r\n\t\t\t\t\tfullScreenSettings.setFullScreen( fullScreen );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tswitch ( spatialMultiplex ) {\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.Mono://Mono\r\n\r\n\t\t\t\t\trenderer.setScissor( 0, 0, size.width, size.height );\r\n\t\t\t\t\trenderer.setViewport( 0, 0, size.width, size.height );\r\n\t\t\t\t\trenderer.render( scene, camera );\r\n\t\t\t\t\trenderer.setScissorTest( false );\r\n\r\n\t\t\t\t\t//если оствить setFullScreen то canvas не перейдет в full screen\r\n\t\t\t\t\t//если в программе по умолчанию был задан full screen и используется canvasMenu\r\n\t\t\t\t\t//Для провероки\r\n\t\t\t\t\t//в файле \"D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\myThree\\Examples\\html\\index.html\"\r\n\t\t\t\t\t//\tдля new MyThree(...)\r\n\t\t\t\t\t//\t\tустановить canvasMenu: true,\r\n\t\t\t\t\t//\t\tубрать canvas: { fullScreen: false, }. Тоесть по умолчанию canvas перейдет в full screen\r\n\t\t\t\t\t//открыть http://localhost/anhr/commonNodeJS/master/myThree/Examples/html/\r\n\r\n\t\t\t\t\t//setFullScreen( true, this );\r\n\r\n\t\t\t\t\t//если оставить setFullScreen то canvas не перейдет в full screen\r\n\t\t\t\t\t//если убрать setFullScreen то canvas перейдет в full screen\r\n\t\t\t\t\t//но тогда будет неправильно выбираться пункт меню stereo Effects в canvasMenu в случае, если \r\n\t\t\t\t\t//Выбрать пункт \"слева направо\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//\tвключится стерео режим.\r\n\t\t\t\t\t//\tcanvas перейдет в full screen.\r\n\t\t\t\t\t//Выбрать пункт \"Восстановить размеры экрана\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//\tcanvas выйдет из full screen.\r\n\t\t\t\t\t//\tстерео режим отключится\r\n\t\t\t\t\t//\tНО! ОСТАНЕТСЯ ВЫБРАННЫМ пункт \"слева направо\" меню stereo Effects в canvasMenu.\r\n\t\t\t\t\t//Для решения проблемы вставил строку ниже\r\n\r\n\t\t\t\t\tif ( options.canvasMenu ) setMultiplex( this );\r\n\t\t\t\t\telse setFullScreen( true, this );\r\n\r\n\t\t\t\t\t//Теперь в режиме full screen при выборе пункта \"Моно\" меню stereo Effects в canvasMenu\r\n\t\t\t\t\t//canvas не выходит из full screen. Ну и фиг с ним.\r\n\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.SbS://'Side by side'\r\n\r\n\t\t\t\t\tconst _width = size.width / 2;\r\n\r\n\t\t\t\t\txL = 0 + parallax; yL = 0; widthL = _width; heightL = size.height;\r\n\t\t\t\t\txR = _width - parallax; yR = 0; widthR = _width; heightR = size.height;\r\n\r\n\t\t\t\t\tsetFullScreen( false, this );\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase spatialMultiplexsIndexs.TaB://'Top and bottom'\r\n\r\n\t\t\t\t\txL = 0 + parallax; yL = 0; widthL = size.width; heightL = size.height / 2;\r\n\t\t\t\t\txR = 0 - parallax; yR = size.height / 2; widthR = size.width; heightR = size.height / 2;\r\n\r\n\t\t\t\t\tsetFullScreen( false, this );\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'THREE.StereoEffect.render: Invalid \"Spatial  multiplex\" parameter: ' + spatialMultiplex );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tsettings.stereo.update( camera );\r\n\r\n\t\t\trenderer.setScissor( xL, yL, widthL, heightL );\r\n\t\t\trenderer.setViewport( xL, yL, widthL, heightL );\r\n\t\t\trenderer.render( scene, settings.stereo.cameraL );\r\n\r\n\t\t\trenderer.setScissor( xR, yR, widthR, heightR );\r\n\t\t\trenderer.setViewport( xR, yR, widthR, heightR );\r\n\t\t\trenderer.render( scene, settings.stereo.cameraR );\r\n\r\n\t\t\trenderer.setScissorTest( false );\r\n\r\n\t\t};\r\n\r\n\t\t//Localization\r\n\t\tfunction getLang( params ) {\r\n\r\n\t\t\tparams = params || {};\r\n\t\t\tconst _lang = {\r\n\r\n\t\t\t\tstereoEffects: 'Stereo effects',\r\n\r\n\t\t\t\tspatialMultiplexName: 'Spatial  multiplex',\r\n\t\t\t\tspatialMultiplexTitle: 'Choose a way to do spatial multiplex.',\r\n\r\n\t\t\t\tspatialMultiplexs: {\r\n\t\t\t\t\t'Mono': spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t'Side by side': spatialMultiplexsIndexs.SbS, //https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side\r\n\t\t\t\t\t'Top and bottom': spatialMultiplexsIndexs.TaB, //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom\r\n\t\t\t\t},\r\n\r\n\t\t\t\teyeSeparationName: 'Eye separation',\r\n\t\t\t\teyeSeparationTitle: 'The distance between left and right cameras.',\r\n\r\n\t\t\t\tfocus: 'Focus',\r\n\t\t\t\tfocusTitle: 'Object distance.',\r\n\r\n\t\t\t\tzeroParallaxName: 'Zero parallax',\r\n\t\t\t\tzeroParallaxTitle: 'Distance to objects with zero parallax.',\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Restore default stereo effects settings.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = params.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t: params.getLanguageCode();\r\n\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t_lang.stereoEffects = 'Стерео эффекты';//'Stereo effects'\r\n\r\n\t\t\t\t\t_lang.spatialMultiplexName = 'Мультиплекс';//'Spatial  multiplex'\r\n\t\t\t\t\t_lang.spatialMultiplexTitle = 'Выберите способ создания пространственного мультиплексирования.';\r\n\r\n\t\t\t\t\t_lang.spatialMultiplexs = {\r\n\t\t\t\t\t\t'Моно': spatialMultiplexsIndexs.Mono, //Mono\r\n\t\t\t\t\t\t'Слева направо': spatialMultiplexsIndexs.SbS, //https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side\r\n\t\t\t\t\t\t'Сверху вниз': spatialMultiplexsIndexs.TaB, //https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t_lang.eyeSeparationName = 'Развод камер';\r\n\t\t\t\t\t_lang.eyeSeparationTitle = 'Расстояние между левой и правой камерами.';\r\n\r\n\t\t\t\t\t_lang.focus = 'Фокус';\r\n\t\t\t\t\t_lang.focusTitle = 'Расстояние до объекта.';\r\n\r\n\t\t\t\t\t_lang.zeroParallaxName = 'Параллакс 0';\r\n\t\t\t\t\t_lang.zeroParallaxTitle = 'Расстояние до объектов с нулевым параллаксом.';\r\n\r\n\t\t\t\t\t_lang.defaultButton = 'Восстановить';\r\n\t\t\t\t\t_lang.defaultTitle = 'Восстановить настройки стерео эффектов по умолчанию.';\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault://Custom language\r\n\t\t\t\t\tif ( ( params.lang === undefined ) || ( params.lang._languageCode != _languageCode ) )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tObject.keys( params.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tif ( _lang[key] === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t_lang[key] = params.lang[key];\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn _lang;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds StereoEffects folder into dat.GUI.\r\n\t\t * @see {@link https://github.com/anhr/dat.gui|dat.gui}.\r\n\t\t * @param {Object} [guiParams={}] the following params are available.\r\n\t\t * @param {GUI} [guiParams.dat] [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t * @param {GUI} [guiParams.folder] <b>StereoEffects</b> folder. See {@link https://github.com/anhr/dat.gui|dat.gui} for details\r\n\t\t * @param {Function} [guiParams.onChangeMode] The event is fired if user has changed the stereo mode.\r\n\t\t * <pre>\r\n\t\t * parameter is new stereo mode.\r\n\t\t * See the <b>settings.spatialMultiplex</b> parameter of the <b>StereoEffect</b> class for details.\r\n\t\t * <pre>\r\n\t\t * @param {number} [guiParams.scale=1] scale of allowed values.\r\n\t\t */\r\n\t\tthis.gui = function ( guiParams = {} ) {\r\n\r\n\t\t\tconst gui = guiParams.folder || options.dat.gui;\r\n\t\t\tif ( !gui || options.dat.stereoEffectsGui === false )\r\n\t\t\t\treturn;\r\n\t\t\tconst dat = guiParams.dat || three.dat;//options.dat.dat;\r\n\t\t\tif ( guiParams === undefined ) guiParams = {};\r\n\t\t\tguiParams.scale = guiParams.scale || 1;\r\n\t\t\tconst stereoEffect = options.dat.getCookieName( 'StereoEffect' ),\r\n\t\t\t\t_lang = getLang( { getLanguageCode: options.getLanguageCode, lang: options.lang } );\r\n\t\t\t\r\n\t\t\tconst optionsDefault = {\r\n\r\n\t\t\t\tspatialMultiplex: settings.spatialMultiplex,\r\n\t\t\t\teyeSep: ( new THREE.StereoCamera().eyeSep / 10 ) * settings.far,\r\n\t\t\t\tfocus: settings.focus,\r\n\t\t\t\tzeroParallax: 0,\r\n\r\n\t\t\t}\r\n\t\t\tObject.freeze( optionsDefault );\r\n\t\t\toptions.dat.cookie.getObject( stereoEffect, settings, optionsDefault );\r\n\t\t\tsettings.spatialMultiplex = parseInt( settings.spatialMultiplex );\r\n\r\n\t\t\tif ( this.setSpatialMultiplex ) this.setSpatialMultiplex( settings.spatialMultiplex );\r\n\r\n\t\t\t//\r\n\r\n\t\t\tfunction displayControllers( value ) {\r\n\r\n\t\t\t\tconst display = value == spatialMultiplexsIndexs.Mono ? 'none' : 'block';\r\n\t\t\t\t_fEyeSeparation.domElement.style.display = display;\r\n\t\t\t\tif ( _controllerCameraFocus !== undefined )\r\n\t\t\t\t\t_controllerCameraFocus.__li.style.display = display;\r\n\t\t\t\t_controllerDefaultF.__li.style.display = display;\r\n\t\t\t\t_controllerZeroParallax.__li.style.display = display;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst _fStereoEffects = gui.addFolder( _lang.stereoEffects );//Stero effects folder\r\n\r\n\t\t\t//Spatial multiplex\r\n\t\t\tconst _controllerSpatialMultiplex = _fStereoEffects.add( settings, 'spatialMultiplex',\r\n\t\t\t\t_lang.spatialMultiplexs ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tvalue = parseInt( value );\r\n\t\t\t\t\tdisplayControllers( value );\r\n\t\t\t\t\tsetObject( stereoEffect );\r\n\t\t\t\t\tif ( guiParams.onChangeMode )\r\n\t\t\t\t\t\tguiParams.onChangeMode( value );\r\n\t\t\t\t\tif ( menuItemStereoEffect )\r\n\t\t\t\t\t\tmenuItemStereoEffect.select( value )\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerSpatialMultiplex, _lang.spatialMultiplexName, _lang.spatialMultiplexTitle );\r\n\t\t\tthis.setControllerSpatialMultiplex = function ( index ) {\r\n\r\n\t\t\t\tsaveToCookie = false;\r\n\t\t\t\t_controllerSpatialMultiplex.setValue( index );\r\n\t\t\t\tsaveToCookie = true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//eyeSeparation\r\n\t\t\t//http://paulbourke.net/papers/vsmm2007/stereoscopy_workshop.pdf\r\n\t\t\tconst _fEyeSeparation = _fStereoEffects.addFolder( _lang.eyeSeparationName );//Eye Separation\r\n\t\t\tdat.folderNameAndTitle( _fEyeSeparation, _lang.eyeSeparationName, _lang.eyeSeparationTitle );\r\n\t\t\t_fEyeSeparation.add( new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tsettings.eyeSep += shift;\r\n\t\t\t\t_controllerEyeSep.setValue( settings.eyeSep );\r\n\r\n\t\t\t}, { settings: { offset: 0.01 }, min: 0.0001, max: 0.01, step: 0.0001 }\r\n\t\t\t) );\r\n\t\t\tconst _controllerEyeSep = dat.controllerZeroStep( _fEyeSeparation, settings.stereo, 'eyeSep', function ( value ) {\r\n\r\n\t\t\t\tsettings.eyeSep = value;\r\n\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerEyeSep, _lang.eyeSeparationName, _lang.eyeSeparationTitle );\r\n\r\n\t\t\tif ( settings.camera !== undefined ) settings.camera.focus = settings.focus;\r\n\t\t\t\r\n\t\t\tvar _controllerCameraFocus;\r\n\t\t\tif ( settings.camera ) {\r\n\r\n\t\t\t\t_controllerCameraFocus = _fStereoEffects.add( settings.camera,\r\n\t\t\t\t\t'focus', optionsDefault.focus / 10, optionsDefault.focus * 2, optionsDefault.focus / 1000 )\r\n\t\t\t\t\t.onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\tsettings.focus = value;\r\n\t\t\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( _controllerCameraFocus, _lang.focus, _lang.focusTitle );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Zero parallax\r\n\t\t\t//http://paulbourke.net/papers/vsmm2007/stereoscopy_workshop.pdf\r\n\t\t\tconst _minMax = ( 60 - ( 400 / 9 ) ) * guiParams.scale + 400 / 9;\r\n\t\t\tconst _controllerZeroParallax = _fStereoEffects.add( settings, 'zeroParallax', - _minMax, _minMax )\r\n\t\t\t\t.onChange( function ( value ) {\r\n\r\n\t\t\t\t\tsettings.zeroParallax = value;\r\n\t\t\t\t\tsetObject( stereoEffect );\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( _controllerZeroParallax, _lang.zeroParallaxName, _lang.zeroParallaxTitle );\r\n\r\n\t\t\t//default button\r\n\t\t\tconst _controllerDefaultF = _fStereoEffects.add( {\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tsettings.stereo.eyeSep = optionsDefault.eyeSep;\r\n\t\t\t\t\t_controllerEyeSep.setValue( settings.stereo.eyeSep );\r\n\r\n\t\t\t\t\tif ( settings.camera ) {\r\n\r\n\t\t\t\t\t\tsettings.camera.focus = optionsDefault.focus;\r\n\t\t\t\t\t\t_controllerCameraFocus.setValue( settings.camera.focus );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsettings.zeroParallax = optionsDefault.zeroParallax;\r\n\t\t\t\t\t_controllerZeroParallax.setValue( settings.zeroParallax );\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' );\r\n\t\t\tdat.controllerNameAndTitle( _controllerDefaultF, _lang.defaultButton, _lang.defaultTitle );\r\n\r\n\t\t\tdisplayControllers( settings.spatialMultiplex );\r\n\r\n\t\t\tvar saveToCookie = true;\r\n\t\t\t/**\r\n\t\t\t * sets an object into cookie.\r\n\t\t\t * @param {string} name cookie name.\r\n\t\t\t */\r\n\t\t\tfunction setObject( name ) {\r\n\r\n\t\t\t\tif ( !saveToCookie )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst object = {};\r\n\t\t\t\tObject.keys( optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tobject[key] = settings[key];\r\n\r\n\t\t\t\t} );\r\n\t\t\t\toptions.dat.cookie.setObject( name, object );\r\n\r\n\t\t\t};\r\n\r\n\t\t};\r\n\r\n\t\tvar _canvasMenu, menuItemStereoEffect;\r\n\t\t/**\r\n\t\t * Adds a StereoEffect's menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {CanvasMenu} [canvasMenu] [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {Object} [params] the following params are available.\r\n\t\t * @param {Function} [params.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n\t\t * <pre>\r\n\t\t   * returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|Syntax} paragraph of RFC 4646 for details.\r\n\t\t * </pre>\r\n\t\t */\r\n\t\tthis.createCanvasMenuItem = function ( canvasMenu, params ) {\r\n\r\n\t\t\t_canvasMenu = canvasMenu;\r\n\t\t\tparams = params || {};\r\n\t\t\tconst _lang = getLang( { getLanguageCode: params.getLanguageCode, lang: params.lang } ),\r\n\t\t\t\tspatialMultiplexs = Object.keys( _lang.spatialMultiplexs );\r\n\t\t\tmenuItemStereoEffect = {\r\n\r\n\t\t\t\tname: '⚭',\r\n\t\t\t\ttitle: _lang.stereoEffects,\r\n\t\t\t\tid: 'menuButtonStereoEffects',\r\n\t\t\t\tdrop: 'up',\r\n\t\t\t\titems: [\r\n\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.Mono],//'Mono',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsMono',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.Mono,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.Mono;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.SbS],//'Side by side',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsSbS',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.SbS,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.SbS,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.SbS;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: spatialMultiplexs[spatialMultiplexsIndexs.TaB],//'Top and bottom',\r\n\t\t\t\t\t\tid: 'menuButtonStereoEffectsTaB',\r\n\t\t\t\t\t\tradio: true,\r\n\t\t\t\t\t\tchecked: settings.spatialMultiplex === spatialMultiplexsIndexs.TaB,\r\n\t\t\t\t\t\tspatialMultiplex: spatialMultiplexsIndexs.TaB,\r\n\t\t\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\t\t\tsettings.spatialMultiplex = spatialMultiplexsIndexs.TaB;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t],\r\n\r\n\t\t\t}\r\n\t\t\tmenuItemStereoEffect.select = function ( value ) {\r\n\r\n\t\t\t\tmenuItemStereoEffect.items.forEach( function ( item ) {\r\n\r\n\t\t\t\t\tif ( item.spatialMultiplex === value ) {\r\n\r\n\t\t\t\t\t\tif ( !item.checked )\r\n\t\t\t\t\t\t\titem.elName.onclick( { target: item.elName } );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tthis.setSpatialMultiplex = function ( index ) {\r\n\r\n\t\t\t\tmenuItemStereoEffect.select( index );\r\n\r\n\t\t\t}\r\n\t\t\tcanvasMenu.menu.push( menuItemStereoEffect );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n};\r\n/**\r\n * Enumeration of available stereo modes. Available as <b>StereoEffect.spatialMultiplexsIndexs</b>.\r\n * @see {@link https://en.wikipedia.org/wiki/DVB_3D-TV|DVB 3D-TV} for details\r\n * @readonly\r\n * @enum {number}\r\n */\r\nStereoEffect.spatialMultiplexsIndexs = {\r\n\t/** No stereo effect */\r\n\tMono: 0,\r\n\t/** {@link https://en.wikipedia.org/wiki/DVB_3D-TV#Side_by_side|Side by side} */\r\n\tSbS: 1, //\r\n\t/** {@link https://en.wikipedia.org/wiki/DVB_3D-TV#Top_and_bottom|Top and bottom} */\r\n\tTaB: 2, //\r\n}\r\nObject.freeze( StereoEffect.spatialMultiplexsIndexs );\r\nconst spatialMultiplexsIndexs = StereoEffect.spatialMultiplexsIndexs;\r\n\r\n/* * @namespace\r\n * @description Assigh setStereoEffect to [THREE.Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster}\r\n */\r\nfunction assign() {\r\n\r\n\tconst THREE = three.THREE;\r\n\tif ( new THREE.Raycaster().setStereoEffect )\r\n\t\treturn;\r\n\t\t\r\n\t//Modifying of THREE.Raycaster for StereoEffect\r\n\tObject.assign( THREE.Raycaster.prototype, {\r\n\r\n\t\t/**\r\n\t\t * @namespace\r\n\t\t * @description Sets the <b>StereoEffect</b> settings to the {@link https://threejs.org/docs/#api/en/core/Raycaster|THREE.Raycaster}.\r\n\t\t * Available as <b>THREE.Raycaster.setStereoEffect(...)</b>.\r\n\t\t * @param {Object} [settings={}]\r\n\t\t * @param {Options} [settings.options] See <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a>.\r\n\t\t * @param {THREE.PerspectiveCamera} settings.camera {@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera|PerspectiveCamera}\r\n\t\t * @param {THREE.Scene} [settings.scene] [Scene]{@link https://threejs.org/docs/index.html?q=Scene#api/en/scenes/Scene}\r\n\t\t * @param {StereoEffect} [settings.stereoEffect=no stereo effects] stereoEffect.\r\n\t\t * @param {THREE.WebGLRenderer} [settings.renderer=renderer parameter of THREE.StereoEffect] renderer. The {@link https://threejs.org/docs/#api/en/renderers/WebGLRenderer|WebGL renderer} displays your beautifully crafted scenes using WebGL.\r\n\t\t * @param {boolean} [settings.raycasterEvents=true] true - add raycaster events: mousemove and pointerdown.\r\n\t\t */\r\n\t\tsetStereoEffect: function ( settings = {} ) {\r\n\r\n\t\t\tif ( settings.stereoEffect === false ) return;\r\n\t\t\tsettings.raycasterEvents = settings.raycasterEvents === undefined ? true : settings.raycasterEvents;\r\n\t\t\tconst camera = settings.camera, renderer = settings.renderer;\r\n\r\n\t\t\tif ( settings.raycasterEvents ){\r\n\r\n\t\t\t\tconst mouse = new THREE.Vector2();\r\n\t\t\t\twindow.addEventListener( 'mousemove', function ( event ) {\r\n\r\n\t\t\t\t\t// calculate mouse position in normalized device coordinates\r\n\t\t\t\t\t// (-1 to +1) for both components\r\n\r\n\t\t\t\t\tmouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\r\n\t\t\t\t\tmouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;\r\n\r\n\t\t\t\t\t// update the picking ray with the camera and mouse position\r\n\t\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\r\n\t\t\t\t\traycaster.stereo.onDocumentMouseMove( event );\r\n\r\n\t\t\t\t}, false );\r\n\t\t\t\twindow.addEventListener( 'pointerdown', function ( event ) {\r\n\r\n\t\t\t\t\traycaster.stereo.onDocumentMouseDown( event );\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst stereoEffect = settings.stereoEffect !== undefined ? settings.stereoEffect : typeof effect !== 'undefined' ? effect :\r\n\t\t\t\tnew StereoEffect( renderer, settings.options ),\r\n\t\t\t\traycaster = this,\r\n\t\t\t\tmouseL = new THREE.Vector2(),\r\n\t\t\t\tmouseR = new THREE.Vector2();\r\n\t\t\tvar particles, //The object or array of objects to check for intersection with the ray. See THREE.Raycaster.intersectObject https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject for details.\r\n//\t\t\t\tintersects, //An array of intersections is returned by THREE.Raycaster.intersectObject or THREE.Raycaster.intersectObjects.\r\n\t\t\t\tmouse; //Attention!!! Do not assign new THREE.Vector2() here\r\n\t\t\t//for prevention of invalid detection of intersection with zero point ( THREE.Vector3( 0, 0, 0 ) )\r\n\t\t\t//after opening of the web page and before user has moved mouse.\r\n\r\n\t\t\tfunction getMousePosition() {\r\n\r\n\t\t\t\tstereoEffect.getRendererSize().getMousePosition( mouse, event );\r\n\r\n\t\t\t\tfunction mousePosition( vectorName, b ) {\r\n\r\n\t\t\t\t\tmouseL.copy( mouse );\r\n\t\t\t\t\tmouseR.copy( mouse );\r\n\t\t\t\t\tconst a = 0.5;\r\n\r\n\t\t\t\t\tmouseL[vectorName] += a;\r\n\t\t\t\t\tmouseL[vectorName] *= 2;\r\n\r\n\t\t\t\t\tmouseR[vectorName] -= a;\r\n\t\t\t\t\tmouseR[vectorName] *= 2;\r\n\r\n\t\t\t\t\t//zeroParallax\r\n\t\t\t\t\tconst size = new THREE.Vector2();\r\n\t\t\t\t\trenderer.getSize( size );\r\n\t\t\t\t\tconst zeroParallax = ( stereoEffect.settings.zeroParallax / size.x ) * b;\r\n\t\t\t\t\tmouseL.x -= zeroParallax;\r\n\t\t\t\t\tmouseR.x += zeroParallax;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch ( parseInt( stereoEffect.settings.spatialMultiplex ) ) {\r\n\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.Mono:\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.SbS:\r\n\t\t\t\t\t\tmousePosition( 'x', 4 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase spatialMultiplexsIndexs.TaB:\r\n\t\t\t\t\t\tmousePosition( 'y', 2 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'THREE.Raycaster.setStereoEffect.getMousePosition: Invalid effect.settings.spatialMultiplex = ' + effect.settings.spatialMultiplex );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tfunction intersection( optionsIntersection ) {\r\n\r\n\t\t\t\tif ( mouse === undefined )\r\n\t\t\t\t\treturn;//User has not moved mouse\r\n\r\n\t\t\t\toptionsIntersection = optionsIntersection || settings;\r\n\t\t\t\tfunction isIntersection() {\r\n\r\n//\t\t\t\t\tintersects = Options.raycaster.intersectionsInOut( particles, raycaster, renderer, mouse, settings );\r\n\t\t\t\t\tOptions.raycaster.intersectionsInOut( particles, raycaster, renderer, mouse, settings );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( parseInt( stereoEffect.settings.spatialMultiplex ) !== spatialMultiplexsIndexs.Mono ) {\r\n\r\n\t\t\t\t\tconst mouseCur = mouse;\r\n\t\t\t\t\tmouse = mouseL;\r\n\t\t\t\t\traycaster.setFromCamera( mouseL, camera );\r\n\t\t\t\t\tif ( !isIntersection() ) {\r\n\r\n\t\t\t\t\t\tmouse = mouseR;\r\n\t\t\t\t\t\traycaster.setFromCamera( mouseR, camera );\r\n\t\t\t\t\t\tisIntersection();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmouse = mouseCur;\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\t\t\t\tisIntersection();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * @namespace\r\n\t\t\t * @description\r\n\t\t\t * <pre>\r\n\t\t\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} helper.\r\n\t\t\t * Available as <b>raycaster.stereo</b>.\r\n\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t * </pre>\r\n\t\t\t * */\r\n\t\t\tthis.stereo = {\r\n\r\n\t\t\t\t/**\r\n\t\t\t\t * [mousemove]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/mousemove_event} event.\r\n\t\t\t\t * User is moving of mouse over canvas.\r\n\t\t\t\t * @param {object} event\r\n\t\t\t\t */\r\n\t\t\t\tonDocumentMouseMove: function ( event ) {\r\n\r\n\t\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\t\treturn;//The object or array of objects to check for intersection with the ray is not defined. See THREE.Raycaster.intersectObject https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject for details.\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tif ( mouse === undefined )\r\n\t\t\t\t\t\tmouse = new THREE.Vector2();\r\n\t\t\t\t\tgetMousePosition();\r\n\t\t\t\t\tintersection();\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Available as <b>raycaster.stereo.isAddedToParticles( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check is added to <b>particles</b>.\r\n\t\t\t\t * @returns true if <b>particle</b> is added to <b>particles</b>.\r\n\t\t\t\t */\r\n\t\t\t\tisAddedToParticles: function ( particle ) {\r\n\r\n\t\t\t\t\tif ( !particles )\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\treturn particles.includes( particle );\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Adds new particle into array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.addParticle( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\taddParticle: function ( particle ) {\r\n\r\n\t\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\t\tparticles = [];\r\n\t\t\t\t\tif ( this.isAddedToParticles( particle ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Duplicate particle \"' + particle.name + '\"' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles.push( particle );\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * New array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.addParticles( particles )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {array} newParticles New array of objects to check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\taddParticles: function ( newParticles ) {\r\n\r\n\t\t\t\t\tif ( particles !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( !Array.isArray( particles ) ) {\r\n\r\n\t\t\t\t\t\t\tvar particlesCur = particles;\r\n\t\t\t\t\t\t\tparticles = [];\r\n\t\t\t\t\t\t\tparticles.push( particlesCur );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tparticles.push( newParticles );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles = newParticles;\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * Remove particle from array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.removeParticle( particle )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for removing from array of objects for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\tremoveParticle: function ( particle ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < particles.length; i++ ) {\r\n\r\n\t\t\t\t\t\tif ( Object.is( particle, particles[i] ) ) {\r\n\r\n\t\t\t\t\t\t\tparticles.splice( i, 1 );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * remove array of objects to check for intersection with the ray.\r\n\t\t\t\t * Available as <b>raycaster.stereo.removeParticles()</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t */\r\n\t\t\t\tremoveParticles: function () { particles = undefined; },\r\n\t\t\t\t/**\r\n\t\t\t\t * <pre>\r\n\t\t\t\t * get position of intersected object\r\n\t\t\t\t * Available as <b>raycaster.stereo.getPosition( intersection )</b>.\r\n\t\t\t\t * <b>raycaster</b> is [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t\t * </pre>\r\n\t\t\t\t * @param {object} intersection first item of array of intersections.\r\n\t\t\t\t * @See [Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details\r\n\t\t\t\t */\r\n\t\t\t\tgetPosition: function ( intersection ) {\r\n\r\n\t\t\t\t\tconst attributesPosition = intersection.object.geometry.attributes.position;\r\n\r\n\t\t\t\t\t//Если опредедить как const, то при выполнении npm run build появится ошибка\r\n\t\t\t\t\t//(babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/StereoEffect/StereoEffect.js: \"position\" is read-only\r\n\t\t\t\t\tvar position = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\r\n\t\t\t\t\tif ( intersection.index !== undefined ) {\r\n\r\n\t\t\t\t\t\tposition.fromArray( attributesPosition.array, intersection.index * attributesPosition.itemSize );\r\n\r\n\t\t\t\t\t\tposition.multiply( intersection.object.scale );\r\n\r\n\t\t\t\t\t\tposition.add( intersection.object.position );\r\n\r\n\t\t\t\t\t} else position = intersection.object.position;\r\n\t\t\t\t\treturn position;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\r\n}\r\nStereoEffect.assign = assign;\r\n\r\n//Localization\r\n\r\nimport { getLanguageCode } from '../lang.js';\r\n//import { getLanguageCode } from 'https://raw.githack.com/anhr/commonNodeJS/master/lang.js';\r\n\r\nconst lang = {\r\n\r\n\tmesh: 'Mesh',\r\n\tpointName: 'Point Name',\r\n\tcolor: 'Сolor',\r\n\topacity: 'Opacity',\r\n\r\n};\r\n\r\nswitch ( getLanguageCode() ) {\r\n\r\n\tcase 'ru'://Russian language\r\n\t\tlang.mesh = '3D объект';\r\n\t\tlang.pointName = 'Имя точки';\r\n\t\tlang.color = 'Цвет';\r\n\t\tlang.opacity = 'Непрозрачность';\r\n\t\tbreak;\r\n\r\n}\r\n\r\nimport { SpriteText } from '../SpriteText/SpriteText.js';\r\n//import { SpriteText } from 'https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/SpriteText.js';\r\n\r\nimport { getObjectPosition } from '../getPosition.js';\r\n\r\n/** @namespace\r\n * @description Creates the <a href=\"../../SpriteText/jsdoc\" target=\"_blank\">SpriteText</a> instance with information about point, intersected with mouse cursor.\r\n * @param {THREE.Raycaster.intersectObject} intersection See [intersection]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n * @param {object} options The following options are available\r\n * @param {object} [options.scales] axes scales.\r\n * See <b>options.scales</b> parameter of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> class for details.\r\n * @param {object} options.spriteOptions Options of the <b>SpriteText</b>.\r\n * See [SpriteText]{@link https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/jsdoc/module-SpriteText..html} for details.\r\n * @returns <b>new SpriteText</b> with information about point, intersected with mouse cursor.\r\n */\r\nStereoEffect.getTextIntersection = function ( intersection, options ) {\r\n\r\n\tconst spriteText = Options.findSpriteTextIntersection( options.spriteOptions.group );\r\n\tif ( spriteText )\r\n\t\treturn spriteText;\r\n\t\t\r\n\tconst THREE = three.THREE;\r\n\tconst position = getObjectPosition( intersection.object, intersection.index ),\r\n\t\tscales = options.scales || {},\r\n\t\tisArrayFuncs = (\r\n\t\t\t( intersection.index !== undefined ) &&\r\n\t\t\t( intersection.object.userData.player !== undefined ) &&\r\n\t\t\t( intersection.object.userData.player.arrayFuncs !== undefined ) \r\n\t\t),\r\n\t\tfuncs = !isArrayFuncs ? undefined : intersection.object.userData.player.arrayFuncs,\r\n\t\tfunc = ( funcs === undefined ) || ( typeof funcs === \"function\" ) ? undefined : funcs[intersection.index],\r\n\t\tpointName = isArrayFuncs && func ? func.name : undefined,\r\n\t\tcolor = !isArrayFuncs || ( func === undefined ) ?\r\n\t\t\tundefined :\r\n\t\t\tArray.isArray( func.w ) ?\r\n\t\t\t\tPlayer.execFunc( func, 'w', group.userData.t, options ) ://.a, options.b ) :\r\n\t\t\t\tfunc.w;\r\n\r\n\tif ( intersection.object.userData.onIntersection ) intersection.object.userData.onIntersection();\r\n\tconst boXYZ = !scales.x &&  !scales.y &&  !scales.z;\r\n\toptions.spriteOptions.name = Options.findSpriteTextIntersection.spriteTextIntersectionName;\r\n\toptions.spriteOptions.name = Options.findSpriteTextIntersection.spriteTextIntersectionName;\r\n\treturn new SpriteText(\r\n\r\n\t\t//text\r\n\t\tlang.mesh + ': ' + ( intersection.object.name === '' ? intersection.object.type : intersection.object.name ) +\r\n\t\t( pointName === undefined ? '' : '\\n'+ lang.pointName + ': ' + pointName ) +\r\n\t\t( ( !boXYZ && !scales.x ) || ( scales.x && !scales.x.isAxis() ) ? '' :\r\n\t\t\t'\\n' + ( ( scales.x && scales.x.name ) || ( scales.x.name === 0 ) ? scales.x.name : 'X' ) + ': ' + position.x ) +\r\n\t\t( ( !boXYZ && !scales.y ) || ( scales.y && !scales.y.isAxis() ) ? '' :\r\n\t\t\t'\\n' + ( ( scales.y && scales.y.name ) || ( scales.y.name === 0 ) ? scales.y.name : 'Y' ) + ': ' + position.y ) +\r\n\t\t( ( !boXYZ && !scales.z ) || ( scales.z && !scales.z.isAxis() ) ? '' :\r\n\t\t\t'\\n' + ( ( scales.z && scales.z.name ) || ( scales.z.name === 0 ) ? scales.z.name : 'Z' ) + ': ' + position.z ) + \r\n\t\t(//w\r\n\t\t\t!isArrayFuncs ?\r\n\t\t\t\t'' :\r\n\t\t\t\tfuncs[intersection.index] instanceof THREE.Vector4 ||\r\n\t\t\t\t\tfuncs[intersection.index] instanceof THREE.Vector3 ||\r\n\t\t\t\t\ttypeof funcs === \"function\" ?\r\n\t\t\t\t\tcolor instanceof THREE.Color ?\r\n\t\t\t\t\t\t'\\n' + lang.color + ': ' + new THREE.Color( color.r, color.g, color.b ).getHexString() :\r\n\t\t\t\t\t\tposition.w !== undefined ? '\\n' + ( scales.w && scales.w.name ? scales.w.name : 'W' ) + ': ' + position.w : '' :\r\n\t\t\t\t\t''\r\n\r\n\t\t) +\r\n\t\t(//opacity\r\n\t\t\t( intersection.object.geometry.attributes.ca === undefined ) ||\r\n\t\t\t\t( intersection.object.geometry.attributes.ca.itemSize < 4 ) ?\r\n\t\t\t\t'' :\r\n\t\t\t\t'\\n' + lang.opacity + ': ' + new THREE.Vector4().fromArray(\r\n\r\n\t\t\t\t\tintersection.object.geometry.attributes.ca.array,\r\n\t\t\t\t\tintersection.index * intersection.object.geometry.attributes.ca.itemSize\r\n\r\n\t\t\t\t).w\r\n\t\t) +\r\n\t\t(//Custom text\r\n\t\t\tintersection.object.userData.raycaster && intersection.object.userData.raycaster.text ? intersection.object.userData.raycaster.text( intersection/*, intersection.object.userData.raycaster.points*/ ) : ''\r\n\t\t),\r\n\t\tintersection.pointSpriteText ? intersection.pointSpriteText : intersection.point,//position,\r\n\t\toptions.spriteOptions\r\n\t);\r\n\r\n}\r\n\r\nexport default StereoEffect;","/**\r\n * View and edit some parameters on the web page.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n * Thanks to https://stackoverflow.com/a/11900218/5175935\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport ColorPicker from './colorpicker/colorpicker.js';\r\n\r\n/**\r\n * @description View and edit some parameters on the web page.\r\n * @param {Object} [settings] see <b>arrayFuncs.controllers[axisName]</b> parameter of <a href=\"./player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints</a>\r\n * @param {HTMLElement|string} [settings.controller]\r\n * <pre>\r\n * HTMLElement - for viewing or editing of some value\r\n * string - id of HTMLElement\r\n * </pre>\r\n * @param {HTMLElement|string} [settings.elName]\r\n * <pre>\r\n * HTMLElement - name of value. See <b>settings.controller</b> above.\r\n * string - id of HTMLElement\r\n * </pre>\r\n * @param {string} controllerId id of controller if <b>settings.controller</b> is not defined.\r\n * @param {Function} name returns name of value.\r\n * @param {Object} options\r\n * @param {Object} [options.elementName='input'] controllers tag name if <b>settings.controller</b> is not defined.\r\n * @param {String} [options.value] controllers <b>value</b> or <b>innerHTML</b>.\r\n * @param {String} [options.axisName] axis name. For find element by ID.\r\n * @param {Function} [options.onchange] callback function is called if user has changed the controllers <b>value</b>.\r\n */\r\nexport function createController( settings, controllerId, name, options ) {\r\n\r\n\tif ( !settings ) return;\r\n\r\n\t//controller\r\n\r\n\tif ( typeof settings.controller === \"string\" ) {\r\n\r\n\t\tconst id = settings.controller;\r\n\t\tsettings.controller = document.getElementById( settings.controller );\r\n\t\tif ( !settings.controller ) console.warn( 'createController: invalid settings.controller = \"' + id + '\"' );\r\n\r\n\t}\r\n\tif ( !settings.controller ) {\r\n\r\n\t\tif ( settings.controller === null ) console.warn( 'createController: invalid settings.controller = ' + settings.controller );\r\n\t\tvar controller = document.getElementById( controllerId );\r\n\t\tif ( !controller ) {\r\n\r\n\t\t\tcontroller = document.createElement( options.elementName ? options.elementName : 'input' );\r\n\t\t\tdocument.querySelector( 'body' ).appendChild( controller );\r\n\r\n\t\t}\r\n\t\tsettings.controller = controller;\r\n\r\n\t}\r\n\tfunction setControllerValue( value ) {\r\n\r\n\t\tif( settings.controller.value !== undefined )\r\n\t\t\tsettings.controller.value = value;//input element type\r\n\t\telse settings.controller.innerHTML = value;//other element types. For example span\r\n\r\n\t}\r\n\tif ( options.value !== undefined )\r\n\t\tsetControllerValue( options.value );\r\n\tif ( ( options.onchange !== undefined ) && settings.controller.onchange === null )\r\n\t\tsettings.controller.onchange = options.onchange;\r\n\tif ( ( options.title !== undefined ) && settings.controller.title === '' )\r\n\t\tsettings.controller.title = options.title;\r\n\r\n\t//slider\r\n\tif( settings.elSlider ) {\r\n\r\n\t\tif ( typeof settings.elSlider === \"string\" ) {\r\n\r\n\t\t\tconst id = settings.elSlider;\r\n\t\t\tsettings.elSlider = document.getElementById( settings.elSlider );\r\n\t\t\tif ( !settings.elSlider ) console.warn( 'createController: invalid settings.elSlider = \"' + id + '\"' );\r\n\r\n\t\t}\r\n\t\tif ( !settings.elSlider || ( settings.elSlider === true ) ) {\r\n\r\n\t\t\tif ( options.axisName ) settings.elSlider = document.getElementById( options.axisName + 'Slider' );\r\n\t\t\tif ( !settings.elSlider ) {\r\n\r\n\t\t\t\tsettings.elSlider = document.createElement( 'div' );\r\n\t\t\t\tif ( settings.controller )\r\n\t\t\t\t\tsettings.controller.parentElement.appendChild( settings.elSlider );\r\n\t\t\t\telse document.querySelector( 'body' ).appendChild( settings.elSlider );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tsettings.boSetValue = true;\r\n\t\t//Horizontal Colorpicker with slider indicator\r\n\t\tif ( !settings.colorpicker ) {\r\n\r\n\t\t\tsettings.colorpicker = ColorPicker.create( settings.elSlider, {\r\n\r\n\t\t\t\t//direction: false,\r\n\t\t\t\tduplicate: true,\r\n\t\t\t\tsliderIndicator: {\r\n\t\t\t\t\tcallback: function ( c ) {\r\n\r\n\t\t\t\t\t\tif ( settings.boSetValue || !settings.controller ) return;\r\n\t\t\t\t\t\tconst value = c.percent / 100;\r\n\t\t\t\t\t\tsettings.controller.onchange( { currentTarget: { value: value } } );\r\n\t\t\t\t\t\tsettings.controller.value = value;\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tvalue: options.value * 100,//percent\r\n\r\n\t\t\t\t},\r\n\t\t\t\tstyle: {\r\n\r\n\t\t\t\t\tborder: '1px solid black',\r\n\t\t\t\t\twidth: settings.controller.clientWidth + 'px',\r\n\t\t\t\t\theight: settings.controller.clientHeight + 'px',\r\n\r\n\t\t\t\t},\r\n\t\t\t\tonError: function ( message ) { alert( 'Horizontal Colorpicker with slider indicator error: ' + message ); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//Непонятно почему если это не сделать, то settings.elSlider не попадает под settings.controller\r\n\t\t\t//Сейчас после settings.controller ставлю <br>\r\n\t\t\t//settings.elSlider.style.display = 'none';\r\n\t\t\t//settings.elSlider.style.display = 'block';\r\n\r\n\t\t}\r\n\t\tif ( options.value !== undefined ) {\r\n\r\n\t\t\tvar value = options.value * 100;\r\n\t\t\tif ( value < 0 ) value = 0;\r\n\t\t\tif ( value > 100 ) value = 100;\r\n\t\t\tsettings.boSetValue = true;\r\n\t\t\tsettings.colorpicker.setValue( value );\r\n\t\t\tsettings.boSetValue = false;\r\n\r\n\t\t}\r\n/*\r\n\t\tdocument.getElementById( 'enterValueHI' ).onclick = function () {\r\n\r\n\t\t\tsettings.colorpicker.setValue( settings.controller.value );\r\n\r\n\t\t}\r\n*/\r\n\t\t\r\n\t}\r\n\r\n\t//name\r\n\r\n\tif ( settings.elName === false )\r\n\t\treturn;\r\n\r\n\tif ( settings.elName === null ) console.warn( 'createController: invalid settings.elName = ' + settings.elName );\r\n\tif ( typeof settings.elName === \"string\" ) {\r\n\r\n\t\tconst id = settings.elName;\r\n\t\tsettings.elName = document.getElementById( settings.elName );\r\n\t\tif ( !settings.elName ) console.warn( 'createController: invalid settings.elName = \"' + id + '\"' );\r\n\r\n\t}\r\n\tvar str = '';\r\n\tif ( !settings.elName ) {\r\n\r\n\t\tif ( options.axisName ) settings.elName = document.getElementById( options.axisName + 'Name' );\r\n\t\tif ( !settings.elName ) {\r\n\r\n\t\t\tsettings.elName = document.createElement( 'span' );\r\n\t\t\tsettings.controller.parentElement.insertBefore( settings.elName, settings.controller );\r\n\t\t\tstr = ' = ';\r\n\r\n\t\t}\r\n\r\n\t}\r\n\tif ( settings.elName.innerHTML !== '' )\r\n\t\treturn;\r\n\tsettings.elName.innerHTML = name() + str;\r\n\r\n}\r\n\r\n","/**\r\n * options of the canvas\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\n/*\r\n//При выполнении npm run build получаю ошибку\r\n//(babel plugin) ReferenceError: Unknown plugin \"external-helpers\" specified in \"base\" at 1, attempted to resolve relative to \"D:\\\\My documents\\\\MyProjects\\\\webgl\\\\three.js\\\\GitHub\\\\three.js\\\\dev\\\\examples\\\\jsm\"\r\n//import { WEBGL } from '../../three.js/dev/examples/jsm/WebGL.js';\r\n\r\nimport { WEBGL } from './WebGL.js';\r\n\r\n//for testing open FireFox and read https://support.biodigital.com/hc/en-us/articles/218322977-How-to-turn-on-WebGL-in-my-browser#h_01EJW3MGDF7KH3PH6TG2DE13H6\r\nif ( WEBGL.isWebGLAvailable() === false ) {\r\n\r\n\tdocument.body.appendChild( WEBGL.getWebGLErrorMessage() );\r\n\talert( WEBGL.getWebGLErrorMessage().innerHTML );\r\n\r\n}\r\n*/\r\nimport ColorPicker from './colorpicker/colorpicker.js';\r\nimport three from './three.js'\r\n\r\n//для создания пустого cookie который ничего не запоминает\r\nimport Cookie from './cookieNodeJS/cookie.js';\r\n\r\nimport cookie from './cookieNodeJS/cookie.js';\r\nimport { getLanguageCode } from './lang.js';\r\nimport Player from './player/player.js';\r\nimport StereoEffect from './StereoEffect/StereoEffect.js';\r\nimport { createController } from './controller.js'\r\n\r\nvar boCreateControllers;\r\n\r\nclass Options {\r\n\r\n\t/**\r\n\t * Options of the canvas\r\n\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t */\r\n\tconstructor( options ) {\r\n\r\n\t\tconst _this = this;\r\n\t\toptions = options || {};\r\n\t\tif ( options.boOptions )\r\n\t\t\treturn options;//duplucate new Options\r\n\r\n\t\tvar lang;\r\n\r\n\t\tif ( options.a === undefined ) options.a = 1;\r\n\t\tif ( options.b === undefined ) options.b = 0;\r\n\r\n\t\t/**\r\n\t\t * set the <b>scales.w</b> key of the <b>options</b>\r\n\t\t * @param {Object} options\r\n\t\t * @param {string} [options.scales.w.name=\"W\"] axis name.\r\n\t\t * @param {number} [options.scales.w.min=0] Minimum range of the <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">color palette</a> index.\r\n\t\t * @param {number} [options.scales.w.max=1] Maximum range of the <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">color palette</a> index.\r\n\t\t */\r\n\t\tthis.setW = function ( optionsCur ) {\r\n\r\n\t\t\toptionsCur = optionsCur || options;\r\n\t\t\tconst axisName = 'w';\r\n\t\t\toptionsCur.scales = optionsCur.scales || {};\r\n\t\t\tconst scale = optionsCur.scales.w;\r\n\t\t\tif ( !optionsCur.palette )\r\n\t\t\t\t_this.setPalette();// optionsCur );\r\n\r\n\t\t\t//максимальное значение шкалы w по умолчанию беру из THREE.Vector4\r\n\t\t\t//потому что в противном случае неверно будет отображаться цвет точки, заданной как THREE.Vector4()\r\n//\t\t\tscale.max = scale.max === undefined ? new three.THREE.Vector4().w : scale.max;\r\n\r\n\t\t}\r\n\t\toptions.scales = options.scales || {};\r\n\t\tconst boCreateScale = !options.scales.x && !options.scales.y && !options.scales.z;\r\n\t\tfunction setScale( axisName ) {\r\n\r\n\t\t\t//Не надо создавать ось потому что иначе будут создавться контролы для осей, которые не хочет видеть пользователь и будет рмсоватся пунктирная линия к не существующей оси если пользователь нажал на точку\r\n\t\t\tif ( boCreateScale )\r\n\t\t\t\toptions.scales[axisName] = options.scales[axisName] || {};\r\n\r\n\t\t\tif ( !options.scales[axisName] )\r\n\t\t\t\treturn;\r\n\r\n/*\r\n\t\t\toptions.scales[axisName].name = options.scales[axisName].name || axisName;\r\n\t\t\toptions.scales[axisName].min = options.scales[axisName].min === undefined ? -1 : options.scales[axisName].min;\r\n\t\t\toptions.scales[axisName].max = options.scales[axisName].max === undefined ? 1 : options.scales[axisName].max;\r\n*/\t\t\t\r\n\r\n\t\t}\r\n\t\tsetScale( 'x' );\r\n\t\tsetScale( 'y' );\r\n\t\tsetScale( 'z' );\r\n//\t\toptions.scales.setW = function () { _this.setW(); }\r\n\t\toptions.point = options.point || {};\r\n\t\tif (options.point.size === undefined) options.point.size = 5.0;\r\n\t\toptions.point.sizePointsMaterial = options.point.sizePointsMaterial || 100.0;\r\n\r\n\t\t/**\r\n\t\t * set the <b>palette</b> key of the <b>options</b>.\r\n\t\t * See <a href=\"../../colorpicker/jsdoc/module-ColorPicker-ColorPicker.html#palette\" target=\"_blank\">color palette</a>.\r\n\t\t * @param {ColorPicker.palette} [palette] new palette.\r\n\t\t */\r\n\t\tthis.setPalette = function ( palette ) {\r\n\r\n\t\t\tif ( palette ) options.palette = palette;\r\n\t\t\telse if ( !options.palette ) options.palette = new ColorPicker.palette();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}\r\n\t\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}. Use the <b>camera</b> key if you want control cameras focus.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}.\r\n\t\t * @param {THREE.Scene} scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t\t */\r\n\t\tthis.createOrbitControls = function ( camera, renderer, scene ) {\r\n\r\n\t\t\tif ( options.orbitControls === false )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tconst settings = options.orbitControls || {};\r\n\t\t\t_this.orbitControls = new three.OrbitControls( camera, renderer.domElement );\r\n\t\t\tif ( settings.enableRotate !== undefined ) _this.orbitControls.enableRotate = settings.enableRotate;\r\n\t\t\t_this.orbitControls.target.set( scene.position.x * 2, scene.position.y * 2, scene.position.z * 2 );\r\n\t\t\t_this.orbitControls.saveState();//For reset of the orbitControls settings in the CameraGui and OrbitControlsGui\r\n\t\t\t_this.orbitControls.update();\r\n\r\n\t\t\tif ( _this.frustumPoints )\r\n\t\t\t\t_this.orbitControls.addEventListener( 'change', function () { _this.frustumPoints.onChangeControls(); } );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Reset <a href=\"../../Player/jsdoc\" target=\"_blank\">Player</a> and restore [camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} position.\r\n\t\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t\t * @param {THREE.Scene} scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t\t */\r\n\t\tthis.restoreSceneController = function ( camera, scene ) {\r\n\r\n\t\t\tif ( !three.dat || ( options.dat === false ) )//options.dat.dat\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t//Localization\r\n\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Reset player and restore camera position.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tswitch ( this.getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\tlang.defaultTitle = 'Восстановить положение камеры и проигрывателя.';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst scenePosition = new three.THREE.Vector3().copy( scene.position ),\r\n\t\t\t\tcameraPosition = new three.THREE.Vector3().copy( camera.position );\r\n\r\n\t\t\tthree.dat.controllerNameAndTitle( options.dat.gui.add( {\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tif ( options.player ) options.player.selectScene( options.playerOptions.selectSceneIndex );\r\n\r\n\t\t\t\t\tcamera.position.copy( cameraPosition );\r\n\t\t\t\t\tscene.position.copy( scenePosition );\r\n\t\t\t\t\tif ( options.orbitControls !== false ) {\r\n\r\n\t\t\t\t\t\toptions.orbitControls.target = new three.THREE.Vector3();\r\n\t\t\t\t\t\toptions.orbitControls.object.position.copy( camera.position );\r\n\t\t\t\t\t\toptions.orbitControls.update();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t}\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * \r\n\t\t\t * playerOptions = {\r\n\t\t\t * \r\n\t\t\t *\tmin: 0,// Minimum range of the axis.\r\n\t\t\t *\tmax: 1,// Maximum range of the axis.\r\n\t\t\t *\tmarks: 10,// Ticks count of the playing. Number of scenes of 3D objects animation.\r\n\t\t\t *\t\t//Have effect for <b>max</b> is not Infinity.\r\n\t\t\t *\tdt: 0.1,// Step of the animation. Have effect only if <b>max</b> is infinity.\r\n\t\t\t *\trepeat: false,// true - Infinitely repeating 3D objects animation.\r\n\t\t\t *\tinterval: 1,// Ticks per seconds.\r\n\t\t\t *\tzoomMultiplier: 1.1,// zoom multiplier of the time.\r\n\t\t\t *\toffset: 0.1,// offset of the time.\r\n\t\t\t *\tname: \"\",// name of the time.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t * @param {number} [playerOptions=0] Minimum range of the axis.\r\n\t\t\t */\r\n\t\t\tplayerOptions: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\toptions.playerOptions = options.playerOptions || {};\r\n\t\t\t\t\tconst playerOptions = options.playerOptions;\r\n\t\t\t\t\tplayerOptions.min = playerOptions.min || 0;\r\n\t\t\t\t\tif ( playerOptions.max === Infinity ) playerOptions.max = null;//Заменяю Infinity на null потому что из cockie Infinity читается как null\r\n\t\t\t\t\tif ( playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\t\tif ( playerOptions.max === undefined ) playerOptions.max = 1;\r\n\t\t\t\t\t\tplayerOptions.marks = playerOptions.marks || 10;//2;\r\n\r\n\t\t\t\t\t} else playerOptions.marks = null;\r\n\t\t\t\t\tif ( playerOptions.max === null ) playerOptions.dt = playerOptions.dt || 0.1;\r\n\t\t\t\t\telse playerOptions.dt = ( playerOptions.max - playerOptions.min ) / ( playerOptions.marks - 1 );\r\n\t\t\t\t\tplayerOptions.repeat = playerOptions.repeat || false;\r\n\t\t\t\t\tplayerOptions.interval = playerOptions.interval || 1;//25;\r\n\t\t\t\t\tplayerOptions.zoomMultiplier = playerOptions.zoomMultiplier || 1.1;\r\n\t\t\t\t\tplayerOptions.offset = playerOptions.offset || 0.1;\r\n\t\t\t\t\tplayerOptions.name = playerOptions.name || '';\r\n\t\t\t\t\tif ( !playerOptions.cameraTarget ) {\r\n\r\n\t\t\t\t\t\tconst cameraTarget = new Player.cameraTarget();\r\n\t\t\t\t\t\tObject.defineProperties( playerOptions, {\r\n\r\n\t\t\t\t\t\t\tcameraTarget: {\r\n\r\n\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\treturn cameraTarget;\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn options.playerOptions;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( playerOptions ) { options.playerOptions = playerOptions; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.a</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\ta: {\r\n\r\n\t\t\t\tget: function () { return options.a; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.b</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tb: {\r\n\r\n\t\t\t\tget: function () { return options.b; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * See the <b>options.dat</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * dat = {\r\n\t\t\t * \r\n\t\t\t *\tgui: new [dat.GUI()]{@link https://github.com/dataarts/dat.gui} instance,\r\n\t\t\t *\t\tundefined - do not use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tcookie: false,// do not save to cookie all user settings\r\n\t\t\t *\tcookieName:,// Name of the cookie.\r\n\t\t\t *\taxesHelperGui: false,// - do not adds a <a href=\"../../AxesHelper/jsdoc/module-AxesHelperGui.html\" target=\"_blank\">AxesHelperGui</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tstereoEffectsGui: false,// - do not adds <a href=\"../../StereoEffect/jsdoc/module-StereoEffect-StereoEffect.html#gui\" target=\"_blank\">Stereo Effects folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tfolderPoint: false,// - do not adds <a href=\"../../jsdoc/folderPoint/FolderPoint.html\" target=\"_blank\">Point settings folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tplayerGui: true,// - adds a <a href=\"../../player/jsdoc/module-Player.html#~Player.gui\" target=\"_blank\">Player controllers</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tguiSelectPoint: true,// - displays the <a href=\"../../guiSelectPoint/jsdoc/module-GuiSelectPoint.html\" target=\"_blank\">Select Point</a>. [dat.gui]{@link https://github.com/dataarts/dat.gui} based graphical user interface for select a point from the mesh.\r\n\t\t\t *\tguiFrustumPoints: true,// - Adds <a href=\"../../FrustumPoints/jsdoc/FrustumPoints.html#gui\" target=\"_blank\">Frustum Points folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tcameraGui: true,// - Adds <a href=\"../../jsdoc/CameraGui/module-CameraGui-CameraGui.html\" target=\"_blank\">Camera folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t\t\t *\tmoveScene: true,// - displays the <a href=\"../../jsdoc/MoveGroupGui/index.html\" target=\"_blank\">move group gui</a>.\r\n\t\t\t *\tspriteTextGui: true,// - displays the <a href=\"../../SpriteText/jsdoc/module-SpriteTextGui.html\" target=\"_blank\">SpriteTextGui</a>.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tdat: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tclass Dat{\r\n\r\n\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t * dat options\r\n\t\t\t\t\t\t * @param {dat} dat [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tconstructor( dat ) {\r\n\r\n\t\t\t\t\t\t\tdat = dat || {};\r\n\t\t\t\t\t\t\tif ( dat.boDat )\r\n\t\t\t\t\t\t\t\treturn dat;//duplucate new Options\r\n\t\t\t\t\t\t\tfunction guiParent() {\r\n\r\n\t\t\t\t\t\t\t\t//без elMyGuiContainer не будет скроллинга gui\r\n\t\t\t\t\t\t\t\tconst elMyGuiContainer = document.createElement( 'div' );\r\n\t\t\t\t\t\t\t\tdat.parent.appendChild( elMyGuiContainer );\r\n\t\t\t\t\t\t\t\telMyGuiContainer.appendChild( dat.gui.domElement );\r\n\t\t\t\t\t\t\t\telMyGuiContainer.style.position = 'absolute';//оставляем gui в пределах canvas\r\n\t\t\t\t\t\t\t\telMyGuiContainer.style.top = '0px';\r\n\t\t\t\t\t\t\t\telMyGuiContainer.style.right = '0px';\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * returns true if <b>dat</b> was converted by <b>new Dat( options );</b>\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tboDat: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return true; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter and setter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tdat: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn('get dat depreacated. Use three.dat = dat.');\r\n\t\t\t\t\t\t\t\t\t\treturn three.dat;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tset: function ( dat ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.warn('Set dat depreacated. Use three.dat = dat.');\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdat.dat &&\r\n\t\t\t\t\t\t\t\t\t\t\t( dat.dat.constructor.name === dat.constructor.name ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t( dat.dat.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'duplicate dat.' );\r\n\t\t\t\t\t\t\t\t\t\tdat.dat = dat;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * Name of the cookie.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tcookieName : {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cookieName ; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * [dat.GUI()]{@link https://github.com/dataarts/dat.gui} instance.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tgui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !dat.gui && three.dat ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//если сделать autoPlace: false то не будет скроллинга для gui\r\n\t\t\t\t\t\t\t\t\t\t\tdat.gui = new three.dat.GUI();// options.dat.parent ? { autoPlace: false, } : undefined );\r\n\t\t\t\t\t\t\t\t\t\t\tif ( options.dat.parent ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tguiParent();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn dat.gui;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcookie: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cookie; },\r\n\t\t\t\t\t\t\t\t\tset: function ( cookie ) { dat.cookie = cookie; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tguiSelectPoint: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.guiSelectPoint; },\r\n\t\t\t\t\t\t\t\t\tset: function ( guiSelectPoint ) { dat.guiSelectPoint = guiSelectPoint; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tcameraGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.cameraGui; },\r\n\t\t\t\t\t\t\t\t\tset: function ( cameraGui ) { dat.cameraGui = cameraGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tplayerGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.playerGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\torbitControlsGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.orbitControlsGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\taxesHelperGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.axesHelperGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tplayController: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.playController; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tstereoEffectsGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.playController; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tmoveScene: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.moveScene; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tspriteTextGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.spriteTextGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfolderPoint: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.folderPoint; },\r\n\t\t\t\t\t\t\t\t\tset: function ( folderPoint ) { dat.folderPoint = folderPoint; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tpointLightGui: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.pointLightGui; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tparent: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return dat.parent; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t//For debugging. Find a hidden keys\r\n\t\t\t\t\t\t\tfor ( var propertyName in dat ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( this[propertyName] === undefined ) console.error( 'Dat: dat.' + propertyName + ' key is hidden' );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.dat === false )\r\n\t\t\t\t\t\treturn options.dat;\r\n\t\t\t\t\toptions.dat = new Dat( options.dat );\r\n\t\t\t\t\tif ( options.dat.gui ) {\r\n\r\n\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\t\t\tconst className = options.dat.gui.domElement.className;\r\n\t\t\t\t\t\t\tvar guiCount = 0;\r\n\t\t\t\t\t\t\toptions.dat.gui.domElement.parentElement.childNodes.forEach( function ( node ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( node.className === className ) guiCount++;\r\n\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\tif ( guiCount > 1 )\r\n\t\t\t\t\t\t\t\tconsole.error( 'Options: duplicate dat.GUI' );\r\n\r\n\t\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t\t\toptions.dat.gui.domElement.addEventListener( 'mouseenter', function ( event ) { options.dat.mouseenter = true; } );\r\n\t\t\t\t\t\toptions.dat.gui.domElement.addEventListener( 'mouseleave', function ( event ) { options.dat.mouseenter = false; } );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.dat.cookie === false ) options.dat.cookie = new Cookie.defaultCookie();\r\n\t\t\t\t\telse if ( options.dat.cookie === undefined ) options.dat.cookie = cookie;\r\n\t\t\t\t\toptions.dat.getCookieName = function ( cookieName = '' ) {\r\n\r\n\t\t\t\t\t\tconst name = options.dat.cookieName ||\r\n\t\t\t\t\t\t\t( options.elContainer ?\r\n\t\t\t\t\t\t\t\ttypeof options.elContainer === \"object\" ?\r\n\t\t\t\t\t\t\t\t\toptions.elContainer.id :\r\n\t\t\t\t\t\t\t\t\ttypeof options.elContainer === \"string\" ?\r\n\t\t\t\t\t\t\t\t\t\toptions.elContainer :\r\n\t\t\t\t\t\t\t\t\t\t'' :\r\n\t\t\t\t\t\t\t\t'' );\r\n\t\t\t\t\t\treturn cookieName + ( ( cookieName !== '' ) && ( name !== '' ) ? '_' : '' ) + name;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//axesHelperGui: false,\r\n\t\t\t\t\t//playerGui: false,\r\n\t\t\t\t\t//guiSelectPoint: false,\r\n\t\t\t\t\t//moveScene: false,\r\n\t\t\t\t\t//cameraGui: false,\r\n\t\t\t\t\t//stereoEffectsGui: false,\r\n\t\t\t\t\t//spriteTextGui: false,\r\n\t\t\t\t\t//folderPoint: false,\r\n\t\t\t\t\treturn options.dat;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( dat ) { options.dat = dat; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Your custom getLanguageCode() function.\r\n\t\t\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t\t * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t\t * Default returns the language code of your browser.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tgetLanguageCode: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( typeof options.getLanguageCode === \"string\" )\r\n\t\t\t\t\t\treturn function () {\r\n\r\n\t\t\t\t\t\t\treturn options.getLanguageCode;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\treturn options.getLanguageCode || getLanguageCode;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * See <b>options.scales</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tscales: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tclass Scales {\r\n\r\n\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t * scales\r\n\t\t\t\t\t\t * @param {object} scales\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tconstructor( scales ) {\r\n\r\n\t\t\t\t\t\t\tclass Scale {\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * scale\r\n\t\t\t\t\t\t\t\t * @param {object} scales\r\n\t\t\t\t\t\t\t\t * @param {string} axisName. 'x' or 'y' or 'z'\r\n\t\t\t\t\t\t\t\t */\r\n\t\t\t\t\t\t\t\tconstructor( scales, axisName ) {\r\n\r\n\t\t\t\t\t\t\t\t\tlet scale = scales[axisName];\r\n//\t\t\t\t\t\t\t\t\tscale = scale || {};\r\n\t\t\t\t\t\t\t\t\tthis.isAxis = function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !scales || ( !scales.x && !scales.y && !scales.z ) || scale ) return true;\r\n\t\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tconst setScale = (callBack) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !scale ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tscales[axisName] = {};\r\n\t\t\t\t\t\t\t\t\t\t\tscale = scales[axisName];\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tcallBack();\r\n\t\t\t\t\t\t\t\t\t\tscale.step = Math.abs( options.scales.w.min - options.scales.w.max ) / 100;\r\n\t\t\t\t\t\t\t\t\t\tif ( options.guiSelectPoint) options.guiSelectPoint.setAxisControl( 'w', scale );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t\t\t * returns true if <b>scale</b> was converted by <b>new Scale( scale );</b>\r\n\t\t\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\t\t\tboScale: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: function () { return true; },\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tmin: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !scale || !scale.min ) return axisName === 'w' ? 0 : -1;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn scale.min;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tset: ( min ) => { setScale( () => { scale.min = min; }); },\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tmax: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//максимальное значение шкалы w по умолчанию беру из THREE.Vector4\r\n\t\t\t\t\t\t\t\t\t\t\t\t//потому что в противном случае неверно будет отображаться цвет точки, заданной как THREE.Vector4()\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !scale || !scale.max ) return axisName === 'w' ? new three.THREE.Vector4().w : 1;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn scale.max;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tset: ( max ) => { setScale( () => { scale.max = max; }); },\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tname: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !scale || ( scale.name === undefined ) ) return axisName;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn scale.name;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\tset: function ( name ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( scale ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscale.name = name;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.setAxisName( axisName, name );\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tmarks: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !scale ) return undefined;\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( !scale.marks ) scale.marks = 3;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn scale.marks;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n//\t\t\t\t\t\t\t\t\t\t\tset: function ( marks ) { scale.marks = marks; },\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t\t\t//For debugging. Find a hidden keys\r\n\t\t\t\t\t\t\t\t\tfor ( var propertyName in scale ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( this[propertyName] === undefined ) console.error( 'Options.Scales: scale.' + propertyName + ' key is hidden' );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst scalesObject = {\r\n\r\n\t\t\t\t\t\t\t\tx: new Scale( options.scales, 'x' ),\r\n\t\t\t\t\t\t\t\ty: new Scale( options.scales, 'y' ),\r\n\t\t\t\t\t\t\t\tz: new Scale( options.scales, 'z' ),\r\n\t\t\t\t\t\t\t\tw: new Scale( options.scales, 'w' ),\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * returns true if <b>scales</b> was converted by <b>new Scales( scales );</b>\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tboScales: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return true; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tx: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return scalesObject.x; },\r\n\t\t\t\t\t\t\t\t\tset: function ( x ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( x === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scales.x;\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scalesObject.x;\r\n\t\t\t\t\t\t\t\t\t\t\tscalesObject.x = new Scale( scales, 'x' );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else scales.x = x;\r\n\t\t\t\t\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.updateScale( 'x' );\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\ty: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return scalesObject.y; },\r\n\t\t\t\t\t\t\t\t\tset: function ( y ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( y === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scales.y;\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scalesObject.y;\r\n\t\t\t\t\t\t\t\t\t\t\tscalesObject.y = new Scale( scales, 'y' );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else scales.y = y;\r\n\t\t\t\t\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.updateScale( 'y' );\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tz: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return scalesObject.z; },\r\n\t\t\t\t\t\t\t\t\tset: function ( z ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( z === undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scales.z;\r\n\t\t\t\t\t\t\t\t\t\t\tdelete scalesObject.z;\r\n\t\t\t\t\t\t\t\t\t\t\tscalesObject.z = new Scale( scales, 'z' );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else scales.z = z;\r\n\t\t\t\t\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.updateScale( 'z' );\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tw: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return scalesObject.w; },\r\n\t\t\t\t\t\t\t\t\tset: function ( w ) { scales.w = w; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * setW\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tsetW: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n/*\r\n\t\t\t\t\t\t\t\t\t\tif ( !scales.setW ) scales.setW = _this.setW;\r\n\t\t\t\t\t\t\t\t\t\treturn scales.setW;\r\n*/\r\n\t\t\t\t\t\t\t\t\t\treturn _this.setW;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter and setter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * true - displays the label and scale of the axes.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tdisplay: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( scales.display === undefined ) scales.display = true;\r\n\t\t\t\t\t\t\t\t\t\treturn scales.display;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tset: function ( display ) { scales.display = display; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter and setter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * options of the text of the marks of AxesHelper\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\ttext: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( scales.text === undefined ) scales.text = {};\r\n\t\t\t\t\t\t\t\t\t\treturn scales.text;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tset: function ( text ) { scales.text = text; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter and setter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * Position of the axes intersection\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tposAxesIntersection: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return scales.posAxesIntersection; },\r\n\t\t\t\t\t\t\t\t\tset: function ( posAxesIntersection ) { scales.posAxesIntersection = posAxesIntersection; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t//For debugging. Find a hidden keys\r\n\t\t\t\t\t\t\tfor ( var propertyName in scales ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( this[propertyName] === undefined ) console.error( 'Options: scales.' + propertyName + ' key is hidden' );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( !options.scales.boScales )\r\n\t\t\t\t\t\toptions.scales = new Scales( options.scales );\r\n\t\t\t\t\treturn options.scales;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( scales ) { options.scales = scales; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Points сolor.\r\n\t\t\t * See <b>options.palette</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpalette: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.palette === undefined ) options.palette = true;\r\n\r\n\t\t\t\t\tswitch ( typeof options.palette ) {\r\n\r\n\t\t\t\t\t\tcase 'number':\r\n\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette( { palette: options.palette } );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'boolean':\r\n\t\t\t\t\t\t\tif ( options.palette )\r\n\t\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette();// { palette: ColorPicker.paletteIndexes.BGYW } );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'string':\r\n\t\t\t\t\t\t\tconst color = new three.THREE.Color(options.palette);\r\n\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette( { palette: [{ percent: 0, r: color.r * 255, g: color.g * 255, b: color.b * 255, },] } );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: {\r\n\r\n\t\t\t\t\t\t\t//Это условие не выполняется корректро если использовать myThree.module.js или myThree.module.min.js вместо myThree.js\r\n\t\t\t\t\t\t\t//if ( options.palette instanceof ColorPicker.palette === false )\r\n\t   \r\n\t\t\t\t\t\t\tif ( Array.isArray( options.palette ) )\r\n\t\t\t\t\t\t\t\toptions.palette = new ColorPicker.palette( { palette: options.palette } );//Custom palette\r\n\t\t\t\t\t\t\telse if ( !options.palette.isPalette() )\r\n\t\t\t\t\t\t\t\tconsole.error( 'MyThree: invalid typeof options.palette: ' + typeof options.palette );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn options.palette;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * returns true if <b>options</b> was converted by <b>new Options( options );</b>\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tboOptions: {\r\n\r\n\t\t\t\tget: function () { return true;/*options.boOptions;*/ },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * returns {\r\n\t\t\t *\r\n\t\t\t * \tsize = 5.0; point size\r\n\t\t\t * \tsizePointsMaterial = 100.0; The <b>size</b> property of the parameters of the [THREE.PointsMaterial]{@link https://threejs.org/docs/index.html?q=PointsMaterial#api/en/materials/PointsMaterial}.\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpoint: {\r\n\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\tget size() { return options.point.size; },\r\n\t\t\t\t\t\tset size( size ) {\r\n\r\n\t\t\t\t\t\t\tif ( options.point.size === size ) return;\r\n\t\t\t\t\t\t\toptions.point.size = size;\r\n\t\t\t\t\t\t\tif ( options.dat && options.dat.folderPoint ) options.dat.folderPoint.size.setValue( size );\r\n\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\tget sizePointsMaterial() { return options.point.sizePointsMaterial; },\r\n\t\t\t\t\t\tset sizePointsMaterial( sizePointsMaterial ) { options.point.sizePointsMaterial = sizePointsMaterial;},\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <b>SpriteText</b> options\r\n\t\t\t * See <b>options</b> parameter of the <a href=\"../../SpriteText/jsdoc/module-SpriteText.html\" target=\"_blank\">SpriteText</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tspriteText: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.spriteText ) return options.spriteText;\r\n\t\t\t\t\treturn {};\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster}.\r\n\t\t\t **/\r\n\t\t\traycaster: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.raycaster ) return options.raycaster;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( raycaster ) { options.raycaster = raycaster; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t\t\t * See <b>options.camera</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcamera: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\toptions.camera = options.camera || {};\r\n\t\t\t\t\tif ( !options.camera.position ) options.camera.position = new three.THREE.Vector3( 0.4, 0.4, 2 );\r\n\t\t\t\t\tif ( !options.camera.scale ) options.camera.scale = new three.THREE.Vector3( 1, 1, 1 );\r\n\t\t\t\t\treturn options.camera;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( camera ) { options.camera = camera; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Camera looking at selected point during playing. See the <b>cameraTarget</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html#init\" target=\"_blank\">Player.cameraTarget.init(...)</a> function for details.\r\n\t\t\t * See <b>options.cameraTarget</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcameraTarget: {\r\n\r\n\t\t\t\tget: function () { return options.cameraTarget; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * The <b>HTMLElement</b>, contains a <b>canvas</b>.\r\n\t\t\t * See <b>options.elContainer</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\telContainer: {\r\n\r\n\t\t\t\tget: function () { return options.elContainer; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * true - use my <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">dropdown menu for canvas</a> in my version of [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t\t\t * See <b>options.canvasMenu</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvasMenu: {\r\n\r\n\t\t\t\tget: function () { return options.canvasMenu; },\r\n\t\t\t\tset: function ( canvasMenu ) {\r\n\r\n\t\t\t\t\tif ( options.canvasMenu && ( options.canvasMenu !== true ) && ( options.canvasMenu !== false ) ) console.warn( 'Duplicate canvasMenu' );\r\n\t\t\t\t\toptions.canvasMenu = canvasMenu;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <b>canvas</b> properties.\r\n\t\t\t * See <b>options.canvas</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvas: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.canvas ) return options.canvas;\r\n\t\t\t\t\treturn { fullScreen: true, }\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Creates a <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a> instance.\r\n\t\t\t * See <b>options.frustumPoints</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tfrustumPoints: {\r\n\r\n\t\t\t\tget: function () { return options.frustumPoints; },\r\n\t\t\t\tset: function ( frustumPoints ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.frustumPoints &&\r\n\t\t\t\t\t\t( options.frustumPoints.constructor.name === frustumPoints.constructor.name ) &&\r\n\t\t\t\t\t\t( options.frustumPoints.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate frustumPoints.' );\r\n\t\t\t\t\toptions.frustumPoints = frustumPoints;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t\t\t * See <b>options.stereoEffect</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tstereoEffect: {\r\n\r\n\t\t\t\tget: function () { return options.stereoEffect; },\r\n\t\t\t\tset: function ( stereoEffect ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.stereoEffect &&\r\n\t\t\t\t\t\t( options.stereoEffect.constructor.name === stereoEffect.constructor.name ) &&\r\n\t\t\t\t\t\t( options.stereoEffect.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate stereoEffect.' );\r\n\t\t\t\t\toptions.stereoEffect = stereoEffect;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a>.\r\n\t\t\t * See <b>options.player</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tplayer: {\r\n\r\n\t\t\t\tget: function () { return options.player; },\r\n\t\t\t\tset: function ( player ) {\r\n\r\n\t\t\t\t\tif ( options.player ) console.error( 'duplicate player.' );\r\n\t\t\t\t\toptions.player = player;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * current time of the <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\ttime: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.player )\r\n\t\t\t\t\t\treturn options.player.getTime();\r\n\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../axesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t\t\t * See <b>options.axesHelper</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\taxesHelper: {\r\n\r\n\t\t\t\tget: function () { return options.axesHelper; },\r\n\t\t\t\tset: function ( axesHelper ) {\r\n\r\n\t\t\t\t\tif ( options.axesHelper ) console.error( 'duplicate axesHelper.' );\r\n\t\t\t\t\toptions.axesHelper = axesHelper;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">CanvasMenu</a>.\r\n\t\t\t * See <b>options.canvasMenu</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcanvasMenu: {\r\n\r\n\t\t\t\tget: function () { return options.canvasMenu; },\r\n\t\t\t\tset: function ( canvasMenu ) {\r\n\r\n\t\t\t\t\tif ( options.canvasMenu ) console.error( 'duplicate canvasMenu.' );\r\n\t\t\t\t\toptions.canvasMenu = canvasMenu;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use [OrbitControls]{@link https://threejs.org/docs/index.html?q=orb#examples/en/controls/OrbitControls}.\r\n\t\t\t * See <b>options.orbitControls</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\torbitControls: {\r\n\r\n\t\t\t\tget: function () { return options.orbitControls; },\r\n\t\t\t\tset: function ( orbitControls ) {\r\n\r\n\t\t\t\t\tif (\r\n\r\n\t\t\t\t\t\toptions.orbitControls &&\r\n\t\t\t\t\t\t( options.orbitControls.constructor.name === orbitControls.constructor.name ) &&\r\n\t\t\t\t\t\t( options.orbitControls.constructor.name !== 'Object' )\r\n\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tconsole.error( 'duplicate orbitControls.' );\r\n\t\t\t\t\toptions.orbitControls = orbitControls;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter returns 1\r\n\t\t\t **/\r\n\t\t\tscale: {\r\n\r\n\t\t\t\tget: function () { return 1; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../jsdoc/pointLight/index.html\" target=\"_blank\">pointLight</a>.\r\n\t\t\t * See <b>options.pointLight</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tpointLight: {\r\n\r\n\t\t\t\tget: function () { return options.pointLight; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html\" target=\"_blank\">Player.cameraTarget</a> class instance. Functions for camera for looking at selected point.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcameraTarget: {\r\n\r\n\t\t\t\tget: function () { return options.cameraTarget; },\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Mouse events listeners for [Raycaster]{@link https://threejs.org/docs/index.html?q=Raycaster#api/en/core/Raycaster} instance.\r\n\t\t\t * See <a href=\"../../jsdoc/Options/Raycaster_EventListeners.html\" target=\"_blank\">EventListeners</a> class.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\teventListeners: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tif ( options.eventListeners ) return options.eventListeners;\r\n/*если я это оставлю, то не смогу определить, используется ли raycaster на этом canvas и нужно ли вызывать addParticle\r\nдля проверки создать MyPoints на пустом canvas\r\n\t\t\t\t\treturn { addParticle: function(){\r\n\r\n\t\t\t\t\t\tconsole.error( 'Options.eventListeners.addParticle: call new Options.raycaster.EventListeners(...) first.' );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}, }\r\n*/\t\t\t\t\t\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( eventListeners ) {\r\n\r\n\t\t\t\t\tif ( options.eventListeners )\r\n\t\t\t\t\t\tconsole.error( 'duplicate eventListeners.' );\r\n\t\t\t\t\toptions.eventListeners = eventListeners;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter and setter\r\n\t\t\t * <pre>\r\n\t\t\t * Use <a href=\"../../guiSelectPoint/jsdoc/\" target=\"_blank\">GuiSelectPoint</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tguiSelectPoint: {\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\treturn options.guiSelectPoint;\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( guiSelectPoint ) {\r\n\r\n\t\t\t\t\tif ( options.guiSelectPoint && ( guiSelectPoint != undefined ) )\r\n\t\t\t\t\t\tconsole.error( 'duplicate guiSelectPoint.' );\r\n\t\t\t\t\toptions.guiSelectPoint = guiSelectPoint;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * Controllers list.\r\n\t\t\t * User can see and edit some parameters on the web page.\r\n\t\t\t * <b>t</b>: Object for view and edit of the current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time.\r\n\t\t\t * \r\n\t\t\t *\tKeys:\r\n\t\t\t *\t\t<b>controller</b>:\r\n\t\t\t *\t\t\t<b>HTMLElement</b> for view and edit of the current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time\r\n\t\t\t *\t\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t *\t\t<b>elName</b>:\r\n\t\t\t *\t\t\t<b>HTMLElement</b> name of the time parameter. See <b>settings.options.playerOptions.name</b> parameter of <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a>\r\n\t\t\t *\t\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t * </pre>\r\n\t\t\t *\r\n\t\t\t * See <b>options.controllers</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a>.\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\tcontrollers: {//не засунул это в options.playerOptions потому что при чтение из cockie теряется HTMLElement\r\n\r\n\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\tclass Controllers{\r\n\r\n\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t * dat options\r\n\t\t\t\t\t\t * @param {dat} dat [dat]{@link https://github.com/dataarts/dat.gui}\r\n\t\t\t\t\t\t */\r\n\t\t\t\t\t\tconstructor( controllers ) {\r\n\r\n\t\t\t\t\t\t\tvar elName;\r\n\t\t\t\t\t\t\tcontrollers = controllers || {};\r\n\t\t\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * returns true if <b>controllers</b> was converted by <b>new Controllers( controllers );</b>\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tboControllers: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return true; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * Object for view and edit of the current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time.\r\n\t\t\t\t\t\t\t\t * Keys:\r\n\t\t\t\t\t\t\t\t *\t<b>controller</b>:\r\n\t\t\t\t\t\t\t\t *\t\t<b>HTMLElement</b> for view and edit of the current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time\r\n\t\t\t\t\t\t\t\t *\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t\t\t\t\t\t *\t<b>elName</b>:\r\n\t\t\t\t\t\t\t\t *\t\t<b>HTMLElement</b> name of the time parameter. See <b>settings.options.playerOptions.name</b> parameter of <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a>\r\n\t\t\t\t\t\t\t\t *\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tt: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( controllers.t === null )\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'options.controllers.t = ' + controllers.t );\r\n\t\t\t\t\t\t\t\t\t\tconst elTime = document.getElementById( 'time' );\r\n\t\t\t\t\t\t\t\t\t\tif ( !controllers.t ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( !elTime ) return;\r\n\t\t\t\t\t\t\t\t\t\t\tcontrollers.t = { elName: document.getElementById( 'tName' ), }\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif ( !controllers.t.controller && elTime ) controllers.t.controller = elTime;\r\n\t\t\t\t\t\t\t\t\t\tif ( controllers.t ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcreateController( controllers.t, 't',\r\n\t\t\t\t\t\t\t\t\t\t\t\tfunction () { return  options.playerOptions && options.playerOptions.name ? options.playerOptions.name : 't'; }, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tonchange: function ( event ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( !options.player ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'options.controllers.t.onchange: create Player instance first. ' + controllers.t.value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( options.player.setTime( controllers.t.controller.value ) === false ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talert( lang.timeAlert + controllers.t.controller.value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrollers.t.controller.focus();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\t\t\t\tif ( ( typeof lang !== 'undefined' ) && ( controllers.t.controller.title === '' ) )\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontrollers.t.controller.title = lang.controllerTTitle;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn controllers.t;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t * getter\r\n\t\t\t\t\t\t\t\t * <pre>\r\n\t\t\t\t\t\t\t\t * List of <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> buttons on the web page.\r\n\t\t\t\t\t\t\t\t * Keys:\r\n\t\t\t\t\t\t\t\t *\t<b>buttonPrew</b>:\r\n\t\t\t\t\t\t\t\t *\t\t<b>HTMLElement</b> Previous players tick.\r\n\t\t\t\t\t\t\t\t *\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t\t\t\t\t\t *\t<b>buttonPlay</b>:\r\n\t\t\t\t\t\t\t\t *\t\t<b>HTMLElement</b> play or pause.\r\n\t\t\t\t\t\t\t\t *\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t\t\t\t\t\t *\t<b>buttonNext</b>:\r\n\t\t\t\t\t\t\t\t *\t\t<b>HTMLElement</b> Next players tick.\r\n\t\t\t\t\t\t\t\t *\t\tor <b>string</b> of <b>HTMLElement</b> id.\r\n\t\t\t\t\t\t\t\t * </pre>\r\n\t\t\t\t\t\t\t\t **/\r\n\t\t\t\t\t\t\t\tplayer: {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function () { return controllers.player; },\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t//For debugging. Find a hidden keys\r\n\t\t\t\t\t\t\tfor ( var propertyName in controllers ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( this[propertyName] === undefined ) console.error( 'Controllers: controllers.' + propertyName + ' key is hidden' );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( boCreateControllers === undefined ) {\r\n\r\n\t\t\t\t\t\tboCreateControllers = true;\r\n\t\t\t\t\t\tconst time = document.getElementById( 'time' ),\r\n\t\t\t\t\t\t\tprev = document.getElementById( 'prev' ),\r\n\t\t\t\t\t\t\tplay = document.getElementById( 'play' ),\r\n\t\t\t\t\t\t\tnext = document.getElementById( 'next' ),\r\n\t\t\t\t\t\t\tboPlayer = prev || play || next ? true : false,\r\n\t\t\t\t\t\t\tboControllers = time || boPlayer ? true : false;\r\n\t\t\t\t\t\tif ( !options.controllers && boControllers ) {\r\n\r\n\t\t\t\t\t\t\toptions.controllers = { t: {} };\r\n\t\t\t\t\t\t\tif ( time ) options.controllers.t.controller = time;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( options.controllers ) {\r\n\r\n\t\t\t\t\t\t\tif ( !options.controllers.player && boPlayer ) options.controllers.player = {};\r\n\t\t\t\t\t\t\tif ( options.controllers.player ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( !options.controllers.player.buttonPrev && prev ) options.controllers.player.buttonPrev = prev;\r\n\t\t\t\t\t\t\t\tif ( !options.controllers.player.buttonPlay && play ) options.controllers.player.buttonPlay = play;\r\n\t\t\t\t\t\t\t\tif ( !options.controllers.player.buttonNext && next ) options.controllers.player.buttonNext = next;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.controllers && !options.controllers.boControllers )\r\n\t\t\t\t\t\toptions.controllers = new Controllers( options.controllers );\r\n\t\t\t\t\treturn options.controllers;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * getter\r\n\t\t\t * <pre>\r\n\t\t\t * title\r\n\t\t\t * </pre>\r\n\t\t\t **/\r\n\t\t\ttitle: {\r\n\r\n\t\t\t\tget: function () { return options.title; }\r\n\r\n\t\t\t},\r\n\r\n\t\t} ); \r\n\r\n\t\t//For debugging. Find a hidden keys\r\n\t\tfor( var propertyName in options ) {\r\n\r\n\t\t   if ( this[propertyName] === undefined ) console.error( 'Options: options.' + propertyName + ' key is hidden' );\r\n\r\n\t\t}\r\n\t\tthis.playerOptions.cameraTarget.init( this.cameraTarget, this, false );\r\n\r\n\t\t//Localization\r\n\r\n\t\tlang = {\r\n\r\n\t\t\ttimeAlert: 'Invalid time fromat: ',\r\n\t\t\tcontrollerTTitle: 'Current time.',\r\n\r\n\t\t};\r\n\t\tswitch ( this.getLanguageCode() ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.timeAlert = 'Неправильный формат времени: ';\r\n\t\t\t\tlang.controllerTTitle = 'Текущее время.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( !three.options ) three.options = this;\r\n\r\n\t}\r\n\r\n} \r\n\r\n/**\r\n * Finds on the [Scene]{@link https://threejs.org/docs/index.html?q=Scene#api/en/scenes/Scene} a child item of the \"Sprite\" type and \"spriteTextIntersection\" name.\r\n * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=Scene#api/en/scenes/Scene} instance.\r\n * @returns item of the \"Sprite\" type and \"spriteTextIntersection\" name or undefined.\r\n */\r\nOptions.findSpriteTextIntersection = function ( scene ) {\r\n\r\n\tvar spriteTextIntersection;\r\n\tscene.children.forEach( function ( item ) {\r\n\r\n\t\tif ( ( item.type === \"Sprite\" ) && ( item.name === Options.findSpriteTextIntersection.spriteTextIntersectionName ) ) {\r\n\r\n\t\t\tspriteTextIntersection = item;\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t} );\r\n\treturn spriteTextIntersection;\r\n\r\n}\r\n/**\r\n * @returns \"spriteTextIntersection\"\r\n * */\r\nOptions.findSpriteTextIntersection.spriteTextIntersectionName = 'spriteTextIntersection';\r\n\r\nclass Raycaster {\r\n\r\n\t/**\r\n\t * [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} methods.\r\n\t * */\r\n\tconstructor() {\r\n\r\n\t\tvar cursor;\r\n\t\t/**\r\n\t\t * @description Displays a sprite text if you move mouse over an 3D object\r\n\t\t * @param {Object} intersection See [.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t\t * @param {Options} options the following options are available.\r\n\t\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {object} [options.spriteText] spriteText options. See <a href=\"../../SpriteText/jsdoc/module-SpriteText.html\" target=\"_blank\">SpriteText</a> <b>options</b> parameter for details.\r\n\t\t * @param {object} [options.scales] axes scales.\r\n\t\t * See <b>options.scales</b> parameter of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> class for details.\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=sc#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera}.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer} instance.\r\n\t\t */\r\n\t\tthis.onIntersection = function ( intersection, options, scene, camera, renderer ) {\r\n\r\n\t\t\tconst canvas = renderer.domElement;\r\n\t\t\tif ( intersection.object.userData.isInfo !== undefined && !intersection.object.userData.isInfo() )\r\n\t\t\t\treturn;\r\n\t\t\tvar spriteTextIntersection = Options.findSpriteTextIntersection( scene );\r\n\t\t\tif ( spriteTextIntersection && ( !intersection.pointSpriteText || ( intersection.object.userData.raycaster && intersection.object.userData.raycaster.text ) ) ) {\r\n\t\t\t\t\r\n\t\t\t\tscene.remove( spriteTextIntersection );\r\n\t\t\t\tspriteTextIntersection = undefined;\r\n\r\n\t\t\t}\r\n\t\t\tif ( spriteTextIntersection === undefined ) {\r\n\r\n\t\t\t\toptions = new Options( options );\r\n\t\t\t\tconst rect = options.spriteText.rect ? JSON.parse( JSON.stringify( options.spriteText.rect ) ) : {};\r\n\t\t\t\trect.displayRect = true;\r\n\t\t\t\trect.backgroundColor = 'rgba(0, 0, 0, 1)';\r\n\t\t\t\tspriteTextIntersection = StereoEffect.getTextIntersection( intersection, {\r\n\r\n\t\t\t\t\tscales: options.scales,\r\n\t\t\t\t\tspriteOptions: {\r\n\r\n\t\t\t\t\t\ttextHeight: options.spriteText.textHeight,\r\n\t\t\t\t\t\tfontColor: options.spriteText.fontColor,\r\n\t\t\t\t\t\trect: rect,\r\n\t\t\t\t\t\tgroup: scene,\r\n\t\t\t\t\t\tcenter: {\r\n\r\n\t\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\t\tcanvas: canvas,\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tspriteTextIntersection.scale.divide( scene.scale );\r\n\t\t\t\tscene.add( spriteTextIntersection );\r\n\t\t\t\t\r\n\t\t\t\tif ( cursor === undefined ) cursor = renderer.domElement.style.cursor;\r\n\t\t\t\trenderer.domElement.style.cursor = 'pointer';\r\n\r\n\t\t\t} else if ( intersection.pointSpriteText ) spriteTextIntersection.position.copy( intersection.pointSpriteText );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @description Hides a sprite text if you move mouse out an object.\r\n\t\t * @param {THREE.Scene} scene [Scene]{@link https://threejs.org/docs/index.html?q=sc#api/en/scenes/Scene}.\r\n\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer} instance.\r\n\t\t */\r\n\t\tthis.onIntersectionOut = function ( scene, renderer ) {\r\n\r\n\t\t\tvar detected = false;\r\n\t\t\tdo {\r\n\r\n\t\t\t\tvar spriteTextIntersection = Options.findSpriteTextIntersection( scene );\r\n\t\t\t\tif ( spriteTextIntersection !== undefined ) {\r\n\r\n\t\t\t\t\tscene.remove( spriteTextIntersection );\r\n\t\t\t\t\tif ( detected )\r\n\t\t\t\t\t\tconsole.error( 'Duplicate spriteTextIntersection' );\r\n\t\t\t\t\tdetected = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} while ( spriteTextIntersection !== undefined )\r\n\r\n\t\t\trenderer.domElement.style.cursor = cursor;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * @description The [pointerdown]{@link https://developer.mozilla.org/en-US/docs/Web/API/Document/pointerdown_event}\r\n\t\t * event is fired when a pointer becomes active. For mouse, it is fired when the device transitions from no buttons depressed to at least one button depressed. For touch, it is fired when physical contact is made with the digitizer. For pen, it is fired when the stylus makes physical contact with the digitizer.\r\n\t\t * @param {Object} intersection See [.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t\t * @param {Options} options the following options are available.\r\n\t\t * @param {GuiSelectPoint} [options.guiSelectPoint] <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a> instance was created.\r\n\t\t * @param {AxesHelper} [options.axesHelper] <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a> instance was created.\r\n\t\t */\r\n\t\tthis.onMouseDown = function ( intersection, options ) {\r\n\r\n\t\t\tif ( ( intersection.object.userData.isInfo !== undefined ) && !intersection.object.userData.isInfo() )\r\n\t\t\t\treturn;//No display information about frustum point\r\n\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\toptions.guiSelectPoint.select( intersection );\r\n\t\t\telse {\r\n\r\n\t\t\t\tif ( intersection.object.userData.onMouseDown ) intersection.object.userData.onMouseDown( intersection );\r\n\t\t\t\tif ( options.axesHelper ) options.axesHelper.exposePosition( intersection );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tconst intersectedObjects = [];\r\n\t\tvar intersects;\r\n\t\t/**\r\n\t\t * @description Intersection of the mouse pointer in or out of a 3D object.\r\n\t\t * @param {Array} particles array of [Mechs]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class objects to check for intersection with the ray.\r\n\t\t * See <a href=\"../../jsdoc/Options/Raycaster_EventListeners.html#addParticle\" target=\"_blank\">addParticle</a>.\r\n\t\t * @param {THREE.Raycaster} raycaster [Raycaster]{@link https://threejs.org/docs/index.html?q=Ray#api/en/core/Raycaster}\r\n\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html?q=Renderer#api/en/renderers/WebGLRenderer}\r\n\t\t * @param {THREE.Vector2} mouse mouse position.\r\n\t\t * @param {Object} [settings={}] the following settings are available\r\n\t\t * @param {Options} [settings.options={}] <b>Options</b> instance\r\n\t\t * @param {THREE.Camera} settings.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera} instance\r\n\t\t * @param {THREE.Scene} settings.scene [Scene]{@link https://threejs.org/docs/index.html?q=scene#api/en/scenes/Scene} instance.\r\n\t\t * @returns Array of interseted with ray 3D objects. \r\n\t\t * See [intersectObjects]{@link https://threejs.org/docs/index.html?q=raycaster#api/en/core/Raycaster.intersectObjects}\r\n\t\t * and [intersectObject]{@link https://threejs.org/docs/index.html?q=raycaster#api/en/core/Raycaster.intersectObject}.\r\n\t\t */\r\n\t\tthis.intersectionsInOut = function ( particles, raycaster, renderer, mouse, settings = {} ) {\r\n\r\n\t\t\tfunction getIntersects() {\r\n\r\n\t\t\t\tif ( particles === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tintersects = Array.isArray( particles ) ? raycaster.intersectObjects( particles ) : raycaster.intersectObject( particles );\r\n\r\n\t\t\t}\r\n\t\t\tgetIntersects();\r\n\t\t\tintersects.forEach( function ( intersection ) {\r\n\r\n\t\t\t\t//Когда создаем SpriteText с информацией об объекте, на которую наведена мышка,\r\n\t\t\t\t//иногда этот текст загораживается объектами, которые расположены ближе к камере\r\n\t\t\t\t//Для решения проблемы текст надо перенести ближе к камере\r\n\t\t\t\tconst three = window.__myThree__.three;\r\n\t\t\t\tintersection.pointSpriteText = new three.THREE.Vector3();\r\n\t\t\t\t//Так и не понял почему в режиме стерео текст отображается в неправильном месте\r\n\t\t\t\tif ( settings.options.stereoEffect && ( settings.options.stereoEffect.settings.spatialMultiplex === StereoEffect.spatialMultiplexsIndexs.Mono ) )\r\n\t\t\t\t\traycaster.ray.at( three.options.camera.near + (three.options.camera.far - three.options.camera.near)/1000, intersection.pointSpriteText );\r\n\t\t\t\t//Поэтому оставляю как было раньше\r\n\t\t\t\telse intersection.pointSpriteText = intersection.point;\r\n\r\n\t\t\t\tvar boDetected = false;\r\n\t\t\t\tintersectedObjects.forEach( function ( intersectedObject ) {\r\n\r\n\t\t\t\t\tif ( intersectedObject.object === intersection.object ) {\r\n\r\n\t\t\t\t\t\tboDetected = true;\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tif ( !boDetected ) {\r\n\r\n\t\t\t\t\tintersectedObjects.push( intersection );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (\r\n\t\t\t\t\tintersection &&\r\n\t\t\t\t\tintersection.object.userData.raycaster &&\r\n\t\t\t\t\tintersection.object.userData.raycaster.onIntersection\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tintersection.object.userData.raycaster.onIntersection( intersection, mouse );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( !settings.scene )\r\n\t\t\t\t\t\tconsole.error( 'THREE.Raycaster.setStereoEffect(): settings.scene = ' + settings.scene );\r\n\t\t\t\t\telse Options.raycaster.onIntersection( intersection, settings.options, settings.scene, settings.camera, renderer );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\t\t\tintersectedObjects.forEach( function ( intersectedObject ) {\r\n\r\n\t\t\t\tvar boDetected = false;\r\n\t\t\t\tintersects.forEach( function ( intersection ) {\r\n\r\n\t\t\t\t\tif ( intersectedObject.object === intersection.object )\r\n\t\t\t\t\t\tboDetected = true;\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tif ( !boDetected ) {\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tintersectedObject.object.userData.raycaster &&\r\n\t\t\t\t\t\tintersectedObject.object.userData.raycaster.onIntersectionOut\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tintersectedObject.object.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\telse if ( settings.scene ) Options.raycaster.onIntersectionOut( settings.scene, renderer );\r\n\r\n\t\t\t\t\tintersectedObjects.splice( intersectedObjects.findIndex( v => v === intersectedObject ), 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\t\t\treturn intersects;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @class\r\n\t\t */\r\n\t\tthis.EventListeners = class {\r\n\r\n\t\t\t/**\r\n\t\t\t * Create a mouse events listeners for [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} instance.\r\n\t\t\t * <p>\r\n\t\t\t * The following events are listening.\r\n\t\t\t *\t<ul>\r\n\t\t\t *\t\t<li><b>mousemove</b>. Is fired at an element when a pointing device (usually a mouse) is moved while the cursor's hotspot is inside it.\r\n\t\t\t *\t\t\tSee [Element: mousemove event]{@link https://developer.mozilla.org/en-US/docs/Web/API/Element/mousemove_event}. </li>\r\n\t\t\t *\t\t<li><b>pointerdown</b>. Is fired when a pointer becomes active. For mouse, it is fired when the device transitions from no buttons depressed to at least one button depressed. For touch, it is fired when physical contact is made with the digitizer. For pen, it is fired when the stylus makes physical contact with the digitizer.\r\n\t\t\t *\t\t\tSee [Document: pointerdown event]{@link https://developer.mozilla.org/en-US/docs/Web/API/Document/pointerdown_event}. </li>\r\n\t\t\t *\t</ul>\r\n\t\t\t * </p>\r\n\t\t\t * <p>\r\n\t\t\t * You can customize your 3D object for following events by add <b>raycaster</b> property into [Object3D.userData]{@link https://threejs.org/docs/index.html?q=mes#api/en/core/Object3D.userData}.\r\n\t\t\t *\t<ul>\r\n\t\t\t *\t\t<li><b>onIntersection</b>. Callback function that take as input the [intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject}, and <b>mouse position</b>.\r\n\t\t\t *\t\t\tFires after intersection of the mouse pointer with a 3D object. </li>\r\n\t\t\t *\t\t<li><b>onIntersectionOut</b>. Callback function.\r\n\t\t\t *\t\t\tFires if mouse pointer leaves of intersection with the 3D object.</li>\r\n\t\t\t *\t\t<li><b>onMouseDown</b>. Callback function that take as input the [intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject}.\r\n\t\t\t *\t\t\tUser has clicked over 3D object.</li>\r\n\t\t\t *\t</ul>\r\n\t\t\t * </p>\r\n\t\t\t * <pre>\r\n\t\t\t * Example:<b>\r\ncube.userData.raycaster = {\r\n\r\n\tonIntersection: function ( intersection, mouse ) {\r\n\r\n\t\tif ( cube.userData.currentHex === undefined )\r\n\t\t\tcube.userData.currentHex = cube.material.emissive.getHex();\r\n\t\tcube.material.emissive.setHex( 0xff0000 );\r\n\t\tOptions.raycaster.onIntersection( intersection, options, group, camera, renderer );\r\n\r\n\t},\r\n\tonIntersectionOut: function () {\r\n\r\n\t\tif ( cube.userData.currentHex !== undefined )\r\n\t\t\tcube.material.emissive.setHex( cube.userData.currentHex );\r\n\t\tcube.userData.currentHex = undefined;\r\n\t\tOptions.raycaster.onIntersectionOut( group, renderer );\r\n\r\n\t},\r\n\tonMouseDown: function ( intersection ) {\r\n\r\n\t\talert( 'Clicked over cube.' );\r\n\r\n\t},\r\n\r\n}\r\n\t\t\t * </b></pre>\r\n\t\t\t * @param {THREE.Camera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html?q=persp#api/en/cameras/PerspectiveCamera} instance\r\n\t\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer} instance\r\n\t\t\t * @param {Object} [settings={}] the following settings are available\r\n\t\t\t * @param {Options} [settings.options={}] <b>Options</b> instance\r\n\t\t\t * @param {number} [settings.threshold=0.03] Precision of the raycaster when intersecting objects, in world units.\r\n\t\t\t * See [Raycaster.params]{@link https://threejs.org/docs/#api/en/core/Raycaster.params}.\r\n\t\t\t */\r\n\t\t\tconstructor( camera, renderer, settings = {} ) {\r\n\r\n\t\t\t\tvar intersectedObject;//, intersects;\r\n\t\t\t\tconst THREE = three.THREE, mouse = new THREE.Vector2(), particles = [],\r\n\t\t\t\t\traycaster = new THREE.Raycaster(), options = settings.options || {};\r\n\t\t\t\traycaster.params.Points.threshold = settings.threshold !== undefined ? settings.threshold : 0.03;\r\n\t\t\t\traycaster.params.Line.threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t\tif ( raycaster.setStereoEffect ) {\r\n\r\n\t\t\t\t\t//the precision of the raycaster when intersecting objects, in world units.\r\n\t\t\t\t\t//See https://threejs.org/docs/#api/en/core/Raycaster.params.\r\n\r\n\t\t\t\t\traycaster.setStereoEffect( {\r\n\r\n\t\t\t\t\t\toptions: settings.options,\r\n\t\t\t\t\t\trenderer: renderer,\r\n\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\tscene: settings.scene,\r\n\t\t\t\t\t\tstereoEffect: options.stereoEffect,\r\n\t\t\t\t\t\traycasterEvents: false,\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst domElement = options.renderer ? options.renderer.domElement : window;\r\n\t\t\t\t\r\n\t\t\t\t//Is fired at an element when a pointing device (usually a mouse) is moved while the cursor's hotspot is inside it.\r\n\t\t\t\t//See https://developer.mozilla.org/en-US/docs/Web/API/Element/mousemove_event\r\n\t\t\t\tdomElement.addEventListener( 'mousemove', function ( event ) {\r\n\r\n\t\t\t\t\tif ( raycaster.stereo !== undefined ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.onDocumentMouseMove( event );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tOptions.raycaster.EventListeners.getRendererSize( renderer ).getMousePosition( mouse, event );\r\n\r\n\t\t\t\t\t//Raycaster https://threejs.org/docs/index.html#api/en/core/Raycaster\r\n\r\n\t\t\t\t\t// update the picking ray with the camera and mouse position\r\n\t\t\t\t\traycaster.setFromCamera( mouse, camera );\r\n\t\t\t\t\t// calculate objects intersecting the picking ray\r\n\t\t\t\t\tintersects = raycaster.intersectObjects( particles );\r\n\t\t\t\t\tif ( !intersects )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( intersects.length === 0 ) {\r\n\r\n\t\t\t\t\t\tif ( intersectedObject ) {\r\n\r\n\t\t\t\t\t\t\tif ( intersectedObject.userData.raycaster && intersectedObject.userData.raycaster.onIntersectionOut )\r\n\t\t\t\t\t\t\t\tintersectedObject.userData.raycaster.onIntersectionOut();\r\n\t\t\t\t\t\t\telse Options.raycaster.onIntersectionOut( settings.scene, renderer );\r\n\t\t\t\t\t\t\tintersectedObject = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconst intersect = intersects[0], object = intersect.object;\r\n\t\t\t\t\t\tif ( object.userData.raycaster && object.userData.raycaster.onIntersection ) object.userData.raycaster.onIntersection( intersect, mouse );\r\n\t\t\t\t\t\telse Options.raycaster.onIntersection( intersect, options, settings.scene, camera, renderer );\r\n\t\t\t\t\t\tintersectedObject = object;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\r\n\t\t\t\t//ATTENTION!!! The 'mousedown' event is not fired you use new version of the OrbitControls.\r\n\t\t\t\t//See \"OrbitControls: Implement Pointer events.\" commit https://github.com/mrdoob/three.js/commit/1422e36e9facbdc5f9d86cf6b97b005a2723a24a#diff-3285de3826a51619836a5c9adc6bee74\r\n\t\t\t\t//window.addEventListener( 'mousedown', function( event )\r\n\t\t\t\t//is fired when a pointer becomes active. For mouse, it is fired when the device transitions from no buttons depressed to at least one button depressed. For touch, it is fired when physical contact is made with the digitizer. For pen, it is fired when the stylus makes physical contact with the digitizer.\r\n\t\t\t\t//See https://developer.mozilla.org/en-US/docs/Web/API/Document/pointerdown_event\r\n\t\t\t\tdomElement.addEventListener( 'pointerdown', function ( event ) {\r\n\r\n\t\t\t\t\tif ( raycaster === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( intersects && ( intersects.length > 0 ) ) {\r\n\r\n\t\t\t\t\t\tconst intersect = intersects[0];\r\n\t\t\t\t\t\tif ( intersect.object.userData.raycaster && intersect.object.userData.raycaster.onMouseDown )\r\n\t\t\t\t\t\t\tintersect.object.userData.raycaster.onMouseDown( intersect, event );//передаем состояние кнопок мыши\r\n\t\t\t\t\t\telse Options.raycaster.onMouseDown( intersect, options );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}, false );\r\n\t\t\t\tfunction isAddedToParticles( particle ) { return particles.includes( particle ); };\r\n\t\t\t\t/**\r\n\t\t\t\t * Adds new particle into array of objects to check for intersection with the ray.\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} or derived class instance for check for intersection with the ray.\r\n\t\t\t\t */\r\n\t\t\t\tthis.addParticle = function ( particle ) {\r\n\r\n\t\t\t\t\tif ( particle.userData.boFrustumPoints )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( raycaster.stereo ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.addParticle( particle );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( isAddedToParticles( particle ) ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Duplicate particle \"' + particle.name + '\"' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparticles.push( particle );\r\n\r\n\t\t\t\t};\r\n\t\t\t\t/**\r\n\t\t\t\t * Removes particle from array of objects to check for intersection with the ray.\r\n\t\t\t\t * @see <b>objects</b> parameter of the [Raycaster.intersectObjects]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObjects} for details.\r\n\t\t\t\t * @param {THREE.Mesh} particle The [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for removing.\r\n\t\t\t\t */\r\n\t\t\t\tthis.removeParticle = function ( particle ) {\r\n\r\n\t\t\t\t\tif ( particle.userData.boFrustumPoints )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( raycaster.stereo ) {\r\n\r\n\t\t\t\t\t\traycaster.stereo.removeParticle( particle );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst index = particles.indexOf( particle );\r\n\t\t\t\t\tif ( index === -1 ) return;\r\n\t\t\t\t\tparticles.splice( index, 1 );\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Convert mouse position to renderer coordinates.\r\n\t\t\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n\t\t\t * @param {HTMLElement} [el] parent of the <b>canvas</b>.\r\n\t\t\t * @returns <pre>\r\n\t\t\t * {\r\n\t\t\t *\r\n\t\t\t *\tgetMousePosition:function\r\n\t\t\t *\r\n\t\t\t * }\r\n\t\t\t * </pre>\r\n\t\t\t */\r\n\t\t\tstatic getRendererSize( renderer, el ) {\r\n\r\n\t\t\t\tel = el || renderer.domElement;\r\n\t\t\t\tconst style = {\r\n\r\n\t\t\t\t\tposition: el.style.position,\r\n\t\t\t\t\tleft: el.style.left,\r\n\t\t\t\t\ttop: el.style.top,\r\n\t\t\t\t\twidth: el.style.width,\r\n\t\t\t\t\theight: el.style.height,\r\n\r\n\t\t\t\t},\r\n\t\t\t\t\trect = el.getBoundingClientRect(),\r\n\t\t\t\t\tleft = Math.round( rect.left ),\r\n\t\t\t\t\ttop = Math.round( rect.top ),\r\n\t\t\t\t\tsize = new three.THREE.Vector2();\r\n\t\t\t\trenderer.getSize( size );\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tgetMousePosition: function ( mouse, event ) {\r\n\r\n\t\t\t\t\t\tmouse.x = ( event.clientX / size.x ) * 2 - 1 - ( left / size.x ) * 2;\r\n\t\t\t\t\t\tmouse.y = - ( event.clientY / size.y ) * 2 + 1 + ( top / size.y ) * 2;\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n/**@namespace\r\n * @description [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} methods.\r\n * @See <a href=\"./Raycaster.html\" target=\"_blank\">Raycaster</a> for details.\r\n * */\r\nOptions.raycaster = new Raycaster();\r\n\r\nexport default Options;","/**\r\n * @module Player\r\n * @description 3D objects animation.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport ScaleController from '../ScaleController.js';\r\nimport PositionController from '../PositionController.js';\r\nimport { controllers } from '../dat.gui/CustomController/build/dat.gui.module.js';\r\n\r\nimport {\r\n\r\n\tgetWorldPosition,\r\n\tgetObjectLocalPosition,\r\n\tgetObjectPosition,\r\n\r\n} from '../getPosition.js';\r\n\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\nimport { createController } from '../controller.js'\r\n\r\n/**\r\n * @callback onSelectScene\r\n * @description This function is called at each new step of the playing. See <b>settings.onSelectScene</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @param {number} index current index of the scene of the animation\r\n * @param {number} t current time\r\n */\r\n\r\n/**\r\n * @callback onChangeScaleT\r\n * @description User has updated the time settings. See <b>settings.onChangeScaleT</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @param {object} scale the updated time settings\r\n */\r\n\r\nclass Player {\r\n\r\n\t/**\r\n\t * 3D objects animation.\r\n\t * @class\r\n\t * @param {THREE.Group|THREE.Scene} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the meshes for playing.\r\n\t * @param {Object} [settings={}] the following settings are available\r\n\t * \r\n\t * @param {Options} [settings.options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean} [settings.options.dat.playerGui] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player.html#gui\" target=\"_blank\">Player controllers</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [settings.options.dat.playController] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">PlayController</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {Object} [settings.options.playerOptions] Player settings.\r\n\t * @param {number} [settings.options.playerOptions.min=0] Start time of the playing.\r\n\t * @param {number} [settings.options.playerOptions.max=1] Stop time of the playing.\r\n\t * @param {number} [settings.options.playerOptions.marks=10] Ticks count of the playing. Number of scenes of 3D objects animation.\r\n\t * Have effect for <b>max</b> is not Infinity.\r\n\t * @param {number} [settings.options.playerOptions.selectSceneIndex=0] current time index.\r\n\t * <pre>\r\n\t * Legal interval from 0 to to <b>marks - 1</b>.\r\n\t * If <b>selectSceneIndex</b> = 0 then time = <b>min</b>.\r\n\t * If <b>selectSceneIndex</b> = <b>marks - 1</b> then time = <b>max</b>.\r\n\t * <pre>\r\n\t * @param {number} [settings.options.playerOptions.dt=0.1] Step of the animation. Have effect only if <b>max</b> is infinity.\r\n\t * @param {boolean} [settings.options.playerOptions.repeat=false] true - Infinitely repeating 3D objects animation.\r\n\t * @param {number} [settings.options.playerOptions.interval=1] Ticks per seconds.\r\n\t * @param {number} [settings.options.playerOptions.zoomMultiplier=1.1] zoom multiplier of the time.\r\n\t * @param {number} [settings.options.playerOptions.offset=0.1] offset of the time.\r\n\t * @param {number} [settings.options.playerOptions.name=\"\"] name of the time.\r\n\t * @param {boolean} [settings.options.player] false - do not create a <b>Player</b> instance.\r\n\t *\r\n\t * @param {onSelectScene} [settings.onSelectScene] This function is called at each new step of the playing. See <a href=\"../../player/jsdoc/module-Player.html#~onSelectScene\" target=\"_blank\">onSelectScene</a>.\r\n\t * @param {onChangeScaleT} [settings.onChangeScaleT] event. User has updated the time settings. See <a href=\"../../player/jsdoc/module-Player.html#~onChangeScaleT\" target=\"_blank\">onChangeScaleT</a>.\r\n\t * @param {FrustumPoints} [settings.frustumPoints] See <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a>.\r\n\t * Have effect only if <b>settings.options</b> is not defined.\r\n\t * @param {THREE.PerspectiveCamera} settings.cameraTarget.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t */\r\n\tconstructor( group, settings={} ) {\r\n\r\n\t\tassign();\r\n\r\n\t\tif ( !settings.options && settings.frustumPoints ) settings.options = settings.frustumPoints.getOptions();\r\n\t\tsettings.options = settings.options || new Options();\r\n\t\tconst options = settings.options;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'Player: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tif ( options.player === false ) return;\r\n\r\n\t\toptions.boPlayer = options.boPlayer || false;\r\n\r\n\t\t//если тут создавать палитру то она не создастся если не создается плееер\r\n\t\t//palette = new palette();\r\n\r\n\t\tif ( options.player ) {\r\n\r\n\t\t\tconsole.error( 'Player: duplicate player.' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\toptions.player = this;\r\n\r\n\t\tsettings.cameraTarget = settings.cameraTarget || {};\r\n\r\n\t\t/**\r\n\t\t * @description This function is called at each new step of the playing.\r\n\t\t * @param {number} [index=0] current index of the scene of the animation\r\n\t\t */\r\n\t\tfunction onSelectScene( index ) {\r\n\r\n\t\t\tindex = index || 0;\r\n\t\t\tconst t = _this.getTime();\r\n\t\t\tPlayer.selectPlayScene( group, { t: t, index: index, options: settings.options } );\r\n\t\t\t_this.setIndex( index, ( options.playerOptions.name === '' ? '' : options.playerOptions.name + ': ' ) + t );\r\n\t\t\tif ( settings.onSelectScene ) _this.selectScenePause = settings.onSelectScene( index, t );\r\n\t\t\tif ( options.frustumPoints ) options.frustumPoints.updateCloudPoints();\r\n\r\n\t\t}\r\n\r\n\t\t//Теперь не нужно создавать color attribute на веб странице что бы цвет точек был верным еще до начала проигрывания\r\n\t\t//Кроме того трассировака начинается с нулевой точки\r\n\t\tsetTimeout( function () { onSelectScene(); }, 0 );\r\n\r\n\t\toptions.playerOptions.selectSceneIndex = options.playerOptions.selectSceneIndex || 0;\r\n\t\tvar selectSceneIndex = options.playerOptions.selectSceneIndex;\r\n\r\n\t\tconst _this = this;\r\n\r\n\t\t/**\r\n\t\t * get time\r\n\t\t */\r\n\t\tthis.getTime = function () {\r\n\r\n\t\t\tconst playerOptions = options.playerOptions, t = playerOptions.min + selectSceneIndex * playerOptions.dt;\r\n\t\t\tif ( isNaN( t ) ) console.error( 'Player.getTime(): t = ' + t );\r\n\t\t\tif ( ( playerOptions.max !== null ) && ( t > playerOptions.max ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' playerOptions.max = ' + playerOptions.max );\r\n\t\t\tif ( ( t < playerOptions.min ) && ( playerOptions.max !== null ) )\r\n\t\t\t\tconsole.error( 'Player.getTime(): t = ' + t + ' playerOptions.min = ' + playerOptions.min );\r\n\t\t\treturn t;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * set time\r\n\t\t * @param {number} t time\r\n\t\t * @returns false - invalid <b>t</b>.\r\n\t\t */\r\n\t\tthis.setTime = function ( t ) {\r\n\r\n\t\t\treturn this.selectScene( parseInt( ( t - options.playerOptions.min ) / options.playerOptions.dt ) );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * select scene for playing\r\n\t\t * @param {number} index Index of the scene. Range from 0 to options.playerOptions.marks - 1\r\n\t\t * @returns false - invalid <b>index</b>.\r\n\t\t */\r\n\t\tthis.selectScene = function ( index ) {\r\n\r\n\t\t\tif ( index === undefined ) {\r\n\r\n\t\t\t\tonSelectScene( selectSceneIndex );\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\t\t\tif ( isNaN( index ) ) {\r\n\r\n\t\t\t\tconsole.error( 'Player.selectScene: index = ' + index );\r\n\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tindex = parseInt( index );\r\n\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\tif ( index >= options.playerOptions.marks )\r\n\t\t\t\t\tindex = 0;\r\n\t\t\t\telse if ( index < 0 )\r\n\t\t\t\t\tindex = options.playerOptions.marks - 1;\r\n\t\t\t\tif ( selectSceneIndex > options.playerOptions.marks )\r\n\t\t\t\t\tselectSceneIndex = options.playerOptions.marks;\r\n\r\n\t\t\t}\r\n\t\t\twhile ( selectSceneIndex !== index ) {\r\n\r\n\t\t\t\tif ( selectSceneIndex < index )\r\n\t\t\t\t\tselectSceneIndex++;\r\n\t\t\t\telse selectSceneIndex--;\r\n\t\t\t\tonSelectScene( selectSceneIndex );\r\n\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to next animation scene\r\n\t\t */\r\n\t\tthis.next = function () {\r\n\r\n\t\t\t_this.selectScene( selectSceneIndex + 1 );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Go to previous animation scene\r\n\t\t */\r\n\t\tthis.prev = function () {\r\n\r\n\t\t\t_this.selectScene( selectSceneIndex - 1 );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Add controller into controllers array\r\n\t\t * @param {controller} controller\r\n\t\t */\r\n\t\tthis.pushController = function ( controller ) {\r\n\r\n\t\t\tif ( ( controller.object !== undefined ) && ( controller.object.playRate !== undefined ) )\r\n\t\t\t\tcontroller.object.playRate = options.playerOptions.min;\r\n\t\t\tthis.controllers.push( controller );\r\n\r\n\t\t}\r\n\r\n\t\t//Play/Pause\r\n\r\n\t\tthis.controllers = [];\r\n\t\tvar playing = false, time, timeNext;\r\n\r\n\t\tfunction RenamePlayButtons() {\r\n\r\n\t\t\toptions.player.controllers.forEach( function ( controller ) { if ( controller.onRenamePlayButtons ) controller.onRenamePlayButtons( playing ); } );\r\n\r\n\t\t}\r\n\r\n\t\tfunction play() {\r\n\r\n\t\t\tif (\r\n\t\t\t\t( selectSceneIndex === -1 ) ||\r\n\t\t\t\t(\r\n\t\t\t\t\t( selectSceneIndex === options.playerOptions.marks ) &&\r\n\t\t\t\t\t( options.playerOptions.max !== null )\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\r\n\t\t\t\tselectSceneIndex = 0;\r\n\r\n\t\t\t}\r\n\t\t\tonSelectScene( selectSceneIndex );\r\n\r\n\t\t}\r\n\r\n\t\tfunction pause() {\r\n\r\n\t\t\tplaying = false;\r\n\t\t\tRenamePlayButtons();\r\n\r\n\t\t\ttime = undefined;\r\n\r\n\t\t}\r\n\t\tfunction isRepeat() {\r\n\r\n\t\t\treturn options.playerOptions.repeat;\r\n\r\n\t\t}\r\n\r\n\t\tfunction playNext() {\r\n\r\n\t\t\tselectSceneIndex++;\r\n\t\t\tif ( ( options.playerOptions.max !== null ) && selectSceneIndex >= options.playerOptions.marks ) {\r\n\r\n\t\t\t\tif ( isRepeat() )\r\n\t\t\t\t\tselectSceneIndex = 0;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\t//Для вычисления текущего времени в случае:\r\n\t\t\t\t\t//1. Запустить плеер и дождаться когда проигрывание остановится после достижения максимального времени\r\n\t\t\t\t\t//2. В guiSelectPoint выбрать точку, цвет которой зависит от времени\r\n\t\t\t\t\t//Тогда если убрать эту строку, то selectSceneIndex и время окажется за диапазоном допустимых значений\r\n\t\t\t\t\t//и цвет точки окажется неверным\r\n\t\t\t\t\tselectSceneIndex = options.playerOptions.marks - 1;\r\n\r\n\t\t\t\t\tpause();\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tplay();\r\n\r\n\t\t}\r\n\r\n\t\tfunction step(timestamp) {\r\n\r\n\t\t\tif (_this.selectScenePause) return;//При построении сцены был применен ProgressBar. Поэтому возврат из options.onSelectScene произошел еще до построения сцены. Нужно приостановить проигрывание, пока сцена не построится.\r\n\t\t\tif (playing)\r\n\t\t\t\twindow.requestAnimationFrame(step);\r\n\t\t\telse time = undefined;\r\n\r\n\t\t\tif (time === undefined) {\r\n\r\n\t\t\t\ttime = timestamp;\r\n\t\t\t\ttimeNext = time + 1000 / options.playerOptions.interval;\r\n\r\n\t\t\t}\r\n\t\t\tif (isNaN(timeNext) || (timeNext === Infinity)) {\r\n\r\n\t\t\t\tconsole.error('Player.animate: timeNext = ' + timeNext);\r\n\t\t\t\tplaying = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (timestamp < timeNext)\r\n\t\t\t\treturn;\r\n\t\t\twhile (timestamp > timeNext)\r\n\t\t\t\ttimeNext += 1000 / options.playerOptions.interval;\r\n\t\t\tplayNext();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * User has clicked the Play ► / Pause ❚❚ button\r\n\t\t */\r\n\t\tthis.play3DObject = function () {\r\n\r\n\t\t\tif ( playing ) {\r\n\r\n\t\t\t\tpause();\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tplaying = true;\r\n\t\t\tif ( ( options.playerOptions.max !== null ) && ( selectSceneIndex >= ( options.playerOptions.marks - 1 ) ) )\r\n\t\t\t\tselectSceneIndex = 0;//-1;\r\n\t\t\tplayNext();\r\n\t\t\tRenamePlayButtons();\r\n\r\n\t\t\twindow.requestAnimationFrame( step );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * <pre>\r\n\t\t *Continue playing asynchronously.\r\n\t\t * Usual using if creating new scene to take long time.\r\n\t\t * Please call it from <b>settings.options.onSelectScene()</b> function after asynchronously creating of the scene.\r\n\t\t * Return true from <b>settings.options.onSelectScene()</b> function for pause of the playing.\r\n\t\t * </pre>\r\n\t\t * @see <a href=\"../../../../egocentricUniverse/master/jsdoc\" target=\"_blank\">example</a>\r\n\t\t */\r\n\t\tthis.continue = () => {\r\n\r\n\t\t\t_this.selectScenePause = false;\r\n\t\t\twindow.requestAnimationFrame(step);\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * User has clicked the repeat ⥀ button\r\n\t\t */\r\n\t\tthis.repeat = function () {\r\n\r\n\t\t\toptions.playerOptions.repeat = !options.playerOptions.repeat;\r\n\t\t\tthis.onChangeRepeat( options.playerOptions.repeat );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns Player settings.\r\n\t\t */\r\n\t\tthis.getSettings = function () { return settings; }\r\n\t\t/**\r\n\t\t * @returns selected scene index.\r\n\t\t */\r\n\t\tthis.getSelectSceneIndex = function () { return selectSceneIndex; }\r\n\r\n\t\t/**@namespace\r\n\t\t * @descriptionUser has pressed the <b>Repeat</b> button of the <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">Player.PlayController</a>.\r\n\t\t * @param {boolean} value true - repeat is off\r\n\t\t * <p>false - repeat is on</p>\r\n\t\t */\r\n\t\tthis.onChangeRepeat = function ( value ) {\r\n\r\n\t\t\toptions.playerOptions.repeat = value;\r\n\t\t\tthis.controllers.forEach( function ( controller ) { if ( controller.onChangeRepeat ) controller.onChangeRepeat(); } );\r\n\r\n\t\t}\r\n\r\n\t\t//Localization\r\n\t\tfunction getLang( params ) {\r\n\r\n\t\t\tparams = params || {};\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tplayer: 'Player',\r\n\t\t\t\tplayerTitle: '3D objects animation.',\r\n\r\n\t\t\t\tmin: 'Min',\r\n\t\t\t\tmax: 'Max',\r\n\t\t\t\tdt: 'Step',\r\n\t\t\t\tdtTitle: 'Time between frames',\r\n\r\n\t\t\t\tmarks: 'Frames',\r\n\t\t\t\tmarksTitle: 'Player frames count',\r\n\r\n\t\t\t\tinterval: 'Rate',\r\n\t\t\t\tintervalTitle: 'Rate of changing of animation scenes per second.',\r\n\r\n\t\t\t\ttime: 'Time',\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\tdefaultTitle: 'Restore default player settings.',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = params.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t\t: params.getLanguageCode();\r\n\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.player = 'Проигрыватель';\r\n\t\t\t\t\tlang.playerTitle = 'Анимация 3D объектов.';\r\n\r\n\t\t\t\t\tlang.min = 'Минимум';\r\n\t\t\t\t\tlang.max = 'Максимум';\r\n\t\t\t\t\tlang.dt = 'Шаг';\r\n\t\t\t\t\tlang.dtTitle = 'Веремя между кадрами';\r\n\r\n\t\t\t\t\tlang.marks = 'Кадры';\r\n\t\t\t\t\tlang.marksTitle = 'Количество кадров проигрывателя';\r\n\r\n\t\t\t\t\tlang.interval = 'Темп',\r\n\t\t\t\t\t\tlang.intervalTitle = 'Скорость смены кадров в секунду.';\r\n\r\n\t\t\t\t\tlang.time = 'Время';\r\n\r\n\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\tlang.defaultTitle = 'Восстановить настройки проигрывателя по умолчанию.';\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault://Custom language\r\n\t\t\t\t\tif ( ( params.lang === undefined ) || ( params.lang._languageCode != _languageCode ) )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tObject.keys( params.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tif ( _lang[key] === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t_lang[key] = params.lang[key];\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn lang;\r\n\r\n\t\t}\r\n\r\n\t\t//PlayController localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tprevSymbol: '←',\r\n\t\t\tprevSymbolTitle: 'Go to previous animation scene',\r\n\t\t\tnextSymbol: '→',\r\n\t\t\tnextSymbolTitle: 'Go to next animation scene',\r\n\t\t\tplaySymbol: '►',\r\n\t\t\tplayTitle: 'Play',\r\n\t\t\tpause: '❚❚',\r\n\t\t\tpauseTitle: 'Pause',\r\n\t\t\trepeat: '⥀',\r\n\t\t\trepeatOn: 'Turn repeat on',\r\n\t\t\trepeatOff: 'Turn repeat off',\r\n\t\t\tcontrollerTitle: 'Current time.',\r\n\t\t\tstereoEffects: 'Stereo effects',\r\n\t\t\tmono: 'Mono',\r\n\t\t\tsideBySide: 'Side by side',\r\n\t\t\ttopAndBottom: 'Top and bottom',\r\n\r\n\t\t};\r\n\t\tfunction localization( getLanguageCode ) {\r\n\t\t\tswitch ( getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\t\t\t\t\tlang.prevSymbolTitle = 'Кадр назад';//'Go to previous animation scene',\r\n\t\t\t\t\tlang.playTitle = 'Проиграть';//'Play'\r\n\t\t\t\t\tlang.nextSymbolTitle = 'Кадр вперед';//'Go to next animation scene';\r\n\t\t\t\t\tlang.pauseTitle = 'Пауза';//'Pause',\r\n\t\t\t\t\tlang.repeatOn = 'Повторять проигрывание';\r\n\t\t\t\t\tlang.repeatOff = 'Остановить повтор проигрывания';\r\n\t\t\t\t\tlang.controllerTitle = 'Текущее время.';\r\n\t\t\t\t\tlang.stereoEffects = 'Стерео эффекты';\r\n\t\t\t\t\tlang.mono = 'Моно';\r\n\t\t\t\t\tlang.sideBySide = 'Слева направо';\r\n\t\t\t\t\tlang.topAndBottom = 'Сверху вниз';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/** <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">PlayController</a> localization\r\n\t\t* @param {Function} [getLanguageCode=\"en\"] Your custom getLanguageCode() function.\r\n\t\t* <pre>\r\n\t\t* returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t* Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t* See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t* Default returns the 'en' is English language.\r\n\t\t* You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t\t* </pre>\r\n\t    * @returns Names and titles of the <b>PlayController</b> controls\r\n\t\t*/\r\n\t\tthis.localization = function ( getLanguageCode = function() { return 'en' } ) {\r\n\r\n\t\t\tlocalization( getLanguageCode );\r\n\t\t\treturn lang;\r\n\r\n\t\t}\r\n\r\n\t\tthis.PlayController = class extends controllers.CustomController {\r\n\r\n\t\t\t/**\r\n\t\t\t * @class playController class for using in my version of [dat.gui]{@link https://github.com/anhr/dat.gui} for animate of 3D objects in my projects.\r\n\t\t\t * @extends dat.controllers.CustomController. See [CustomController.js]{@link https://github.com/anhr/commonNodeJS/blob/master/dat.gui/CustomController/src/dat/controllers/CustomController.js}\r\n\t\t\t * @param {GUI} [gui] [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}. Folder for controller\r\n\t\t\t */\r\n\t\t\tconstructor( gui ) {\r\n\r\n\t\t\t\tconst player = options.player, getLanguageCode = options.getLanguageCode;\r\n\t\t\t\tplayer.createControllersButtons( options );\r\n\r\n\t\t\t\tgui = gui || options.dat.gui;\r\n\t\t\t\tif ( !gui || options.dat.playController === false ) {\r\n\r\n\t\t\t\t\tsuper( {} );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlocalization( getLanguageCode );\r\n\r\n\t\t\t\tfunction addButton( innerHTML, title, onclick ) {\r\n\r\n\t\t\t\t\tconst button = document.createElement( 'span' );\r\n\t\t\t\t\tbutton.innerHTML = innerHTML;\r\n\t\t\t\t\tbutton.title = title;\r\n\t\t\t\t\tbutton.style.cursor = 'pointer';\r\n\t\t\t\t\tbutton.style.margin = '0px 2px';\r\n\t\t\t\t\tbutton.onclick = onclick;\r\n\t\t\t\t\treturn button;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar _renamePlayButtons, _renameRepeatButtons;//_selectScene, _repeat, _getGroup,\r\n\t\t\t\tconst colorOff = 'rgb(255,255,255)', colorOn = 'rgb(128,128,128)';\r\n\r\n\t\t\t\tsuper( {\r\n\r\n\t\t\t\t\tplayRate: 1,//Default play rate is 1 changes per second\r\n\t\t\t\t\tproperty: function ( customController ) {\r\n\r\n\t\t\t\t\t\tvar buttons = {};\r\n\t\t\t\t\t\tfunction RenamePlayButtons( innerHTML, title ) {\r\n\r\n\t\t\t\t\t\t\tbuttons.buttonPlay.innerHTML = innerHTML;\r\n\t\t\t\t\t\t\tbuttons.buttonPlay.title = title;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_renamePlayButtons = RenamePlayButtons;\r\n\r\n\t\t\t\t\t\tbuttons.buttonPrev = addButton( lang.prevSymbol, lang.prevSymbolTitle, player.prev );\r\n\t\t\t\t\t\tbuttons.buttonPlay = addButton( playing ? lang.pause : lang.playSymbol,\r\n\t\t\t\t\t\t\tplaying ? lang.pauseTitle : lang.playTitle, player.play3DObject );\r\n\r\n\t\t\t\t\t\tif ( player.getSettings().options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\t\t\t//Repeat button\r\n\r\n\t\t\t\t\t\t\tfunction RenameRepeatButtons( isRepeat ) {\r\n\r\n\t\t\t\t\t\t\t\tvar title, color;\r\n\t\t\t\t\t\t\t\tif ( isRepeat ) {\r\n\r\n\t\t\t\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ( buttons.buttonRepeat.title === title )\r\n\t\t\t\t\t\t\t\t\treturn;//stop of infinite recursive call\r\n\r\n\t\t\t\t\t\t\t\tbuttons.buttonRepeat.title = title;\r\n\t\t\t\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t\t\t\t\tplayer.onChangeRepeat( isRepeat );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_renameRepeatButtons = RenameRepeatButtons;\r\n\t\t\t\t\t\t\tfunction repeat( value ) {\r\n\r\n\t\t\t\t\t\t\t\tRenameRepeatButtons( buttons.buttonRepeat.title === lang.repeatOn );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar title, color;\r\n\t\t\t\t\t\t\tif ( player.getSettings().repeat ) {\r\n\r\n\t\t\t\t\t\t\t\ttitle = lang.repeatOff;\r\n\t\t\t\t\t\t\t\tcolor = colorOff;\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\ttitle = lang.repeatOn;\r\n\t\t\t\t\t\t\t\tcolor = colorOn;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbuttons.buttonRepeat = addButton( lang.repeat, title, repeat );\r\n\t\t\t\t\t\t\tbuttons.buttonRepeat.style.color = color;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbuttons.buttonNext = addButton( lang.nextSymbol, lang.nextSymbolTitle, player.next );\r\n\t\t\t\t\t\tfunction getGroup() {\r\n\r\n\t\t\t\t\t\t\treturn group;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn buttons;\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'playRate' );\r\n\t\t\t\tplayer.PlayController = this;\r\n\t\t\t\tthis.lang = lang;\r\n\t\t\t\t\r\n\t\t\t\t/** @namespace\r\n\t\t\t\t * @description Get array of THREE.Vector4 points. User has pressed the <b>Play</b> button. Rename the <b>Play</b> putton.\r\n\t\t\t\t * @param {boolean} playing true - name is \"❚❚\"\r\n\t\t\t\t * <p>false = name is \"►\"\r\n\t\t\t\t */\r\n\t\t\t\tthis.onRenamePlayButtons = function ( playing ) {\r\n\r\n\t\t\t\t\tvar name, title;\r\n\t\t\t\t\tif ( playing ) {\r\n\r\n\t\t\t\t\t\tname = lang.pause;\r\n\t\t\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_renamePlayButtons( name, title, true );\r\n\r\n\t\t\t\t}\r\n\t\t\t\t/** @namespace\r\n\t\t\t\t * @description User has pressed the <b>Repeat</b> button.\r\n\t\t\t\t */\r\n\t\t\t\tthis.onChangeRepeat = function () {\r\n\r\n\t\t\t\t\t_renameRepeatButtons( player.getSettings().options.playerOptions.repeat );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tplayer.pushController( this );\r\n\t\t\t\t/**\r\n\t\t\t\t * @param {number} value current time of the playing\r\n\t\t\t\t */\r\n\t\t\t\tthis.setValue = function ( value ) {\r\n\r\n\t\t\t\t\tthis._controller.domElement.childNodes[0].value = value;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst controler = gui.add( this );\r\n\t\t\t\t//что бы можно было вводить цифры после запятой\r\n\t\t\t\tcontroler.__truncationSuspended = true;\r\n\r\n\t\t\t}\r\n\t\t\tset controller( newController ) {\r\n\r\n\t\t\t\tthis._controller = newController;\r\n\t\t\t\tvar _this = this;\r\n\t\t\t\tthis._controller.onChange( function ( value ) { options.player.setTime( value ); /*_this.onChange( value );*/ } );\r\n\t\t\t\tthis._controller.domElement.title = this.lang.controllerTitle;\r\n\r\n\t\t\t}\r\n\t\t\tget controller() { return this._controller; }\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds a Player's controllers into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t\t * @param {GUI} [folder] Player's folder\r\n\t\t */\r\n\t\tthis.gui = function ( folder ) {\r\n\r\n\t\t\tconst cookie = options.dat.cookie,\r\n\t\t\t\tcookieName = options.dat.getCookieName( 'Player' ),\r\n\t\t\t\tgetLanguageCode = options.getLanguageCode,\r\n\t\t\t\tdat = three.dat;// options.dat.dat;\r\n\r\n\t\t\tfolder = folder || options.dat.gui;\r\n\t\t\tif ( !folder || options.dat.playerGui === false )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tfunction setDT() {\r\n\r\n\t\t\t\tif ( options.playerOptions.max === null ) options.playerOptions.dt = options.playerOptions.dt || 0.1;\r\n\t\t\t\telse options.playerOptions.dt = ( options.playerOptions.max - options.playerOptions.min ) / ( options.playerOptions.marks - 1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction setSettings() {\r\n\r\n\t\t\t\tsetDT();\r\n\t\t\t\tcookie.setObject( cookieName, options.playerOptions );\r\n\t\t\t\tif ( settings.onChangeScaleT ) settings.onChangeScaleT( options.playerOptions );\r\n\r\n\t\t\t}\r\n\t\t\tfunction setMax() {\r\n\r\n\t\t\t\tif ( options.playerOptions.max !== null )\r\n\t\t\t\t\toptions.playerOptions.max = options.playerOptions.min + options.playerOptions.dt * ( options.playerOptions.marks - 1 );\r\n\r\n\t\t\t}\r\n\t\t\tsetMax();\r\n\t\t\tconst axesDefault = JSON.parse( JSON.stringify( options.playerOptions ) ),\r\n\t\t\t\tlang = getLang( {\r\n\r\n\t\t\t\t\tgetLanguageCode: getLanguageCode,\r\n\r\n\t\t\t\t} );\r\n\t\t\tObject.freeze( axesDefault );\r\n\t\t\tconst max = options.playerOptions.max, marks = options.playerOptions.marks;\r\n\t\t\tcookie.getObject( cookieName, options.playerOptions, options.playerOptions );\r\n\t\t\tif ( ( max === null ) || ( max === Infinity ) ||\r\n\t\t\t\t( options.playerOptions.max === null )//раньше на веб странице плеер был настроен на бесконечное проигрыванияе а сейчас проигрывание ограничено по времени\r\n\t\t\t) {\r\n\r\n\t\t\t\toptions.playerOptions.max = max;\r\n\t\t\t\toptions.playerOptions.marks = marks;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst fPlayer = folder.addFolder( lang.player );\r\n\t\t\tdat.folderNameAndTitle( fPlayer, lang.player, lang.playerTitle );\r\n\r\n\t\t\tfunction scale() {\r\n\r\n\t\t\t\tconst axes = options.playerOptions,\r\n\t\t\t\t\tscaleControllers = {};\r\n\t\t\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\t\t\tvar zoom = customController.controller.getValue();\r\n\r\n\t\t\t\t\taxes.min = action( axes.min, zoom );\r\n\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\t\t\t\t\tif ( axes.max ) {\r\n\r\n\t\t\t\t\t\taxes.max = action( axes.max, zoom );\r\n\t\t\t\t\t\tsetDT();\r\n\t\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscaleControllers.folder = fPlayer.addFolder( axes.name !== '' ? axes.name : lang.time );\r\n\r\n\t\t\t\tscaleControllers.scaleController = scaleControllers.folder.add( new ScaleController( onclick,\r\n\t\t\t\t\t{ settings: settings.options.playerOptions, getLanguageCode: getLanguageCode, } ) ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.zoomMultiplier = value;\r\n\t\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\tconst positionController = new PositionController( function ( shift ) {\r\n\r\n\t\t\t\t\tonclick( positionController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\t\tvalue += shift;\r\n\t\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}, { settings: settings.options.playerOptions, getLanguageCode: getLanguageCode, } );\r\n\t\t\t\tscaleControllers.positionController = scaleControllers.folder.add( positionController ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\taxes.offset = value;\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t//min\r\n\t\t\t\tscaleControllers.min = dat.controllerZeroStep( scaleControllers.folder, axes, 'min', function ( value ) { setSettings(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.min, lang.min );\r\n\r\n\t\t\t\t//max\r\n\t\t\t\t//axes.max сейчас используется исключитьельно для удобства пользовательского интерфейса\r\n\t\t\t\t//Вместо axes.max используется axes.dt\r\n\t\t\t\tsetMax();\r\n\t\t\t\tif ( axes.max !== null ) {\r\n\r\n\t\t\t\t\tscaleControllers.max = dat.controllerZeroStep( scaleControllers.folder, axes, 'max', function ( value ) { setSettings(); } );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.max, lang.max );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t//dt\r\n\t\t\t\t\tscaleControllers.dt = dat.controllerZeroStep( scaleControllers.folder, axes, 'dt', function ( value ) { setSettings(); } );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.dt, lang.dt, lang.dtTitle );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//marks\r\n\t\t\t\tif ( axes.marks ) {\r\n\r\n\t\t\t\t\tscaleControllers.marks = scaleControllers.folder.add( axes, 'marks' ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.marks = parseInt( axes.marks );\r\n\t\t\t\t\t\tsetSettings();\r\n\t\t\t\t\t\tconst elSlider = getSliderElement();\r\n\t\t\t\t\t\tif ( elSlider ) elSlider.max = options.playerOptions.marks - 1;\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tdat.controllerNameAndTitle( scaleControllers.marks, axes.marksName === undefined ? lang.marks : axes.marksName,\r\n\t\t\t\t\t\taxes.marksTitle === undefined ? lang.marksTitle : axes.marksTitle );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Ticks per seconds.\r\n\t\t\t\tscaleControllers.interval = scaleControllers.folder.add( settings.options.playerOptions, 'interval', 1, 25, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.interval, lang.interval, lang.intervalTitle );\r\n\r\n\t\t\t\t//Default button\r\n\t\t\t\tdat.controllerNameAndTitle( scaleControllers.folder.add( {\r\n\r\n\t\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\t\taxes.zoomMultiplier = axesDefault.zoomMultiplier;\r\n\t\t\t\t\t\tscaleControllers.scaleController.setValue( axes.zoomMultiplier );\r\n\r\n\t\t\t\t\t\taxes.offset = axesDefault.offset;\r\n\t\t\t\t\t\tscaleControllers.positionController.setValue( axes.offset );\r\n\r\n\t\t\t\t\t\taxes.min = axesDefault.min;\r\n\t\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\t\t\t\tif ( scaleControllers.max ) {\r\n\r\n\t\t\t\t\t\t\taxes.max = axesDefault.max;\r\n\t\t\t\t\t\t\tsetDT();\r\n\t\t\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( scaleControllers.dt ) {\r\n\r\n\t\t\t\t\t\t\taxes.dt = axesDefault.dt;\r\n\t\t\t\t\t\t\tscaleControllers.dt.setValue( axes.dt );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( axesDefault.marks ) {\r\n\r\n\t\t\t\t\t\t\taxes.marks = axesDefault.marks;\r\n\r\n\t\t\t\t\t\t\t//scaleControllers.marks is undefined если программист сначала установил max: Infinity,\r\n\t\t\t\t\t\t\t//соханил Player in cookie, например изменил marks\r\n\t\t\t\t\t\t\t//удалил max: Infinity,\r\n\t\t\t\t\t\t\t//Нажал кнопку Default для проигрывателя\r\n\t\t\t\t\t\t\tif ( scaleControllers.marks )\r\n\t\t\t\t\t\t\t\tscaleControllers.marks.setValue( axes.marks );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\taxes.interval = axesDefault.interval;\r\n\t\t\t\t\t\tscaleControllers.interval.setValue( axes.interval );\r\n\r\n\t\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t\t}\r\n\t\t\tscale();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds player buttons into web page.\r\n\t\t * @param {Object} options the following options are available\r\n\t\t * @param {Object} [options.controllers.player] player buttons, available from web page\r\n\t\t * @param {HTMLElement|string} [options.controllers.player.buttonPrev=\"prev\"] Go to previous animation scene.\r\n\t\t * <pre>\r\n\t\t * HTMLElement - <b>input</b> element of the \"button\" type.\r\n\t\t * string - <b>id</b> of <b>input</b> element.\r\n\t\t * </pre>\r\n\t\t * @param {HTMLElement|string} [options.controllers.player.buttonPlay=\"play\"] play or pause of the playing.\r\n\t\t * <pre>\r\n\t\t * HTMLElement - <b>input</b> element of the \"button\" type.\r\n\t\t * string - <b>id</b> of <b>input</b> element.\r\n\t\t * </pre>\r\n\t\t * @param {HTMLElement|string} [options.controllers.player.buttonNext=\"next\"] Go to next animation scene.\r\n\t\t * <pre>\r\n\t\t * HTMLElement - <b>input</b> element of the \"button\" type.\r\n\t\t * string - <b>id</b> of <b>input</b> element.\r\n\t\t * </pre>\r\n\t\t*/\r\n\t\tthis.createControllersButtons = function ( options ) {\r\n\r\n\t\t\tif ( !options.controllers || !options.controllers.player ) return;\r\n\t\t\tconst settings = options.controllers.player\r\n\r\n\t\t\t//Previous button\r\n\r\n\t\t\tif ( settings.buttonPrev === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonPrev = ' + settings.buttonPrev );\r\n\t\t\tif ( settings.buttonPrev ) {\r\n\r\n\t\t\t\tconst buttonPrev = typeof settings.buttonPrev === 'string' ? document.getElementById( settings.buttonPrev ) : settings.buttonPrev;\r\n\t\t\t\tif ( buttonPrev === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonPrev = ' + settings.buttonPrev );\r\n\t\t\t\tif ( buttonPrev ) {\r\n\r\n\t\t\t\t\tbuttonPrev.value = lang.prevSymbol;\r\n\t\t\t\t\tbuttonPrev.title = lang.prevSymbolTitle;\r\n\t\t\t\t\tbuttonPrev.onclick = function ( event ) { if ( options.player ) options.player.prev(); }\r\n\t\t\t\t\tsettings.buttonPrev = buttonPrev;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Play button\r\n\t\t\t\r\n\t\t\tif ( settings.buttonPlay === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonPlay = ' + settings.buttonPlay );\r\n\t\t\tif ( settings.buttonPlay ) {\r\n\r\n\t\t\t\tconst buttonPlay = typeof settings.buttonPlay === 'string' ? document.getElementById( settings.buttonPlay ) : settings.buttonPlay;\r\n\t\t\t\tif ( buttonPlay === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonPlay = ' + settings.buttonPlay );\r\n\t\t\t\tif ( buttonPlay ) {\r\n\r\n\t\t\t\t\tbuttonPlay.value = playing ? lang.pause : lang.playSymbol;\r\n\t\t\t\t\tbuttonPlay.title = playing ? lang.pauseTitle : lang.playTitle;\r\n\t\t\t\t\tbuttonPlay.onclick = function ( event ) { if ( options.player ) options.player.play3DObject(); }\r\n\t\t\t\t\tsettings.buttonPlay = buttonPlay;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Next button\r\n\r\n\t\t\tif ( settings.buttonNext === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonNext = ' + settings.buttonNext );\r\n\t\t\tif ( settings.buttonNext ) {\r\n\r\n\t\t\t\tconst buttonNext = typeof settings.buttonNext === 'string' ? document.getElementById( settings.buttonNext ) : settings.buttonNext;\r\n\t\t\t\tif ( buttonNext === null ) console.warn( 'Player.createControllersButtons: invalid options.controllers.player.buttonNext = ' + settings.buttonNext );\r\n\t\t\t\tif ( buttonNext ) {\r\n\r\n\t\t\t\t\tbuttonNext.value = lang.nextSymbol;\r\n\t\t\t\t\tbuttonNext.title = lang.nextSymbolTitle;\r\n\t\t\t\t\tbuttonNext.onclick = function ( event ) { if ( options.player ) options.player.next(); }\r\n\t\t\t\t\tsettings.buttonNext = buttonNext;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar _canvasMenu;\r\n\t\t/**\r\n\t\t * Adds a Player's menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @param {CanvasMenu} canvasMenu [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t* @param {Function} [getLanguageCode=\"en\"] Your custom getLanguageCode() function.\r\n\t\t* <pre>\r\n\t\t* returns the \"primary language\" subtag of the language version of the browser.\r\n\t\t* Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t* See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t* Default returns the 'en' is English language.\r\n\t\t* You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t\t* </pre>\r\n\t\t*/\r\n\t\tthis.createCanvasMenuItem = function ( canvasMenu, getLanguageCode = function() { return 'en' } ) {\r\n\r\n\t\t\t_canvasMenu = canvasMenu;\r\n\r\n\t\t\tconst player = this, menu = canvasMenu.menu, lang = player.localization( getLanguageCode );\r\n\r\n\t\t\t//Previous button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: lang.prevSymbol,\r\n\t\t\t\ttitle: lang.prevSymbolTitle,\r\n\t\t\t\tonclick: function ( event ) { player.prev(); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//Play button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: playing ? lang.pause : lang.playSymbol,\r\n\t\t\t\ttitle: playing ? lang.pauseTitle : lang.playTitle,\r\n\t\t\t\tid: \"menuButtonPlay\",\r\n\t\t\t\tonclick: function ( event ) {\r\n\r\n\t\t\t\t\tplayer.play3DObject();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t//Repeat button\r\n\t\t\t\tmenu.push( {\r\n\r\n\t\t\t\t\tname: lang.repeat,\r\n\t\t\t\t\ttitle: this.getSettings().repeat ? lang.repeatOff : lang.repeatOn,\r\n\t\t\t\t\tid: \"menuButtonRepeat\",\r\n\t\t\t\t\tonclick: function ( event ) { player.repeat(); }\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Next button\r\n\t\t\tmenu.push( {\r\n\r\n\t\t\t\tname: lang.nextSymbol,\r\n\t\t\t\ttitle: lang.nextSymbolTitle,\r\n\t\t\t\tonclick: function ( event ) { player.next(); }\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tthis.controllers.push( {\r\n\r\n\t\t\t\t/* *\r\n\t\t\t\t * Renames the \"Play\" button of the player's menu.\r\n\t\t\t\t * @param {boolean} playing <b>true</b> - pause.\r\n\t\t\t\t * <p><b>false</b> - play</p>\r\n\t\t\t\t */\r\n\t\t\t\tonRenamePlayButtons: function ( playing ) {\r\n\r\n\t\t\t\t\tvar name, title;\r\n\t\t\t\t\tif ( playing ) {\r\n\r\n\t\t\t\t\t\tname = lang.pause;\r\n\t\t\t\t\t\ttitle = lang.pauseTitle;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tname = lang.playSymbol;\r\n\t\t\t\t\t\ttitle = lang.playTitle;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst elMenuButtonPlay = canvasMenu.querySelector( '#menuButtonPlay' );\r\n\t\t\t\t\telMenuButtonPlay.innerHTML = name;\r\n\t\t\t\t\telMenuButtonPlay.title = title;\r\n\t\t\t\t\tif ( options.controllers && options.controllers.player && options.controllers.player.buttonPlay ) {\r\n\r\n\t\t\t\t\t\toptions.controllers.player.buttonPlay.value = name;\r\n\t\t\t\t\t\toptions.controllers.player.buttonPlay.title = title;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t\t/* *\r\n\t\t\t\t * Changes \"Repeat\" button of the player's menu between <b>repeat Off</b> and <b>repeat On</b>.\r\n\t\t\t\t */\r\n\t\t\t\tonChangeRepeat: function () {\r\n\r\n\t\t\t\t\tcanvasMenu.querySelector( '#menuButtonRepeat' ).title = options.playerOptions.repeat ? lang.repeatOff : lang.repeatOn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds slider menu item into [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t */\r\n\t\tthis.addSlider = function () {\r\n\r\n\t\t\tif ( options.playerOptions.max === null )\r\n\t\t\t\treturn;\r\n\r\n\t\t\t_canvasMenu.menu.push( {\r\n\r\n\t\t\t\tname: '<input type=\"range\" min=\"0\" max=\"' + ( options.playerOptions.marks - 1 ) + '\" value=\"0\" class=\"slider\" id=\"sliderPosition\">',\r\n\t\t\t\tstyle: 'float: right;',\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tfunction getSliderElement() { if ( _canvasMenu ) return _canvasMenu.querySelector( '#sliderPosition' ); }\r\n\r\n\t\t/**\r\n\t\t * Adds an events into slider menu item of the [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu}.\r\n\t\t * @returns slider element\r\n\t\t */\r\n\t\tthis.addSliderEvents = function () {\r\n\r\n\t\t\tconst elSlider = getSliderElement(), player = this;\r\n\t\t\tif ( elSlider ) {\r\n\r\n\t\t\t\telSlider.onchange = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\t\t\t\telSlider.oninput = function ( event ) { player.selectScene( parseInt( elSlider.value ) ); };\r\n\r\n\t\t\t\tvar pointerdown;\r\n\t\t\t\tconst player = this;\r\n\t\t\t\telSlider.addEventListener( 'pointerdown', e => { pointerdown = true; } );\r\n\t\t\t\telSlider.addEventListener( 'pointerup', e => { pointerdown = false; } );\r\n\t\t\t\telSlider.addEventListener( 'mousemove', e => {\r\n\r\n\t\t\t\t\tif ( !pointerdown )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tplayer.selectScene( ( options.playerOptions.marks - 1 ) * e.offsetX / elSlider.clientWidth );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\treturn elSlider;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Sets <b>index</b> and <b>title</b> of the slider element of the player's menu.\r\n\t\t * @param {string} index\r\n\t\t * @param {string} title\r\n\t\t */\r\n\t\tthis.setIndex = function ( index, title ) {\r\n\r\n\t\t\tconst t = this.getTime();\r\n\t\t\tif ( options.controllers && options.controllers.t )\r\n\t\t\t\toptions.controllers.t.controller.value = t;\r\n\t\t\tif ( typeof this.PlayController === \"object\" ) this.PlayController.setValue( t );\r\n\t\t\tconst elSlider = getSliderElement();\r\n\t\t\tif ( elSlider ) {\r\n\r\n\t\t\t\telSlider.value = index;\r\n\t\t\t\telSlider.title = title;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Changes the \"max\" value of the slider of the player's menu. Moves <b>Player</b> to the first scene.\r\n\t\t * @param {Object} scale See  <b>options.playerOptions</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t */\r\n\t\tthis.onChangeScale = function ( scale ) {\r\n\r\n\t\t\tgetSliderElement().max = scale.marks - 1;\r\n\t\t\tthis.selectScene( 0 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * @class\r\n */\r\nPlayer.cameraTarget = class {\r\n\r\n\t/**\r\n\t * Functions for camera for looking at selected point.\r\n\t */\r\n\tconstructor() {\r\n\r\n\t\tconst cameraTargetDefault = { boLook: false, },//По умолчанию не слежу за точкой\r\n\t\t\t_cameraTarget = {\r\n\r\n\t\t\t\tboLook: cameraTargetDefault.boLook,\r\n\t\t\t\tgetDistanceToCamera() {\r\n\r\n\t\t\t\t\tif ( typeof this.distanceToCameraCur !== 'undefined' ) return this.distanceToCameraCur;\r\n\t\t\t\t\treturn this.distanceToCamera;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\tvar _options;\r\n\t\tcameraTargetDefault.rotation = {};\r\n\t\t_cameraTarget.rotation = {};\r\n\t\tvar boTarget = false,//true - target point was detected. For displaying of the console warning if duplicate target point was detected\r\n\t\t\tboPlayer = false;//true - была попытка получить camera из _options.player. Добавил что бы не выполнялась лишняя работа\r\n\r\n\t\t//Если определен ( boCameraTargetLook !== undefined ) , то явно было задано следить или не следить за точкой.\r\n\t\t//Тогда если есть точка, за которой надо следить ( cameraTarget.bodefault === false )\r\n\t\t//и явно не было задано следить или не следить заточкой  ( boCameraTargetLook === undefined ),\r\n\t\t//то надо следить за точкой ( cameraTargetDefault.boLook = true )\r\n\t\tvar boCameraTargetLook;\r\n\r\n\t\t/**\r\n\t\t * get camera target\r\n\t\t * @param {Object} [options] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {Object} [options.player] <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> instance.\r\n\t\t */\r\n\t\tthis.get = function ( options ) {\r\n\r\n\t\t\tif ( !options && !_options )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.get: options = ' + options );\r\n\t\t\telse if ( _options && options && !Object.is( _options, options ) )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.get: options is ambiguous' );\r\n\t\t\t_options = _options || options;\r\n\t\t\tif ( !_cameraTarget.camera && !boPlayer && _options.player ) {\r\n\r\n\t\t\t\tcameraTargetDefault.camera = _options.player.getSettings().cameraTarget.camera;\r\n\t\t\t\tif ( cameraTargetDefault.camera ) setCameraTarget();\r\n\t\t\t\tboPlayer = true;\r\n\r\n\t\t\t}\r\n\t\t\tif ( _cameraTarget.camera )\r\n\t\t\t\treturn _cameraTarget;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Create default camera target\r\n\t\t * @param {object} cameraTarget the following cameraTarget are available:\r\n\t\t * @param {THREE.PerspectiveCamera} [cameraTarget.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t\t * @param {boolean} [cameraTarget.boLook=false] true - camera look at the target.\r\n\t\t * @param {THREE.Vector3} [cameraTarget.distanceToCamera] Distance from target point to camera.\r\n\t\t   * You can set the distance to the camera depending on the time.\r\n\t\t * <pre>\r\n\t\t *\tExample 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n\t\t *\tExample 2: new THREE.Vector3( 0, 0,\r\n\t\t *\t\t[ { t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 } ] )\r\n\t\t *\tDefault is camera.position.\r\n\t\t * </pre>\r\n\t\t * @param {object} [cameraTarget.rotation] rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n\t\t * @param {number|function|array} [cameraTarget.rotation.angle=0] Angle of rotation in radians.\r\n\t\t * <pre>\r\n\t\t *   number. Example: Math.PI / 2 rotate to 90 degrees.\r\n\t\t *   function. Example: new Function( 't', 'return 5*t' ).\r\n\t\t *   array.\r\n\t\t *     Example 1: [0, Math.PI]\r\n\t\t *       0 is angle for t = min is start time of the playing.\r\n\t\t *       Math.PI is rotate to 180 degrees\r\n\t\t *         for t = max is time of the stopping of the playing.\r\n\t\t *       If max time is infinity, then angle is for t = min.\r\n\t\t *     Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n\t\t *       t is time,\r\n\t\t *       v is angle for current t.\r\n\t\t * </pre>\r\n\t\t * @param {THREE.Vector3} [cameraTarget.rotation.axis] Axis of rotattion.\r\n\t\t * <pre>\r\n\t\t *   Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n\t\t *   Default is rotate around y axis\r\n\t\t * </pre>\r\n\t\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * @param {boolean} [boErrorMessage=true] false - Do not send an error message to the console if <b>cameraTarget.camera</b> is not defined.\r\n\t\t */\r\n\t\tthis.init = function ( cameraTarget, options, boErrorMessage = true ) {\r\n\r\n\t\t\tif ( !cameraTarget ) return;\r\n\t\t\t\r\n\t\t\tif ( !options && !_options )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.init: options = ' + options );\r\n\t\t\telse if ( _options && options && !Object.is( _options, options ) )\r\n\t\t\t\tconsole.error( 'Player.cameraTarget.init: options is ambiguous' );\r\n\t\t\t_options = _options || options;\r\n\r\n\t\t\t//cameraTargetDefault.boLook = false по умолчанию камера не смотритт на выбранную точку если:\r\n\t\t\t// 1 ни разу не вызывается init. Тоесть нет настроек cameraTargetDefault и нет ни однойточки, на которую смотрит камера\r\n\t\t\t// 2 cameraTarget.bodefault !== false и cameraTarget.boLook = false - программист явно запретил смотреть на точку\r\n\r\n\t\t\t//Если есть хоть одна точка, на которую должна смотреть камера cameraTarget.bodefault === false,\r\n\t\t\t//то для этой точки не устанавливаем playerCameraTarget.cameraTargetDefault\r\n\t\t\t//Другими словами если есть точка, на которую должна смотреть камера,\r\n\t\t\t//то камера будет на нее смотреть если нет запрета смотеть на точку - playerCameraTarget.cameraTargetDefault = false\r\n\t\t\tif ( cameraTarget.bodefault !== false ) {\r\n\r\n\t\t\t\tif ( boTarget )\r\n\t\t\t\t\treturn;//Не надо устанавливать cameraTargetDefault после того,\r\n\t\t\t\t//как были устанвлены настройки cameraTargetDefault из точек\r\n\t\t\t\t//Иначе натройки точки не будут приоритетными\r\n\r\n\t\t\t\tif ( cameraTarget.boLook !== undefined ) {\r\n\r\n\t\t\t\t\tcameraTargetDefault.boLook = cameraTarget.boLook;\r\n\t\t\t\t\tboCameraTargetLook = cameraTarget.boLook;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( cameraTarget.boLook === true ) {\r\n\r\n\t\t\t\t//Есть точка, за которой надо следить\r\n\r\n\t\t\t\tif ( boTarget ) console.warn( 'playerCameraTarget().init(...): duplicate target point' );\r\n\t\t\t\tboTarget = true;\r\n\r\n\t\t\t\tif ( boCameraTargetLook === undefined )\r\n\t\t\t\t\tcameraTargetDefault.boLook = true;//запрета на слежение камерой за точкой не было и есть точка, за которой надо следить\r\n\r\n\t\t\t} else return;\r\n\t\t\tcameraTargetDefault.camera = cameraTargetDefault.camera ||\r\n\t\t\t\tcameraTarget.camera ||\r\n\t\t\t\t( _options.player ? _options.player.getSettings().cameraTarget.camera : undefined );\r\n\t\t\tif ( !cameraTargetDefault.camera && boErrorMessage ) {\r\n\r\n\t\t\t\tconsole.error( 'playerCameraTarget().init(...): cameraTargetDefault.camera = ' + cameraTargetDefault.camera );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tcameraTargetDefault.distanceToCamera = cameraTargetDefault.distanceToCamera || cameraTarget.distanceToCamera;\r\n\t\t\tcameraTarget.rotation = cameraTarget.rotation || {};\r\n\t\t\tcameraTargetDefault.rotation.angle = cameraTargetDefault.rotation.angle || cameraTarget.rotation.angle;\r\n\t\t\tcameraTargetDefault.rotation.axis = cameraTargetDefault.rotation.axis || cameraTarget.rotation.axis;\r\n\t\t\tsetCameraTarget( cameraTarget );\r\n\r\n\t\t}\r\n\t\tfunction setCameraTarget( cameraTarget ) {\r\n\r\n\t\t\tassign();\r\n\r\n\t\t\tif ( !cameraTarget )\r\n\t\t\t\tcameraTarget = cameraTargetDefault;//У выбранной для слежения точки нет cameraTarget\r\n\t\t\tif ( !_cameraTarget.boMaual ) {//если не делать эту проверку, то пользователь не сможет изменить вручную _cameraTarget.boLook когда выбрана точка, за которой надо следить\r\n\r\n\t\t\t\tif ( cameraTarget.boLook !== undefined )\r\n\t\t\t\t\t_cameraTarget.boLook = cameraTarget.boLook;\r\n\t\t\t\telse _cameraTarget.boLook = cameraTargetDefault.boLook;\r\n\r\n\t\t\t}\r\n\t\t\tcameraTargetDefault.camera = cameraTargetDefault.camera || cameraTarget.camera;\r\n\t\t\t_cameraTarget.camera = cameraTarget.camera || cameraTargetDefault.camera;\r\n\r\n\t\t\t//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n\t\t\t//то при проигрывании каждый раз distanceToCamera будет равна camera.position\r\n\t\t\t//\t\t_cameraTarget.distanceToCamera = cameraTarget.distanceToCamera || cameraTargetDefault.distanceToCamera || new THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\t\t//Если в программе не определены функции distanceToCamera (тоесть cameraTarget.distanceToCamera === undefined и cameraTargetDefault.distanceToCamera === undefined),\r\n\t\t\t//То сначала _cameraTarget.distanceToCamera будет равна camera.position, а потом при проигрывании не будет меняться\r\n\t\t\t_cameraTarget.distanceToCamera =\r\n\t\t\t\tcameraTarget.distanceToCamera ||\r\n\t\t\t\tcameraTargetDefault.distanceToCamera ||\r\n\t\t\t\t_cameraTarget.distanceToCamera ||\r\n\t\t\t\tnew THREE.Vector3().copy( cameraTargetDefault.camera.position );\r\n\r\n\t\t\tif ( !cameraTarget.rotation ) cameraTarget.rotation = {};\r\n\t\t\tif ( cameraTarget.rotation.angle !== undefined )\r\n\t\t\t\t_cameraTarget.rotation.angle = cameraTarget.rotation.angle;\r\n\t\t\telse _cameraTarget.rotation.angle = cameraTargetDefault.rotation.angle || 0;\r\n\t\t\t_cameraTarget.rotation.axis = cameraTarget.rotation.axis || cameraTargetDefault.rotation.axis || new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Change target.\r\n\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} with selected point as target for camera.\r\n\t\t * @param {number} i index of the point.\r\n\t\t * @param {Options} [options] See <a href=\"../../jsdoc/Options/index.html\" target=\"_blank\">Options</a>.\r\n\t\t */\r\n\t\tthis.changeTarget = function ( mesh, i, options ) {\r\n\r\n\t\t\tassign();\r\n\r\n\t\t\t//Update cameraTarget\r\n\t\t\tconst func = !mesh.userData.player || ( typeof mesh.userData.player.arrayFuncs === \"function\" ) ? {} : mesh.userData.player.arrayFuncs[i];\r\n\t\t\tif ( !func.cameraTarget )\r\n\t\t\t\tfunc.cameraTarget = { boLook: false };\r\n\t\t\tsetCameraTarget( func.cameraTarget );\r\n\r\n\t\t\t_options = _options || options;\r\n\t\t\tconst cameraTarget = _options.playerOptions.cameraTarget.get( _options );\r\n\r\n\t\t\tif ( cameraTarget ) {\r\n\r\n\t\t\t\tif ( cameraTarget && cameraTarget.boLook ) {\r\n\r\n\t\t\t\t\tconst target = getWorldPosition( mesh, new THREE.Vector3().fromArray( mesh.geometry.attributes.position.array, i * mesh.geometry.attributes.position.itemSize ) );\r\n\t\t\t\t\tcameraTarget.target = target;\r\n\r\n\t\t\t\t} else delete cameraTarget.target;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Update camera settings.\r\n\t\t * @param {Object} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t */\r\n\t\tthis.setCameraTarget = function ( options ) {\r\n\r\n\t\t\tassign();\r\n\r\n\t\t\tvar cameraTarget = options.playerOptions.cameraTarget.get( options );\r\n\t\t\tif ( !cameraTarget ) cameraTarget = cameraTarget || {};\r\n\t\t\tconst camera = cameraTarget.camera;\r\n\r\n\t\t\tif ( !camera )\r\n\t\t\t\treturn;//В этом приложении невозможно следить за точкой, потому что ни разу не была вызывана Player.cameraTarget.init()\r\n\r\n\t\t\t//На случай когда не определена ни одна точка как cameraTarget и пользователь поставил птичку в controllerCameraTarget\r\n\t\t\tif ( !cameraTarget.distanceToCamera )\r\n\t\t\t\tcameraTarget.distanceToCamera = new THREE.Vector3().copy( camera.position );\r\n\r\n\t\t\tif ( !cameraTarget.distanceToCameraCur )\r\n\t\t\t\tcameraTarget.distanceToCameraCur = new THREE.Vector3();\r\n\r\n\t\t\tconst t = options.time,\r\n\t\t\t\tdistanceToCamera = cameraTarget.distanceToCamera,\r\n\t\t\t\tdistanceToCameraCur = new THREE.Vector3().copy( cameraTarget.distanceToCameraCur );\r\n\t\t\tcameraTarget.distanceToCameraCur.set(\r\n\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'x', t, options ),\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'y', t, options ),\r\n\t\t\t\tPlayer.execFunc( distanceToCamera, 'z', t, options )\r\n\r\n\t\t\t);\r\n\r\n\t\t\tif ( !cameraTarget.setCameraPosition )\r\n\t\t\t\tcameraTarget.setCameraPosition = function ( /*setCameraDefault*/ ) {\r\n\r\n\t\t\t\t\tvar target = cameraTarget.target;\r\n\r\n\t\t\t\t\t//не менять позицию камеры если\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t!cameraTarget.boLook ||//не следить за точкой\r\n\t\t\t\t\t\t(//или\r\n\t\t\t\t\t\t\t!target &&//нет точки, за которой надо следить\r\n\t\t\t\t\t\t\tcameraTarget.distanceToCameraCur.equals( distanceToCameraCur )//и не изменилось расстояние камеры до target\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\treturn;//Камере не нужно следить за выбранной точкой или ни одна точка не определена как target\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tdistanceToCameraCur.copy( cameraTarget.distanceToCameraCur );\r\n\t\t\t\t\tconst t = options.time;\r\n\t\t\t\t\tcamera.position.copy( cameraTarget.distanceToCameraCur );\r\n\t\t\t\t\tcamera.position.applyAxisAngle( cameraTarget.rotation.axis, Player.execFunc( cameraTarget.rotation, 'angle', t, options ) );\r\n\t\t\t\t\tif ( !target ) {\r\n\r\n\t\t\t\t\t\tif ( Player.orbitControls ) target = Player.orbitControls.target;\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t//console.warn( 'Under constaction' );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcamera.position.add( target );\r\n\t\t\t\t\tcamera.lookAt( target );\r\n\t\t\t\t\tif ( options.orbitControls ) {\r\n\r\n\t\t\t\t\t\tif ( !options.orbitControls.target.equals( target ) ) {\r\n\r\n\t\t\t\t\t\t\toptions.orbitControls.target.copy( target );\r\n\t\t\t\t\t\t\tif ( options.orbitControlsGui )\r\n\t\t\t\t\t\t\t\toptions.orbitControlsGui.setTarget( target );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( options.orbitControls._listeners )\r\n\t\t\t\t\t\t\toptions.orbitControls._listeners.change[0]();//move frustumpoints\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\tif ( options.cameraGui ) options.cameraGui.update();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description execute function\r\n * @param {THREE.Vector4} funcs vector of the functions for executing.\r\n * @param {string} axisName axis name of the function for executing. Can be as \"x\", \"y\", \"z\", \"w\".\r\n * @param {number} t time. First parameter of the function for executing.\r\n * @param {object} [options={}] the following options are available:\r\n * @param {number} [options.a=1] multiplier. Second parameter of the function for executing.\r\n * @param {number} [options.b=0] addendum. Third parameter of the function for executing.\r\n * @returns function execution value.\r\n */\r\nPlayer.execFunc = function ( funcs, axisName, t, options={} ) {\r\n\r\n\tvar func = funcs[axisName];\r\n\tconst a = options.a, b = options.b, typeofFuncs = typeof func;\r\n\tif ( typeof t === \"undefined\" ) t = options.playerOptions ? options.playerOptions.min : 0;\r\n\tswitch ( typeofFuncs ) {\r\n\r\n\t\tcase \"undefined\":\r\n\t\t\treturn undefined;\r\n\t\tcase \"number\":\r\n\t\t\treturn func;\r\n\t\tcase \"string\":\r\n\t\t\tfunc = new Function( 't', 'a', 'b', 'return ' + func );\r\n\t\tcase \"function\":\r\n\t\t\ttry {\r\n\r\n\t\t\t\tconst res = func( t, a, b );\r\n\t\t\t\tif ( res === undefined )\r\n\t\t\t\t\tthrow 'function returns ' + res;\r\n\t\t\t\tif ( !Array.isArray( res ) ) return res;\r\n\t\t\t\telse func = res;\r\n\r\n\t\t\t} catch( e ) {\r\n\r\n\t\t\t\tconsole.error( e );\r\n\t\t\t\tthrow e;\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\tcase \"object\":\r\n\t\t\tif ( Array.isArray( func ) ) {\r\n\r\n\t\t\t\tif ( func.length === 0 ) {\r\n\r\n\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array is empty' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst a = func,\r\n\t\t\t\t\tl = func.length - 1,\r\n\t\t\t\t\tmax = options.playerOptions.max === null ? Infinity : options.playerOptions.max,\r\n\t\t\t\t\tmin = options.playerOptions.min,\r\n\t\t\t\t\ttStep = ( max - min ) / l;\r\n\t\t\t\tvar tStart = min, tStop = max,\r\n\t\t\t\t\tiStart = 0, iStop = l;\r\n\t\t\t\tfor ( var i = 0; i < func.length; i++ ) {\r\n\r\n\t\t\t\t\tif ( tStep * i + min < t ) {\r\n\r\n\t\t\t\t\t\tiStart = i;\r\n\t\t\t\t\t\tiStop = i + 1;\r\n\t\t\t\t\t\ttStart = tStep * iStart + min;\r\n\t\t\t\t\t\ttStop = tStep * iStop + min;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction execW( i ) {\r\n\r\n\t\t\t\t\tif ( typeof a[i] === \"function\" )\r\n\t\t\t\t\t\treturn a[i]( t, a, b );\r\n\t\t\t\t\tif ( a[i] instanceof THREE.Color )\r\n\t\t\t\t\t\treturn a[i];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( typeof a[iStart] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' ) {\r\n\r\n\t\t\t\t\t\treturn execW( iStart );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( typeof a[iStart] === \"object\" ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < func.length; i++ ){\r\n\r\n\t\t\t\t\t\t\tif ( i === ( func.length - 1 ) ) return a[i].v;\r\n\r\n\t\t\t\t\t\t\tiStart = i; iStop = i + 1;\r\n\t\t\t\t\t\t\ttStart = a[iStart].t; tStop = a[iStop].t;\r\n\t\t\t\t\t\t\tif ( ( tStart <= t ) && ( tStop > t ) ) {\r\n\r\n\t\t\t\t\t\t\t\tvar x = ( a[iStop].v - a[iStart].v ) / ( tStop - tStart ),\r\n\t\t\t\t\t\t\t\t\ty = a[iStart].v - x * tStart;\r\n\t\t\t\t\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: value is not detected' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStart + ' typeof = ' + ( typeof a[iStart] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( iStop >= func.length ) iStop = iStart;\r\n\t\t\t\tif ( typeof a[iStop] !== \"number\" ) {\r\n\r\n\t\t\t\t\tif ( axisName === 'w' )\r\n\t\t\t\t\t\treturn execW( iStop );\r\n\t\t\t\t\tif ( typeof a[iStop] !== \"object\" ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] array item ' + iStop + ' typeof = ' + ( typeof a[iStop] ) + ' is not number' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar x = ( a[iStop] - a[iStart] ) / ( tStop - tStart ),\r\n\t\t\t\t\ty = a[iStart] - x * tStart;\r\n\t\t\t\tif ( isNaN( x ) || isNaN( y ) ) console.error( 'Player.execFunc: invalid x = ' + x + ' or y = ' + y );\r\n\t\t\t\treturn x * t + y;\r\n\r\n\t\t\t}\r\n\t\t\tif ( func.func )\r\n\t\t\t\treturn func.func instanceof Function ? func.func( t, a, b ) : func.func;\r\n\t\t\tif ( axisName !== 'w' )\r\n\t\t\t\tconsole.error( 'Player.execFunc: funcs[\"' + axisName + '\"] object is not array' );\r\n\t\t\treturn func;\r\n\t\tdefault:\r\n\t\t\tconsole.error( 'Player.execFunc: Invalud typeof funcs[\"' + axisName + '\"]: ' + typeofFuncs );\r\n\t}\r\n\treturn;\r\n\r\n}\r\n\r\nvar lang;\r\n\r\nclass Ids {\r\n\r\n\tconstructor() {\r\n\r\n\t\tfunction addKeys( axisName ) {\r\n\r\n\t\t\tfunction keyValue( controllerId ) {\r\n\r\n\t\t\t\tconst id = axisName + controllerId;\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tget controllerId() { return this.boUsed ? undefined : id; },\r\n\t\t\t\t\tget elController() { return document.getElementById( this.controllerId ); },\r\n\r\n\t\t\t\t\tnameId: id + 'Name',\r\n\t\t\t\t\tget elName() { return document.getElementById( this.nameId ); },\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\treturn {\r\n\r\n\t\t\t\tfunc: keyValue( 'Func' ),\r\n\t\t\t\tposition: keyValue( 'Position' ),\r\n\t\t\t\tworldPosition: keyValue( 'WorldPosition' ),\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tthis.x = addKeys( 'x' );\r\n\t\tthis.y = addKeys( 'y' );\r\n\t\tthis.z = addKeys( 'z' );\r\n\t\tthis.w = addKeys( 'w' );\r\n\t\t/*\r\n\t\t\ty: addKeys( 'y' ),\r\n\t\t\tz: addKeys( 'z' ),\r\n\t\t\tw: addKeys( 'w' ),\r\n\t\t*/\r\n\r\n\t}\r\n\r\n}\r\nvar ids = new Ids();\r\n\r\n/** @namespace\r\n * @description Select a scene for playing of the mesh\r\n * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for playing.\r\n * @param {Object} [settings={}] the following settings are available\r\n * @param {number} [settings.t=0] time\r\n * @param {Object} [settings.options={ dat: false }] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {boolean} [settings.options.boPlayer] true - is not select play scene for mesh.userData.boFrustumPoints = true. Default is false.\r\n * @param {object} [settings.options.playerOptions] The <b>settings.options.playerOptions</b> parameter of the <a href=\"./module-Player-Player.html\" target=\"_blank\">Player</a> .\r\n * @param {number} [settings.options.a] multiplier. Second parameter of the arrayFuncs item function. Default is 1.\r\n * @param {number} [settings.options.b] addendum. Third parameter of the arrayFuncs item function. Default is 0.\r\n * @param {object} [settings.options.scales] axes scales.\r\n * See <b>options.scales</b> of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> for details.\r\n * @param {object} [settings.options.palette=new ColorPicker.palette();//palette: ColorPicker.paletteIndexes.BGYW] See <a href=\"../../colorPicker/jsdoc/module-ColorPicker.html#~Palette\" target=\"_blank\">ColorPicker.palette</a>.\r\n * @param {object} [settings.options.point={}] point settings. Applies to points with ShaderMaterial.\r\n * <pre>\r\n * See [ShaderMaterial]{@link https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial} for details.\r\n * The size of the point seems constant and does not depend on the distance to the camera.\r\n * </pre>\r\n * @param {number} [settings.options.point.size=0.02] The apparent angular size of a point in radians.\r\n*/\r\nPlayer.selectMeshPlayScene = function ( mesh, settings = {} ) {\r\n\r\n\tassign();\r\n\r\n\tvar t = settings.t, options = settings.options || { dat: false };\r\n\r\n\toptions = new Options( options );\r\n\tif ( t === undefined ) t = options.playerOptions.min;\r\n\toptions.scales.setW();\r\n\tif (\r\n\r\n\t\t!mesh.userData.player ||\r\n\t\t( options && options.boPlayer && mesh.userData.boFrustumPoints )\r\n\r\n\t)\r\n\t\treturn;\r\n\r\n\t//Эти строки нужны что бы появлялся текст возле точки, если на нее наведена мышка\r\n\t//при условии, что до этого точка была передвинута с помошью проигрывателя.\r\n\tif ( mesh.geometry ) {//scene do not have geometry\r\n\r\n\t\tdelete mesh.geometry.boundingSphere;\r\n\t\tmesh.geometry.boundingSphere = null;\r\n\r\n\t}\r\n\r\n\tif ( mesh.userData.player.selectPlayScene ) {\r\n\r\n\t\tmesh.userData.player.selectPlayScene( t );\r\n\r\n\t\t//если не приводить угол поворота в диапазон 0 - 360 градусов,\r\n\t\t//то угол поворота будет равен нулю или Math.PI * 2\r\n\t\t//когда пользователь выберет mesh в guiSelectPoint.js\r\n\t\t//потому что в органе управления угла поворота угол поворота ограничен 0 - 360 градусов,\r\n\t\t//смотри строку\r\n\t\t//cRotations[name] = fRotation.add( new THREE.Vector3(), name, 0, Math.PI * 2, 1 / 360 ).\r\n\t\t//в guiSelectPoint\r\n\t\tfunction setRotation( axisName ) {\r\n\r\n\t\t\twhile ( mesh.rotation[axisName] < 0 ) mesh.rotation[axisName] += Math.PI * 2;\r\n\t\t\twhile ( mesh.rotation[axisName] > Math.PI * 2 ) mesh.rotation[axisName] -= Math.PI * 2;\r\n\r\n\t\t}\r\n\t\tsetRotation( 'x' );\r\n\t\tsetRotation( 'y' );\r\n\t\tsetRotation( 'z' );\r\n\t\t\r\n\t}\r\n\r\n\tfunction setAttributes( a, b ) {\r\n\r\n\t\tif ( !mesh.geometry || mesh.userData.nd )\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\tconst attributes = mesh.geometry.attributes,\r\n\t\t\tarrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\tif ( arrayFuncs === undefined )\r\n\t\t\treturn;\r\n\t\tif ( t === undefined )\r\n\t\t\tconsole.error( 'setPosition: t = ' + t );\r\n\r\n\t\tvar min, max;\r\n\t\tif ( options && ( options.scales.w !== undefined ) ) {\r\n\r\n\t\t\tmin = options.scales.w.min; max = options.scales.w.max;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tmax = value;\r\n\t\t\tmin = max - 1;\r\n\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\t\tvar funcs = arrayFuncs[i], needsUpdate = false;\r\n\t\t\tfunction setPosition( axisName, fnName ) {\r\n\r\n\t\t\t\tvar value = Player.execFunc( funcs, axisName, t, options );// a, b );\r\n\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\tattributes.position[fnName]( i, value );\r\n\t\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tsetPosition( 'x', 'setX' );\r\n\t\t\tsetPosition( 'y', 'setY' );\r\n\t\t\tsetPosition( 'z', 'setZ' );\r\n\t\t\tsetPosition( 'w', 'setW' );\r\n\r\n\t\t\t//если тут поставить var то цвет точки, которая определена как THREE.Vector3 будет равет цвету предыдущей точки\r\n\t\t\t//потому что перемнные типа var видны снаружи блока {}\r\n\t\t\tlet color;\r\n\r\n\t\t\tfunction getColor() {\r\n\r\n\t\t\t\tif ( mesh.userData.player.palette )\r\n\t\t\t\t\tcolor = mesh.userData.player.palette.toColor( value, min, max );\r\n\t\t\t\telse if ( options.palette )\r\n\t\t\t\t\tcolor = options.palette.toColor( value, min, max );\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tconst c = { r: 255, g: 255, b: 255 };\r\n\t\t\t\t\tcolor = new THREE.Color( \"rgb(\" + c.r + \", \" + c.g + \", \" + c.b + \")\" );\r\n\t\t\t\t\treturn color;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( typeof funcs.w === \"function\" ) {\r\n\r\n\t\t\t\tvar value = funcs.w( t, a, b );\r\n\t\t\t\tif ( options.scales.w ) {\r\n\r\n\t\t\t\t\tmin = options.scales.w.min;\r\n\t\t\t\t\tmax = options.scales.w.max;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.warn( 'Player.selectMeshPlayScene: Кажется эти экстремумы заданы неверно' );\r\n\t\t\t\t\tmin = 0;\r\n\t\t\t\t\tmax = 100;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( attributes.position.itemSize >= 4 )\r\n\t\t\t\t\tattributes.position.setW( i, value );\r\n\t\t\t\tneedsUpdate = true;\r\n\r\n\t\t\t\tgetColor();\r\n\r\n\t\t\t} else if ( typeof funcs.w === \"object\" ) {\r\n\r\n\t\t\t\tif ( funcs.w instanceof THREE.Color )\r\n\t\t\t\t\tcolor = funcs.w;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tvar value = Player.execFunc( funcs, 'w', t, options );\r\n\t\t\t\t\tif ( funcs.w.min !== undefined ) min = funcs.w.min;\r\n\t\t\t\t\tif ( funcs.w.max !== undefined ) max = funcs.w.max;\r\n\t\t\t\t\tgetColor();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tcolor = setColorAttibute(\r\n\t\t\t\tfuncs.w === undefined ?\r\n\t\t\t\t\tnew THREE.Vector4().w :\r\n\t\t\t\t\ttypeof funcs.w === \"number\" ? funcs.w : Player.execFunc( funcs, 'w', t, options ),\r\n\t\t\t\tmesh, i, color );\r\n\t\t\tif ( needsUpdate )\r\n\t\t\t\tattributes.position.needsUpdate = true;\r\n\r\n\t\t\tif ( funcs.trace && !funcs.line ) {\r\n\r\n\t\t\t\tfuncs.line = new Player.traceLine( options );\r\n\t\t\t\tfuncs.trace = false;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.line && funcs.line.addPoint )\r\n\t\t\t\tfuncs.line.addPoint( mesh, i, color );\r\n\t\t\tif ( funcs.cameraTarget && ( funcs.cameraTarget.boLook === true ) )\r\n\t\t\t\toptions.playerOptions.cameraTarget.changeTarget( mesh, i, options );\r\n\r\n\t\t};\r\n\r\n\t}\r\n\tsetAttributes( options ? options.a : 1, options ? options.b : 0 );\r\n\tconst message = 'Player.selectMeshPlayScene: invalid mesh.scale.';\r\n\tif ( mesh.scale.x <= 0 ) console.error( message + 'x = ' + mesh.scale.x );\r\n\tif ( mesh.scale.y <= 0 ) console.error( message + 'y = ' + mesh.scale.y );\r\n\tif ( mesh.scale.z <= 0 ) console.error( message + 'z = ' + mesh.scale.z );\r\n\r\n\tfunction setColorAttibute( value, mesh, index , color ){\r\n\r\n\t\t//не менять цвет точки если позиция состоит из 3 значений\r\n\t\t//такая ситуация имеется в геометрических фигурах. Например в кубе\r\n\t\tif ( mesh.geometry.attributes.position.itemSize < 4 ) return;\r\n\r\n\t\tif ( options.palette )\r\n\t\t\tcolor = options.palette.toColor( value, options.scales.w.min, options.scales.w.max );\r\n\t\tif (!color) return;\r\n\t\tconst attributes = mesh.geometry.attributes, arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\tif ( !Player.setColorAttribute( attributes, index, color ) && arrayFuncs[index] instanceof THREE.Vector4 ) {\r\n\r\n\t\t\tif ( mesh.userData.player && arrayFuncs ) {\r\n\r\n\t\t\t\tmesh.geometry.setAttribute( 'color',\r\n\t\t\t\t\tnew THREE.Float32BufferAttribute( Player.getColors( arrayFuncs,\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\tpositions: attributes.position,\r\n\t\t\t\t\t\t\toptions: options,\r\n\r\n\t\t\t\t\t\t} ), 4 ) );\r\n\t\t\t\tif ( !Player.setColorAttribute( attributes, index, color ) )\r\n\t\t\t\t\tconsole.error( 'Player.selectMeshPlayScene: the color attribute is not exists. Please use THREE.Vector3 instead THREE.Vector4 in the arrayFuncs or add \"color\" attribute' );\r\n\r\n\t\t\t} else console.error( 'Player.selectMeshPlayScene: set color attribute failed. Invalid mesh.userData.player.arrayFuncs' );\r\n\r\n\t\t}\r\n\t\treturn color;\r\n\r\n\t}\r\n\r\n\tif ( mesh.userData.player && mesh.userData.player.arrayFuncs && mesh.userData.player.arrayFuncs instanceof Array )\r\n\t\tmesh.userData.player.arrayFuncs.forEach( function ( func, index ) {\r\n\r\n\t\t\tif ( func.controllers ) {\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tif ( !lang ) {\r\n\t\t\t\t\tlang = {\r\n\r\n\r\n\t\t\t\t\t\tcontrollerXTitle: 'X position',\r\n\t\t\t\t\t\tcontrollerYTitle: 'Y position',\r\n\t\t\t\t\t\tcontrollerZTitle: 'Z position',\r\n\t\t\t\t\t\tcontrollerWTitle: 'color index',\r\n\r\n\t\t\t\t\t\tcontrollerWorld: 'World',\r\n\r\n\t\t\t\t\t\tcontrollerXWorldTitle: 'X world position',\r\n\t\t\t\t\t\tcontrollerYWorldTitle: 'Y world position',\r\n\t\t\t\t\t\tcontrollerZWorldTitle: 'Z world position',\r\n\t\t\t\t\t\tcontrollerWWorldTitle: 'color index',\r\n\r\n\t\t\t\t\t\tcontrollerXFunctionTitle: 'X = f(t)',\r\n\t\t\t\t\t\tcontrollerYFunctionTitle: 'Y = f(t)',\r\n\t\t\t\t\t\tcontrollerZFunctionTitle: 'Z = f(t)',\r\n\t\t\t\t\t\tcontrollerWFunctionTitle: 'W = f(t)',\r\n\r\n\t\t\t\t\t\tpositionAlert: 'Invalid position fromat: ',\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\tlang.controllerXTitle = 'Позиция X';\r\n\t\t\t\t\t\t\tlang.controllerYTitle = 'Позиция Y';\r\n\t\t\t\t\t\t\tlang.controllerZTitle = 'Позиция Z';\r\n\t\t\t\t\t\t\tlang.controllerWTitle = 'Индекс цвета';\r\n\r\n\t\t\t\t\t\t\tlang.controllerWorld = 'Абсолютный';\r\n\r\n\t\t\t\t\t\t\tlang.controllerXWorldTitle = 'Абсолютная позиция X';\r\n\t\t\t\t\t\t\tlang.controllerYWorldTitle = 'Абсолютная позиция Y';\r\n\t\t\t\t\t\t\tlang.controllerZWorldTitle = 'Абсолютная позиция Z';\r\n\t\t\t\t\t\t\tlang.controllerWWorldTitle = 'Индекс цвета';\r\n\r\n\r\n\t\t\t\t\t\t\tlang.positionAlert = 'Неправильный формат позиции точки: ';\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != languageCode ) )\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst positionLocal = getObjectLocalPosition( mesh, index );\r\n\t\t\t\tfunction setPosition( value, axisName ) {\r\n\r\n\t\t\t\t\tconst axesId = axisName === 'x' ? 0 : axisName === 'y' ? 1 : axisName === 'z' ? 2 : axisName === 'w' ? 3 : undefined;\r\n\t\t\t\t\tif ( axisName === 'w' ){\r\n\r\n\t\t\t\t\t\tsetColorAttibute( value, mesh, index );\r\n\t\t\t\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\t\t\t\toptions.guiSelectPoint.update();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst indexValue = axesId + mesh.geometry.attributes.position.itemSize * index,\r\n\t\t\t\t\t\tvalueOld = mesh.geometry.attributes.position.array[ indexValue ];\r\n\t\t\t\t\tmesh.geometry.attributes.position.array[ indexValue ] = value;\r\n\t\t\t\t\tconst axisControllers = func.controllers[axisName];\r\n\t\t\t\t\tif ( isNaN( mesh.geometry.attributes.position.array[ indexValue ] ) ) {\r\n\r\n\t\t\t\t\t\talert( lang.positionAlert + value );\r\n\t\t\t\t\t\tconst controller = axisControllers.position.controller;\r\n\t\t\t\t\t\tcontroller.focus();\r\n\t\t\t\t\t\tcontroller.value = valueOld;\r\n\t\t\t\t\t\tmesh.geometry.attributes.position.array[ indexValue ] = valueOld;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmesh.geometry.attributes.position.needsUpdate = true;\r\n\t\t\t\t\tif ( options.axesHelper )\r\n\t\t\t\t\t\toptions.axesHelper.updateAxes();\r\n\t\t\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\t\t\toptions.guiSelectPoint.update();\r\n\t\t\t\t\tif ( axisControllers.worldPosition && axisControllers.worldPosition.controller ) {\r\n\r\n\t\t\t\t\t\tconst controller = axisControllers.worldPosition.controller;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcontroller.innerHTML = getObjectPosition( mesh, index )[axisName];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction createControllers( axisName ) {\r\n\r\n\t\t\t\t\tvar axisControllers = func.controllers[axisName];\r\n\t\t\t\t\tif ( axisControllers === false ) return;\r\n\t\t\t\t\tconst position = 'position';\r\n\t\t\t\t\t//если Controllers для текущей оси не определен а на веб странице есть Controllers для этой оси\r\n\t\t\t\t\t//то нужно создать axisControllers\r\n\t\t\t\t\tif ( !axisControllers && ( ids[axisName].func.elController || ids[axisName].position.elController || ids[axisName].worldPosition.elController ) ) {\r\n\r\n\t\t\t\t\t\taxisControllers = {};\r\n\t\t\t\t\t\tfunc.controllers[axisName] = axisControllers;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( !axisControllers ) return;\r\n\t\t\t\t\t//добавляем в axisControllers те Controllers, которые есть на веб странице для текущей оси\r\n\t\t\t\t\tfunction addKey( keyName ) {\r\n\r\n\t\t\t\t\t\tif ( !ids[axisName][keyName].elController ) return;\r\n\t\t\t\t\t\tif ( !axisControllers[keyName] ) {\r\n\r\n\t\t\t\t\t\t\tif ( !ids[axisName][keyName].boUsed ) {\r\n\r\n\t\t\t\t\t\t\t\taxisControllers[keyName] = {\r\n\r\n\t\t\t\t\t\t\t\t\tcontroller: ids[axisName][keyName].elController,\r\n\t\t\t\t\t\t\t\t\telName: ids[axisName][keyName].elName ? ids[axisName][keyName].elName : false,\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tids[axisName][keyName].boUsed = true;\r\n\t\t\t\t\t\t\t\tif ( ( keyName === position ) && ( axisName === 'w' ) )\r\n\t\t\t\t\t\t\t\t\taxisControllers[keyName].elSlider = true;\r\n\r\n\t\t\t\t\t\t\t} else console.warn( 'Player.selectMeshPlayScene createControllers: Same controller is using for different points. Controller ID is \"' + ids[axisName][keyName].controllerId + '\"\"' );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddKey( 'func' );\r\n\t\t\t\t\taddKey( position );\r\n\t\t\t\t\taddKey( 'worldPosition' );\r\n\r\n\t\t\t\t\tcreateController( axisControllers.func, ids[axisName].func.controllerId, function () { return options.scales[axisName].name + ' = f(t)'; }, {\r\n\r\n\t\t\t\t\t\tvalue: func[axisName],\r\n\t\t\t\t\t\ttitle: axisName === 'x' ? lang.controllerXFunctionTitle : axisName === 'y' ? lang.controllerYFunctionTitle : axisName === 'z' ? lang.controllerZFunctionTitle : axisName === 'w' ? lang.controllerWFunctionTitle : '',\r\n\t\t\t\t\t\tonchange: function ( event ) {\r\n\r\n\t\t\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\t\t\tfunc[axisName] = event.currentTarget.value;\r\n\t\t\t\t\t\t\t\tconst value = Player.execFunc( func, axisName, options.player.getTime(), options );\r\n\t\t\t\t\t\t\t\tif ( axisControllers.position && axisControllers.position.controller ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst controller = axisControllers.position.controller;\r\n\t\t\t\t\t\t\t\t\tcontroller.onchange( { currentTarget: { value: value } } );\r\n\t\t\t\t\t\t\t\t\tcontroller.value = value;\r\n\r\n\t\t\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\t\t\tsetPosition( value, axisName );\r\n\t\t\t\t\t\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\t\t\t\t\t\toptions.guiSelectPoint.update();\r\n\r\n\t\t\t\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\t\t\t\talert( 'Axis: ' + options.scales[axisName].name + '. Function: \"' + func[axisName] + '\". ' + e );\r\n\t\t\t\t\t\t\t\tevent.currentTarget.focus();\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t//position\r\n\t\t\t\t\tcreateController( axisControllers.position, axisName + 'Position', function () { return options.scales[axisName].name; }, {\r\n\r\n\t\t\t\t\t\tvalue: positionLocal[axisName],\r\n\t\t\t\t\t\ttitle: axisName === 'x' ? lang.controllerXTitle : axisName === 'y' ? lang.controllerYTitle : axisName === 'z' ? lang.controllerZTitle : axisName === 'w' ? lang.controllerWTitle : '',\r\n\t\t\t\t\t\tonchange: function ( event ) { setPosition( event.currentTarget.value, axisName ); },\r\n\t\t\t\t\t\taxisName: axisName,\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t//World position\r\n\t\t\t\t\tcreateController( axisControllers.worldPosition, axisName + 'WorldPosition', function () { return lang.controllerWorld + ' ' + options.scales[axisName].name; }, {\r\n\r\n\t\t\t\t\t\tvalue: getWorldPosition( mesh, positionLocal )[axisName],\r\n\t\t\t\t\t\ttitle: axisName === 'x' ? lang.controllerXWorldTitle : axisName === 'y' ? lang.controllerYWorldTitle : axisName === 'z' ? lang.controllerZWorldTitle : axisName === 'w' ? lang.controllerWTitle : '',\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//point name\r\n\t\t\t\tif ( func.name ) {\r\n\r\n\t\t\t\t\tif ( !func.controllers.pointName ) func.controllers.pointName = 'pointName';\r\n\t\t\t\t\tconst elPointName = typeof func.controllers.pointName === \"string\" ? document.getElementById( func.controllers.pointName ) : func.controllers.pointName ;\r\n\t\t\t\t\tif ( elPointName ) elPointName.innerHTML = func.name;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcreateControllers( 'x' );\r\n\t\t\t\tcreateControllers( 'y' );\r\n\t\t\t\tcreateControllers( 'z' );\r\n\t\t\t\tcreateControllers( 'w' );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\tif ( !options || !options.guiSelectPoint ) {\r\n\r\n\t\tif ( options.axesHelper ) options.axesHelper.movePosition();\r\n\t\treturn;\r\n\r\n\t}\r\n\r\n\toptions.guiSelectPoint.setMesh();\r\n\r\n\tvar selectedPointIndex = options.guiSelectPoint.getSelectedPointIndex();\r\n\tif ( ( selectedPointIndex !== -1 ) && options.guiSelectPoint.isSelectedMesh( mesh ) ) {\r\n\r\n\t\toptions.guiSelectPoint.setPosition( {\r\n\r\n\t\t\tobject: mesh,\r\n\t\t\tindex: selectedPointIndex,\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description set color attribute\r\n * @param {Object} attributes [geometry.attributes]{@link https://threejs.org/docs/index.html?q=geometry#api/en/core/BufferGeometry.attributes} of the mesh\r\n * @param {number} i index of the color in the color attribute array.\r\n * @param {THREE.Color} color color.\r\n * @returns true - success\r\n * <p>false - colorAttribute was not detected.</p>\r\n */\r\nPlayer.setColorAttribute = function ( attributes, i, color ) {\r\n\r\n\tif ( typeof color === \"string\" )\r\n\t\tcolor = new THREE.Color( color );\r\n\tconst colorAttribute = attributes.color || attributes.ca;\r\n\tif ( colorAttribute === undefined )\r\n\t\treturn false;\r\n\tcolorAttribute.setX( i, color.r );\r\n\tcolorAttribute.setY( i, color.g );\r\n\tcolorAttribute.setZ( i, color.b );\r\n\tcolorAttribute.needsUpdate = true;\r\n\treturn true;\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description Get array of THREE.Vector4 points.\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs <b>points.geometry.attributes.position</b> array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * <ul>\r\n * <li>float - position of the point.</li>\r\n * Example: 0.5\r\n * <li>[float] - array of positions of the point.</li>\r\n * Example 1: [0.6, 0, -0.5]\r\n * 0.6 is positon for t = min is start time of the playing.\r\n * 0 is position for t = ( max - min ) / 2\r\n * -0.5 is positon for t = max is stop time of the playing.\r\n * If stop time of the playing is infinity, then position is equal to the first item of the array or 0.6 in the example 1.\r\n * \r\n * Example 2: [{ t: 0, v: 0.6 }, { t: 1, v: -0.6 }]\r\n * Every item of array is object with:\r\n * t is time\r\n * v is position for current t.\r\n * <li>[Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * <li>string - text of the function.\r\n * Example: 'Math.sin(t*a*2*Math.PI)*0.5+b' )</li>\r\n * </ul>\r\n * <b>Vector.w</b> is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the <b>Vector.w</b> is from 0 to 1. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * <b>Vector.w</b> can be as [THREE.Color]{@link https://threejs.org/docs/index.html?q=colo#api/en/math/Color}. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n *   \r\n *   //You can set the camera to look at a point. Use <b>cameraTarget</b> key for it.\r\n *   //ATTENTION!!! Only one point can have <b>cameraTarget</b> key!\r\n *   //   You will receive the \r\n *   \r\n *   //      Player.getPoints: duplicate cameraTarget\r\n *   \r\n *   //   console warning if two or more points have <b>cameraTarget</b> key.\r\n *   //   Then only last point with <b>cameraTarget</b> key will be have an effect.\r\n *   [cameraTarget]: {\r\n *\r\n *      camera: [camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera},\r\n *      \r\n *      //rotation camera around point specified by an axis and an angle. Default is undefined - no rotation\r\n *      [rotation]: {\r\n *      \r\n *         [angle]: number|function|array. Angle of rotation in radians.\r\n *            number. Example: Math.PI / 2 rotate to 90 degrees.\r\n *            function. Example: new Function( 't', 'return 5*t' ).\r\n *            array. Example 1: [0, Math.PI]\r\n *                  0 is angle for t = min is start time of the playing.\r\n *                  Math.PI is rotate to 180 degrees for t = max is time of the stopping of the playing.\r\n *                  If max time is infinity, then angle is for t = min.\r\n *               Example 2: [{ t: 0, v: 0 }, { t: 1, v: Math.PI / 2 }\r\n *                  t is time,\r\n *                  v is angle for current t.\r\n *            \r\n *            Default is 0\r\n *\r\n *         [axis]: THREE.Vector3. Axis of rotattion. Example: new THREE.Vector3( 1, 0, 0 ) - rotate around x axis.\r\n *            Default is new THREE.Vector3( 0, 1, 0 );//Rotate around y axis\r\n *            \r\n *      },\r\n *      \r\n *      [distanceToCamera]: <b>THREE.Vector3</b>. Distance from point to camera.\r\n *         You can set the distance to the camera depending on the time.\r\n *         Example 1: new THREE.Vector3( 0, 0, new Function( 't', 'return 2+t' ) )\r\n *         Example 2: new THREE.Vector3( 0, 0, [{ t: 0, v: 5 }, { t: 1, v: 2 }, { t: 10, v: 2 }, { t: 11, v: 5 }] )\r\n *         Default is camera.position.\r\n *      [orbitControls]: [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}. Change the <b>OrbitControl</b> setting during playing.\r\n *      [orbitControlsGui]: <a href=\"../../OrbitControls/jsdoc/index.html\" target=\"_blank\">OrbitControlsGui</a> instance;\r\n *\r\n *   },\r\n *   //Use controls on the web page for display and edit of the point values.\r\n *   [controllers]: {\r\n *   \r\n *      pointName: HTML element or id of element for point name\r\n *      \r\n *      //axisName is \"x\" or \"y\" or \"z\" or \"w\"\r\n *      [axisName]: {\r\n *\r\n *         //Function text controller\r\n *         func: {\r\n *         \r\n *            controller: HTMLElement - <b>input</b> element of function text\r\n *               or string - id of the <b>input</b> element. Default id is \"[axisName]Func\". Example: \"xFunc\".\r\n *            elName: HTMLElement - <b>span</b> element of the function name\r\n *               or string - id of the <b>span</b> element. Default id is \"[axisName]FuncName\". Example: \"xFuncName\".\r\n *               or false - name element is not exists.\r\n *\r\n *         }\r\n *\r\n *         //Point position controller\r\n *         position: {\r\n *\r\n *            controller: HTMLElement - <b>input</b> element of the point position\r\n *               or string - id of the <b>input</b> element. Default id is \"[axisName]Position\". Example: \"xPosition\".\r\n *            elName: HTMLElement - <b>span</b> element of the point position name\r\n *               or string - id of the <b>span</b> element. Default id is \"[axisName]PositionName\". Example: \"xPositionName\".\r\n *               or false - name element is not exists.\r\n *\r\n *         }\r\n *\r\n *         //World point position controller.\r\n *         worldPosition: {\r\n *\r\n *            controller: HTMLElement - <b>input</b> element of the world point position\r\n *               or string - id of the <b>input</b> element. Default id is \"[axisName]WorldPosition\". Example: \"xWorldPosition\".\r\n *            elName: HTMLElement - <b>span</b> element of the world point position name\r\n *               or string - id of the <b>span</b> element. Default id is \"[axisName]WorldPositionName\". Example: \"xWorldPositionName\".\r\n *               or false - name element is not exists.\r\n *\r\n *         }\r\n *\r\n *      }\r\n *\r\n *   },\r\n *\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsPoints] followed optionsPoints is available\r\n * @param {THREE.Group} [optionsPoints.group] {@link https://threejs.org/docs/index.html#api/en/objects/Group|Group}\r\n * or {@link https://threejs.org/docs/index.html#api/en/scenes/Scene|Scene}.\r\n * Use only if you want trace lines during playing. See <b>trace</b> of the <b>arrayFuncs</b> param above.\r\n * @param {number} [optionsPoints.t=0] first parameter of the <b>arrayFuncs</b> item function. Start time of animation.\r\n * @param {object} [optionsPoints.options] the following options are available\r\n * @param {number} [optionsPoints.options.a=1] multiplier. Second parameter of the <b>arrayFuncs</b> item function.\r\n * @param {number} [optionsPoints.options.b=0] addendum. Third parameter of the <b>arrayFuncs</b> item function.\r\n * @param {object} [optionsPoints.options.playerOptions] See <b>settings.options.playerOptions</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a> class.\r\n * @returns array of <b>THREE.Vector4</b> points.\r\n */\r\nPlayer.getPoints = function ( arrayFuncs, optionsPoints ) {\r\n\r\n\tassign();\r\n\t\r\n\tif ( !Array.isArray( arrayFuncs ) ) arrayFuncs = [ arrayFuncs ];\r\n\t\r\n\toptionsPoints = optionsPoints || {};\r\n\tif ( optionsPoints.t === undefined ) optionsPoints.t = optionsPoints.options && optionsPoints.options.player ? optionsPoints.options.player.getSettings().options.playerOptions.min : 0;\r\n\tconst options = optionsPoints.options || new Options(),\r\n\t\toptionsDefault = new Options( { palette: options.palette } );\r\n\toptions.setW( optionsDefault );\r\n\tconst wDefault = optionsDefault.scales.w.max;//new THREE.Vector4().w;//1;//цвет точки по умолчанию равен цвету палитры для максимального значения value,\r\n\t\t\t\t\t\t//которе по умолчанияю равно 1 и определяется в Options class.\r\n\t\t\t\t\t\t//Палитра по умолчанию ColorPicker.paletteIndexes.BGYW\r\n\t\t\t\t\t\t//у которой цвет максимального значения value белый.\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar item = arrayFuncs[i];\r\n\t\tif ( Array.isArray( item ) )\r\n\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\titem[0] === undefined ? 0 : item[0],\r\n\t\t\t\titem[1] === undefined ? 0 : item[1],\r\n\t\t\t\titem[2] === undefined ? 0 : item[2],\r\n\t\t\t\titem[3] === undefined ? wDefault : item[3]\r\n\r\n\t\t\t);\r\n\t\telse if (\r\n\r\n\t\t\t( typeof item === \"object\" )\r\n\t\t\t&& ( item instanceof THREE.Vector2 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector3 === false )\r\n\t\t\t&& ( item instanceof THREE.Vector4 === false )\r\n\r\n\t\t) {\r\n\r\n\t\t\tif ( ( item.vector === undefined ) )\r\n\t\t\t\tarrayFuncs[i] = new THREE.Vector4(\r\n\r\n\t\t\t\t\titem.x === undefined ? 0 : item.x,\r\n\t\t\t\t\titem.y === undefined ? 0 : item.y,\r\n\t\t\t\t\titem.z === undefined ? 0 : item.z,\r\n\t\t\t\t\titem.w === undefined ? 0 : item.w\r\n\r\n\t\t\t\t);\r\n\t\t\telse if (\r\n\r\n\t\t\t\t( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector3 === true )\r\n\t\t\t\t|| ( item.vector instanceof THREE.Vector4 === true )\r\n\r\n\t\t\t) {\r\n\r\n\t\t\t\tif ( item.vector instanceof THREE.Vector2 === true )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector.x === undefined ? 0 : item.vector.x,\r\n\t\t\t\t\t\titem.vector.y === undefined ? 0 : item.vector.y,\r\n\t\t\t\t\t\titem.vector.z === undefined ? 0 : item.vector.z,\r\n\r\n\t\t\t\t\t);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ( item.vector.length === 4 )\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector4(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\t\t\t\t\t\titem.vector[3] === undefined ? 0 : item.vector[3]\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse if ( item.vector.length === 3 )\r\n\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector3(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\t\t\t\t\t\titem.vector[2] === undefined ? 0 : item.vector[2],\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse if ( item.vector.length < 3 )\r\n\r\n\t\t\t\t\tarrayFuncs[i].vector = new THREE.Vector4(\r\n\r\n\t\t\t\t\t\titem.vector[0] === undefined ? 0 : item.vector[0],\r\n\t\t\t\t\t\titem.vector[1] === undefined ? 0 : item.vector[1],\r\n\r\n\t\t\t\t\t);\r\n\t\t\t\telse console.error( 'Player.getPoints(...) falied! item.vector.length = ' + item.vector.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t};\r\n\tconst points = [];\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar funcs = arrayFuncs[i];\r\n\t\tfunction getAxis( axisName ) {\r\n\r\n\t\t\tif ( typeof funcs === \"number\" )\r\n\t\t\t\tfuncs = new THREE.Vector4( funcs, 0, 0, 0 );\r\n\t\t\tif ( ( funcs instanceof THREE.Vector2 ) || ( funcs instanceof THREE.Vector3 ) || ( funcs instanceof THREE.Vector4 ) ) {\r\n\r\n\t\t\t\tconst value = Player.execFunc( funcs, axisName, optionsPoints.t, options );\r\n\t\t\t\treturn value;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.vector === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'Player.getAxis().getPoints(): funcs.vector = ' + funcs.vector );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcs.name !== undefined )\r\n\t\t\t\tfuncs.vector.name = funcs.name;\r\n\r\n\t\t\tif ( funcs.trace ) funcs.vector.trace = funcs.trace;\r\n\t\t\tif ( funcs.controllers ) funcs.vector.controllers = funcs.controllers;\r\n\t\t\tif ( funcs.cameraTarget ) {\r\n\r\n\t\t\t\tfuncs.vector.cameraTarget = funcs.cameraTarget;\r\n\t\t\t\tdelete funcs.cameraTarget;\r\n\r\n\t\t\t}\r\n\t\t\tarrayFuncs[i] = funcs.vector;\r\n\t\t\tfuncs = funcs.vector;\r\n\t\t\treturn Player.execFunc( funcs, axisName, optionsPoints.t, options );\r\n\r\n\r\n\t\t}\r\n\t\tconst point = funcs.vector instanceof THREE.Vector3 === true ?\r\n\t\t\tnew THREE.Vector3( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ) ) :\r\n\t\t\tnew THREE.Vector4( getAxis( 'x' ), getAxis( 'y' ), getAxis( 'z' ), getAxis( 'w' ) );\r\n\r\n\t\tif ( funcs.cameraTarget ) {\r\n\r\n\t\t\tfuncs.cameraTarget.bodefault = false;\r\n\t\t\tif ( funcs.cameraTarget.boLook === undefined ) funcs.cameraTarget.boLook = true;\r\n\r\n\t\t\toptions.playerOptions.cameraTarget.init( funcs.cameraTarget, options );\r\n\r\n\t\t}\r\n\t\tpoints.push( point );\r\n\r\n\t}\r\n\treturn points;\r\n\r\n}\r\nvar boColorWarning = true;\r\n/** @namespace\r\n * @description Get array of mesh colors.\r\n * @param {THREE.Vector4|THREE.Vector3|THREE.Vector2|object|array} arrayFuncs points.geometry.attributes.position array\r\n * <pre>\r\n * THREE.Vector4: 4D point.\r\n * THREE.Vector3: 3D point. w = 1. Default is white color\r\n * THREE.Vector2: 2D point. w = 1, z = 0. Default is white color\r\n * Vector's x, y, z, w is position of the point.\r\n * Can be as:\r\n * float - position of the point.\r\n * [float] - array of positions of the point.\r\n * [Function]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} - position of the point is function of the t.\r\n * Example: new Function( 't', 'a', 'b', 'return Math.sin(t*a*2*Math.PI)*0.5+b' )\r\n *\r\n * Vector.w is index of the [palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n * Default range of the Vector.w is from 0 to 1. You can change range by use an object:\r\n * {\r\n *   func: Vector.w\r\n *   max: new max value of tne Vector.w\r\n *   min: new min value of tne Vector.w\r\n * }\r\n * Example:\r\n * {\r\n *\r\n *   func: new Function( 't', 'return 1-2*t' ),\r\n *   min: -1,\r\n *   max: 1,\r\n *\r\n * }\r\n * Vector.w can be as THREE.Color. Example: new THREE.Color( \"rgb(255, 127, 0)\" )\r\n *\r\n * object: {\r\n *   vector: THREE.Vector4|THREE.Vector3|THREE.Vector2 - point position\r\n *   [name]: point name. Default is undefined.\r\n *   [trace]: true - displays the trace of the point movement. Default is undefined.\r\n * }\r\n * or\r\n * object: {\r\n *   x: x axis. Defauilt is 0.\r\n *   y: y axis. Defauilt is 0.\r\n *   z: z axis. Defauilt is 0.\r\n *   w: w axis. Defauilt is 0.\r\n * }\r\n *\r\n * array: [\r\n *   0: x axis. Defauilt is 0.\r\n *   1: y axis. Defauilt is 0.\r\n *   2: z axis. Defauilt is 0.\r\n *   3: w axis. Defauilt is 0.\r\n * ]\r\n * </pre>\r\n * @param {object} [optionsColor] the following options are available:\r\n * @param {object} [optionsColor.options] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {THREE.BufferAttribute} [optionsColor.positions] geometry.attributes.position of the new mesh.\r\n * @param {array} [optionsColor.colors=[]] array for mesh colors.\r\n * @param {array} [optionsColor.opacity] array of opacities of each geometry position. Each item of array is float value in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n * @returns array of mesh colors.\r\n */\r\nPlayer.getColors = function ( arrayFuncs, optionsColor ) {\r\n\r\n\tassign();\r\n\t\r\n\tif ( !Array.isArray( arrayFuncs ) ) arrayFuncs = [ arrayFuncs ];\r\n\r\n\toptionsColor = optionsColor || {};\r\n\toptionsColor.options = optionsColor.options || {};\r\n\t\r\n\tif (\r\n\t\t( optionsColor.positions !== undefined ) &&\r\n\t\tArray.isArray( arrayFuncs ) &&\r\n\t\t( arrayFuncs.length !== optionsColor.positions.count )\r\n\t) {\r\n\r\n\t\tconsole.error( 'getColors failed! arrayFuncs.length: ' + arrayFuncs.length + ' != positions.count: ' + optionsColor.positions.count );\r\n\t\treturn optionsColor.colors;\r\n\r\n\t}\r\n\r\n\t//не надо убирать const length. Иначе переполнится память\r\n\tconst length = Array.isArray( arrayFuncs ) ? arrayFuncs.length : optionsColor.positions.count;\r\n\r\n\toptionsColor.colors = optionsColor.colors || [];\r\n\tconst colors = [];\r\n\tif ( !optionsColor.options.palette )\r\n\t\toptionsColor.options.setPalette();\r\n\r\n\tfor ( var i = 0; i < length; i++ ) {\r\n\r\n\t\tconst iColor = 3 * i;\r\n\t\tif (iColor >= optionsColor.colors.length) {\r\n\t\t\t\r\n\t\t\tconst funcs = Array.isArray( arrayFuncs ) ? arrayFuncs[i] : undefined;\r\n\t\t\tvar vector;\r\n\t\t\tif (\r\n\t\t\t\t( funcs instanceof THREE.Vector4 ) ||//w of the funcs is color of the point\r\n\t\t\t\t( optionsColor.positions && ( optionsColor.positions.itemSize === 4 ) )//w position of the positions is color of the point\r\n\t\t\t\t) {\r\n\t\r\n\t\t\t\tlet min, max;\r\n\t\t\t\tvar w = funcs.w;\r\n\t\t\t\tif ( funcs.w instanceof Object && funcs.w.func ) {\r\n\t\r\n\t\t\t\t\tif ( funcs.w.max ) max = funcs.w.max;\r\n\t\t\t\t\tif ( funcs.w.min ) min = funcs.w.min;\r\n\t\t\t\t\tw = funcs.w.func;\r\n\t\r\n\t\t\t\t} else {\r\n\t\r\n\t\t\t\t\toptionsColor.options.setW();\r\n\t\t\t\t\tmin = optionsColor.options.scales.w.min; max = optionsColor.options.scales.w.max;\r\n\t\r\n\t\t\t\t}\r\n\t\t\t\tif ( w instanceof Function && !optionsColor.options.player && boColorWarning ) {\r\n\t\r\n\t\t\t\t\tboColorWarning = false;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tconst t = optionsColor.options.playerOptions ? optionsColor.options.playerOptions.min : 0;\r\n\t\t\t\tvar color = optionsColor.options.palette.toColor(\r\n\t\t\t\t\tfuncs === undefined ?\r\n\t\t\t\t\t\tnew THREE.Vector4().fromBufferAttribute( optionsColor.positions, i ).w :\r\n\t\t\t\t\t\tw instanceof Function ?\r\n\t\t\t\t\t\t\tw( t ) :\r\n\t\t\t\t\t\t\ttypeof w === \"string\" ?\r\n\t\t\t\t\t\t\t\tPlayer.execFunc( funcs, 'w', t, optionsColor.options ) :\r\n\t\t\t\t\t\t\t\tw === undefined ? new THREE.Vector4().w : w,\r\n\t\t\t\t\tmin, max );\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );\r\n\t\r\n\t\t\t} else if ( optionsColor.colors instanceof THREE.Float32BufferAttribute )\r\n\t\t\t\tvector = new THREE.Vector3( 1, 1, 1 );\r\n\t\t\telse if (optionsColor.color != undefined) {\r\n\r\n\t\t\t\tconst color = new THREE.Color(optionsColor.color);\r\n\t\t\t\tcolors.push( color.r, color.g, color.b );//white\r\n\t\t\t\t\r\n\t\t\t} else colors.push( 1, 1, 1 );//white\r\n\r\n\t\t}\r\n\t\telse colors.push( optionsColor.colors[iColor], optionsColor.colors[iColor + 1], optionsColor.colors[iColor + 2] );\r\n\r\n\t\t//opacity\r\n\t\tif ( optionsColor.opacity instanceof Array )\r\n\t\t\tcolors.push( i < optionsColor.opacity.length ? optionsColor.opacity[i] : 1 );\r\n\t\telse colors.push( 1 );\r\n\r\n\t}\r\n\toptionsColor.colors = colors;\r\n\treturn optionsColor.colors;\r\n\r\n}\r\n\r\n/** @class */\r\nPlayer.traceLine = class traceLine\r\n{\r\n\r\n\t/**\r\n\t * trace line of moving of the point during playing\r\n\t * @param {object} options the following options are available\r\n\t * @param {object} options.player See <a href=\"../../player/jsdoc/module-Player.html\" target=\"_blank\">Player</a>.\r\n\t */\r\n\tconstructor( options ) {\r\n\r\n\t\tvar line;\r\n\t\tconst arrayLines = [];//сюда добавляются линии когда max: Infinity,\r\n\r\n\t\tassign();\r\n\r\n\t\tif ( !options.player ) {\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Is trace line visible?\r\n\t\t * @returns true - trace line is visible.\r\n\t\t * <p>false - trace line is not visible.</p>\r\n\t\t */\r\n\t\tthis.isVisible = function () {\r\n\r\n\t\t\tif ( !options.player )\r\n\t\t\t\treturn false;//не запущен Player(...)\r\n\r\n\t\t\tif ( line ) return line.visible;\r\n\t\t\tif ( arrayLines.length === 0 ) return false;\r\n\t\t\t//сюда попадает когда t max is Infinity ( options.playerOptions.max === null ) и когда пользователь выбрал точку в guiSelectPoint у которой установлена трассировка\r\n\t\t\treturn arrayLines[0].visible;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Show or hide trace line.\r\n\t\t * @param {boolean} visible true - show trace line.\r\n\t\t * <p>false - hide trace line.</p>\r\n\t\t */\r\n\t\tthis.visible = function ( visible ) {\r\n\r\n\t\t\tif ( !options.player )\r\n\t\t\t\treturn false;//не запущен Player(...)\r\n\r\n\t\t\tif ( line ) {\r\n\r\n\t\t\t\tline.visible = visible;\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\t//сюда попадает когда t max is Infinity (options.playerOptions.max === null) и когда пользователь в выбранной в guiSelectPoint  точке изменил галочку трассировки\r\n\t\t\tarrayLines.forEach( function ( line ) {\r\n\r\n\t\t\t\tline.visible = visible;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * add point into trace line.\r\n\t\t * @param {THREE.Mesh} mesh. See [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for tracing.\r\n\t\t * @param {number} index of the point for tracing.\r\n\t\t * @param {THREE.Color} color. Line color. See [Color]{@link https://threejs.org/docs/index.html#api/en/math/Color}.\r\n\t\t */\r\n\t\tthis.addPoint = function ( mesh, index, color ) {\r\n\r\n\t\t\tconst attributesPosition = mesh.geometry.attributes.position;\r\n\t\t\tvar point = attributesPosition.itemSize >= 4 ? new THREE.Vector4( 0, 0, 0, 0 ) : new THREE.Vector3();\r\n\t\t\tpoint.fromArray( attributesPosition.array, index * attributesPosition.itemSize );\r\n\r\n\t\t\t//нельзя ставить const потому что привыполнении npm run build будет ошибка\r\n\t\t\t// (babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/player/player.js: \"sceneIndex\" is read-only\r\n\t\t\tvar sceneIndex = options.player ? options.player.getSelectSceneIndex() : 0;\r\n\r\n\t\t\tif ( options.playerOptions.max === null ) {\r\n\r\n\t\t\t\t//Infinity play\r\n\t\t\t\t\r\n\t\t\t\tsceneIndex = Math.abs( sceneIndex );\r\n\t\t\t\tif ( sceneIndex < ( arrayLines.length - 1 ) ) {\r\n\r\n\t\t\t\t\twhile ( sceneIndex < ( arrayLines.length - 1 ) ) {\r\n\r\n\t\t\t\t\t\tmesh.remove( arrayLines[arrayLines.length - 1] );\r\n\t\t\t\t\t\tarrayLines.pop();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t// geometry\r\n\t\t\t\tconst geometry = new THREE.BufferGeometry(), MAX_POINTS = 2;\r\n\r\n\t\t\t\t// attributes\r\n\t\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\t\tconst line = new THREE.Line( geometry, new THREE.LineBasicMaterial( { vertexColors: true } ) );\r\n\t\t\t\t//\t\t\tgroup.add( line );\r\n\t\t\t\tmesh.add( line );\r\n\r\n\t\t\t\t//на случай когда пользователь изменил флажок трассировки\r\n\t\t\t\t//первая линия arrayLines[0] всегда имеет visible = true потому что сюда попадат только если установлена трассировка по умолчанию\r\n\t\t\t\t//или пользователь установил флаг трассировки\r\n\t\t\t\tif ( arrayLines[0] ) line.visible = arrayLines[0].visible;\r\n\r\n\t\t\t\t//point position\r\n\t\t\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\t\t\tconst itemSize = line.geometry.attributes.position.itemSize;\r\n\t\t\t\tpoint.toArray( line.geometry.attributes.position.array, 1 * itemSize );\r\n\t\t\t\tconst point0 = arrayLines.length === 0 ? point :\r\n\t\t\t\t\tnew THREE.Vector3().fromArray( arrayLines[arrayLines.length - 1].geometry.attributes.position.array, 1 * itemSize );\r\n\t\t\t\tpoint0.toArray( line.geometry.attributes.position.array, 0 * itemSize );\r\n\t\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t//point color\r\n\t\t\t\tif ( color === undefined )\r\n\t\t\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 0, arrayLines.length === 0 ? color :\r\n\t\t\t\t\tnew THREE.Color().fromArray( arrayLines[arrayLines.length - 1].geometry.attributes.color.array, 1 * itemSize ) );\r\n\t\t\t\tPlayer.setColorAttribute( line.geometry.attributes, 1, color );\r\n\r\n\t\t\t\tarrayLines.push( line );\r\n\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( line === undefined ) {\r\n\r\n\t\t\t\t// geometry\r\n\t\t\t\tconst geometry = new THREE.BufferGeometry();\r\n\r\n\t\t\t\t//Thanks to https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\r\n\t\t\t\tvar MAX_POINTS;\r\n\t\t\t\tif ( options.playerOptions.max !== null ) {\r\n\r\n\t\t\t\t\tif ( options.playerOptions && options.playerOptions.marks )\r\n\t\t\t\t\t\tMAX_POINTS = options.playerOptions.marks;\r\n\t\t\t\t\telse if ( options.player && options.player.marks )\r\n\t\t\t\t\t\tMAX_POINTS = options.player.marks;\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\tconsole.error( 'Player.traceLine: MAX_POINTS = ' + MAX_POINTS + '. Create Player first or remove all trace = true from all items of the arrayFuncs' );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else MAX_POINTS = sceneIndex + 1;\r\n\r\n\t\t\t\t// attributes\r\n\t\t\t\tconst positions = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( positions, 3 ) );\r\n\t\t\t\tconst colors = new Float32Array( MAX_POINTS * 3 ); // 3 coordinates per point\r\n\t\t\t\tgeometry.setAttribute( 'color', new THREE.Float32BufferAttribute( colors, 3 ) );\r\n\r\n\t\t\t\t// draw range\r\n\t\t\t\tgeometry.setDrawRange( sceneIndex, sceneIndex );\r\n\r\n\t\t\t\tline = new THREE.Line( geometry, new THREE.LineBasicMaterial( {\r\n\t\t\t\t\t\r\n\t\t\t\t\t//неудачная попытка исправить frustumPoints после перехода на THREE.REVISION = \"145dev\"\r\n\t\t\t\t\tvertexColors: true,\r\n\r\n\t\t\t\t\t//THREE.Material: 'vertexColors' parameter is undefined.\r\n\t\t\t\t\t//vertexColors: THREE.VertexColors\r\n\t\t\t\t\r\n\t\t\t\t} ) );\r\n\t\t\t\tline.visible = true;\r\n\t\t\t\tmesh.add( line );\r\n\r\n\t\t\t}\r\n\t\t\t//Если не удалять boundingSphere\r\n\t\t\t//и если двигается камера от проигрывания или ее перемещает пользователь\r\n\t\t\t//то в некоторых случаях линию не будет видно даже если она не выходит из поля видимости\r\n\t\t\t//потому что она выходит за рамки frustupoints\r\n\t\t\tif ( line.geometry ) {//scene do not have geometry\r\n\r\n\t\t\t\tdelete line.geometry.boundingSphere;\r\n\t\t\t\tline.geometry.boundingSphere = null;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//point position\r\n\t\t\tpoint = new THREE.Vector3().copy( point );\r\n\t\t\tpoint.toArray( line.geometry.attributes.position.array, sceneIndex * line.geometry.attributes.position.itemSize );\r\n\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t//point color\r\n\t\t\tif ( color === undefined )\r\n\t\t\t\tcolor = new THREE.Color( 1, 1, 1 );//White\r\n\t\t\tPlayer.setColorAttribute( line.geometry.attributes, sceneIndex, color );\r\n\r\n\t\t\t//set draw range\r\n\t\t\tvar start = line.geometry.drawRange.start, count = sceneIndex + 1 - start;\r\n\t\t\tif ( start > sceneIndex ) {\r\n\r\n\t\t\t\tvar stop = start + line.geometry.drawRange.count;\r\n\t\t\t\tstart = sceneIndex;\r\n\t\t\t\tcount = stop - start;\r\n\r\n\t\t\t}\r\n\t\t\tline.geometry.setDrawRange( start, count );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Remove trace line.\r\n\t\t */\r\n\t\tthis.remove = function () {\r\n\r\n\t\t\tif ( line === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tline.geometry.dispose();\r\n\t\t\tline.material.dispose();\r\n\t\t\tline.parent.remove( line );\r\n\t\t\t//\t\tgroup.remove( line );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description get item size of the attribute of the mesh geometry\r\n * @param {array} arrayFuncs points.geometry.attributes.position array.\r\n * See arrayFuncs parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n */\r\nPlayer.getItemSize = function ( arrayFuncs ) {\r\n\r\n\tassign();\r\n\r\n\tfor ( var i = 0; i < arrayFuncs.length; i++ ) {\r\n\r\n\t\tvar func = arrayFuncs[i];\r\n\t\tif ( func instanceof THREE.Vector4 )\r\n\t\t\treturn 4;\r\n\r\n\t}\r\n\treturn 3;\r\n\r\n}\r\n/** @namespace\r\n * @description Select a scene for playing\r\n * @param {THREE.Group} group [THREE.Group]{@link https://threejs.org/docs/index.html#api/en/objects/Group}\r\n * @param {Object} [settings={}] the following settings are available.\r\n * @param {number} [settings.t=0] time\r\n * @param {number} [settings.index] index of the time.\r\n * @param {Object} [settings.options={}] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n */\r\nPlayer.selectPlayScene = function ( group, settings = {} ) {\r\n\r\n\tconst t = settings.t !== undefined ? settings.t : 0,\r\n\t\tindex = settings.index !== undefined ? settings.index : undefined,\r\n\t\toptions = settings.options || new Options();\r\n\tgroup.userData.t = t;\r\n\tPlayer.selectMeshPlayScene( group, { t: t, options: options } );\r\n\tfunction selectMeshPlayScene( group ) {\r\n\r\n\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\tif ( mesh instanceof THREE.Group ) selectMeshPlayScene( mesh );\r\n\t\t\telse Player.selectMeshPlayScene( mesh, { t: t, options: options } );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\tselectMeshPlayScene( group );\r\n\toptions.playerOptions.cameraTarget.setCameraTarget( options );\r\n\tconst cameraTarget = options.playerOptions.cameraTarget.get();\r\n\r\n\t//если index === undefined значит пользователь нажал кнопку 'Default' для восстановления положения камеры.\r\n\t//Значит надо вызвать camera.userData.default.setDefault()\r\n\t//\r\n\t//если index !== undefined значит проигрыватель вызывает очередной кадр и не нужно перемещать камеру в исходное положение\r\n\t//приуслвии что не выбрана ни одна точка как cameraTarget\r\n\tif ( cameraTarget && cameraTarget.setCameraPosition ) cameraTarget.setCameraPosition( index === undefined );\r\n\r\n}\r\nvar THREE;\r\n/* * @namespace\r\n * @description assign some THREE methods\r\n */\r\nfunction assign( ) {\r\n\r\n\tif ( !three.isThree() ) {\r\n\r\n\t\tconsole.warn( 'Player: can not assign. Set THREE first.' )\r\n\t\treturn;\r\n\r\n\t}\r\n\tTHREE = three.THREE;\r\n\tObject.assign( THREE.BufferGeometry.prototype, {\r\n\r\n\t\tsetFromPoints: function ( points, itemSize ) {\r\n\r\n\t\t\titemSize = itemSize || 3;\r\n\t\t\tvar position = [];\r\n\r\n\t\t\tfor ( var i = 0, l = points.length; i < l; i++ ) {\r\n\r\n\t\t\t\tvar point = points[i];\r\n\t\t\t\tposition.push( point.x, point.y, point.z || 0 );\r\n\t\t\t\tif ( itemSize >= 4 )\r\n\t\t\t\t\tposition.push( point.w || 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.setAttribute( 'position', new THREE.Float32BufferAttribute( position, itemSize ) );\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n\t//three.js\\dev\\src\\math\\Vector4.js\r\n\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\tmultiply: function ( v ) {\r\n\r\n\t\t\tthis.x *= v.x;\r\n\t\t\tthis.y *= v.y;\r\n\t\t\tthis.z *= v.z;\r\n\t\t\tif ( v.w !== undefined )\r\n\t\t\t\tthis.w *= v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\t//three.js\\dev\\src\\math\\Vector4.js\r\n\tObject.assign( THREE.Vector4.prototype, {\r\n\r\n\t\tadd: function ( v, w ) {\r\n\r\n\t\t\tif ( w !== undefined ) {\r\n\r\n\t\t\t\tconsole.warn( 'THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.' );\r\n\t\t\t\treturn this.addVectors( v, w );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.x += v.x;\r\n\t\t\tthis.y += v.y;\r\n\t\t\tthis.z += v.z;\r\n\t\t\tif ( v.w !== undefined )\r\n\t\t\t\tthis.w += v.w;\r\n\r\n\t\t\treturn this;\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\t//three.js\\dev\\src\\objects\\Points.js\r\n\tObject.assign( THREE.Points.prototype, {\r\n\r\n\t\traycast: function ( raycaster, intersects ) {\r\n\r\n\t\t\tconst _inverseMatrix = new THREE.Matrix4();\r\n\t\t\tconst _ray = new THREE.Ray();\r\n\t\t\tconst _sphere = new THREE.Sphere();\r\n\t\t\tconst _position = new THREE.Vector3();\r\n\t\t\tfunction testPoint( point, index, localThresholdSq, matrixWorld, raycaster, intersects, object ) {\r\n\r\n\t\t\t\tconst rayPointDistanceSq = _ray.distanceSqToPoint( point );\r\n\r\n\t\t\t\tif ( rayPointDistanceSq < localThresholdSq ) {\r\n\r\n\t\t\t\t\tconst intersectPoint = new THREE.Vector3();\r\n\r\n\t\t\t\t\t_ray.closestPointToPoint( point, intersectPoint );\r\n\t\t\t\t\tintersectPoint.applyMatrix4( matrixWorld );\r\n\r\n\t\t\t\t\tconst distance = raycaster.ray.origin.distanceTo( intersectPoint );\r\n\r\n\t\t\t\t\tif ( distance < raycaster.near || distance > raycaster.far ) return;\r\n\r\n\t\t\t\t\tintersects.push( {\r\n\r\n\t\t\t\t\t\tdistance: distance,\r\n\t\t\t\t\t\tdistanceToRay: Math.sqrt( rayPointDistanceSq ),\r\n\t\t\t\t\t\tpoint: intersectPoint,\r\n\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\tface: null,\r\n\t\t\t\t\t\tobject: object\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst geometry = this.geometry;\r\n\t\t\tconst matrixWorld = this.matrixWorld;\r\n\t\t\tconst threshold = raycaster.params.Points.threshold;\r\n\r\n\t\t\t// Checking boundingSphere distance to ray\r\n\r\n\t\t\tif ( geometry.boundingSphere === null ) geometry.computeBoundingSphere();\r\n\r\n\t\t\t_sphere.copy( geometry.boundingSphere );\r\n\t\t\t_sphere.applyMatrix4( matrixWorld );\r\n\t\t\t_sphere.radius += threshold;\r\n\r\n\t\t\tif ( raycaster.ray.intersectsSphere( _sphere ) === false ) return;\r\n\r\n\t\t\t//\r\n\r\n\t\t\t_inverseMatrix.copy( matrixWorld ).invert();\r\n\t\t\t\r\n\t\t\t_ray.copy( raycaster.ray ).applyMatrix4( _inverseMatrix );\r\n\r\n\t\t\tconst localThreshold = threshold / ( ( this.scale.x + this.scale.y + this.scale.z ) / 3 );\r\n\t\t\tconst localThresholdSq = localThreshold * localThreshold;\r\n\r\n\t\t\tif ( geometry.isBufferGeometry ) {\r\n\r\n\t\t\t\tconst index = geometry.index;\r\n\t\t\t\tconst attributes = geometry.attributes;\r\n\t\t\t\tconst positions = attributes.position.array;\r\n\t\t\t\tconst itemSize = attributes.position.itemSize;\r\n\r\n\t\t\t\tif ( index !== null ) {\r\n\r\n\t\t\t\t\tconst indices = index.array;\r\n\r\n\t\t\t\t\tfor ( let i = 0, il = indices.length; i < il; i++ ) {\r\n\r\n\t\t\t\t\t\tconst a = indices[i];\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, a * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, a, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfor ( let i = 0, l = positions.length / itemSize; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t_position.fromArray( positions, i * itemSize );\r\n\r\n\t\t\t\t\t\ttestPoint( _position, i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst vertices = geometry.vertices;\r\n\r\n\t\t\t\tfor ( let i = 0, l = vertices.length; i < l; i++ ) {\r\n\r\n\t\t\t\t\ttestPoint( vertices[i], i, localThresholdSq, matrixWorld, raycaster, intersects, this );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n}\r\n//assign();\r\n/**\r\n * @namespace\r\n * @description assign some THREE methods\r\n * */\r\nPlayer.assign = function () { assign(); }\r\n\r\nexport default Player;\r\n","/**\r\n * @module myObject\r\n * @description base class for my threejs objects\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n * \r\n*/\r\n\r\nimport three from './three.js'\r\nimport Player from './player/player.js'\r\n\r\nconst sMyObject = 'MyObject';\r\n\r\nclass MyObject {\r\n\r\n\tconstructor( settings={}, vertices ) {\r\n\r\n\t\tconst _this = this;\r\n\r\n\t\tsettings.object = settings.object || {};\r\n\t\tsettings.object.geometry = settings.object.geometry || {};\r\n\r\n\t\tif (!settings.object.geometry.position || !settings.object.geometry.position.isPositionProxy)\r\n\t\t\tsettings.object.geometry.position = new Proxy(settings.object.geometry.position || [], {\r\n\t\r\n\t\t\t\tget: (positions, name) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst positionId = parseInt(name);\r\n\t\t\t\t\tif (!isNaN(positionId)) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\treturn new Proxy(positions[positionId], {\r\n\t\r\n\t\t\t\t\t\t\tset: (position, name, value) => {\r\n\t\r\n\t\t\t\t\t\t\t\tconst axisId = parseInt(name);\r\n\t\t\t\t\t\t\t\tif (!isNaN(axisId)) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tposition[axisId] = value;\r\n\t\t\t\t\t\t\t\t\tsettings.bufferGeometry.userData.position[positionId][axisId] = value;\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tposition[name] = value;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch (name) {\r\n\t\r\n\t\t\t\t\t\tcase 'isPositionProxy': return true;\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn positions[name];\r\n\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t});\r\n\t\r\n\t\tconst THREE = three.THREE;\r\n\r\n\t\tif (!settings.bufferGeometry) settings.bufferGeometry = new THREE.BufferGeometry();\r\n\t\tthis.bufferGeometry = settings.bufferGeometry;\r\n\r\n\t\tif (vertices)\r\n\t\t\t//for for compatibility with ND\r\n\t\t\t//Что бы можно было менять позицию и цвет вершины\r\n\t\t\tsettings.object.geometry.position = settings.object.geometry.position || vertices;\r\n\t\t\r\n\t\tconst createPositionAttribute = (pointLength, pointsLength) => {\r\n\r\n\t\t\t//https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\r\n\t\t\tconst MAX_POINTS = settings.object.geometry.MAX_POINTS;\r\n\t\t\tif (MAX_POINTS != undefined) settings.bufferGeometry.setDrawRange(0, pointsLength * 2 - 1);//Непонятно почему draw count так вычисляется. Еще смотри class Universe.constructor.project.projectGeometry.gui.addControllers.aAngleControls.createArc\r\n//\t\t\tconst positions = new Float32Array(pointsLength * pointLength);\r\n\t\t\tconst positions = new Float32Array((MAX_POINTS != undefined ? MAX_POINTS : pointsLength) * pointLength);\r\n\t\t\tsettings.bufferGeometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, pointLength));\r\n\t\t\tsettings.bufferGeometry.userData.position = new Proxy(settings.bufferGeometry.attributes.position, {\r\n\t\r\n\t\t\t\tget: (position, name) => {\r\n\t\r\n\t\t\t\t\tconst positionId = parseInt(name);\r\n\t\t\t\t\tif (!isNaN(positionId)) {\r\n\r\n\t\t\t\t\t\tconst positionOffset = positionId * position.itemSize, array = position.array;\r\n\t\t\t\t\t\tconst positionItem = new Proxy([], {\r\n\r\n\t\t\t\t\t\t\tget: (vertice, name) => {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst axisId = parseInt(name);\r\n\t\t\t\t\t\t\t\tif (!isNaN(axisId)) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (axisId >= position.itemSize) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t//console.error(sMyObject + ': get position axis failed. Invalid axisId = ' + axisId);\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn array[positionOffset + axisId];\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'forEach': return (item) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor (let axisId = 0; axisId < position.itemSize; axisId++) item(array[positionOffset + axisId], axisId);\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcase 'length': return position.itemSize;\r\n\t\t\t\t\t\t\t\t\tcase 'toJSON': return (item) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet res = '[';\r\n\t\t\t\t\t\t\t\t\t\tpositionItem.forEach(axis => { res += axis + ', ' })\r\n\t\t\t\t\t\t\t\t\t\treturn res.substring(0, res.length-2) + ']';\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcase 'x': return array[positionOffset + 0];\r\n\t\t\t\t\t\t\t\t\tcase 'y': return array[positionOffset + 1];\r\n\t\t\t\t\t\t\t\t\tcase 'z': return array[positionOffset + 2];\r\n\t\t\t\t\t\t\t\t\tcase 'w': {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (position.itemSize < 4) return;\r\n\t\t\t\t\t\t\t\t\t\treturn array[positionOffset + 3];\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn vertice[name];\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tset: (vertice, name, value) => {\r\n\r\n\t\t\t\t\t\t\t\t//edit vertice in http://localhost/anhr/commonNodeJS/master/nD/Examples/ for testing\r\n\t\t\t\t\t\t\t\tconst axisId = parseInt(name);\r\n\t\t\t\t\t\t\t\tif (!isNaN(axisId)) {\r\n\r\n\t\t\t\t\t\t\t\t\tarray[positionOffset + axisId] = value;\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvertice[name] = value;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn positionItem;\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch (name) {\r\n\t\r\n\t\t\t\t\t\tcase 'length': return position.count;\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.error(sMyObject + ': get settings.bufferGeometry.userData.position. Invalid name: ' + name);\r\n\t\t\t\t\treturn position[name];\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t});\t\t\t\r\n\r\n\t\t\t//color\r\n\t\t\tif (_this.setW) _this.setW();\r\n\t\t\tconst itemSize = settings.object.geometry.opacity ? 4 : 3, colors = new Float32Array((MAX_POINTS != undefined ? MAX_POINTS : pointsLength) * itemSize);\r\n\t\t\tsettings.bufferGeometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, itemSize));\r\n\r\n\t\t}\r\n\t\tthis.setPositionAttributeFromPoints = (points, boCreatePositionAttribute) => {\r\n\r\n\t\t\tif (boCreatePositionAttribute) delete settings.bufferGeometry.attributes.position;\r\n\t\t\tif (!settings.bufferGeometry.attributes.position) {\r\n\t\t\t\t\r\n\t\t\t\tcreatePositionAttribute(\r\n\t\t\t\t\tthis.pointLength ? this.pointLength() :\r\n\t\t\t\t\t\tpoints[0].w === undefined ? 3 : 4,\r\n\t\t\t\t\tpoints.length);\r\n\t\t\t\tfor( let i = 0; i < points.length; i++ ) this.setPositionAttributeFromPoint(i);\r\n\r\n\t\t\t}\r\n\t\t\treturn settings.bufferGeometry;\r\n\t\t\t\r\n\t\t}\r\n\t\tthis.verticeColor = (i, vertice) => {\r\n\r\n\t\t\tconst colors = settings.object.geometry.colors;\r\n\t\t\tconst colorsId = i * 3;\r\n\t\t\tif (colors && colors[colorsId] != undefined)\r\n\t\t\t\treturn [colors[colorsId], colors[colorsId + 1], colors[colorsId + 2]];\r\n\t\t\tconst color = settings.object.color;\r\n\t\t\tif ((color != undefined) && (typeof color != 'object')) { return new THREE.Color(_this.color()); }\r\n\t\t\t//Вершина не имеет 4 координаты. Установить цвет вершины по умолчанию\r\n\t\t\tconst getDefaultColor = () => { return new THREE.Color(_this.color()); }\r\n\t\t\tlet w\r\n\t\t\tif (vertice) w = vertice.w;\r\n\t\t\telse if (!_this.getPoint) {\r\n\r\n\t\t\t\tconst position = _this.bufferGeometry.attributes.position;\r\n\t\t\t\tif (position.itemSize != 4) return getDefaultColor();\r\n\t\t\t\tw = new THREE.Vector4().fromBufferAttribute(position, i).w;\r\n\r\n\t\t\t}\r\n\t\t\telse w = _this.getPoint(i).w;\r\n\t\t\tif (w === undefined) return getDefaultColor();\r\n\t\t\treturn w;\r\n\r\n\t\t}\r\n\t\tthis.setPositionAttributeFromPoint = (i, vertice) => {\r\n\r\n\t\t\t//Position attribute\r\n\t\t\t\r\n\t\t\tconst attributes = settings.bufferGeometry.attributes, position = attributes.position, itemSize = position.itemSize;\r\n\t\t\tvertice = vertice || _this.getPoint(i);\r\n\t\t\tlet positionId = i * itemSize, array = position.array;\r\n\t\t\t                  array [positionId++] = vertice.x != undefined ? vertice.x : vertice[0] != undefined ? vertice[0] : 0;\r\n\t\t\tif (itemSize > 1) array [positionId++] = vertice.y != undefined ? vertice.y : vertice[1] != undefined ? vertice[1] : 0;\r\n\t\t\tif (itemSize > 2) array [positionId++] = vertice.z != undefined ? vertice.z : vertice[2] != undefined ? vertice[2] : 0;\r\n\t\t\tconst w = vertice.w;\r\n\t\t\tif (itemSize > 3) array [positionId] = w;\r\n\r\n\t\t\t//Color attribute\r\n\t\t\t\r\n\t\t\tlet colorId = i * attributes.color.itemSize;\r\n\t\t\tarray = attributes.color.array;\r\n\t\t\tconst verticeColor = this.verticeColor(i, vertice);\r\n\t\t\tif (typeof verticeColor === 'number'){\r\n\r\n\t\t\t\tif (settings.options) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst wScale = settings.options.scales.w;\r\n\t\t\t\t\tPlayer.setColorAttribute(attributes, i, settings.options.palette.toColor(w, wScale.min, wScale.max));\r\n\r\n\t\t\t\t}\r\n\t\t\t\tcolorId += attributes.color.itemSize - 1;\r\n\t\t\t\t\r\n\t\t\t} else if (Array.isArray(verticeColor)) verticeColor.forEach(item => array[colorId++] = item);\r\n\t\t\telse if (verticeColor instanceof THREE.Color) {\r\n\r\n\t\t\t\tarray [colorId++] = verticeColor.r;\r\n\t\t\t\tarray [colorId++] = verticeColor.g;\r\n\t\t\t\tarray [colorId++] = verticeColor.b;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\telse console.error(sMyObject + '.setPositionAttributeFromPoint: Invalid verticeColor = ' + verticeColor);\r\n\r\n\t\t\t//opacity\r\n\t\t\tif (attributes.color.itemSize > 3) this.verticeOpacity(i);\r\n\t\t\t\r\n\t\t}\r\n\t\tthis.verticeOpacity = (i, transparent, opacity) => {\r\n\r\n\t\t\tconst color = settings.bufferGeometry.attributes.color;\r\n\t\t\tif (color.itemSize != 4) {\r\n\r\n\t\t\t\tconsole.error(sMyObject + '.verticeOpacity: Invalid color.itemSize = ' + color.itemSize);\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tconst array = color.array;\r\n\t\t\tconst verticeOpacity = settings.object.geometry.opacity ? settings.object.geometry.opacity[i] : undefined;\r\n\t\t\tarray[color.itemSize * i + 3] = transparent ? opacity : verticeOpacity === undefined ? 1 : verticeOpacity;\r\n\t\t\tcolor.needsUpdate = true;\r\n\r\n\t\t}\r\n\t\tthis.verticesOpacity = ( transparent, opacity ) => {\r\n\t\t\t\r\n\t\t\tconst color = settings.bufferGeometry.attributes.color;\r\n\t\t\tif ( color && ( color.itemSize > 3 ) ) {\r\n\r\n\t\t\t\tfor ( let i = 0; i < color.count; i++ ) { this.verticeOpacity(i, transparent, opacity); }\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst object3D = _this.object3D;\r\n\t\t\t\tif (object3D) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tobject3D.material.transparent = transparent;\r\n\t\t\t\t\tobject3D.material.opacity = transparent ? opacity : 1;\r\n\t\t\t\t\tobject3D.material.needsUpdate = true;//for THREE.REVISION = \"145dev\"\r\n\r\n\t\t\t\t} else console.error(sMyObject + '.verticesOpacity: Invalid object3D');\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\r\n\t\t}\r\n\t\tthis.color = () => {\r\n\t\r\n\t\t\tconst color = settings.object.color != undefined ? settings.object.color : settings.pointsOptions != undefined ? settings.pointsOptions.color : undefined;\r\n\t\t\treturn (color != undefined) ? color : this.defaultColor;//'lime';\r\n\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tget defaultColor() { return 'white'; }\r\n\tget isOpacity() {\r\n\r\n\t\tif (this.bufferGeometry.attributes.color.itemSize > 3) {\r\n\t\t\t\r\n\t\t\tif (!this.object3D.material.transparent) console.error(sMyObject + '.isOpacity: invalid this.object3D.material.transparent = ' + this.object3D.material.transparent);\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t\treturn false;\r\n\t\r\n\t}\r\n\r\n}\r\nexport default MyObject;\r\n","/**\r\n * @module getShaderMaterialPoints\r\n * @description get THREE.Points with THREE.ShaderMaterial material\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport three from '../three.js'\r\nimport Player from '../player/player.js';\r\nimport Options from '../Options.js'\r\nimport MyObject from '../myObject.js'\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\nconst currentScriptPath = getCurrentScriptPath(),\r\n\t_vertex_text = {\r\n\r\n\t\tarray: [],\r\n\t\tsetItem: function ( path, text ) { this.array.push( { path: path, text: text } ) },\r\n\t\tgetItem: function ( path ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.array.length; i++ ) { if ( this.array[i].path === path ) return this.array[i].text; }\r\n\r\n\t\t}\r\n\r\n\t},\r\n\t_fragment_text = {\r\n\r\n\t\tarray: [],\r\n\t\tsetItem: function ( path, text ) { this.array.push( { path: path, text: text } ) },\r\n\t\tgetItem: function ( path ) {\r\n\r\n\t\t\tfor ( var i = 0; i < this.array.length; i++ ) { if ( this.array[i].path === path ) return this.array[i].text; }\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\nclass getShaderMaterialPoints extends MyObject {\r\n\r\n\t/**\r\n\t * get [THREE.Points]{@link https://threejs.org/docs/index.html?q=Points#api/en/objects/Points} with [THREE.ShaderMaterial]{@link https://threejs.org/docs/index.html?q=ShaderMaterial#api/en/materials/ShaderMaterial} material\r\n\t * @param {THREE.Group|THREE.Scene} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t * @param {array} arrayFuncs <b>points.geometry.attributes.position</b> array.\r\n\t * See <b>arrayFuncs</b> parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n\t * @param {function(THREE.Points)} onReady Callback function that take as input the new THREE.Points.\r\n\t * @param {object} [settings={}]\r\n\t * @param {number} [settings.tMin=0] start time. Uses for playing of the points.\r\n\t * @param {object} [settings.pointsOptions] points options.\r\n\t * See <b>settings.pointsOptions</b> of <a href=\"../../MyPoints/jsdoc/module-MyPoints.html\" target=\"_blank\">MyPoints</a> for details.\r\n\t * @param {object} [settings.options={}] see <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> <b>options</b> parameter for details\r\n\t * @param {Object} [settings.options.point] point options.\r\n\t * See <a href=\"../../jsdoc/Options/Options.html#point\" target=\"_blank\">Options get point</a> member for details.\r\n\t * @param {number} [settings.options.scales] Axis scales.\r\n\t * See  <b>options.scales</b> of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> for details.\r\n\t * @param {object} [settings.options.scales.w] w axis scale.\r\n\t * See <a href=\"../../jsdoc/Options/Options.html#setW\" target=\"_blank\">Options.setW(options)</a> for details.\r\n\t*/\r\n\tconstructor(group, arrayFuncs, onReady, settings = {}) {\r\n\r\n\t\tsuper(settings, arrayFuncs);\r\n\r\n\t\tconst THREE = three.THREE, tMin = settings.pointsOptions === undefined ?\r\n\t\t\tsettings.tMin === undefined ? 0 : settings.tMin :\r\n\t\t\tsettings.pointsOptions.tMin === undefined ? 0 : settings.pointsOptions.tMin;\r\n\r\n\t\tsettings.options = settings.options || new Options();\r\n\r\n\t\tsettings.pointsOptions = settings.pointsOptions || {};\r\n\r\n\t\t//Эту строку нужно вызывать до создания точек THREE.Points\r\n\t\t//что бы вызывалась моя версия THREE.BufferGeometry().setFromPoints для создания geometry c itemSize = 4\r\n\t\t//потому что в противном случае при добавлени этих точек в FrustumPoints.pushArrayCloud() координата w будет undefined\r\n\t\tPlayer.assign();\r\n\r\n\t\tvar geometry;\r\n\t\tif (arrayFuncs instanceof THREE.BufferGeometry) {\r\n\r\n\t\t\tgeometry = arrayFuncs;\r\n\t\t\tarrayFuncs = [];\r\n\t\t\tfor (var i = 0; i < geometry.attributes.position.count; i++)\r\n\t\t\t\tarrayFuncs.push(new THREE.Vector3().fromBufferAttribute(geometry.attributes.position, i));\r\n\r\n\t\t} else if (typeof arrayFuncs === 'function')\r\n\t\t\tgeometry = arrayFuncs();\r\n\t\telse {\r\n\r\n\t\t\tif (settings.pointsOptions.bufferGeometry)\r\n\t\t\t\tgeometry = settings.pointsOptions.bufferGeometry;\r\n\t\t\telse {\r\n\t\t\t\t\r\n\t\t\t\tconst points = Player.getPoints(arrayFuncs, { options: settings.options, group: group, t: tMin, });\r\n\t\t\t\tthis.getPoint = (i) => { return points[i]; }\r\n\t\t\t\tgeometry = this.setPositionAttributeFromPoints(points);\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tconst indexArrayCloud = settings.pointsOptions.frustumPoints ? settings.pointsOptions.frustumPoints.pushArrayCloud(geometry) : undefined;//индекс массива точек в FrustumPoints.arrayCloud которые принадлежат этому points\r\n/*\r\n\t\tif ((settings.pointsOptions === undefined) || !settings.pointsOptions.boFrustumPoints) {\r\n\r\n\t\t\t//если не делать эту проверку, то будет неправильный цвет точки, если не задана палитра и шкала w\r\n\t\t\tif (!settings.options.scales.w) settings.options.scales.setW();\r\n\t\t\tgeometry.setAttribute(\r\n\t\t\t\t'color',\r\n\t\t\t\tnew THREE.Float32BufferAttribute(Player.getColors\r\n\t\t\t\t(arrayFuncs,\r\n\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\tcolor: settings.pointsOptions.color,\r\n\t\t\t\t\t\tcolors: settings.pointsOptions.colors,\r\n\t\t\t\t\t\topacity: settings.pointsOptions === undefined ? undefined : settings.pointsOptions.opacity,\r\n\t\t\t\t\t\tpositions: geometry.attributes.position,\r\n\t\t\t\t\t\toptions: settings.options,\r\n\r\n\t\t\t\t\t}),\r\n\t\t\t\t4));\r\n\r\n\t\t}\r\n*/\t\t\r\n\r\n\t\tconst texture = new THREE.TextureLoader().load(currentScriptPath + \"/textures/point.png\",\r\n\t\t\tfunction (texture) { }, function () { }, function () { console.error('THREE.TextureLoader: error'); });\r\n\t\ttexture.wrapS = THREE.RepeatWrapping;\r\n\t\ttexture.wrapT = THREE.RepeatWrapping;\r\n\r\n\t\tconst uniforms = {\r\n\r\n\t\t\tpointTexture: { value: texture },\r\n\r\n\t\t\tpointSize: {\r\n\r\n\t\t\t\tvalue: (settings.pointsOptions !== undefined) && (settings.pointsOptions.shaderMaterial !== undefined) && (settings.pointsOptions.shaderMaterial.point !== undefined) ?\r\n\t\t\t\t\tsettings.pointsOptions.shaderMaterial.point.size :\r\n\t\t\t\t\tsettings.options.point.size\r\n\r\n\t\t\t},\r\n\r\n\t\t}\r\n\r\n\t\tvar cloud;\r\n\t\tif ((settings.pointsOptions !== undefined) && (settings.pointsOptions.uniforms !== undefined))\r\n\t\t\tcloud = settings.pointsOptions.uniforms(uniforms);\r\n\r\n\r\n\t\t/**\r\n\t\t * Loading of the vertex and fragment contents from external files.\r\n\t\t * Thanks to https://stackoverflow.com/a/48188509/5175935\r\n\t\t * @param {function()} onLoad Callback function that called after success loading.\r\n\t\t * */\r\n\t\tfunction loadShaderText(onload, path) {\r\n\r\n\t\t\tconst shaderText = {};\r\n\r\n\t\t\t/**\r\n\t\t\t * This is a basic asyncronous shader loader for THREE.js.\r\n\t\t\t * Thanks to https://www.davideaversa.it/2016/10/three-js-shader-loading-external-file/\r\n\t\t\t * https://github.com/THeK3nger/threejs-async-shaders-example\r\n\t\t\t * \r\n\t\t\t * It uses the built-in THREE.js async loading capabilities to load shaders from files!\r\n\t\t\t * \r\n\t\t\t * `onProgress` and `onError` are stadard TREE.js stuff. Look at \r\n\t\t\t * https://threejs.org/examples/webgl_loader_obj.html for an example. \r\n\t\t\t * \r\n\t\t\t * @param {String} vertex_url URL to the vertex shader code.\r\n\t\t\t * @param {String} fragment_url URL to fragment shader code\r\n\t\t\t * @param {function(String, String)} onLoad Callback function(vertex, fragment) that take as input the loaded vertex and fragment contents.\r\n\t\t\t * @param {object} [options] the following options are available\r\n\t\t\t * @param {function(event)} [options.onProgress] Callback for the `onProgress` event.\r\n\t\t\t * @param {function(event)} [options.onError] Callback for the `onError` event.\r\n\t\t\t */\r\n\t\t\tfunction ShaderLoader(vertex_url, fragment_url, onLoad, options) {\r\n\r\n\t\t\t\toptions = options || {};\r\n\r\n\t\t\t\tvar vertex_text = _vertex_text.getItem(vertex_url);\r\n\t\t\t\tfunction loadFragment() {\r\n\r\n\t\t\t\t\tconst fragment_text = _fragment_text.getItem(fragment_url);\r\n\t\t\t\t\tif (!fragment_text) {\r\n\r\n\t\t\t\t\t\t//load fragment.c file\r\n\t\t\t\t\t\tconst fragment_loader = new THREE.FileLoader(THREE.DefaultLoadingManager);\r\n\t\t\t\t\t\tfragment_loader.setResponseType('text');\r\n\t\t\t\t\t\tfragment_loader.load(fragment_url, function (fragment_text) {\r\n\r\n\t\t\t\t\t\t\t_fragment_text.setItem(fragment_url, fragment_text);\r\n\t\t\t\t\t\t\tonLoad(vertex_text, fragment_text);\r\n\r\n\t\t\t\t\t\t}, options.onProgress, options.onError);\r\n\r\n\t\t\t\t\t} else onLoad(vertex_text, fragment_text);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (!vertex_text) {\r\n\r\n\t\t\t\t\t//load vertex.c file\r\n\t\t\t\t\tconst vertex_loader = new THREE.FileLoader(THREE.DefaultLoadingManager);\r\n\t\t\t\t\tvertex_loader.setResponseType('text');\r\n\t\t\t\t\tvertex_loader.load(vertex_url, function (vertex_text_new) {\r\n\r\n\t\t\t\t\t\t_vertex_text.setItem(vertex_url, vertex_text_new);\r\n\t\t\t\t\t\tvertex_text = vertex_text_new;\r\n\t\t\t\t\t\tloadFragment();\r\n\r\n\t\t\t\t\t}, options.onProgress, options.onError);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tloadFragment();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpath = path || {};\r\n\t\t\tpath.vertex = path.vertex || currentScriptPath + \"/getShaderMaterialPoints/vertex.c\";\r\n\t\t\tpath.fragment = path.fragment || currentScriptPath + \"/getShaderMaterialPoints/fragment.c\";\r\n\t\t\tShaderLoader(path.vertex, path.fragment,\r\n\t\t\t\tfunction (vertex, fragment) {\r\n\r\n\t\t\t\t\tshaderText.vertex = vertex;\r\n\t\t\t\t\tshaderText.fragment = fragment;\r\n\t\t\t\t\tonload(shaderText);\r\n\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tonError: function (event) {\r\n\r\n\t\t\t\t\t\tconsole.error(event.srcElement.responseURL + ' status = ' + event.srcElement.status + ' ' + event.srcElement.statusText);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tloadShaderText(function (shaderText) {\r\n\r\n\t\t\t//See description of the\r\n\t\t\t//const int cloudPointsWidth = %s;\r\n\t\t\t//in the \\frustumPoints\\vertex.c\r\n\t\t\tif (cloud !== undefined) {\r\n\r\n\t\t\t\tcloud.editShaderText(shaderText);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst points = new THREE.Points(geometry, new THREE.ShaderMaterial({\r\n\r\n\t\t\t\t//See https://threejs.org/examples/webgl_custom_attributes_points2.html\r\n\t\t\t\t//D: \\My documents\\MyProjects\\webgl\\three.js\\GitHub\\three.js\\dev\\examples\\webgl_custom_attributes_points2.html\r\n\t\t\t\t//OpenGL Shading Language https://www.khronos.org/opengl/wiki/OpenGL_Shading_Language\r\n\t\t\t\t//Обзор спецификации GLSL ES 2.0 http://a-gro-pro.blogspot.com/2013/06/glsl-es-20.html\r\n\t\t\t\t//Open GL 4. Язык шейдеров. Книга рецептов http://www.cosmic-rays.ru/books61/2015ShadingLanguage.pdf\r\n\t\t\t\t//OpenGL® 4.5 Reference Pages. Ключевые слова по алфавиту https://www.khronos.org/registry/OpenGL-Refpages/gl4/\r\n\r\n\t\t\t\tuniforms: uniforms,\r\n\t\t\t\tvertexShader: shaderText.vertex,\r\n\t\t\t\tfragmentShader: shaderText.fragment,\r\n\t\t\t\ttransparent: true,\r\n\r\n\t\t\t}));\r\n\t\t\tpoints.userData.shaderMaterial = settings.pointsOptions === undefined ? settings.shaderMaterial : settings.pointsOptions.shaderMaterial;\r\n\t\t\tif (settings.options.saveMeshDefault !== undefined)\r\n\t\t\t\tsettings.options.saveMeshDefault(points);\r\n\t\t\tif ((settings.pointsOptions) && (settings.pointsOptions.frustumPoints))\r\n\t\t\t\tpoints.userData.cloud = { indexArray: indexArrayCloud, }\r\n\t\t\tpoints.userData.shaderMaterial = settings.pointsOptions === undefined ? settings.shaderMaterial : settings.pointsOptions.shaderMaterial;\r\n\t\t\tonReady(points);\r\n\r\n\t\t\t//Convert all points with cloud and shaderMaterial from local to world positions\r\n\t\t\t// i.e. calculate scales, positions and rotation of the points.\r\n\t\t\t//Converting of all points with cloud, but not shaderMaterial see updateCloudPoint in the frustumPoints.create function\r\n\t\t\tif (points.userData.boFrustumPoints) {\r\n\r\n\t\t\t\tsettings.pointsOptions.group.children.forEach(function (mesh) {\r\n\r\n\t\t\t\t\tsettings.options.frustumPoints.updateCloudPoint(mesh);\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//нужно что бы обновились точки в frustumPoints\r\n\t\t\tif (points.material.uniforms.palette !== undefined)\r\n\t\t\t\tpoints.material.uniforms.palette.value.needsUpdate = true;\r\n\t\t\tif (points.material.uniforms.cloudPoints !== undefined)\r\n\t\t\t\tpoints.material.uniforms.cloudPoints.value.needsUpdate = true;\r\n\t\t\t//Player.selectMeshPlayScene(points, { options: settings.options });\r\n\t\t\t//Что бы камера смотрела на выбранную точку сразу после запуска приложения\r\n\t\t\tconst cameraTarget = settings.options.playerOptions.cameraTarget.get(settings.options);\r\n\t\t\tif (cameraTarget && cameraTarget.setCameraPosition) cameraTarget.setCameraPosition();\r\n\r\n\t\t}, settings.pointsOptions === undefined ? undefined : settings.pointsOptions.path);\r\n\r\n\t}\r\n\r\n}\r\nexport default getShaderMaterialPoints;\r\n","/**\r\n * @module MyPoints\r\n * @description Array of my points.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport Player from '../player/player.js';\r\nimport getShaderMaterialPoints from '../getShaderMaterialPoints/getShaderMaterialPoints.js';\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\nimport MyObject from '../myObject.js'\r\n\r\nclass MyPoints extends MyObject {\r\n\r\n\t/**\r\n\t * Creating the new [THREE.Points]{@link https://threejs.org/docs/index.html?q=poi#api/en/objects/Points} and adding it into group.\r\n\t * @param {array} arrayFuncs <b>points.geometry.attributes.position</b> array.\r\n\t * See <b>arrayFuncs</b> parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n\t * @param {THREE.Group} [group] [Group]{@link https://threejs.org/docs/index.html?q=grou#api/en/objects/Group} for new points.\r\n\t * Default is <b><a href=\"../../jsdoc/three/Three.html\" target=\"_blank\">three</a>.scene</b>\r\n\t * @param {object} [settings={}] the following settings are available\r\n\t * @param {object|Options} [settings.options=new Options()] the following options are available.\r\n\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Object} [settings.options.point] point options.\r\n\t * See <a href=\"../../jsdoc/Options/global.html#point\" target=\"_blank\">Options.point</a> for details.\r\n\t * @param {object} [settings.options.scales.w] followed w axis scale params is available\r\n\t * @param {object} [settings.options.scales.w.min=0] Minimal range of the [color palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n\t * @param {object} [settings.options.scales.w.max=1] Maximal range of the [color palette]{@link https://github.com/anhr/commonNodeJS/tree/master/colorpicker}.\r\n\t * @param {object} [settings.options.palette=new ColorPicker.palette();//palette: ColorPicker.paletteIndexes.BGYW] See <a href=\"../../colorPicker/jsdoc/module-ColorPicker.html#~Palette\" target=\"_blank\">ColorPicker.palette</a>.\r\n\t * <pre>\r\n\t * Example:\r\n\t * <b>new ColorPicker.palette( { palette: ColorPicker.paletteIndexes.bidirectional } );</b>\r\n\t * </pre>\r\n\t * @param {GuiSelectPoint} [settings.options.guiSelectPoint] A [dat.gui]{@link https://github.com/anhr/dat.gui} based graphical user interface for select a point from the mesh.\r\n\t * See <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a> for details.\r\n\t * @param {object} [settings.options.raycaster] Followed [raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} options is available.\r\n\t * @param {Function(particle)} [settings.options.raycaster.addParticle] Callback function that take as input the <b>new THREE.Points</b>.\r\n\t * Add new particle into array of objects to check for intersection with the ray. See [THREE.Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t * @param {Function(particle)} [settings.options.raycaster.removeParticle] Callback function that take as input the <b>new THREE.Points</b>.\r\n\t * Remove particle from array of objects to check for intersection with the ray. See [THREE.Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} for details.\r\n\t * @param {object} [settings.pointsOptions={}] followed points options is availablee:\r\n\t * @param {FrustumPoints} [settings.pointsOptions.frustumPoints] Include this points into array of points with cloud. See <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a>.\r\n\t * @param {number} [settings.pointsOptions.tMin=0] start time. Uses for playing of the points..\r\n\t * @param {string} [settings.pointsOptions.name=\"\"] Name of the points. Used for displaying of items of the <b>Select</b> drop down control of the <b>Meshes</b> folder of the [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t * @param {object|boolean} [settings.pointsOptions.shaderMaterial] creates the [THREE.Points]{@link https://threejs.org/docs/index.html?q=poi#api/en/objects/Points} with [THREE.ShaderMaterial]{@link https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial} material.\r\n\t * The size of the each point of the <b>THREE.Points</b> seems the same on canvas\r\n\t * because I reduce the size of the points closest to the camera and increase the size of the points farthest to the camera.\r\n\t * <p>false - no shaderMaterial.\r\n\t * @param {object} [settings.pointsOptions.shaderMaterial.point]\r\n\t * @param {number} [settings.pointsOptions.shaderMaterial.point.size] point size.\r\n\t * @param {THREE.Vector3} [settings.pointsOptions.position=new THREE.Vector3( 0, 0, 0 )] position of the points.\r\n\t * <pre>\r\n\t * Vector's x, y, z is position of the points.\r\n\t * Can be as:\r\n\t * float - position of the points.\r\n\t * [float] - array of positions of the points.\r\n\t * Function - position of the points is function of the t. Example:\r\n\t *\t<b>new Function( 't', 'return 0.1 + t' )</b>\r\n\t * </pre>\r\n\t * Example:\r\n\t * @param {Array} [settings.pointsOptions.colors] Array of colors for the each vertex.\r\n\t * <pre>\r\n\t * Every vertex is associated with 3 values of the <b>colors</b> array.\r\n\t * Each value of the <b>colors</b> array is red or green or blue color of the particular vertex in range from 0 to 1.\r\n\t * \r\n\t * 0 is no color.\r\n\t * 1 is full color.\r\n\t * \r\n\t * For example:\r\n\t * settings.object.geometry.colors: [\r\n\t * \t1, 0, 0,//red color of the <b>position[0]</b> vertex.\r\n\t * \t0, 1, 0,//green color of the <b>position[1]</b> vertex.\r\n\t * \t0, 0, 1,//blue color of the <b>position[2]</b> vertex.\r\n\t * \t1, 1, 1,//white color of the <b>position[3]</b> vertex.\r\n\t * ],\r\n\t * Have effect only if <b>arrayFuncs</b> points are not <b>THREE.Vector4</b> type. See <b>arrayFuncs</b> parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n\t * </pre>\r\n\t * @param {String|number} [settings.pointsOptions.color='lime'] color of points.\r\n\t * <pre>\r\n\t * String - color name. See list of available color names in the <b>_colorKeywords</b> object in the [Color.js]{@link https://github.com/mrdoob/three.js/blob/dev/src/math/Color.js} file.\r\n\t * number - color [Hex triplet]{@link https://en.wikipedia.org/wiki/Web_colors#Hex_triplet}. Example: 0x0000ff - blue color.\r\n\t * Have effect only if <b>settings.pointsOptions.colors</b> are not defined.\r\n\t * <pre>\r\n\t * @param {boolean|array} [settings.pointsOptions.opacity] \r\n\t * <pre>\r\n\t * boolean -\r\n\t *\tIf true then opacity of the point is depend from distance to all meshes points from the group with defined <b>mesh.userData.cloud</b>.\r\n\t *\tSee <b>optionsColor.opacity</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.getColors.html\" target=\"_blank\">Player.getColors(...)</a>ions.getColors for details.\r\n\t * array -\r\n\t *\tArray of opacities of each position of the points.\r\n\t *\tEach item of array is float value in the range of 0.0 - 1.0 indicating how transparent the material is.\r\n\t *\tA value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t * @param {THREE.Vector3} [settings.pointsOptions.scale=new THREE.Vector3( 1, 1, 1 )] scale of the points.\r\n\t * <pre>\r\n\t * Vector's x, y, z is scale of the points.\r\n\t * Can be as:\r\n\t * float - scale of the points.\r\n\t * [float] - array of scales of the points.\r\n\t * Function - scale of the points is function of the t. Example:\r\n\t *\t<b>new Function( 't', 'return 1.1 + t' )</b>\r\n\t * </pre>\r\n\t * Example:\r\n\t * <b>new THREE.Vector3 ( new Function( 't', 'return 1 + t' ), 1, 1)</b>\r\n\t * @param {THREE.Vector3} [settings.pointsOptions.rotation=new THREE.Vector3( 0, 0, 0 )] rotation of the points.\r\n\t * <pre>\r\n\t * Vector's x, y, z is rotation of the points.\r\n\t * Can be as:\r\n\t * float - rotation of the points.\r\n\t * [float] - array of rotations of the points.\r\n\t * Function - rotation of the points is function of the t. Example:\r\n\t *\t<b>new Function( 't', 'return Math.PI / 2 + t * Math.PI * 2' )</b>\r\n\t * </pre>\r\n\t * Example:\r\n\t * <b>new THREE.Vector3 ( new Function( 't', 'return Math.PI / 2 + t * Math.PI * 2' ), 0, 0)</b>\r\n\t * @param {function} [settings.pointsOptions.onReady] Callback function that take as input the <b>new THREE.Points</b>.\r\n\t * Fires after creating of the points.\r\n\t * <pre>\r\n\t * function( points )\r\n\t *\t<b>points</b> - [Points]{@link https://threejs.org/docs/index.html?q=Poin#api/en/objects/Points}.\r\n\t *\tCall the <b>points.userData.opacity(opacity)</b> function if you want to change the opacity of the points.\r\n\t *\t\tThe <b>opacity</b> parameter is float in the range of 0.0 - 1.0 indicating how transparent the points is.\r\n\t *\t\tA value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t * </pre>\r\n\t * @param {object} [settings.pointsOptions.raycaster] Followed [raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster} options is available.\r\n\t * @param {Function(intersection, mouse)} [settings.pointsOptions.raycaster.onIntersection] Callback function that take as input the <b>[intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} </b>, and <b>mouse position</b>.\r\n\t * Fires after intersection of the mouse pointer with a point.\r\n\t * @param {Function()} [settings.pointsOptions.raycaster.onIntersectionOut] Callback function.\r\n\t * Fires if mouse pointer leaves of intersection with the point.\r\n\t * @param {Function(intersection)} [settings.pointsOptions.raycaster.onMouseDown] Callback function that take as input the <b>[intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject} </b>.\r\n\t * User has clicked over point.\r\n\t * @param {object} [settings.pointsOptions.elements] Followed elements can display on the web page\r\n\t * @param {HTMLElement|string} [settings.pointsOptions.elements.pointsName] Display of the <b>settings.pointsOptions.name</b> on the web page.\r\n\t * <pre>\r\n\t * HTMLElement - element for displaying.\r\n\t * string - <b>id</b> of the element.\r\n\t * </pre>\r\n\t */\r\n\tconstructor(arrayFuncs, group, settings) {\r\n\r\n\t\tsuper(settings, arrayFuncs);\r\n\r\n\t\tconst _this = this;\r\n\t\t\r\n\t\tconst THREE = three.THREE;\r\n\r\n\t\tgroup = group || three.scene;\r\n\r\n\t\tif ((typeof arrayFuncs !== 'function') && (arrayFuncs.length === 0))\r\n\t\t\tarrayFuncs.push(new THREE.Vector3());\r\n\r\n\t\tsettings.pointsOptions = settings.pointsOptions || {};\r\n\t\tconst pointsOptions = settings.pointsOptions;\r\n\t\tsettings.options = settings.options || new Options();\r\n\t\tvar options = settings.options;\r\n\t\tif (!options.boOptions) options = new Options(options);\r\n\t\tpointsOptions.tMin = pointsOptions.tMin || 0;\r\n\t\tpointsOptions.name = pointsOptions.name || '';\r\n\t\tpointsOptions.position = pointsOptions.position || new THREE.Vector3(0, 0, 0);\r\n\t\tpointsOptions.scale = pointsOptions.scale || new THREE.Vector3(1, 1, 1);\r\n\t\tpointsOptions.rotation = pointsOptions.rotation || new THREE.Vector3();\r\n\t\tpointsOptions.group = group;\r\n\r\n\t\t//points name\r\n\t\tif (pointsOptions.name !== '' && pointsOptions.elements) {\r\n\r\n\t\t\tif (pointsOptions.elements.pointsName === null) console.warn('MyPoints: Points name element is not exists');\r\n\t\t\tif (!pointsOptions.elements.pointsName) pointsOptions.elements.pointsName = 'pointsName';\r\n\t\t\tconst elPointsName = typeof pointsOptions.elements.pointsName === \"string\" ?\r\n\t\t\t\tdocument.getElementById(pointsOptions.elements.pointsName) : pointsOptions.elements.pointsName;\r\n\t\t\tif (elPointsName) elPointsName.innerHTML = pointsOptions.name;\r\n\t\t\telse console.warn('MyPoints: Element with id: \"' + pointsOptions.elements.pointsName + '\" is not exists');\r\n\r\n\t\t}\r\n\r\n\t\t//Эту строку нужно вызывать до создания точек THREE.Points\r\n\t\t//что бы вызывалась моя версия THREE.BufferGeometry().setFromPoints для создания geometry c itemSize = 4\r\n\t\t//потому что в противном случае при добавлени этих точек в FrustumPoints.pushArrayCloud() координата w будет undefined\r\n\t\tPlayer.assign();\r\n\r\n\t\tif (pointsOptions.shaderMaterial !== false)\r\n\t\t\tnew getShaderMaterialPoints(group, arrayFuncs,function (points) { Points(points); }, {\r\n\r\n\t\t\t\toptions: options,\r\n\t\t\t\tpointsOptions: pointsOptions,\r\n\t\t\t\tobject: { geometry: { position: settings.object.geometry.position, opacity: settings.object.geometry.opacity } },\r\n\t\t\t\tbufferGeometry: settings.bufferGeometry,\r\n\r\n\t\t\t});\r\n\t\telse {\r\n\r\n\t\t\tlet buffer;\r\n\t\t\tif ( typeof arrayFuncs === 'function' ) buffer = arrayFuncs();\r\n\t\t\telse {\r\n\r\n\t\t\t\tconst points = Player.getPoints(arrayFuncs, { options: options, group: group, t: pointsOptions.tMin });\r\n\t\t\t\tthis.getPoint = (i) => { return points[i]; }\r\n\t\t\t\tbuffer = this.setPositionAttributeFromPoints( points );\r\n\r\n\t\t\t}\r\n\t\t\tconst points = new THREE.Points( buffer,\r\n\t\t\t\tnew THREE.PointsMaterial({\r\n\r\n\t\t\t\t\tsize: options.point.size / options.point.sizePointsMaterial,\r\n\r\n\t\t\t\t\t//THREE.Material: 'vertexColors' parameter is undefined.\r\n\t\t\t\t\t//vertexColors: THREE.VertexColors,\r\n\t\t\t\t\tvertexColors: true,\r\n\t\t\t\t\ttransparent: settings.pointsOptions.opacity ?\r\n\t\t\t\t\t\ttrue ://установлена прозрачность вершин\r\n\t\t\t\t\t\tundefined,\r\n\r\n\t\t\t\t})\r\n\r\n\t\t\t);\r\n\r\n\t\t\tif (pointsOptions.frustumPoints)\r\n\t\t\t\tpoints.userData.cloud = {\r\n\r\n\t\t\t\t\tindexArray: pointsOptions.frustumPoints.pushArrayCloud(points.geometry),//индекс массива точек в FrustumPoints.arrayCloud которые принадлежат этому points\r\n\r\n\t\t\t\t}\r\n\t\t\tPoints(points);\r\n\r\n\t\t}\r\n\t\tfunction Points(points) {\r\n\r\n\t\t\t_this.object3D = points;\r\n\t\t\tpoints.name = pointsOptions.name;//'Wave';\r\n\t\t\tif (pointsOptions.pointIndexes !== undefined)\r\n\t\t\t\tpoints.userData.pointIndexes = function (pointIndex) { return pointsOptions.pointIndexes(pointIndex); }\r\n\t\t\tif (pointsOptions.pointName !== undefined)\r\n\t\t\t\tpoints.userData.pointName = function (pointIndex) { return pointsOptions.pointName(pointIndex); }\r\n\t\t\tif (pointsOptions.controllers !== undefined) {\r\n\r\n\t\t\t\tpoints.userData.addControllers = pointsOptions.addControllers;\r\n\t\t\t\tpoints.userData.controllers = function ( /*cFrustumPoints*/) { return pointsOptions.controllers( /*cFrustumPoints*/); }\r\n\r\n\t\t\t}\r\n\t\t\tif (settings.pointsOptions.raycaster) points.userData.raycaster = settings.pointsOptions.raycaster;\r\n\t\t\tvar arrayFuncsPlayer;\r\n\t\t\tif (arrayFuncs instanceof THREE.BufferGeometry) {\r\n\r\n\t\t\t\tarrayFuncsPlayer = [];\r\n\t\t\t\tfor (var i = 0; i < arrayFuncs.attributes.position.count; i++)\r\n\t\t\t\t\tarrayFuncsPlayer.push(new THREE.Vector3().fromBufferAttribute(arrayFuncs.attributes.position, i));\r\n\r\n\t\t\t} else arrayFuncsPlayer = arrayFuncs;\r\n\t\t\tpoints.userData.player = {\r\n\r\n\t\t\t\tarrayFuncs: arrayFuncsPlayer,\r\n\t\t\t\tselectPlayScene: function (t) {\r\n\r\n\t\t\t\t\tsetPositions(t);\r\n\t\t\t\t\tsetScales(t);\r\n\t\t\t\t\tsetRotations(t);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tfunction setPositions(t) {\r\n\r\n\t\t\t\tt = t || pointsOptions.tMin;\r\n\t\t\t\tfunction setPosition(axisName) {\r\n\r\n\t\t\t\t\tpoints.position[axisName] = typeof pointsOptions.position[axisName] === \"function\" ?\r\n\t\t\t\t\t\tpointsOptions.position[axisName](t, options.a, options.b) :\r\n\t\t\t\t\t\tpointsOptions.position[axisName];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetPosition('x');\r\n\t\t\t\tsetPosition('y');\r\n\t\t\t\tsetPosition('z');\r\n\r\n\t\t\t}\r\n\t\t\tsetPositions();\r\n\t\t\tfunction setScales(t) {\r\n\r\n\t\t\t\tt = t || pointsOptions.tMin;\r\n\t\t\t\tfunction setScale(axisName) {\r\n\r\n\t\t\t\t\tpoints.scale[axisName] = typeof pointsOptions.scale[axisName] === \"function\" ?\r\n\t\t\t\t\t\tpointsOptions.scale[axisName](t, options.a, options.b) :\r\n\t\t\t\t\t\tpointsOptions.scale[axisName];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetScale('x');\r\n\t\t\t\tsetScale('y');\r\n\t\t\t\tsetScale('z');\r\n\r\n\t\t\t}\r\n\t\t\tsetScales();\r\n\t\t\tfunction setRotations(t) {\r\n\r\n\t\t\t\tt = t || pointsOptions.tMin;\r\n\t\t\t\tfunction setRotation(axisName) {\r\n\r\n\t\t\t\t\tpoints.rotation[axisName] = typeof pointsOptions.rotation[axisName] === \"function\" ?\r\n\t\t\t\t\t\tpointsOptions.rotation[axisName](t, options.a, options.b) :\r\n\t\t\t\t\t\tpointsOptions.rotation[axisName];\r\n\t\t\t\t\twhile (points.rotation[axisName] < 0) points.rotation[axisName] += Math.PI * 2;\r\n\t\t\t\t\twhile (points.rotation[axisName] > Math.PI * 2) points.rotation[axisName] -= Math.PI * 2\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetRotation('x');\r\n\t\t\t\tsetRotation('y');\r\n\t\t\t\tsetRotation('z');\r\n\r\n\t\t\t}\r\n\t\t\tsetRotations();\r\n\t\t\tgroup.add(points);\r\n\r\n//\t\t\tpoints.userData.setPositionAttribute = ( i ) => { _this.setPositionAttribute( i ); }\r\n\t\t\tpoints.userData.myObject = _this;\r\n\t\t\tpoints.userData.opacity = (opacity) => {\r\n\r\n\t\t\t\t_this.verticesOpacity(false, opacity);\r\n/*\t\t\t\t\r\n\t\t\t\tconst ca = points.geometry.attributes.ca ? points.geometry.attributes.ca : points.geometry.attributes.color, array = ca.array;\r\n\t\t\t\tfor (let i = 0; i < ca.count; i++) {\r\n\r\n\t\t\t\t\tconst pointOpacity = settings.object.geometry.opacity[i];\r\n\t\t\t\t\tarray[ca.itemSize * i + 3] = pointOpacity === undefined ? opacity : pointOpacity;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tca.needsUpdate = true;\r\n*/\t\t\t\t\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (pointsOptions.boFrustumPoints) points.userData.boFrustumPoints = pointsOptions.boFrustumPoints;\r\n\t\t\tif (options.guiSelectPoint) options.guiSelectPoint.addMesh(points);\r\n\t\t\tif (options.eventListeners) options.eventListeners.addParticle(points);\r\n\t\t\tif (pointsOptions.onReady !== undefined) pointsOptions.onReady(points);\r\n\r\n\t\t\tif (!points.userData.boFrustumPoints && options.raycaster && options.raycaster.addParticle)\r\n\t\t\t\toptions.raycaster.addParticle(points);\r\n\r\n\t\t}\r\n\r\n\t}\r\n//\tget defaultColor() { return 'white'; }\r\n\r\n}\r\nexport default MyPoints;\r\n","/**\r\n * @module DropdownMenu\r\n * @description Creates a drop down menu in your javaScript code.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport loadScript from '../loadScriptNodeJS/loadScript.js';\r\n\r\nvar optionsStyle = {\r\n\r\n\t//style rel=\"stylesheet\"\r\n\ttag: 'style'\r\n\r\n}\r\n\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n//Такая же функция есть в frustumPoints.js но если ее использовать то она будет возвращать путь на frustumPoints.js\r\nconst getCurrentScript = function () {\r\n\r\n\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\treturn document.currentScript.src;\r\n\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\tstr = scripts[scripts.length - 1].src;\r\n\tif ( str !== '' )\r\n\t\treturn src;\r\n\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n};\r\n//Thanks to https://stackoverflow.com/a/27369985/5175935\r\nconst getCurrentScriptPath = function () {\r\n\tconst script = getCurrentScript(),\r\n\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\treturn path;\r\n};\r\n//console.warn( 'getCurrentScriptPath = ' + getCurrentScriptPath() );\r\nvar currentScriptPath = getCurrentScriptPath();\r\n//Для D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\DropdownMenu\\build\r\nvar arrayPath = currentScriptPath.split( /(.*)(\\/build)/ );\r\nif ( arrayPath[2] === '/build' ) currentScriptPath = arrayPath[1];\r\n//Для D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\canvasMenu\\build\r\narrayPath = currentScriptPath.split( /(.*)(\\/canvasMenu)/ );\r\nif ( arrayPath[2] === '/canvasMenu' ) currentScriptPath = arrayPath[1] + '/DropdownMenu';\r\n\r\n//Attention! Load menu.css file before other css files for correctly priority of the styles\r\nloadScript.sync( currentScriptPath + '/styles/menu.css', optionsStyle );//move dat.gui into canvas\r\nloadScript.sync( currentScriptPath + '/styles/gui.css', optionsStyle );//move dat.gui into canvas\r\nloadScript.sync( currentScriptPath + '/styles/Decorations/transparent.css', optionsStyle );\r\nloadScript.sync( currentScriptPath + '/styles/Decorations/gradient.css', optionsStyle );\r\n\r\n/**\r\n * Creates new menu\r\n * @param {Array} arrayMenu array of menu and submenu items. If array item is string then menu item name. If array item is object then options of the new menu item:\r\n * @param {String|HTMLElement} [arrayMenu.name] if string then menu item name. If HTMLElement then item element.\r\n * @param {String} [arrayMenu.title] menu item title.\r\n * @param {String} [arrayMenu.id] menu item identifier.\r\n * @param {String} [arrayMenu.style] menu item style. Example: \"float: right;\".\r\n * @param {Array} [arrayMenu.items] array of submenu items. Same as menu item.\r\n * @param {Function} [arrayMenu.onclick] <b>function(event)</b> called when user has clicked a menu item. event - event details.\r\n * @param {Object} [arrayMenu.drop] direction of drop of the submenu.\r\n * <pre>\r\n * Following directions is available:\r\n * If string then \"up\" - drop submenu to up. \"left\" - shift submenu to left.\r\n * If object then following members is available:\r\n * </pre>\r\n * @param {boolean} [arrayMenu.drop.up] true - drop submenu to up.\r\n * @param {boolean} [arrayMenu.drop.left] true - shift submenu to left.\r\n * @param {boolean} [arrayMenu.radio] true - defines a radio menu item.\r\n * @param {boolean} [arrayMenu.checkbox] true - defines a checkbox menu item.\r\n * @param {boolean} [arrayMenu.checked] true - checked state of a checkbox or radio menu item.\r\n *\r\n * @param {Object} [options] the following options are available.\r\n * @param {HTMLElement} [options.elParent=\"body\" element] Parent element of new menu.\r\n * @param {HTMLElement} [options.canvas] <b>canvas</b> element. Use if you want put a menu inside a canvas. Use [CanvasMenu]{@link https://github.com/anhr/commonNodeJS/tree/master/canvasMenu} instead <b>DropdownMenu</b> for it.\r\n * @param {String} [options.decorations] You can decorate your menu by a built-in style or use your custom style. Currently two built-in styles is available:\r\n * <pre>\r\n * 'Gradient' - use [gradient.css]{@link https://raw.githack.com/anhr/commonNodeJS/master/DropdownMenu/styles/Decorations/gradient.css} file for decoration.\r\n * 'Transparent' - use [transparent.css]{@link https://raw.githack.com/anhr/commonNodeJS/master/DropdownMenu/styles/Decorations/transparent.css} file for decoration.\r\n * Custom decoration:\r\n * 'Custom' please edit the [custom.css]{@link https://raw.githack.com/anhr/commonNodeJS/master/DropdownMenu/Examples/html/custom.css} file from my example if you want a custom decoration of your menu.\r\n * <pre>\r\n */\r\nfunction create( arrayMenu, options ) {\r\n\r\n\toptions = options || {};\r\n\toptions.elParent = options.elParent || document.querySelector( 'body' );\r\n\tswitch ( options.decorations ) {\r\n\r\n\t\tcase 'Gradient':\r\n\t\tcase 'Transparent':\r\n\t\tcase 'Custom':\r\n\t\tcase undefined:\r\n\t\t\tbreak;\r\n\t\tdefault: console.error( 'DropdownMenu.create: Invalid options.decorations: ' + options.decorations );\r\n\t}\r\n\r\n\t//create menu element\r\n\tvar elMenu = document.createElement( 'menu' );\r\n\tif ( options.elParent.classList.contains( \"container\" ) )\r\n\t\telMenu.className = 'controls';\r\n\r\n\tvar timeoutControls;\r\n\tfunction displayControls() {\r\n\r\n\t\telMenu.style.opacity = 1;\r\n\t\tclearTimeout( timeoutControls );\r\n\t\ttimeoutControls = setTimeout( function () {\r\n\r\n\t\t\telMenu.style.opacity = 0;\r\n\r\n\t\t}, 5000 );\r\n\r\n\t}\r\n\tif ( options.canvas ) {\r\n\r\n\t\telMenu.style.opacity = 0;\r\n\t\toptions.canvas.onmouseout = function ( event ) {\r\n\r\n\t\t\telMenu.style.opacity = 0;\r\n\r\n\t\t}\r\n\t\toptions.canvas.onmousemove = function ( event ) {\r\n\r\n\t\t\tdisplayControls();\r\n\r\n\t\t}\r\n\t\telMenu.onmousemove = function ( event ) {\r\n\r\n\t\t\tdisplayControls();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\toptions.elParent.appendChild( elMenu );\r\n\r\n\tarrayMenu.forEach( function ( menuItem ) {\r\n\r\n\t\tvar dropdownChild = 'dropdown-child';\r\n\t\tfunction moveUpLeft( drop ) {\r\n\r\n\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\tvar display = elDropdownChild.style.display;\r\n\t\t\t\telDropdownChild.style.display = 'block';\r\n\t\t\t\tif ( drop.up )\r\n\t\t\t\t\telDropdownChild.style.top = '-' + ( elDropdownChild.offsetHeight ) + 'px';\r\n\t\t\t\telse elDropdownChild.style.top = ( elMenuButton.offsetHeight -1 ) + 'px';\r\n\t\t\t\tif ( drop.left )\r\n\t\t\t\t\telDropdownChild.style.left = ( elMenuButton.offsetWidth - elDropdownChild.offsetWidth ) + 'px';\r\n\t\t\t\telDropdownChild.style.display = display;\r\n\r\n\t\t\t}, 0 );\r\n\r\n\t\t}\r\n\r\n\r\n\t\t//Create menuButton class element\r\n\t\tvar elMenuButton = document.createElement( 'span' );\r\n\t\telMenuButton.className =\r\n\t\t\t'menuButton' + ( options.decorations === undefined ? '' : ' menuButton' + options.decorations );\r\n\r\n\t\tif ( menuItem.style !== undefined )\r\n\t\t\telMenuButton.style.cssText = menuItem.style;\r\n\r\n\t\tif ( menuItem.radio !== undefined )\r\n\t\t\telMenuButton.style.cssText = menuItem.style;\r\n\r\n\t\tif ( menuItem.onclick !== undefined )\r\n\t\t\telMenuButton.onclick = menuItem.onclick;\r\n\t\tif ( menuItem.id !== undefined )\r\n\t\t\telMenuButton.id = menuItem.id;\r\n\r\n\t\tvar name;\r\n\t\tif ( typeof menuItem === 'string' )\r\n\t\t\tname = menuItem;\r\n\t\telse {\r\n\r\n\t\t\tname = menuItem.name;\r\n\r\n\t\t\tif ( menuItem.id )\r\n\t\t\t\telMenuButton.id = menuItem.id;\r\n\t\t\tif ( menuItem.title )\r\n\t\t\t\telMenuButton.title = menuItem.title;\r\n\r\n\t\t}\r\n\r\n\t\t//Create name span\r\n\t\tswitch ( typeof name ) {\r\n\t\t\tcase \"object\":\r\n\t\t\t\telMenuButton.appendChild( name );\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"string\":\r\n\t\t\tcase \"undefined\":\r\n\t\t\t\telMenuButton.innerHTML = name;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: console.error( 'Invalid typeof name: ' + typeof name );\r\n\t\t}\r\n\r\n\t\t//Create dropdown-child items\r\n\t\tif ( menuItem.items ) {\r\n\r\n\t\t\tvar elDropdownChild = document.createElement( 'span' );\r\n\t\t\telDropdownChild.className = dropdownChild + ' ' + dropdownChild + ( options.decorations === undefined ? 'Default' : options.decorations );\r\n\t\t\telDropdownChild.title = '';\r\n\t\t\telMenuButton.appendChild( elDropdownChild );\r\n\r\n\t\t\t//for compatibility with firefox\r\n//\t\t\tgetMenuButtonBorderWidth();\r\n\r\n\t\t\tmenuItem.items.forEach( function ( itemItem ) {\r\n\r\n\t\t\t\t//Create name span\r\n\t\t\t\tvar elName = document.createElement( 'nobr' ),\r\n\t\t\t\t\tclassChecked = 'checked';\r\n\t\t\t\tfunction getItemName(item) {\r\n\r\n\t\t\t\t\tconst str = typeof item === 'string' ?\r\n\t\t\t\t\t\titem :\r\n\t\t\t\t\t\t\titem.radio === true ?\r\n\t\t\t\t\t\t\t( item.checked ? '◉' : '◎' ) + ' ' + item.name\r\n\t\t\t\t\t\t\t: item.checkbox === true ? ( item.checked ? '☑' : '☐' ) + ' ' + item.name : item.name;//✓🗹\r\n\t\t\t\t\t//console.log(str);\r\n\t\t\t\t\treturn str;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction getElementFromEvent( event ) {\r\n\t\t\t\t\tif ( !event ) event = window.event;//for IE6\r\n\t\t\t\t\treturn event.target || event.srcElement;\r\n\t\t\t\t}\r\n\t\t\t\tvar name;\r\n\t\t\t\tif ( typeof itemItem === 'string' )\r\n\t\t\t\t\tname = itemItem;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tname = itemItem.name;\r\n\t\t\t\t\telName.onclick = function ( event ) {\r\n\r\n\t\t\t\t\t\tif ( itemItem.radio === true ) {\r\n\r\n\t\t\t\t\t\t\tmenuItem.items.forEach( function ( item ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( item.radio === true ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( getElementFromEvent( event ) === item.elName ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\titem.checked = true;\r\n\t\t\t\t\t\t\t\t\t\titem.elName.classList.add( classChecked );\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\titem.checked = false;\r\n\t\t\t\t\t\t\t\t\t\titem.elName.classList.remove( classChecked );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\titem.elName.innerHTML = getItemName( item );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t} else if ( itemItem.checkbox === true ) {\r\n\r\n\t\t\t\t\t\t\tif ( itemItem.checked === true ) {\r\n\r\n\t\t\t\t\t\t\t\titemItem.elName.classList.add( classChecked );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\titemItem.elName.classList.remove( classChecked );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titemItem.checked = !itemItem.checked;\r\n\t\t\t\t\t\t\titemItem.elName.innerHTML = getItemName( itemItem );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( itemItem.onclick )\r\n\t\t\t\t\t\t\titemItem.onclick( event );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( itemItem.radio === true )\r\n\t\t\t\t\telName.classList.add( 'radio' );\r\n\t\t\t\tif ( itemItem.checkbox === true )\r\n\t\t\t\t\telName.classList.add( 'checkbox' );\r\n\t\t\t\tif ( itemItem.id )\r\n\t\t\t\t\telName.id = itemItem.id;\r\n\t\t\t\tif ( itemItem.title )\r\n\t\t\t\t\telName.title = itemItem.title;\r\n\t\t\t\telName.innerHTML = getItemName( itemItem );\r\n\r\n\t\t\t\tif ( itemItem.checked === true )\r\n\t\t\t\t\telName.classList.add( classChecked );\r\n\r\n\t\t\t\telDropdownChild.appendChild( elName );\r\n\t\t\t\tif ( typeof itemItem !== \"string\")\r\n\t\t\t\t\titemItem.elName = elName;\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif ( typeof menuItem.drop === 'object' ) {\r\n\r\n\t\t\t\tmoveUpLeft( menuItem.drop );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tswitch ( menuItem.drop ) {\r\n\r\n\t\t\t\t\tcase 'up':\r\n\t\t\t\t\t\tmoveUpLeft( {\r\n\r\n\t\t\t\t\t\t\tup: true,\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\tmoveUpLeft( {\r\n\r\n\t\t\t\t\t\t\tleft: true,\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase undefined:\r\n\t\t\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\t\t\telDropdownChild.style.left = '-' + elMenuButton.clientWidth + 'px';\r\n\t\t\t\t\t\t\telDropdownChild.style.top = ( elMenuButton.offsetHeight - 1 ) + 'px';\r\n\r\n\t\t\t\t\t\t}, 0 );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'Invalid menuItem.drop: ' + menuItem.drop );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\telMenu.appendChild( elMenuButton );\r\n\r\n\t} );\r\n\treturn elMenu;\r\n\r\n}\r\nexport { create };\r\n","/**\r\n * @module DropdownMenu\r\n * @description Creates a drop down menu in your javaScript code.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport { create } from './index.js';\r\n/**\r\n * Creates a drop down menu in your javaScript code.\r\n */\r\nvar DropdownMenu = {\r\n\r\n    create: create,\r\n\r\n}\r\nexport default DropdownMenu;\r\n","/**\r\n * @module CanvasMenu\r\n * @description My [dropdown menu]{@link https://github.com/anhr/commonNodeJS/tree/master/DropdownMenu} for canvas in my [three.js]{@link https://threejs.org/} projects.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport three from '../three.js'\r\n//import { lang } from '../controllerPlay/index.js';\r\n\r\n//import { create as dropdownMenuCreate } from '../DropdownMenu/index.js';\r\nimport DropdownMenu from '../DropdownMenu/dropdownMenu.js';\r\n\r\n//import StereoEffect from 'https://raw.githack.com/anhr/commonNodeJS/master/StereoEffect/StereoEffect.js';\r\nimport StereoEffect from '../StereoEffect/StereoEffect.js';\r\n\r\nimport CreateFullScreenSettings from '../createFullScreenSettings.js';\r\nimport Options from '../Options.js'\r\n\r\n/**\r\n * @callback onFullScreenToggle\r\n * @param {boolean} fullScreen true - full screen mode of the canvas.\r\n */\r\n\r\nclass CanvasMenu {\r\n\r\n\t/**\r\n\t * @class Create [dropdown menu]{@link https://github.com/anhr/commonNodeJS/tree/master/DropdownMenu} for canvas in my [three.js]{@link https://threejs.org/} projects.\r\n\t * @param {THREE.WebGLRenderer} renderer [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n\t * @param {Object} [settings={}] the following settings are available\r\n\t * @param {Array} [settings.menu] menu array. See <b>arrayMenu</b> of the [DropdownMenu.create]{@link https://raw.githack.com/anhr/commonNodeJS/master/DropdownMenu/jsdoc/module-DropdownMenu.html#~create}\r\n\t * @param {Function} [settings.onOver] The event is fired at an Element when a pointing device (such as a mouse or trackpad) is used to move the cursor onto the element or one of its child elements.\r\n\t * <pre>\r\n\t * true - mouseenter event.\r\n\t * false - mouseleave event.\r\n\t * </pre>\r\n\t *\r\n\t * @param {Object} [settings.fullScreen] Add a \"Full Screen\" button\r\n\t * <p>\r\n\t * Full screen of the canvas see <b>settings.options.canvas.fullScreen</b>.\r\n\t * </p>\r\n\t * @param {onFullScreen} settings.fullScreen.camera [THREE.PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t * @param {onFullScreenToggle} [settings.fullScreen.onFullScreenToggle] user toggled fullscreen mode of the canvas.\r\n\t *\r\n\t * @param {Options} [settings.options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Player} [settings.options.player] <a href=\"../../Player/jsdoc/index.html\" target=\"_blank\">Player</a> instance. Playing of 3D ojbects in my projects.\r\n\t * @param {StereoEffect} [settings.options.stereoEffect] <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a> instance.\r\n\t * @param {boolean} [settings.options.canvas.fullScreen] Default canvas is full screen. false - no full screen\r\n\t * @param {Function} [settings.options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t */\r\n\tconstructor( renderer, settings = {} ) {\r\n\r\n\t\tif ( !three.isThree() ) {\r\n\r\n\t\t\tconsole.warn( 'CanvasMenu: Set THREE first.' )\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst THREE = three.THREE;\r\n\r\n\t\tsettings.options = settings.options || new Options();\r\n\t\tconst options = settings.options;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'CanvasMenu: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tif ( options.canvasMenu === false ) return;\r\n\t\toptions.canvasMenu = this;\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst lang = {\r\n\t\t\tfullScreen: 'Full Screen',\r\n\t\t\tnonFullScreen: 'Non Full Screen',\r\n\t\t}\r\n\r\n\t\tconst getLanguageCode = options.getLanguageCode;\r\n\t\tswitch ( getLanguageCode() ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\t\t\t\tlang.prevSymbolTitle = 'Кадр назад';//'Go to previous animation scene',\r\n\t\t\t\tlang.playTitle = 'Проиграть';//'Play'\r\n\t\t\t\tlang.nextSymbolTitle = 'Кадр вперед';//'Go to next animation scene';\r\n\t\t\t\tlang.pauseTitle = 'Пауза';//'Pause',\r\n\t\t\t\tlang.repeatOn = 'Повторять проигрывание';\r\n\t\t\t\tlang.repeatOff = 'Остановить повтор проигрывания';\r\n\t\t\t\tlang.controllerTitle = 'Текущее время.';\r\n\t\t\t\tlang.stereoEffects = 'Стерео эффекты';\r\n\t\t\t\tlang.mono = 'Моно';\r\n\t\t\t\tlang.sideBySide = 'Слева направо';\r\n\t\t\t\tlang.topAndBottom = 'Сверху вниз';\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tif ( THREE && ( renderer instanceof THREE.WebGLRenderer !== true ) ) {\r\n\r\n\t\t\tconsole.error( 'CanvasMenu: renderer is not THREE.WebGLRenderer' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst elCanvas = renderer.domElement, elContainer = elCanvas.parentElement;\r\n\t\tif ( elContainer.tagName !== \"DIV\" ) {\r\n\r\n\t\t\tconsole.error( 'CanvasMenu: elContainer.tagName = ' + elContainer.tagName );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst container = \"container\";\r\n\t\tif ( !elContainer.classList.contains( container ) ) elContainer.classList.add( container );\r\n\t\tsettings.menu = settings.menu || [];\r\n\r\n\t\t/**\r\n\t\t * Menu array\r\n\t\t * @array canvasMenu.\r\n\t\t * menu\r\n\t\t * @see <b>arrayMenu</b> of the [DropdownMenu.create]{@link https://raw.githack.com/anhr/commonNodeJS/master/DropdownMenu/jsdoc/module-DropdownMenu.html#~create}\r\n\t\t */\r\n\t\tthis.menu = settings.menu;\r\n\r\n\t\tif ( settings.options.stereoEffect && settings.options.stereoEffect.createCanvasMenuItem )\r\n\t\t\tsettings.options.stereoEffect.createCanvasMenuItem( this, { getLanguageCode: options.getLanguageCode } );\r\n\r\n\t\tif ( options.player ) { options.player.createCanvasMenuItem( this, getLanguageCode ); }\r\n\r\n\t\tCreateFullScreenSettings.RendererSetSize( renderer, this );\r\n\r\n\t\t//Full Screen button\r\n\t\tvar fullScreenSettings;\r\n\t\tif ( settings.fullScreen !== undefined ) {\r\n\r\n\t\t\tif ( !settings.fullScreen.camera ) {\r\n\r\n\t\t\t\tconsole.error( 'CanvasMenu: settings.fullScreen.camera = ' + settings.fullScreen.camera );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tfullScreenSettings = new CreateFullScreenSettings( THREE, renderer, settings.fullScreen.camera,\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tcanvasMenu: this,\r\n\t\t\t\t\tfullScreen: settings.fullScreen,\r\n\r\n\t\t\t\t} );\r\n\t\t\tif ( options.canvas.fullScreen !== false )\r\n\t\t\t\tfullScreenSettings.setFullScreen( false, true );\r\n\r\n\t\t\t/**\r\n\t\t\t * @param {StereoEffect} stereoEffect <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t\t\t * @returns Set <b>stereoEffect</b> to <b>fullScreenSettings</b> and returns <a href=\"../../jsdoc/CreateFullScreenSettings/index.html\" target=\"_blank\">fullScreenSettings</a>.\r\n\t\t\t */\r\n\t\t\tthis.getFullScreenSettings = function ( stereoEffect ) {\r\n\r\n\t\t\t\tfullScreenSettings.setStereoEffect( stereoEffect );\r\n\t\t\t\treturn fullScreenSettings;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * @returns <b>true</b> if <b>canvas</b> is full screen.\r\n\t\t\t */\r\n\t\t\tthis.isFullScreen = function () { return fullScreenSettings.isFullScreen(); }\r\n\t\t\t/**\r\n\t\t\t * Sets the full screen of the canvas.\r\n\t\t\t * @param {boolean} fullScreen false - full screen of the canvas.\r\n\t\t\t */\r\n\t\t\tthis.setFullScreen = function ( fullScreen ) { return fullScreenSettings.setFullScreen( fullScreen ); }\r\n\t\t\tif (!options.canvas.noButtonFullScreen)\r\n\t\t\t\tsettings.menu.push( {\r\n\t\r\n\t\t\t\t\tstyle: 'float: right;',\r\n\t\t\t\t\tid: \"menuButtonFullScreen\",\r\n\t\t\t\t\tonclick: function ( event ) { fullScreenSettings.onclick(); }\r\n\t\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\t//Play slider\r\n\t\tif ( options.player ) options.player.addSlider();\r\n\r\n\t\tconst elMenu = DropdownMenu.create( settings.menu, {\r\n\r\n\t\t\telParent: typeof elContainer === \"string\" ? document.getElementById( elContainer ) : elContainer,\r\n\t\t\tcanvas: typeof elCanvas === \"string\" ? document.getElementById( elCanvas ) : elCanvas,\r\n\t\t\tdecorations: 'Transparent',\r\n\r\n\t\t} );\r\n\r\n\t\t/**\r\n\t\t * @param {string} selectors See CSS selectors in [HTML DOM querySelector() Method]{@link https://www.w3schools.com/jsref/met_document_queryselector.asp} for details.\r\n\t\t * @returns First element that matches a specified CSS selector(s) in the <b>canvasMenu</b>.\r\n\t\t */\r\n\t\tthis.querySelector = function ( selectors ) { return elMenu.querySelector( selectors ); }\r\n\t\telMenu.addEventListener( 'mouseenter', function ( event ) {\r\n\r\n\t\t\tif ( settings.options.dat ) settings.options.dat.mouseenter = true;\r\n\t\t\tif ( settings.onOver ) settings.onOver( true );\r\n\r\n\t\t} );\r\n\t\telMenu.addEventListener( 'mouseleave', function ( event ) {\r\n\r\n\t\t\tif ( settings.options.dat ) settings.options.dat.mouseenter = false;\r\n\t\t\tif ( settings.onOver ) settings.onOver( false );\r\n\r\n\t\t} );\r\n\t\tif ( options.player ) options.player.addSliderEvents();// options.THREE );\r\n\r\n\t\tif ( settings.fullScreen ) {\r\n\r\n\t\t\t/**\r\n\t\t\t * Sets the \"Full Screen\" button. Available only if <b>settings.fullScreen</b> is defined.\r\n\t\t\t * @param {boolean} fullScreen true - non full screen.\r\n\t\t\t * <p>false - full screen of the canvas.</p>\r\n\t\t\t */\r\n\t\t\tthis.setFullScreenButton = function ( fullScreen ) {\r\n\r\n\t\t\t\tif ( fullScreen === undefined ) {\r\n\r\n\t\t\t\t\tif ( options.canvas.fullScreen === false )\r\n\t\t\t\t\t\tfullScreen = false;\r\n\t\t\t\t\telse fullScreen = true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst elMenuButtonFullScreen = elContainer.querySelector( '#menuButtonFullScreen' );//document.getElementById( 'menuButtonFullScreen' );\r\n\t\t\t\tif ( elMenuButtonFullScreen === null )\r\n\t\t\t\t\treturn true;\r\n\t\t\t\tif ( fullScreen ) {\r\n\r\n\t\t\t\t\telMenuButtonFullScreen.innerHTML = '⤦';\r\n\t\t\t\t\telMenuButtonFullScreen.title = lang.nonFullScreen;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\telMenuButtonFullScreen.innerHTML = '⤢';\r\n\t\t\t\t\telMenuButtonFullScreen.title = lang.fullScreen;\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\t\t\tthis.setFullScreenButton();\r\n\r\n\t\t\tif (\r\n\t\t\t\tsettings.options.stereoEffect &&\r\n\t\t\t\tsettings.options.stereoEffect.settings &&\r\n\t\t\t\t( settings.options.stereoEffect.settings.spatialMultiplex !== StereoEffect.spatialMultiplexsIndexs.Mono )\r\n\t\t\t)\r\n\t\t\t\tthis.setFullScreen( false );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Sets the size of the slider element of the player's menu.\r\n\t\t * @param {Number} width width of the canvas\r\n\t\t */\r\n\t\tthis.setSize = function ( width ) {\r\n\t\t\tif ( elMenu === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tvar itemWidth = 0, elSlider;\r\n\t\t\tfor ( var i = 0; i < elMenu.childNodes.length; i++ ) {\r\n\r\n\t\t\t\tvar menuItem = elMenu.childNodes[i];\r\n\t\t\t\tvar computedStyle = window.getComputedStyle( menuItem ),\r\n\t\t\t\t\tstyleWidth =\r\n\t\t\t\t\t\tparseInt( computedStyle[\"margin-left\"] ) +\r\n\t\t\t\t\t\tparseInt( computedStyle[\"margin-right\"] ) +\r\n\t\t\t\t\t\tparseInt( computedStyle[\"padding-left\"] ) +\r\n\t\t\t\t\t\tparseInt( computedStyle[\"padding-right\"] )\r\n\t\t\t\t\t;\r\n\t\t\t\tvar elSliderCur = menuItem.querySelector( '.slider' );\r\n\t\t\t\tif ( elSliderCur === null )\r\n\t\t\t\t\titemWidth += menuItem.offsetWidth + styleWidth;\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\telSlider = elSliderCur;\r\n\t\t\t\t\titemWidth += styleWidth;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( !elSlider )\r\n\t\t\t\treturn;//no controllerPlay\r\n\t\t\tvar sliderWidth = width - itemWidth;\r\n\t\t\tif ( sliderWidth > 0 ) {\r\n\r\n\t\t\t\telSlider.parentElement.style.width = sliderWidth + 'px';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tconst size = { set: function ( width, height ) { this.x = width; this.y = height } };\r\n\t\trenderer.getSize( size );\r\n\t\tthis.setSize( size.x, size.y );\r\n\r\n\t\tif ( this.menu.length === 0 ) console.warn( 'CanvasMenu: menu is empty.' );\r\n\r\n\t}\r\n\r\n}\r\nexport default CanvasMenu;\r\n","/**\r\n * Remove all child objects of the object and call dispose on their geometry, material and texture.\r\n * \r\n * Thanks to https://stackoverflow.com/a/48768960/5175935\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n * @author [欧阳维杰]{@link https://stackoverflow.com/users/6045817/%e6%ac%a7%e9%98%b3%e7%bb%b4%e6%9d%b0}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\nfunction clearThree( obj ) {\r\n\twhile ( obj.children.length > 0 ) {\r\n\t\tclearThree( obj.children[0] )\r\n\t\tobj.remove( obj.children[0] );\r\n\t}\r\n\tif ( obj.geometry ) {\r\n\r\n\t\tif ( obj.geometry.attributes !== undefined )\r\n\t\t\tObject.keys( obj.geometry.attributes ).forEach( prop => {\r\n\r\n\t\t\t\tobj.geometry.deleteAttribute( prop );\r\n\r\n\t\t\t} );\r\n\t\tobj.geometry.dispose();\r\n\r\n\t}\r\n\r\n\tif ( obj.material ) {\r\n\t\t//in case of map, bumpMap, normalMap, envMap ...\r\n\t\tObject.keys( obj.material ).forEach( prop => {\r\n\r\n\t\t\tif ( !obj.material[prop] )\r\n\t\t\t\treturn\r\n\t\t\tif ( typeof obj.material[prop].dispose === 'function' )\r\n\t\t\t\tobj.material[prop].dispose();\r\n\r\n\t\t} )\r\n\t\tif ( obj.material.uniforms !== undefined )\r\n\t\t\tobj.material.uniforms.pointTexture.value.dispose();//Texture\r\n\t\tobj.material.dispose();\r\n\t}\r\n}\r\nexport default clearThree;\r\n","/**\r\n * @module AxesHelper\r\n * @description An axis object to visualize the 1, 2 or 3 axes.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport { SpriteText } from '../SpriteText/SpriteText.js';\r\n//import { SpriteText } from 'https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/SpriteText.js';\r\n\r\nimport clearThree from '../clearThree.js';\r\n//import clearThree from 'https://raw.githack.com/anhr/commonNodeJS/master/clearThree.js';\r\n\r\nimport { getObjectPosition } from '../getPosition.js';\r\n\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\n\r\nclass AxesHelper {\r\n\r\n\t/**\r\n\t * An axis object to visualize the 1, 2 or 3 axes.\r\n\t * @param {THREE.Group|THREE.Scene} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t * @param {object} [options=new Options()] the following options are available.\r\n\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean} [options.axesHelper] false - do not create a <b>AxesHelper</b> instance.\r\n\t * @param {object} [options.scales={}] axes scales.\r\n\t *\r\n\t * @param {object} [options.scales[axis]] axes options. <b>axis</b> is \"x\" or \"y\" or \"z\".\r\n\t * @param {string} [options.scales[axis].name=\"X\" or \"Y\" or \"Z\" or \"W\"] axis name.\r\n\t * @param {number} [options.scales[axis].min=-1] Minimum range of the axis.\r\n\t * @param {number} [options.scales[axis].max=1] Maximum range of the axis.\r\n\t * @param {number} [options.scales[axis].marks=3] Number of scale marks.\r\n\t * @param {number} [options.scales[axis].zoomMultiplier=1.1] zoom multiplier.\r\n\t * @param {number} [options.scales[axis].offset=0.1] position offset.\r\n\t *\r\n\t * @param {THREE.Vector3} [options.scales.posAxesIntersection=new THREE.Vector3()] Position of the axes intersection.\r\n\t * @param {boolean} [options.scales.display=true] true - displays the label and scale of the axes.\r\n\t * @param {object} [options.scales.color='rgba(255, 255, 255, 0.5)'] axes color. Available color names see [THREE.Color]{@link https://threejs.org/docs/index.html?q=color#api/en/math/Color}.NAMES.\r\n\t * @param {object} [options.scales.text={}] followed options of the text of the marks is available\r\n\t * @param {boolean} [options.scales.text.precision=4] Formats a scale marks into a specified length.\r\n\t * @param {number} [options.scales.text.textHeight=0.04] The height of the text.\r\n\t * @param {object} [options.scales.text.rect={}] rectangle around the text.\r\n\t * @param {boolean} [options.scales.text.rect.displayRect=true] true - the rectangle around the text is visible.\r\n\t * @param {number} [options.scales.text.rect.borderRadius=15]\r\n\t * @param {THREE.PerspectiveCamera} [options.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}. Use the camera key if you want control cameras focus.\r\n\t * Set the camera if you want to see text size is independent from camera.fov. The text height will be calculated as textHeight = camera.fov * textHeight / 50\r\n\t * See https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera.fov about camera.fov.\r\n\t * Default is undefined. Default camera.fov is 50.\r\n\t*/\r\n\tconstructor( group, options ) {\r\n\r\n\t\tconst THREE = three.THREE;\r\n\t\t//Этот вызов нужен на случай, когда в приложении import из guiSelectPoint.js происходит из разных файлов. Например\r\n\t\t//В одном месте\r\n\t\t//import { GuiSelectPoint, getObjectPosition } from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\t\t//а в другом месте\r\n\t\t//import { GuiSelectPoint, getObjectPosition } from '../../../commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\t\t//Тогда в приложении будет два экземпляра guiSelectPoint.js\r\n\t\t//Для обоих экземпляров guiSelectPoint.js надо установить отдельный THREE\r\n\t\t//\tGuiSelectPoint.setTHREE( THREE );\r\n\r\n\t\tconst axesHelper = this;\r\n\r\n\t\toptions = options || new Options();\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'AxesHelper: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tif ( options.axesHelper === false ) return;\r\n\r\n\t\toptions.camera.fov = options.camera.fov || 50;\r\n\r\n\t\toptions.scales = options.scales || {};\r\n\t\toptions.scales.color = options.scales.color || 'rgba(255, 255, 255, 0.5)';//'white';//0xffffff;\r\n/*\t\t\r\n\t\toptions.scales.display = options.scales.display !== undefined ? options.scales.display : true;\r\n\t\toptions.scales.text = options.scales.text || {};\r\n*/\t\t\r\n\t\toptions.scales.text.textHeight = options.scales.text.textHeight || 0.04;//Please specify the textHeight if you want the changing of the text height is available in gui.\r\n\t\toptions.scales.text.precision = options.scales.text.precision || 4;\r\n\t\toptions.scales.text.rect = options.scales.text.rect || {};\r\n\t\toptions.scales.text.rect.displayRect = options.scales.text.rect.displayRect !== undefined ? options.scales.text.rect.displayRect : true;\r\n\t\toptions.scales.text.rect.borderRadius = options.scales.text.rect.borderRadius !== undefined ? options.scales.text.rect.borderRadius : 15;\r\n\t\tfunction setScale( axisName ) {\r\n\r\n\t\t\tconst scale = options.scales[axisName];\r\n\t\t\tif ( !scale ) return;\r\n//\t\t\tif ( scale.marks === undefined ) scale.marks = 3;\r\n\t\t\tif ( scale.offset === undefined ) scale.offset = 0.1;\r\n\t\t\tif ( scale.zoomMultiplier === undefined ) scale.zoomMultiplier = 1.1;\r\n\r\n\t\t}\r\n\t\tsetScale( 'x' );\r\n\t\tsetScale( 'y' );\r\n\t\tsetScale( 'z' );\r\n\r\n\t\t/**\r\n\t\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t\t * */\r\n\t\tthis.options = options;\r\n\r\n\t\tconst groupAxesHelper = new THREE.Group();\r\n\t\tgroupAxesHelper.userData.optionsSpriteText = {\r\n\r\n\t\t\tfontColor: options.scales.color,\r\n\t\t\ttextHeight: options.scales.text.textHeight,\r\n\t\t\tfov: options.camera.fov,\r\n\t\t\trect: options.scales.text.rect,\r\n\r\n\t\t}\r\n\t\tgroup.add( groupAxesHelper );\r\n\r\n\t\toptions.scales.posAxesIntersection = options.scales.posAxesIntersection || new THREE.Vector3();//For moving of the axes intersection to the center of the canvas ( to the camera focus )\r\n\r\n\t\t/**\r\n\t\t * create axis\r\n\t\t * @param {string} axisName axis name\r\n\t\t */\r\n\t\tthis.createAxis = function ( axisName ) {\r\n\r\n\t\t\tconst group = new THREE.Group();\r\n\t\t\tgroup.visible = options.scales.display;\r\n\r\n\t\t\tconst scale = options.scales[axisName];\r\n\t\t\tif ( !scale.isAxis() )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tvar color = options.scales.color, opacity = 1;\r\n\t\t\ttry {\r\n\r\n\t\t\t\tvar array = options.scales.color.split( /rgba\\(\\.*/ )[1].split( /\\)/ )[0].split( /, */ );\r\n\t\t\t\tcolor = 'rgb(' + array[0] + ', ' + array[1] + ', ' + array[2] + ')';\r\n\t\t\t\tif ( array[3] !== undefined )\r\n\t\t\t\t\topacity = array[3];\r\n\r\n\t\t\t} catch ( e ) { }\r\n\t\t\tconst lineAxis = new THREE.Line( new THREE.BufferGeometry().setFromPoints( [\r\n\r\n\t\t\t\t//Begin vertice of the axis\r\n\t\t\t\tnew THREE.Vector3(\r\n\r\n\t\t\t\t\t//X\r\n\t\t\t\t\taxisName !== 'x' ? 0\r\n\t\t\t\t\t\t: !options.scales.x ? 0//X axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.x.min,//begin of the X axix\r\n\t\t\t\t\t//Y\r\n\t\t\t\t\taxisName !== 'y' ? 0\r\n\t\t\t\t\t\t: !options.scales.y ? 0//Y axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.y.min,//begin of the Y axix\r\n\t\t\t\t\t//Z\r\n\t\t\t\t\taxisName !== 'z' ? 0\r\n\t\t\t\t\t\t: !options.scales.z ? 0//Z axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.z.min,//begin of the Z axix\r\n\r\n\t\t\t\t),\r\n\t\t\t\t//end vertice of the axis\r\n\t\t\t\tnew THREE.Vector3(\r\n\r\n\t\t\t\t\t//X\r\n\t\t\t\t\taxisName !== 'x' ? 0\r\n\t\t\t\t\t\t: !options.scales.x ? 0//X axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.x.max,//end of the X axix\r\n\t\t\t\t\t//Y\r\n\t\t\t\t\taxisName !== 'y' ? 0\r\n\t\t\t\t\t\t: !options.scales.y ? 0//Y axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.y.max,//end of the Y axix\r\n\t\t\t\t\t//Z\r\n\t\t\t\t\taxisName !== 'z' ? 0\r\n\t\t\t\t\t\t: !options.scales.z ? 0//Z axis is not exists\r\n\t\t\t\t\t\t\t: options.scales.z.max,//end of the Z axix\r\n\r\n\t\t\t\t),\r\n\t\t\t] ), new THREE.LineBasicMaterial( { color: color, opacity: opacity, transparent: true, } ) );\r\n\t\t\t//moving of the axes intersection to the center of the canvas ( to the camera focus ) munus posAxesIntersection\r\n\t\t\tif ( axisName !== 'x' ) lineAxis.position.x = options.scales.posAxesIntersection.x;\r\n\t\t\tif ( axisName !== 'y' ) lineAxis.position.y = options.scales.posAxesIntersection.y;\r\n\t\t\tif ( axisName !== 'z' ) lineAxis.position.z = options.scales.posAxesIntersection.z;\r\n\t\t\tlineAxis.add( group );\r\n\t\t\tlineAxis.userData.axisName = axisName;\r\n\t\t\tgroupAxesHelper.add( lineAxis );\r\n\r\n\t\t\tif ( scale.marks !== undefined ) {\r\n\r\n\t\t\t\tconst SpriteMark = function (\r\n\t\t\t\t\tposition,\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tposition = position || new THREE.Vector3( 0, 0, 0 );\r\n\t\t\t\t\tconst sizeAttenuation = false;\r\n\r\n\r\n\t\t\t\t\tconst sprite = new THREE.Sprite( new THREE.SpriteMaterial( {\r\n\r\n\t\t\t\t\t\tmap: new THREE.Texture(),\r\n\t\t\t\t\t\tsizeAttenuation: sizeAttenuation,\r\n\r\n\t\t\t\t\t} ) );\r\n\t\t\t\t\tconst canvas = document.createElement( 'canvas' );\r\n\t\t\t\t\tsprite.material.map.minFilter = THREE.LinearFilter;\r\n\t\t\t\t\tconst context = canvas.getContext( '2d' );\r\n\r\n\t\t\t\t\tfunction update() {\r\n\r\n\t\t\t\t\t\tconst center = new THREE.Vector2(\r\n\r\n\t\t\t\t\t\t\t//x\r\n\t\t\t\t\t\t\taxisName !== 'y' ? 0.5 ://For x and z axes риска не сдвигается\r\n\t\t\t\t\t\t\t\t0,//For y axes риска сдвигается вправо\r\n\r\n\t\t\t\t\t\t\t//y\r\n\t\t\t\t\t\t\taxisName === 'y' ? 0.5 ://For y axes риска не сдвигается\r\n\t\t\t\t\t\t\t\t1//For x and z axes риска сдвигается вниз\r\n\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tvar width = 3;//, linesCount = 1,\r\n\t\t\t\t\t\tcontext.fillStyle = options.scales.color;//'rgba(0, 255, 0, 1)';\r\n\t\t\t\t\t\tcontext.fillRect( 0, 0, canvas.width, canvas.height );\r\n\r\n\t\t\t\t\t\t// Inject canvas into sprite\r\n\t\t\t\t\t\tsprite.material.map.image = canvas;\r\n\t\t\t\t\t\tsprite.material.map.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tif ( axisName === 'y' ) {\r\n\r\n\t\t\t\t\t\t\tsprite.scale.x = ( width * ( canvas.width / canvas.height ) ) / canvas.width;\r\n\t\t\t\t\t\t\tsprite.scale.y = 1 / canvas.height;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tsprite.scale.x = 1 / canvas.width;\r\n\t\t\t\t\t\t\tsprite.scale.y = width / canvas.height;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tsprite.scale.x *= options.camera.fov / ( 50 * 2 );\r\n\t\t\t\t\t\tsprite.scale.y *= options.camera.fov / ( 50 * 2 );\r\n\r\n\t\t\t\t\t\tsprite.position.copy( position );\r\n\t\t\t\t\t\tsprite.center = center;\r\n\r\n\t\t\t\t\t\t//size attenuation. Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.) Default is false.\r\n\t\t\t\t\t\t//See https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation\r\n\t\t\t\t\t\tsprite.material.sizeAttenuation = sizeAttenuation;\r\n\r\n\t\t\t\t\t\tsprite.material.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tfunction getTextPrecision() {\r\n\r\n\t\t\t\t\t\t\treturn options.scales.text.precision !== undefined ? text.toPrecision( options.scales.text.precision ) : text.toString();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar text = ( axisName === 'x' ? position.x : axisName === 'y' ? position.y : position.z );\r\n\t\t\t\t\t\tfunction getCenterX() {\r\n\r\n\t\t\t\t\t\t\tconst a = ( 0.013 - 0.05 ) / 15, b = 0.013 - 17 * a;\r\n\t\t\t\t\t\t\treturn - width * ( getTextPrecision().length * a + b );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst spriteText = new SpriteText(\r\n\t\t\t\t\t\t\tgetTextPrecision(),\r\n\t\t\t\t\t\t\tnew THREE.Vector3(\r\n\t\t\t\t\t\t\t\tposition.x,\r\n\t\t\t\t\t\t\t\tposition.y,\r\n\t\t\t\t\t\t\t\tposition.z,\r\n\t\t\t\t\t\t\t), {\r\n\r\n\t\t\t\t\t\t\tgroup: group,\r\n\t\t\t\t\t\t\trotation: axisName === 'y' ? 0 : - Math.PI / 2,\r\n\t\t\t\t\t\t\tcenter: new THREE.Vector2(\r\n\r\n\t\t\t\t\t\t\t\tgetCenterX(),//текст по оси y сдвигается вправо\r\n\t\t\t\t\t\t\t\t//текст по оси x и z сдвигается вниз\r\n\r\n\t\t\t\t\t\t\t\taxisName === 'x' ? 1 ://текст по оси x сдвигается влево\r\n\t\t\t\t\t\t\t\t\t0,//текст по оси z сдвигается вправо,\r\n\t\t\t\t\t\t\t\t//текст по оси y сдвигается вверх\r\n\r\n\t\t\t\t\t\t\t),\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tspriteText.userData.updatePrecision = function () {\r\n\r\n\t\t\t\t\t\t\tspriteText.userData.updateText( text.toPrecision( options.scales.text.precision ) );\r\n\t\t\t\t\t\t\tspriteText.center.x = getCenterX();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgroup.add( spriteText );\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\t\tupdate();\r\n\t\t\t\t\treturn sprite;\r\n\r\n\t\t\t\t};\r\n\t\t\t\tconst max = scale.max,\r\n\t\t\t\t\tmin = scale.min,\r\n\t\t\t\t\td = ( max - min ) / ( scale.marks - 1 );\r\n\t\t\t\tfor ( var i = 0; i < scale.marks; i++ ) {\r\n\r\n\t\t\t\t\tconst pos = i * d + min;\r\n\t\t\t\t\tgroup.add( new SpriteMark( new THREE.Vector3(\r\n\t\t\t\t\t\taxisName === 'x' ? pos : 0,\r\n\t\t\t\t\t\taxisName === 'y' ? pos : 0,\r\n\t\t\t\t\t\taxisName === 'z' ? pos : 0,\r\n\t\t\t\t\t) ) );\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//Axis name\r\n\t\t\tvar axisNameOptions = {\r\n\r\n\t\t\t\tcenter: new THREE.Vector2(\r\n\t\t\t\t\taxisName === 'y' ? 1.1 : -0.1,\r\n\t\t\t\t\taxisName === 'y' ? 0 : -0.1\r\n\t\t\t\t),\r\n\t\t\t\tgroup: group,\r\n\r\n\t\t\t}\r\n//\t\t\tscale.name = scale.name || axisName;\r\n\t\t\tgroup.add( new SpriteText(\r\n\t\t\t\tscale.name,\r\n\t\t\t\tnew THREE.Vector3(\r\n\t\t\t\t\taxisName === 'x' ? scale.max : 0,\r\n\t\t\t\t\taxisName === 'y' ? scale.max : 0,\r\n\t\t\t\t\taxisName === 'z' ? scale.max : 0,\r\n\t\t\t\t), axisNameOptions ) );\r\n\t\t\tgroup.add( new SpriteText(\r\n\t\t\t\tscale.name,\r\n\t\t\t\tnew THREE.Vector3(\r\n\t\t\t\t\taxisName === 'x' ? scale.min : 0,\r\n\t\t\t\t\taxisName === 'y' ? scale.min : 0,\r\n\t\t\t\t\taxisName === 'z' ? scale.min : 0,\r\n\t\t\t\t), axisNameOptions ) );\r\n\r\n\t\t}\r\n\t\tthis.createAxis( 'x' );\r\n\t\tthis.createAxis( 'y' );\r\n\t\tthis.createAxis( 'z' );\r\n\t\tif ( groupAxesHelper.children.length === 0 )\r\n\t\t\tconsole.warn( 'AxesHelper: Define at least one axis.' )\r\n\r\n\t\t//dotted lines\r\n\t\tfunction dotLines( _scene ) {\r\n\r\n\t\t\tvar lineX, lineY, lineZ, scene = _scene,\r\n\t\t\t\tgroupDotLines, intersection;\r\n\t\t\tthis.remove = function () {\r\n\r\n\t\t\t\tif ( groupDotLines === undefined )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t//clear memory\r\n\t\t\t\t//\r\n\t\t\t\t//Если это не делать, то со временем может произойти событие webglcontextlost\r\n\t\t\t\t//https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/webglcontextlost_event\r\n\t\t\t\t//\r\n\t\t\t\t//for testing\r\n\t\t\t\t//\topen http://localhost/threejs/nodejs/controllerPlay/Examples/html/ page\r\n\t\t\t\t//\tselect a point\r\n\t\t\t\t//\topen dat.gui\r\n\t\t\t\t//\tin the PlayController:\r\n\t\t\t\t//\t\tclick the ⥀ button\r\n\t\t\t\t//\t\tRate of changing of animation scenes per second to 25\r\n\t\t\t\t//\t\tclick the ► play button\r\n\t\t\t\t//\tNow you can see animation of the scene\r\n\t\t\t\t//\tIn the Windows open Resource Monitor\r\n\t\t\t\t//\t\tOpen the Memory tab\r\n\t\t\t\t//\t\tThe Commit(KB) for chrome.exe do not increasing about 20 minutes.\r\n\t\t\t\tclearThree( groupDotLines );\r\n\r\n\t\t\t\tscene.remove( groupDotLines );\r\n\t\t\t\tgroupDotLines = undefined;\r\n\t\t\t\tlineX = undefined;\r\n\t\t\t\tlineY = undefined;\r\n\t\t\t\tlineZ = undefined;\r\n\r\n\t\t\t};\r\n\t\t\tfunction createGroup() {\r\n\r\n\t\t\t\tdotLines.remove();\r\n\t\t\t\tgroupDotLines = new THREE.Group();\r\n\t\t\t\tscene.add( groupDotLines );\r\n\r\n\t\t\t}\r\n\t\t\tfunction verticeAxis( axisName ) { return ( options.scales.posAxesIntersection[axisName] - group.position[axisName] ) / group.scale[axisName]; }\r\n\t\t\tfunction getDashSize() { return 0.05 / ( Math.max( Math.max( group.scale.x, group.scale.y ), group.scale.z ) ); }\r\n\t\t\tthis.dottedLines = function ( _intersection ) {\r\n\r\n\t\t\t\tintersection = _intersection;\r\n\t\t\t\tconst pointVertice = intersection instanceof THREE.Vector4 || intersection instanceof THREE.Vector3 ? intersection : getObjectPosition( intersection.object, intersection.index );\r\n\t\t\t\tif ( groupDotLines !== undefined ) {\r\n\r\n\t\t\t\t\tfunction dottedLine( axisName ) {\r\n\r\n\t\t\t\t\t\tvar line;\r\n\t\t\t\t\t\tswitch ( axisName ) {\r\n\r\n\t\t\t\t\t\t\tcase 'x':\r\n\t\t\t\t\t\t\t\tline = lineX;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\t\t\tline = lineY;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'z':\r\n\t\t\t\t\t\t\t\tline = lineZ;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault: console.error( 'AxesHelper.dotLines.dottedLines.dottedLine: axesId = ' + axesId );\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( !line )\r\n\t\t\t\t\t\t\treturn;//Current axis is not exists\r\n\t\t\t\t\t\tvar lineVertices = line.geometry.attributes.position.array;\r\n\t\t\t\t\t\tlineVertices[0] = axisName === 'x' ? pointVertice.x :\r\n\t\t\t\t\t\t\tverticeAxis( 'x' );//group.position.x, group.scale.x );\r\n\t\t\t\t\t\tlineVertices[1] = axisName === 'y' ? pointVertice.y :\r\n\t\t\t\t\t\t\tverticeAxis( 'y' );//group.position.y, group.scale.y );\r\n\t\t\t\t\t\tlineVertices[2] = axisName === 'z' ? pointVertice.z :\r\n\t\t\t\t\t\t\tverticeAxis( 'z' );//group.position.z, group.scale.z );\r\n\r\n\t\t\t\t\t\tlineVertices[3] = pointVertice.x;\r\n\t\t\t\t\t\tlineVertices[4] = pointVertice.y;\r\n\t\t\t\t\t\tlineVertices[5] = pointVertice.z;\r\n\r\n\t\t\t\t\t\tvar size = getDashSize();\r\n\t\t\t\t\t\tline.material.dashSize = size;\r\n\t\t\t\t\t\tline.material.gapSize = size;\r\n\r\n\t\t\t\t\t\tline.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdottedLine( 'x' );\r\n\t\t\t\t\tdottedLine( 'y' );\r\n\t\t\t\t\tdottedLine( 'z' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcreateGroup();\r\n\r\n\t\t\t\tfunction dottedLine( axisName ) {\r\n\r\n\t\t\t\t\tif ( !options.scales[axisName].isAxis() )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tvar lineVertices = [\r\n\t\t\t\t\t\tnew THREE.Vector3().copy( options.scales.posAxesIntersection ),\r\n\t\t\t\t\t\tpointVertice,\r\n\t\t\t\t\t];\r\n\t\t\t\t\tlineVertices[0].x = axisName === 'x' ? lineVertices[1].x : verticeAxis( 'x' );\r\n\t\t\t\t\tlineVertices[0].y = axisName === 'y' ? lineVertices[1].y : verticeAxis( 'y' );\r\n\t\t\t\t\tlineVertices[0].z = axisName === 'z' ? lineVertices[1].z : verticeAxis( 'z' );\r\n\r\n\t\t\t\t\tvar size = getDashSize();\r\n\t\t\t\t\tif ( options.colorsHelper === undefined )\r\n\t\t\t\t\t\toptions.colorsHelper = 0x80;\r\n\t\t\t\t\tvar line = new THREE.LineSegments( new THREE.BufferGeometry().setFromPoints( lineVertices ),\r\n\t\t\t\t\t\tnew THREE.LineDashedMaterial( {\r\n\t\t\t\t\t\t\tcolor: 'rgb(' + options.colorsHelper + ', ' + options.colorsHelper + ', ' + options.colorsHelper + ')',\r\n\t\t\t\t\t\t\tdashSize: size, gapSize: size\r\n\t\t\t\t\t\t} ) );\r\n\t\t\t\t\tline.computeLineDistances();\r\n\t\t\t\t\tgroupDotLines.add( line );\r\n\t\t\t\t\treturn line;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tlineX = dottedLine( 'x' );\r\n\t\t\t\tlineY = dottedLine( 'y' );\r\n\t\t\t\tlineZ = dottedLine( 'z' );\r\n\r\n\t\t\t};\r\n\t\t\tthis.update = function () {\r\n\r\n\t\t\t\tif ( ( groupDotLines === undefined ) || ( intersection === undefined ) )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tthis.dottedLines( intersection );\r\n\r\n\t\t\t}\r\n\t\t\tthis.movePointAxes = function ( axesId, value ) {\r\n\r\n\t\t\t\tvar line;\r\n\t\t\t\tswitch ( axesId ) {\r\n\r\n\t\t\t\t\tcase mathBox.axesEnum.x:\r\n\t\t\t\t\t\tline = lineX;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase mathBox.axesEnum.y:\r\n\t\t\t\t\t\tline = lineY;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase mathBox.axesEnum.z:\r\n\t\t\t\t\t\tline = lineZ;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'point.userData.movePointAxes: invalid axesId: ' + axesId );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( line === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tline.geometry.attributes.position.array[axesId + 3] = value;\r\n\r\n\t\t\t\tlineX.geometry.attributes.position.array[axesId] = value;\r\n\t\t\t\tlineY.geometry.attributes.position.array[axesId] = value;\r\n\t\t\t\tlineZ.geometry.attributes.position.array[axesId] = value;\r\n\r\n\t\t\t\tlineX.geometry.attributes.position.needsUpdate = true;\r\n\t\t\t\tlineY.geometry.attributes.position.needsUpdate = true;\r\n\t\t\t\tlineZ.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t};\r\n\r\n\t\t}\r\n\t\tdotLines = new dotLines( group );\r\n\r\n\t\tvar _intersection;\r\n\t\t/**\r\n\t\t* Expose position on axes.\r\n\t\t* @param {THREE.Vector3|object} intersection position or intersection. See {@link https://threejs.org/docs/index.html#api/en/core/Raycaster|Raycaster} for detail.\r\n\t\t*/\r\n\t\tthis.exposePosition = function ( intersection ) {\r\n\r\n\t\t\t_intersection = intersection;\r\n\t\t\tif ( intersection === undefined ) {\r\n\r\n\t\t\t\t_intersection = undefined;\r\n\t\t\t\tdotLines.remove();\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tdotLines.dottedLines( intersection );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t* move exposed position on axes.\r\n\t\t*/\r\n\t\tthis.movePosition = function () {\r\n\r\n\t\t\tif ( !_intersection  )\r\n\t\t\t\treturn;\r\n\t\t\tthis.exposePosition( _intersection );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * get group\r\n\t\t * @returns {@link https://threejs.org/docs/index.html#api/en/objects/Group|Group}\r\n\t\t */\r\n\t\tthis.getGroup = function () { return groupAxesHelper; }\r\n\r\n\t\t/**\r\n\t\t * update axes\r\n\t\t */\r\n\t\tthis.updateAxes = function () {\r\n\r\n\t\t\tfunction updateAxis( axisName ) {\r\n\r\n\t\t\t\tgroupAxesHelper.children.forEach( function ( group ) {\r\n\r\n\t\t\t\t\tif ( group.userData.axisName !== axisName )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tgroupAxesHelper.remove( group );\r\n\t\t\t\t\taxesHelper.createAxis( axisName );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tupdateAxis( 'x' );\r\n\t\t\tupdateAxis( 'y' );\r\n\t\t\tupdateAxis( 'z' );\r\n\t\t\tdotLines.update();\r\n\r\n\t\t}\r\n\t\toptions.axesHelper = this;\r\n\r\n\t}\r\n\r\n}\r\nexport default AxesHelper;","/**\r\n * @module SpriteTextGui\r\n * @description Adds SpriteText settings folder into {@link https://github.com/anhr/dat.gui|dat.gui}.\r\n * @see {@link https://github.com/anhr/SpriteText|SpriteText}\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport { ScaleControllers } from '../ScaleController.js';//https://github.com/anhr/commonNodeJS\r\n//import { ScaleControllers } from 'https://raw.githack.com/anhr/commonNodeJS/master/ScaleController.js';\r\n\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\n\r\nimport { SpriteText } from './SpriteText.js';\r\n//import { SpriteText } from 'https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/SpriteText.js';\r\n\r\n//Каждый экземляр SpriteTextGui должен иметь униканое cookieName.\r\n//Иначе если пользователь сделает какое то изменеие в SpriteTextGui, то это изменеие отразится \r\n//в других экземлярах SpriteTextGui после перезанрузки веб страницы. В частности могут появиться ненужные органы управления\r\nvar _spriteTextGuiCount = 0;\r\n\r\n/**\r\n * Adds SpriteText settings folder into dat.gui.\r\n * @param {THREE.Group|THREE.Scene|THREE.Sprite} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the <b>SpriteText</b> and of all child groups of the <b>SpriteText</b> for which these settings will have an effect.\r\n * Or Sprite returned from <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">new SpriteText(...)</a>.\r\n *\r\n * @param {Options} [options] See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {object} [options.dat] use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n * @param {GUI} [options.dat.dat] [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n * @param {boolean} [options.dat.cookie] false - do not save to cookie all user settings\r\n * @param {string} [options.dat.cookieName] Name of the cookie.\r\n * @param {boolean} [options.dat.guiSelectPoint] false - do not displays <b>GuiSelectPoint</b>.\r\n * @param {Function} [options.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n * <pre>\r\n * returns the \"primary language\" subtag of the language version of the browser.\r\n * Examples: \"en\" - English language, \"ru\" Russian.\r\n * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n * </pre>\r\n * @param {object} [guiParams={}] Followed parameters is allowed. Default is no parameters\r\n * @param {GUI} [guiParams.folder] <b>SpriteTextGui</b> folder. See {@link https://github.com/anhr/dat.gui|dat.gui} for details\r\n * @param {GUI} [guiParams.parentFolder] parent folder, returned by {@link https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+addFolder|gui.addFolder(name)}\r\n * @param {string} [guiParams.optionsSpriteText] See <b>options</b> of <a href=\"module-SpriteText.html\" target=\"_blank\">SpriteText</a>. Default is <b>group.userData.optionsSpriteText</b> or no options\r\n * @param {string} [guiParams.spriteFolder] sprite folder name. Default is lang.spriteText\r\n * @param {string} [guiParams.settings] See <b>options.settings</b> of <a href=\"../../jsdoc/ScaleController/module-ScaleController-ScaleController.html\" target=\"_blank\">ScaleControllers</a> settings\r\n * @returns {GUI} sprite folder\r\n */\r\nexport function SpriteTextGui( group, options, guiParams = {} ) {\r\n\r\n\toptions = new Options( options );\r\n\tconst gui = guiParams.folder || options.dat.gui;\r\n\tif ( !gui || options.dat.spriteTextGui === false )\r\n\t\treturn;\r\n\tconst optionsSpriteText = guiParams.optionsSpriteText || group.userData.optionsSpriteText || {},\r\n\t\tTHREE = three.THREE,\r\n\t\tdat = three.dat;//options.dat.dat;\r\n\r\n\tif ( Object.keys(optionsSpriteText).length === 0 ) console.warn( 'SpriteTextGui: optionsSpriteText is empty.' );\r\n\t\t\r\n\tif ( THREE.Color.NAMES[optionsSpriteText.fontColor] ) {\r\n\r\n\t\tconst color = new THREE.Color( optionsSpriteText.fontColor );\r\n\t\toptionsSpriteText.fontColor = 'rgba(' + color.r * 255 + ',' + color.g * 255 + ',' + color.b * 255 + ',1)'\r\n\r\n\t}\r\n\tconst optionsDefault = JSON.parse( JSON.stringify( optionsSpriteText ) );\r\n\tObject.freeze( optionsDefault );\r\n\r\n\t//Localization\r\n\r\n\tconst lang = {\r\n\r\n\t\tspriteText: 'Sprite Text',\r\n\t\tspriteTextTitle: 'Settings for text that always faces towards the camera.',\r\n\r\n\t\ttext: 'Text',\r\n\t\ttextTitle: 'The text to be displayed on the sprite.',\r\n\r\n\t\ttextHeight: 'Height',\r\n\t\ttextHeightTitle: 'Text Height.',\r\n\r\n\t\tfontFace: 'Font Face',\r\n\r\n\t\tfontFaces: 'Font Faces',\r\n\t\tfontFaceTitle: 'Choose text font.',\r\n\r\n\t\tbold: 'Bold',\r\n\r\n\t\titalic: 'Italic',\r\n\r\n\t\trotation: 'Rotation',\r\n\t\trotationTitle: 'Sprite rotation',\r\n\r\n\t\tfontProperties: 'Font Properties',\r\n\t\tfontPropertiesTitle: 'Other font properties. The font property uses the same syntax as the CSS font property.',\r\n\r\n\t\tfontStyle: 'Font Style',\r\n\t\tfontStyleTitle: 'Text style being used when drawing text. Read only.',\r\n\r\n\t\tdisplayRect: 'Border',\r\n\t\tdisplayRectTitle: 'Display a border around the text.',\r\n\t\tborderColor: 'Border Color',\r\n\t\tbackgroundColor: 'Background Color',\r\n\t\tborderRadius: 'Border Radius',\r\n\t\tborderThickness: 'Border Thickness',\r\n\r\n\t\tfontColor: 'Font Color',\r\n\r\n\t\tanchor: 'Anchor',\r\n\t\tanchorTitle: 'The text anchor point.',\r\n\r\n\t\tsizeAttenuation: 'Size Attenuation',\r\n\t\tsizeAttenuationTitle: 'Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.)',\r\n\r\n\t\tdefaultButton: 'Default',\r\n\t\tdefaultTitle: 'Restore default Sprite Text settings.',\r\n\r\n\t};\r\n\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\tcase 'ru'://Russian language\r\n\r\n\t\t\tlang.spriteText = 'Текстовый спрайт';//'Sprite Text'\r\n\t\t\tlang.spriteTextTitle = 'Настройки для текста, который всегда обращен к камере.';\r\n\r\n\t\t\tlang.text = 'Текст';\r\n\t\t\tlang.textTitle = 'Текст, который будет отображен в спрайте.';\r\n\r\n\t\t\tlang.textHeight = 'Высота';\r\n\t\t\tlang.textHeightTitle = 'Высота текста.';\r\n\r\n\t\t\tlang.fontFace = 'Имя шрифта';\r\n\r\n\t\t\tlang.fontFaces = 'Имена шрифтов';\r\n\t\t\tlang.fontFaceTitle = 'Выберите шрифта текста.';\r\n\r\n\t\t\tlang.bold = 'Жирный';\r\n\r\n\t\t\tlang.italic = 'Наклонный';\r\n\r\n\t\t\tlang.rotation = 'Вращение';\r\n\t\t\tlang.rotationTitle = 'Вращение текстового спрайта';\r\n\r\n\t\t\tlang.fontProperties = 'Дополнительно';\r\n\t\t\tlang.fontPropertiesTitle = 'Дополнительные свойства шрифта. Свойство шрифта использует тот же синтаксис, что и свойство шрифта CSS.';\r\n\r\n\t\t\tlang.fontStyle = 'Стиль шрифта';\r\n\t\t\tlang.fontStyleTitle = 'Стиль шрифта, используемый при рисовании текста. Не редактируется.';\r\n\r\n\t\t\tlang.displayRect = 'Рамка';\r\n\t\t\tlang.displayRectTitle = 'Отобразить рамку вокруг текста.';\r\n\t\t\tlang.borderColor = 'Цвет рамки';\r\n\t\t\tlang.backgroundColor = 'Цвет фона';\r\n\t\t\tlang.borderRadius = 'Зкругление углов';\r\n\t\t\tlang.borderThickness = 'Толщина рамки';\r\n\r\n\t\t\tlang.fontColor = 'Цвет шрифта';\r\n\r\n\t\t\tlang.anchor = 'Якорь';\r\n\t\t\tlang.anchorTitle = 'Точка привязки текста.';\r\n\r\n\t\t\tlang.sizeAttenuation = 'Размер';\r\n\t\t\tlang.sizeAttenuationTitle = 'Будет ли размер спрайта зависеть от расстояния до камеры. (Только перспективная камера.)';\r\n\r\n\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\tlang.defaultTitle = 'Восстановить настройки текстового спрайта по умолчанию.';\r\n\t\t\tbreak;\r\n\t\tdefault://Custom language\r\n\t\t\tif ( ( guiParams.lang === undefined ) || ( guiParams.lang.languageCode != _languageCode ) )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tObject.keys( guiParams.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlang[key] = guiParams.lang[key];\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\tguiParams.spriteFolder = guiParams.spriteFolder || lang.spriteText;\r\n\t_spriteTextGuiCount++;\r\n\tconst cookieName = options.dat.getCookieName( 'SpriteText' + _spriteTextGuiCount ),\r\n\t\tcookie = options.dat.cookie,\r\n\t\toptionsGroup = optionsSpriteText.group;\r\n\tcookie.getObject( cookieName, optionsSpriteText, optionsSpriteText );\r\n\toptionsSpriteText.group = optionsGroup;\r\n\tif ( group instanceof THREE.Sprite !== true ) {\r\n\r\n\t\tif ( group.userData.optionsSpriteText === undefined )\r\n\t\t\tgroup.userData.optionsSpriteText = optionsSpriteText;\r\n\t\telse if ( guiParams.optionsSpriteText !== undefined ) console.warn( 'SpriteTextGui: duplicate group.userData.optionsSpriteText' );\r\n\r\n\t}\r\n\r\n\t//updateSpriteText function is repeatedly called during restore settings to default values.\r\n\t//See fSpriteText.userData.restore() function for details.\r\n\t//I have set to false before restoring and set to true again and called function once after restoring for resolving of problem.\r\n\tvar boUpdateSpriteText = true;\r\n\tfunction updateSpriteText( noSave ) {\r\n\r\n\t\tif ( !boUpdateSpriteText )\r\n\t\t\treturn;\r\n\t\tSpriteText.updateSpriteTextGroup( group );\r\n\t\tif ( group.userData.update )\r\n\t\t\tgroup.userData.update();// optionsSpriteText );\r\n\r\n\t\tif ( controllerFont !== undefined )\r\n\t\t\tcontrollerFont.setValue( optionsSpriteText.font );\r\n\r\n\t\tif ( !noSave )\r\n\t\t\tcookie.setObject( cookieName, optionsSpriteText );\r\n\r\n\t}\r\n\r\n\tif ( !guiParams.hasOwnProperty( 'parentFolder' ) )\r\n\t\tguiParams.parentFolder = gui;\r\n\r\n\t//Sprite folder\r\n\tconst fSpriteText = guiParams.parentFolder.addFolder( guiParams.spriteFolder );\r\n\tdat.folderNameAndTitle( fSpriteText, guiParams.spriteFolder, lang.spriteTextTitle );\r\n\r\n\t//Sprite text height\r\n\tconst textHeight = 'textHeight';\r\n\tif ( optionsSpriteText.hasOwnProperty( textHeight ) && ( optionsSpriteText[textHeight] !== undefined ) ) {\r\n\r\n\t\tScaleControllers( fSpriteText, optionsSpriteText, textHeight, function () { updateSpriteText(); }, {\r\n\r\n\t\t\ttext: lang.textHeight, textTitle: lang.textHeightTitle,\r\n\t\t\tgetLanguageCode: guiParams.getLanguageCode,\r\n\t\t\tsettings: guiParams.settings,\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t//font  face\r\n\tif ( optionsSpriteText.fontFace !== undefined ) {\r\n\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, 'fontFace' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.fontFace );\r\n\r\n\t}\r\n\r\n\t//font faces\r\n\tif ( optionsSpriteText.fontFaces !== undefined ) {\r\n\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, 'fontFace', optionsSpriteText.fontFaces ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.fontFaces, lang.fontFaceTitle );\r\n\r\n\t}\r\n\r\n\t//bold\r\n\tif ( optionsSpriteText.hasOwnProperty( 'bold' ) ) {\r\n\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, 'bold' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.bold );\r\n\r\n\t}\r\n\r\n\t//italic\r\n\tif ( optionsSpriteText.hasOwnProperty( 'italic' ) ) {\r\n\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, 'italic' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.italic );\r\n\r\n\t}\r\n\r\n\t//rotation\r\n\tconst rotation = 'rotation';\r\n\tif ( optionsSpriteText.hasOwnProperty( rotation ) ) {\r\n\r\n\t\tvar min = 0,\r\n\t\t\tmax = Math.PI * 2;\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, rotation, min, max, ( max - min ) / 360 ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.rotation, lang.rotationTitle );\r\n\r\n\t}\r\n\r\n\t//font properties\r\n\tif ( optionsSpriteText.hasOwnProperty( 'fontProperties' ) ) {\r\n\r\n\t\tdat.controllerNameAndTitle(\r\n\t\t\tfSpriteText.add( optionsSpriteText, 'fontProperties' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.fontProperties, lang.fontPropertiesTitle );\r\n\r\n\t}\r\n\r\n\t//font style\r\n\tif ( optionsSpriteText.hasOwnProperty( 'font' ) ) {\r\n\r\n\t\tvar controllerFont = fSpriteText.add( optionsSpriteText, 'font' );\r\n\t\tcontrollerFont.__input.readOnly = true;\r\n\t\tdat.controllerNameAndTitle( controllerFont, lang.fontStyle, lang.fontStyleTitle );\r\n\r\n\t}\r\n\r\n\t//text rectangle\r\n\tif ( optionsSpriteText.hasOwnProperty( 'rect' ) ) {\r\n\r\n\t\tif ( optionsSpriteText.rect.displayRect === undefined ) optionsSpriteText.rect.displayRect = false;\r\n\t\tdat.controllerNameAndTitle( fSpriteText.add( optionsSpriteText.rect, 'displayRect' ).onChange( function ( value ) {\r\n\r\n\t\t\tupdateSpriteText();\r\n\t\t\tfRect.domElement.style.display = optionsSpriteText.rect.displayRect ? 'block' : 'none';\r\n\r\n\t\t} ), lang.displayRect, lang.displayRectTitle );\r\n\t\tconst fRect = fSpriteText.addFolder( lang.displayRect );//'Border'\r\n\t\tfRect.domElement.style.display = optionsSpriteText.rect.displayRect ? 'block' : 'none';\r\n\r\n\t\t//border thickness\r\n\t\tconst borderThickness = 'borderThickness';\r\n\t\tif ( optionsSpriteText.rect.hasOwnProperty( borderThickness ) ) {\r\n\r\n\t\t\tdat.controllerNameAndTitle(\r\n\t\t\t\tfRect.add( optionsSpriteText.rect, borderThickness, 1, optionsSpriteText.rect.borderThickness * 30, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t\t} ), lang.borderThickness );\r\n\r\n\t\t}\r\n\r\n\t\t//border сolor\r\n\t\tconst borderColor = 'borderColor';\r\n\t\tif ( optionsSpriteText.rect.hasOwnProperty( borderColor ) ) {\r\n\r\n\t\t\tdat.controllerNameAndTitle( fRect.addColor( optionsSpriteText.rect, borderColor ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.borderColor );\r\n\r\n\t\t}\r\n\r\n\t\t//background color\r\n\t\tconst backgroundColor = 'backgroundColor';\r\n\t\tif ( optionsSpriteText.rect.hasOwnProperty( backgroundColor ) ) {\r\n\r\n\t\t\tdat.controllerNameAndTitle( fRect.addColor( optionsSpriteText.rect, backgroundColor ).onChange( function ( value ) {\r\n\r\n\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t} ), lang.backgroundColor );\r\n\r\n\t\t}\r\n\r\n\t\t//border radius\r\n\t\tconst borderRadius = 'borderRadius';\r\n\t\tif ( optionsSpriteText.rect.hasOwnProperty( borderRadius ) ) {\r\n\r\n\t\t\tdat.controllerNameAndTitle(\r\n\t\t\t\tfRect.add( optionsSpriteText.rect, borderRadius, 0, 100, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tupdateSpriteText();\r\n\r\n\t\t\t\t} ), lang.borderRadius );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//font сolor\r\n\tif ( optionsSpriteText.hasOwnProperty( 'fontColor' ) ) {\r\n\r\n\t\tdat.controllerNameAndTitle( fSpriteText.addColor( optionsSpriteText, 'fontColor' ).onChange( function ( value ) {\r\n\r\n\t\t\tupdateSpriteText();\r\n\r\n\t\t} ), lang.fontColor );\r\n\r\n\t}\r\n\r\n\t//anchor. https://threejs.org/docs/index.html#api/en/objects/Sprite.center\r\n\tif ( optionsSpriteText.hasOwnProperty( 'center' ) ) {\r\n\r\n\t\toptionsSpriteText.center = SpriteText.getCenter( optionsSpriteText.center );\r\n\r\n\t\t//anchor folder\r\n\t\tconst fAnchor = fSpriteText.addFolder( 'center' );\r\n\t\tdat.folderNameAndTitle( fAnchor, lang.anchor, lang.anchorTitle );\r\n\r\n\t\t//anchor x\r\n\t\tfAnchor.add( optionsSpriteText.center, 'x', 0, 1, 0.1 ).onChange( function ( value ) {\r\n\r\n\t\t\tupdateSpriteText();\r\n\r\n\t\t} );\r\n\r\n\t\t//anchor y\r\n\t\tfAnchor.add( optionsSpriteText.center, 'y', 0, 1, 0.1 ).onChange( function ( value ) {\r\n\r\n\t\t\tupdateSpriteText();\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t//size attenuation. Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.) Default is false.\r\n\t//See https://threejs.org/docs/index.html#api/en/materials/SpriteMaterial.sizeAttenuation\r\n\tconst sizeAttenuation = 'sizeAttenuation';\r\n\tif ( optionsSpriteText.hasOwnProperty( sizeAttenuation ) && ( optionsSpriteText[sizeAttenuation] !== undefined ) ) {\r\n\r\n\t\tdat.controllerNameAndTitle( fSpriteText.add( optionsSpriteText, sizeAttenuation ).onChange( function ( value ) {\r\n\r\n\t\t\tupdateSpriteText();\r\n\r\n\t\t} ), lang.sizeAttenuation, lang.sizeAttenuationTitle );\r\n\r\n\t}\r\n\r\n\t//default button\r\n\tfSpriteText.userData = {\r\n\r\n\t\toptions: options,\r\n\t\trestore: function ( value ) {\r\n\r\n\t\t\tboUpdateSpriteText = false;\r\n\t\t\tfunction setValues( folder, key, optionsDefault ) {\r\n\r\n\t\t\t\tfolder.__controllers.forEach( function ( controller ) {\r\n\r\n\t\t\t\t\tif ( controller.property !== key ) {\r\n\r\n\t\t\t\t\t\tif ( typeof optionsDefault[key] !== \"object\" )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tObject.keys( optionsDefault[key] ).forEach( function ( optionKey ) {\r\n\r\n\t\t\t\t\t\t\tif ( controller.property !== optionKey )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tcontroller.setValue( optionsDefault[key][optionKey] );\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontroller.setValue( optionsDefault[key] );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tObject.keys( optionsDefault ).forEach( function ( key ) {\r\n\r\n\t\t\t\tsetValues( fSpriteText, key, optionsDefault );\r\n\t\t\t\tif ( typeof optionsDefault[key] === \"object\" ) {\r\n\r\n\t\t\t\t\tObject.keys( optionsDefault[key] ).forEach( function ( keyObject ) {\r\n\r\n\t\t\t\t\t\tObject.keys( fSpriteText.__folders ).forEach( function ( keyFolder ) {\r\n\r\n\t\t\t\t\t\t\tsetValues( fSpriteText.__folders[keyFolder], keyObject, optionsDefault[key] );\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tObject.keys( fSpriteText.__folders ).forEach( function ( keyFolder ) {\r\n\r\n\t\t\t\t\tif ( keyFolder !== key )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tObject.keys( optionsDefault[keyFolder] ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tsetValues( fSpriteText.__folders[keyFolder], key, optionsDefault[keyFolder] );\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tboUpdateSpriteText = true;\r\n\t\t\tupdateSpriteText();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\tconst defaultParams = { defaultF: fSpriteText.userData.restore, };\r\n\tif ( optionsDefault === undefined ) console.error( 'SpriteTextGui: optionsDefault = ' + optionsDefault );\r\n\tdat.controllerNameAndTitle( fSpriteText.add( defaultParams, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\tupdateSpriteText( true );\r\n\r\n\treturn fSpriteText;\r\n\r\n};\r\n","/**\r\n * @module AxesHelperGui\r\n * @description Adds <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> settings folder into {@link https://github.com/anhr/dat.gui|dat.gui}.\r\n * @see {@link https://github.com/anhr/AxesHelper|AxesHelper}\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport ScaleController from '../ScaleController.js';\r\n//import ScaleController from 'https://raw.githack.com/anhr/commonNodeJS/master/ScaleController.js';\r\n\r\nimport PositionController from '../PositionController.js';\r\n//import PositionController from 'https://raw.githack.com/anhr/commonNodeJS/master/PositionController.js';\r\n\r\nimport { SpriteTextGui } from '../SpriteText/SpriteTextGui.js';\r\n//import { SpriteTextGui } from 'https://raw.githack.com/anhr/commonNodeJS/master/SpriteText/SpriteTextGui.js';\r\n\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\n\r\n/**\r\n * Adds <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> settings folder into {@link https://github.com/anhr/dat.gui|dat.gui}.\r\n * An axis object to visualize axes.\r\n * @param {Options} options Followed parameters is allowed.\r\n * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {boolean} [options.dat.axesHelperGui] false - do not adds <b>AxesHelperGui</b> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n * @param {AxesHelper} [options.axesHelper is <a href=\"./module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> instance.\r\n * @param {Function} [options.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n * <pre>\r\n * returns the \"primary language\" subtag of the language version of the browser.\r\n * Examples: \"en\" - English language, \"ru\" Russian.\r\n * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n * </pre>\r\n * @param {cookie} [options.cookie] Your custom cookie function for saving and loading of the AxesHelper settings.\r\n * <pre>\r\n * See [cookieNodeJS]{@link https://github.com/anhr/commonNodeJS/tree/master/cookieNodeJS}.\r\n * Default cookie is not saving settings.\r\n * </pre>\r\n * @param {string} [options.cookieName] Name of the cookie is \"AxesHelper\" + options.cookieName.\r\n * @param {GUI} [gui] is [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}.\r\n*/\r\nexport default function AxesHelperGui( options, gui ) {\r\n\r\n\tif ( !options.boOptions ) {\r\n\r\n\t\tconsole.error( 'AxesHelperGui: call options = new Options( options ) first' );\r\n\t\treturn;\r\n\r\n\t}\r\n\tgui = gui || options.dat.gui;\r\n\tif ( !gui || ( options.dat === false ) || ( options.dat.axesHelperGui === false ) )\r\n\t\treturn;\r\n\tif ( options.axesHelper === false )\r\n\t\treturn;\r\n\tif ( !options.axesHelper ) {\r\n\r\n\t\tconsole.error( 'AxesHelperGui: create AxesHelper instance first' );\r\n\t\treturn;\r\n\r\n\t}\r\n\t\r\n\tconst THREE = three.THREE, dat = three.dat;\r\n\r\n\tconst scalesDefault = JSON.parse( JSON.stringify( options.scales ) ),\r\n\t\tgroupAxesHelper = options.axesHelper.getGroup();\r\n\tscalesDefault.posAxesIntersection = new THREE.Vector3().copy(options.scales.posAxesIntersection);\r\n\tObject.freeze( scalesDefault );\r\n\r\n\toptions = options || {};\r\n\r\n\t//Localization\r\n\r\n\tconst lang = {\r\n\r\n\t\taxesHelper: 'Axes Helper',\r\n\r\n\t\tscales: 'Scales',\r\n\r\n\t\tdisplayScales: 'Display',\r\n\t\tdisplayScalesTitle: 'Display or hide axes scales.',\r\n\r\n\t\tprecision: 'Precision',\r\n\t\tprecisionTitle: 'Formats a number to a specified length.',\r\n\r\n\t\tmin: 'Min',\r\n\t\tmax: 'Max',\r\n\t\t\t\r\n\t\tmarks: 'Marks',\r\n\t\tmarksTitle: 'Number of scale marks',\r\n\r\n\t\taxesIntersection: 'Axes Intersection',\r\n\r\n\t\tdefaultButton: 'Default',\r\n\t\tdefaultTitle: 'Restore default Axes Helper settings.',\r\n\t\tdefaultAxesIntersectionTitle: 'Restore default axes intersection.',\r\n\r\n\t};\r\n\tswitch ( options.getLanguageCode() ){\r\n\r\n\t\tcase 'ru'://Russian language\r\n\r\n\t\t\tlang.axesHelper = 'Оси координат';\r\n\r\n\t\t\tlang.scales = 'Шкалы';\r\n\r\n\t\t\tlang.displayScales = 'Показать';\r\n\t\t\tlang.displayScalesTitle = 'Показать или скрыть шкалы осей координат.';\r\n\r\n\t\t\tlang.precision = 'Точность';\r\n\t\t\tlang.precisionTitle = 'Ограничить количество цифр в числе.';\r\n\r\n\t\t\tlang.min = 'Минимум';\r\n\t\t\tlang.max = 'Максимум';\r\n\t\t\t\t\r\n\t\t\tlang.marks = 'Риски';\r\n\t\t\tlang.marksTitle = 'Количество отметок на шкале';\r\n\r\n\t\t\tlang.axesIntersection = 'Начало координат',\r\n\r\n\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\tlang.defaultTitle = 'Восстановить настройки осей координат по умолчанию.';\r\n\t\t\tlang.defaultAxesIntersectionTitle = 'Восстановить начало координат по умолчанию.';\r\n\r\n\t\t\tbreak;\r\n\t\tdefault://Custom language\r\n\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != languageCode ) )\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t} );\r\n\r\n\t}\r\n\r\n\tconst cookie = options.dat.cookie,\r\n\t\tcookieName = options.dat.getCookieName( 'AxesHelper' );\r\n\tcookie.getObject( cookieName, options.scales, options.scales );\r\n\r\n\tfunction setSettings() {\r\n\r\n\t\tcookie.setObject( cookieName, options.scales );\r\n\r\n\t}\r\n\r\n\t//AxesHelper folder\r\n\tconst fAxesHelper = gui.addFolder( lang.axesHelper );\r\n\r\n\t//scales folder\r\n\tconst fScales = fAxesHelper.addFolder( lang.scales );\r\n\r\n\t//display scales\r\n\r\n\tconst controllerDisplayScales = fScales.add( options.scales, 'display' ).onChange( function ( value ) {\r\n\r\n\t\tgroupAxesHelper.children.forEach( function ( group ) {\r\n\r\n\t\t\tgroup.children.forEach( function ( group ) {\r\n\r\n\t\t\t\tgroup.visible = value;\r\n\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\t\tdisplayControllers();\r\n\t\tsetSettings();\r\n\t\t\t\r\n\r\n\t} );\r\n\tdat.controllerNameAndTitle( controllerDisplayScales, lang.displayScales, lang.displayScalesTitle );\r\n\r\n\tvar controllerPrecision;\r\n\tif ( options.scales.text.precision !== undefined ) {\r\n\r\n\t\tcontrollerPrecision = fScales.add( options.scales.text, 'precision', 2, 17, 1 ).onChange( function ( value ) {\r\n\r\n\t\t\tfunction updateSpriteTextGroup( group ) {\r\n\r\n\t\t\t\tgroup.children.forEach( function ( spriteItem ) {\r\n\r\n\t\t\t\t\tif ( spriteItem instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\t\t\tif ( spriteItem.userData.updatePrecision !== undefined )\r\n\t\t\t\t\t\t\tspriteItem.userData.updatePrecision();\r\n\r\n\t\t\t\t\t} else if ( ( spriteItem instanceof THREE.Group ) || ( spriteItem instanceof THREE.Line ) )\r\n\t\t\t\t\t\tupdateSpriteTextGroup( spriteItem );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tupdateSpriteTextGroup( groupAxesHelper );\r\n\t\t\tsetSettings();\r\n\r\n\t\t} )\r\n\t\tdat.controllerNameAndTitle( controllerPrecision, lang.precision, lang.precisionTitle );\r\n\r\n\t}\r\n\r\n\tconst fSpriteText = typeof SpriteTextGui === \"undefined\" ? undefined : SpriteTextGui( groupAxesHelper, {\r\n\r\n\t\tdat: {\r\n\r\n\t\t\tgui: options.dat.gui,\r\n\t\t\tcookieName: 'AxesHelper_' + options.dat.getCookieName(),\r\n\r\n\t\t},\r\n\r\n\t}, {\r\n\r\n\t\tparentFolder: fScales,\r\n\r\n\t} );\r\n\r\n\t//Axes intersection folder\r\n\r\n\tconst fAxesIntersection = fAxesHelper.addFolder( lang.axesIntersection ),\r\n\t\taxesIntersectionControllers = { x: {}, y: {}, z: {} };\r\n\tfunction axesIntersection( axisName ) {\r\n\r\n\t\tconst scale = options.scales[axisName];\r\n\t\tif ( !scale.isAxis() )\r\n\t\t\treturn;\r\n\r\n\t\tconst scaleControllers = axesIntersectionControllers[axisName];\r\n\r\n\t\tscaleControllers.controller = fAxesIntersection.add( {\r\n\r\n\t\t\tvalue: options.scales.posAxesIntersection[axisName],\r\n\r\n\t\t}, 'value',\r\n\t\t\tscale.min,\r\n\t\t\tscale.max,\r\n\t\t\t( scale.max - scale.min ) / 100 ).\r\n\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\toptions.scales.posAxesIntersection[axisName] = value;\r\n\t\t\t\toptions.axesHelper.updateAxes();\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\t\tdat.controllerNameAndTitle( scaleControllers.controller, scale.name );\r\n\r\n\t}\r\n\taxesIntersection( 'x' );\r\n\taxesIntersection( 'y' );\r\n\taxesIntersection( 'z' );\r\n\r\n\t//default button Axes intersection \r\n\tvar defaultParams = {\r\n\r\n\t\tdefaultF: function ( value ) {\r\n\t\t\t\r\n\t\t\taxesIntersectionControllers.x.controller.setValue( scalesDefault.posAxesIntersection.x );\r\n\t\t\taxesIntersectionControllers.y.controller.setValue( scalesDefault.posAxesIntersection.y );\r\n\t\t\taxesIntersectionControllers.z.controller.setValue( scalesDefault.posAxesIntersection.z );\r\n\r\n\t\t},\r\n\r\n\t};\r\n\tdat.controllerNameAndTitle( fAxesIntersection.add( defaultParams, 'defaultF' ), lang.defaultButton, lang.defaultAxesIntersectionTitle );\r\n\r\n\tfAxesHelper.add( new ScaleController(\r\n\t\tfunction ( customController, action ) {\r\n\r\n\t\t\tfunction zoom( zoom, action ) {\r\n\r\n\t\t\t\tfunction axesZoom( axes, scaleControllers ) {\r\n\r\n\t\t\t\t\tif ( axes === undefined )\r\n\t\t\t\t\t\treturn;//not 3D axesHelper\r\n\r\n\t\t\t\t\taxes.min = action( axes.min, zoom );\r\n\t\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\t\t\taxes.max = action( axes.max, zoom );\r\n\t\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\t\t\t\t\tscaleControllers.onchangeWindowRange();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\taxesZoom( options.scales.x, scalesControllers.x );\r\n\t\t\t\taxesZoom( options.scales.y, scalesControllers.y );\r\n\t\t\t\taxesZoom( options.scales.z, scalesControllers.z );\r\n\r\n\t\t\t}\r\n\t\t\tzoom( customController.controller.getValue(), action );\r\n\r\n\t\t}, {\r\n\r\n\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\tgetLanguageCode: options.getLanguageCode,\r\n\r\n\t} ) ).onChange( function ( value ) {\r\n\r\n\t\tconsole.warn( 'ScaleController.onChange' );\r\n\r\n\t} );\r\n\r\n\tfunction scale( axisName ) {\r\n\r\n\t\tconst axes = options.scales[axisName];\r\n\t\tif ( axes === undefined )\r\n\t\t\treturn;\r\n\r\n\t\tconst scaleControllers = scalesControllers[axisName],\r\n\t\t\taxesDefault = scalesDefault[axisName];\r\n\r\n\t\tObject.freeze( axesDefault );\r\n\r\n\t\tfunction updateAxis() {\r\n\r\n\t\t\tgroupAxesHelper.children.forEach( function ( group ) {\r\n\r\n\t\t\t\tif ( group.userData.axisName !== axisName )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tgroupAxesHelper.remove( group );\r\n\t\t\t\toptions.axesHelper.createAxis( axisName );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tscaleControllers.updateAxis = updateAxis;\r\n\r\n\t\tfunction onchangeWindowRange() {\r\n\r\n\t\t\tupdateAxis();\r\n\t\t\tsetSettings();\r\n\r\n\t\t}\r\n\t\tscaleControllers.onchangeWindowRange = onchangeWindowRange;\r\n\t\t\r\n\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\tvar zoom = customController.controller.getValue();\r\n\r\n\t\t\taxes.min = action( axes.min, zoom );\r\n\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\taxes.max = action( axes.max, zoom );\r\n\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\tonchangeWindowRange( windowRange, axes );\r\n\r\n\t\t}\r\n\r\n\t\tscaleControllers.folder = fAxesHelper.addFolder( axes.name );\r\n\r\n\t\tscaleControllers.scaleController = scaleControllers.folder.add( new ScaleController( onclick,\r\n\t\t\t{ settings: axes, getLanguageCode: options.getLanguageCode, } ) ).onChange( function ( value ) {\r\n\r\n\t\t\t\taxes.zoomMultiplier = value;\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\r\n\t\tvar positionController = new PositionController( function ( shift ) {\r\n\r\n\t\t\tonclick( positionController, function ( value, zoom ) {\r\n\r\n\t\t\t\tvalue += shift;\r\n\t\t\t\treturn value;\r\n\r\n\t\t\t} );\r\n\r\n\t\t}, { settings: axes, getLanguageCode: options.getLanguageCode, } );\r\n\t\tscaleControllers.positionController = scaleControllers.folder.add( positionController ).onChange( function ( value ) {\r\n\r\n\t\t\taxes.offset = value;\r\n\t\t\tsetSettings();\r\n\r\n\t\t} );\r\n\r\n\t\t//min\r\n\t\tscaleControllers.min = dat.controllerZeroStep( scaleControllers.folder, axes, 'min', function ( value ) {\r\n\r\n\t\t\tonchangeWindowRange( windowRange );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( scaleControllers.min, lang.min );\r\n\r\n\t\t//max\r\n\t\tscaleControllers.max = dat.controllerZeroStep( scaleControllers.folder, axes, 'max', function ( value ) {\r\n\r\n\t\t\tonchangeWindowRange( windowRange );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( scaleControllers.max, lang.max );\r\n\r\n\t\t//marks\r\n\t\tif ( axes.marks !== undefined ) {//w axis do not have marks\r\n\r\n\t\t\tscaleControllers.marks = dat.controllerZeroStep( scaleControllers.folder, axes, 'marks', function ( value ) {\r\n\r\n\t\t\t\tonchangeWindowRange( windowRange );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.marks, axes.marksName === undefined ? lang.marks : axes.marksName,\r\n\t\t\t\taxes.marksTitle === undefined ? lang.marksTitle : axes.marksTitle );\r\n\r\n\t\t}\r\n\r\n\t\t//Default button\r\n\t\tscaleControllers.defaultButton = scaleControllers.folder.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\taxes.min = axesDefault.min;\r\n\t\t\t\tscaleControllers.min.setValue( axes.min );\r\n\r\n\t\t\t\taxes.max = axesDefault.max;\r\n\t\t\t\tscaleControllers.max.setValue( axes.max );\r\n\r\n\t\t\t\taxes.zoomMultiplier = axesDefault.zoomMultiplier;\r\n\t\t\t\tscaleControllers.scaleController.setValue( axes.zoomMultiplier );\r\n\r\n\t\t\t\taxes.offset = axesDefault.offset;\r\n\t\t\t\tscaleControllers.positionController.setValue( axes.offset );\r\n\r\n\t\t\t\tif ( axesDefault.marks !== undefined ) {\r\n\r\n\t\t\t\t\taxes.marks = axesDefault.marks;\r\n\t\t\t\t\tscaleControllers.marks.setValue( axes.marks );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tonchangeWindowRange( windowRange, axes );\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle(scaleControllers.defaultButton , lang.defaultButton, lang.defaultTitle );\r\n\r\n\t}\r\n\tconst scalesControllers = { x: {}, y: {}, z: {} };//, w: {} };//, t: {}, };\r\n\tfunction windowRange() {\r\n\r\n\t\tsetSettings();\r\n\r\n\t}\r\n\tscale('x');\r\n\tscale('y');\r\n\tscale('z');\r\n\r\n\t//default button\r\n\tvar defaultParams = {\r\n\r\n\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\tcontrollerDisplayScales.setValue( scalesDefault.display );\r\n\t\t\tif ( controllerPrecision !== undefined )\r\n\t\t\t\tcontrollerPrecision.setValue( scalesDefault.text.precision );\r\n\t\t\tfSpriteText.userData.restore();\r\n\t\t\tfunction defaulAxis( axisName ) {\r\n\r\n\t\t\t\tif ( scalesControllers[axisName].defaultButton )\r\n\t\t\t\t\tscalesControllers[axisName].defaultButton.object.defaultF();\r\n\r\n\t\t\t}\r\n\t\t\tdefaulAxis( 'x' );\r\n\t\t\tdefaulAxis( 'y' );\r\n\t\t\tdefaulAxis( 'z' );\r\n\r\n\t\t},\r\n\r\n\t};\r\n\tdat.controllerNameAndTitle( fAxesHelper.add( defaultParams, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\t\t\r\n\tfunction displayControllers() {\r\n\r\n\t\tvar display = options.scales.display ? 'block' : 'none';\r\n\t\tif ( fSpriteText !== undefined )\r\n\t\t\tfSpriteText.domElement.style.display = display;\r\n\t\tif ( controllerPrecision !== undefined )\t\r\n\t\t\tcontrollerPrecision.domElement.parentElement.parentElement.style.display = display;\r\n\r\n\t}\r\n\tdisplayControllers();\r\n\t\r\n\tif ( scalesControllers.x.updateAxis ) scalesControllers.x.updateAxis();\r\n\tif ( scalesControllers.y.updateAxis ) scalesControllers.y.updateAxis();\r\n\tif ( scalesControllers.z.updateAxis ) scalesControllers.z.updateAxis();\r\n\r\n}\r\n","/**\r\n * @module OrbitControlsGui\r\n * @description [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls} graphical user interface\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport PositionController from '../PositionController.js';\r\nimport three from '../three.js'\r\n\r\nclass OrbitControlsGui {\r\n\r\n\t/**\r\n\t * OrbitControls graphical user interface\r\n\t * @param {Options} options See <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a>.\r\n\t * The following options are available.\r\n\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean} [options.dat.orbitControlsGui] false - do not adds <b>OrbitControlsGui</b> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {OrbitControls} [options.orbitControls] [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}.\r\n\t * Call <a href=\"../../jsdoc/Options/Options.html#createOrbitControls\" target=\"_blank\">Options.createOrbitControls(...)</a> for define of the <b>options.orbitControls</b>.\r\n\t * @param {object} [options.scales] axes scales.\r\n\t * See <b>options.scales</b> of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a>.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t * @param {GUI} [gui] is [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui}.\r\n\t */\r\n\tconstructor( options, gui ) {\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'OrbitControlsGui: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tgui = gui || options.dat.gui;\r\n\t\tif ( !gui || !options.orbitControls || options.dat.orbitControlsGui === false )\r\n\t\t\treturn;\r\n\t\tconst dat = three.dat,//options.dat.dat,\r\n\t\t\torbitControls = options.orbitControls;\r\n\t\toptions.orbitControlsGui = this;\r\n\r\n\t\torbitControls.addEventListener( 'change', function () {\r\n\r\n\t\t\t//console.log( 'orbitControls.target: ' + orbitControls.target.x + ' ' + orbitControls.target.y + ' ' + orbitControls.target.z )\r\n\t\t\tif ( targetX ) targetX.setValue( orbitControls.target.x );\r\n\t\t\tif ( targetY ) targetY.setValue( orbitControls.target.y );\r\n\t\t\tif ( targetZ ) targetZ.setValue( orbitControls.target.z );\r\n\t\t\t/*\r\n\t\t\tconsole.warn('camera.position = ' + camera.position.x + ' ' + camera.position.y + ' ' + camera.position.z\r\n\t\t\t\t+ '\\r\\ncamera.quaternion = ' + camera.quaternion.x + ' ' + camera.quaternion.y + ' ' + camera.quaternion.z\r\n\t\t\t\t+ '\\r\\ncamera.scale = ' + camera.scale.x + ' ' + camera.scale.y + ' ' + camera.scale.z\r\n\t\t\t\t);\r\n\t\t\t*/\r\n\r\n\t\t} );\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\torbitControls: 'Orbit Controls',\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultTitle: 'Restore default Orbit controls settings.',\r\n\t\t\ttarget: 'Target',\r\n\r\n\t\t};\r\n\r\n\t\tconst _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t: options.getLanguageCode();\r\n\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultTitle = 'Восстановить настройки Orbit controls по умолчанию.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tconst fOrbitControls = gui.addFolder( lang.orbitControls ),\r\n\t\t\tfX = !options.scales.x ? undefined : fOrbitControls.addFolder( options.scales.x.name ),\r\n\t\t\tfY = !options.scales.y ? undefined : fOrbitControls.addFolder( options.scales.y.name ),\r\n\t\t\tfZ = !options.scales.z ? undefined : fOrbitControls.addFolder( options.scales.z.name );\r\n\r\n\t\tfunction addTarget( folder, axisIndex ) {\r\n\r\n\t\t\tif ( !folder )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tfunction setTarget( value ) {\r\n\r\n\t\t\t\tif ( value === undefined )\r\n\t\t\t\t\tvalue = 0;\r\n\t\t\t\torbitControls.target[axisIndex] = value;\r\n\t\t\t\torbitControls.update();\r\n\r\n\t\t\t\ttarget.setValue( value );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfolder.add( new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tsetTarget( orbitControls.target[axisIndex] + shift );\r\n\r\n\t\t\t} ) );\r\n\r\n\t\t\t//target\r\n\t\t\tconst target = dat.controllerZeroStep( folder, orbitControls.target, axisIndex, function ( value ) {\r\n\r\n\t\t\t\tsetTarget( value );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( target, lang.target );\r\n\r\n\t\t\t//Default button\r\n\t\t\tdat.controllerNameAndTitle( folder.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tsetTarget();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t\treturn target;\r\n\r\n\t\t}\r\n\t\tconst targetX = addTarget( fX, 'x' ),\r\n\t\t\ttargetY = addTarget( fY, 'y' ),\r\n\t\t\ttargetZ = addTarget( fZ, 'z' );\r\n\r\n\t\t//Default button\r\n\t\tdat.controllerNameAndTitle( fOrbitControls.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\torbitControls.reset();\r\n\t\t\t\t/*\r\n\t\t\t\t\t\t\torbitControls.target.x = 0;\r\n\t\t\t\t\t\t\torbitControls.target.y = 0;\r\n\t\t\t\t\t\t\torbitControls.target.z = 0;\r\n\t\t\t\t\t\t\torbitControls.update();\r\n\t\t\t\t*/\r\n\t\t\t\ttargetX.setValue( orbitControls.target.x );\r\n\t\t\t\ttargetY.setValue( orbitControls.target.y );\r\n\t\t\t\ttargetZ.setValue( orbitControls.target.z );\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\t\t/**\r\n\t\t* Set camera [target]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls.target}.\r\n\t\t* @param {THREE.Vector3} target new camera [target]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls.target}\r\n\t\t*/\r\n\t\tthis.setTarget = function ( target ) {\r\n\r\n\t\t\tif ( targetX ) targetX.setValue( target.x );\r\n\t\t\tif ( targetY ) targetY.setValue( target.y );\r\n\t\t\tif ( targetZ ) targetZ.setValue( target.z );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default OrbitControlsGui;","/**\r\n * Modify of the dat object.\r\n * @see {@link https://github.com/dataarts/dat.gui} about dat.gui\r\n *\r\n * @author Andrej Hristoliubov https://anhr.github.io/AboutMe/\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n//import { GUI } from '../../three.js/dev/examples/jsm/libs/dat.gui.module.js';\r\n//import { GUI } from '../../dat.gui/CustomController/build/dat.gui.module.js';\r\nimport { GUI } from './dat.gui.module.js';\r\nexport function dat() { };\r\nif ( typeof dat !== 'undefined' ) {\r\n\r\n\t//dat.GUI is included into current project\r\n\t//See https://github.com/dataarts/dat.gui/blob/master/API.md about dat.GUI API.\r\n\tdat.GUI = GUI;\r\n\r\n\tfunction elNameAndTitle( el, name, title ) {\r\n\r\n\t\tif ( name === undefined )\r\n\t\t\tconsole.warn( 'elNameAndTitle: name = ' + name );\r\n\t\tel.innerHTML = name;\r\n\t\tif ( title !== undefined )\r\n\t\t\tel.title = title;\r\n\r\n\t}\r\n\r\n\tif ( dat.controllerNameAndTitle === undefined ) {\r\n\r\n\t\tdat.controllerNameAndTitle = function ( controller, name, title ) {\r\n\r\n\t\t\telNameAndTitle( controller.__li.querySelector( \".property-name\" ), name, title );\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerNameAndTitle method.' );\r\n\r\n\tif ( dat.folderNameAndTitle === undefined ) {\r\n\r\n\t\tdat.folderNameAndTitle = function ( folder, name, title ) {\r\n\r\n\t\t\telNameAndTitle( folder.__ul.querySelector( \"li.title\" ), name, title );\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.folderNameAndTitle method.' );\r\n\r\n\tif ( dat.controllerZeroStep === undefined ) {\r\n\r\n\t\t//Solving of dat.gui NumberController Step bug.\r\n\t\t//See https://github.com/dataarts/dat.gui/issues/48 for details.\r\n\t\t//\r\n\t\t//folder: GUI or folder for new Controller.\r\n\t\t//object: The object to be manipulated. See https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+add for details\r\n\t\t//property: The name of the property to be manipulated. See https://github.com/dataarts/dat.gui/blob/master/API.md#GUI+add for details\r\n\t\t//onchange: Callback function will be called if controller value was changed. Can be undefined.\r\n\t\t//\r\n\t\t//Example of using\r\n\t\t/*\r\n\t\tvar gui = new dat.GUI();\r\n\t\tvar object = { min: 123.456 }\r\n\t\tdat.controllerZeroStep( gui, object, 'min', function ( value ) {\r\n\r\n\t\t\tconsole.log( 'object.min = ' + object.min + ' value = ' + value );\r\n\r\n\t\t} );\r\n\t\t*/\r\n\t\tdat.controllerZeroStep = function ( folder, object, property, onchange ) {\r\n\r\n\t\t\tif ( typeof object[property] !== \"number\" ) console.warn( 'typeof object[property] = ' + typeof object[property] );\r\n\t\t\tvar controller = folder.add( object, property ),\r\n\t\t\t\tinput = controller.__input;\r\n\t\t\tcontroller.__input = document.createElement( 'input' );\r\n\t\t\tinput.value = object[property];\r\n\t\t\tinput.onchange = function ( value ) {\r\n\r\n\t\t\t\tobject[property] = parseFloat( input.value );\r\n\r\n\t\t\t\tif ( onchange !== undefined )\r\n\t\t\t\t\tonchange( object[property] );\r\n\r\n\t\t\t};\r\n\t\t\tcontroller.setValue = function ( value, boOnChange ) {\r\n\r\n\t\t\t\tinput.value = object[property] = value;\r\n\r\n\t\t\t\t//нужно в CameraGui когда пользователь редактирует функцию расстояния от камеры до цели\r\n\t\t\t\tif ( boOnChange && onchange )\r\n\t\t\t\t\tonchange( object[property] );\r\n\r\n\t\t\t};\r\n\t\t\treturn controller;\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerZeroStep method.' );\r\n\r\n\tif ( dat.controllerSetValue === undefined ) {\r\n\r\n\t\t//for resolving of the bug\r\n\t\t//Testing:\r\n\t\t//select Surface in the Examples drop down menu of the webgl_math.html page.\r\n\t\t//Click mouse over any point.\r\n\t\t//Now you can see number of selected line in the Select Line drop down menu\r\n\t\t//\tand number of selected point in the Select Point drop down menu.\r\n\t\t//Select \"no select\" in the Select Line drop down menu.\r\n\t\t//Click mouse over any point again.\r\n\t\t//Now you can see a bug: You see \"no select\" instead of number of selected line in the Select Line drop down menu.\r\n\t\tdat.controllerSetValue = function ( controller, index ) {\r\n\r\n\t\t\tcontroller.setValue( index );\r\n\t\t\tcontroller.__li.querySelector( 'select' ).selectedIndex = index;\r\n\r\n\t\t};\r\n\r\n\t} else console.error( 'Duplicate dat.controllerSetValue method.' );\r\n\r\n}\r\n/*\r\nvar datModifier = {\r\n}\r\nexport default datModifier;\r\n*/\r\n","/**\r\n * @module functionsFolder\r\n * @description Adds the [Functions]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} folder into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport Options from './Options.js'\r\nimport three from './three.js'\r\n\r\nclass functionsFolder {\r\n\r\n\t/**\r\n\t * Adds the [Functions]{@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function} folder into [dat.gui]{@link https://github.com/anhr/dat.gui}.\r\n\t * @param {GUI} fParent parent folder for functions folder.\r\n\t * @param {Object} scales [AxesHelper]{@link https://raw.githack.com/anhr/AxesHelper/master/jsdoc/module-AxesHelper.html} options.scales for details.\r\n\t * @param {Function} onFinishChange callback function is called every time, when user have entered new value of the function and the function controller is lost of the focus.\r\n\t * <pre>\r\n\t * parameter value is new value of the function.\r\n\t * </pre>\r\n\t * @param {Options} options <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t * @param {object} [vector] Vector with initial text of the function\r\n\t * @param {string} [vector.x] text of the x axis function\r\n\t * @param {string} [vector.y] text of the y axis function\r\n\t * @param {string} [vector.z] text of the z axis function\r\n\t*/\r\n\tconstructor( fParent, onFinishChange, options, vector ) {\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'functionsFolder: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst dat = three.dat,\r\n\t\t\tTHREE = three.THREE,\r\n\t\t\tscales = options.scales;\r\n\t\tconst _this = this;\r\n\t\tvar boError = false,//true - обнаружена ошибка ввода. Нужно вывести сообщение об ошибке и вернуть фокус на поле управления\r\n\t\t\tboAlert = false;//предотвращает бесконечный вывод сообщения об ошибке\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tfunctions: 'Functions',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultTitle: 'Restore default functions.',\r\n\r\n\t\t};\r\n\r\n\t\tconst _languageCode = options.getLanguageCode === undefined ? 'en'//Default language is English\r\n\t\t\t: options.getLanguageCode();\r\n\r\n\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.functions = 'Функции';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultTitle = 'Восстановить функции.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( vector ) {\r\n\r\n\t\t\tvector.x = getFuncText( vector.x );\r\n\t\t\tvector.y = getFuncText( vector.y );\r\n\t\t\tvector.z = getFuncText( vector.z );\r\n\r\n\t\t} else vector = { x: '', y: '', z: '', }\r\n\r\n\t\tconst fFunctions = fParent.addFolder( lang.functions ),\r\n\r\n\t\t\t//onFinishChange вызывается даже если vector не изменился. Поэтому такой onFinishChange пропускается\r\n\t\t\tvectorCur = {\r\n\r\n\t\t\t\tx: vector.x,\r\n\t\t\t\ty: vector.y,\r\n\t\t\t\tz: vector.z,\r\n\t\t\t\tw: vector.w,\r\n\r\n\t\t\t},\r\n\t\t\tcFunctions = {};\r\n\t\tfunction createControl( axisName ) {\r\n\r\n\t\t\tif ( vector[axisName] === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tcFunctions[axisName] = fFunctions.add( vector, axisName ).onFinishChange( function ( value ) {\r\n\r\n\t\t\t\t__onFinishChange( value, axisName, vectorCur );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cFunctions[axisName], getAxisName( axisName ) );\r\n\r\n\t\t}\r\n\t\tfunction getAxisName( axisName ) { return scales[axisName] && scales[axisName].name ? scales[axisName].name : axisName; }\r\n\t\tcreateControl( 'x' );\r\n\t\tcreateControl( 'y' );\r\n\t\tcreateControl( 'z' );\r\n\t\tcreateControl( 'w' );\r\n\r\n\t\t//Default scale button\r\n\t\tconst buttonDefault = fFunctions.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' );\r\n\t\tdat.controllerNameAndTitle( buttonDefault, lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\tfunction getFuncText( func ) {\r\n\r\n\t\t\tif ( func === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tif ( typeof func === 'object' ) {\r\n\r\n\t\t\t\tif ( func instanceof THREE.Color ) return func.getStyle();\r\n\t\t\t\tif ( Array.isArray( func ) ) return JSON.stringify( func )\r\n\t\t\t\tfunc = func.func ? func.func : func;\r\n\r\n\t\t\t}\r\n\t\t\tconst typeofFunc = typeof func;\r\n\t\t\tswitch ( typeofFunc ) {\r\n\r\n\t\t\t\tcase 'number':\r\n\t\t\t\t\tfunc = func.toString();//если это не делать будет создан NumberControllerBox, ктороый не позволяет вводить float\r\n\t\t\t\tcase 'string':\r\n\t\t\t\t\treturn func;\r\n\t\t\t\tcase 'function':\r\n\t\t\t\t\treturn func.toString().split( /return (.*)/ )[1];\r\n\t\t\t\tdefault: console.error( 'functionsFolder.getFuncText(...): typeof func = ' + typeofFunc );\r\n\t\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tfunction __onFinishChange( value, axisName, vectorCur ) {\r\n\r\n\t\t\tif ( ( vectorCur[axisName] === value ) && !boError )\r\n\t\t\t\treturn;\r\n\t\t\ttry {\r\n\r\n\t\t\t\tboError = false;\r\n\t\t\t\tvectorCur[axisName] = value;\r\n\t\t\t\tvar func;\r\n\t\t\t\tconst typeofValue = typeof value;\r\n\t\t\t\tswitch ( typeofValue ) {\r\n\r\n\t\t\t\t\tcase 'string':\r\n\r\n\t\t\t\t\t\tvar float = parseFloat( value );\r\n\t\t\t\t\t\tif ( float.toString() !== value ) {\r\n\r\n\t\t\t\t\t\t\tconst color = value.replace( /\\s/g, \"\" ).split( /rgb\\((\\d+),(\\d+),(\\d+)\\)/ );\r\n\t\t\t\t\t\t\tif ( color.length === 5 ) func = new THREE.Color( value );\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tvar array;\r\n\t\t\t\t\t\t\t\ttry {\r\n\r\n\t\t\t\t\t\t\t\t\tarray = JSON.parse( value );\r\n\r\n\t\t\t\t\t\t\t\t} catch ( e ) { }\r\n\t\t\t\t\t\t\t\tif ( Array.isArray( array ) ) func = array;\r\n\t\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\t\tfunc = new Function( 't', 'a', 'b', 'return ' + value );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else func = float;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tcase 'number':\r\n\r\n\t\t\t\t\t\tfunc = value;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tconsole.error( 'onFinishChange( ' + value + ' ): invalid type = ' + typeofValue );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Новое значение введено правильно\r\n\t\t\t\tonFinishChange( func, axisName, value );\r\n\t\t\t\tboAlert = false;\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( !boAlert ) {\r\n\r\n\t\t\t\t\talert( 'Axis: ' + getAxisName( axisName ) + '. Function: \"' + value + '\". ' + e );\r\n\t\t\t\t\tboAlert = true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t_this.setFocus( axisName );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * set the function text\r\n\t\t * @param {object} _vector vector of the axis functions.\r\n\t\t * @param {object} _vector.x x axis function.\r\n\t\t * @param {object} _vector.y y axis function.\r\n\t\t * @param {object} _vector.z z axis function.\r\n\t\t */\r\n\t\tthis.setFunction = function ( _vector ) {\r\n\r\n\t\t\t_vector = _vector || options.vector;\r\n\t\t\tif ( !_vector )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tconst vector = {\r\n\r\n\t\t\t\tx: _vector ? getFuncText( _vector.x ) : '',\r\n\t\t\t\ty: _vector ? getFuncText( _vector.y ) : '',\r\n\t\t\t\tz: _vector ? getFuncText( _vector.z ) : '',\r\n\t\t\t\tw: _vector ? getFuncText( _vector.w ) : '',\r\n\r\n\t\t\t},\r\n\t\t\t\t//onFinishChange вызывается даже если vector не изменился. Поэтому такой onFinishChange пропускается\r\n\t\t\t\tvectorCur = {\r\n\r\n\t\t\t\t\tx: vector.x,\r\n\t\t\t\t\ty: vector.y,\r\n\t\t\t\t\tz: vector.z,\r\n\t\t\t\t\tw: vector.w,\r\n\r\n\t\t\t\t};\r\n\t\t\tif ( !_vector.vectorDefault )\r\n\t\t\t\t_vector.vectorDefault = {\r\n\r\n\t\t\t\t\tx: vector.x,\r\n\t\t\t\t\ty: vector.y,\r\n\t\t\t\t\tz: vector.z,\r\n\t\t\t\t\tw: vector.w,\r\n\r\n\t\t\t\t};\r\n\t\t\tfunction setVectorAxis( axisName ) {\r\n\r\n\t\t\t\tif ( _vector[axisName] === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcFunctions[axisName].__onFinishChange = function ( value ) {\r\n\r\n\t\t\t\t\t__onFinishChange( value, axisName, vectorCur );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvector[axisName] = getFuncText( _vector[axisName] );\r\n\t\t\t\tcFunctions[axisName].setValue( vector[axisName] );\r\n\t\t\t\tvectorCur[axisName] = vector[axisName];\r\n\r\n\t\t\t}\r\n\t\t\tsetVectorAxis( 'x' );\r\n\t\t\tsetVectorAxis( 'y' );\r\n\t\t\tvar dislay = false;\r\n\t\t\tif ( _vector.z ) {\r\n\r\n\t\t\t\tsetVectorAxis( 'z' );\r\n\t\t\t\tdislay = true;\r\n\r\n\t\t\t}\r\n\t\t\tbuttonDefault.object.defaultF = function ( value ) {\r\n\r\n\t\t\t\tfunction setValue( axisName ) {\r\n\r\n\t\t\t\t\tif ( !cFunctions[axisName] )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcFunctions[axisName].setValue( _vector.vectorDefault[axisName] );\r\n\t\t\t\t\tcFunctions[axisName].__onFinishChange( _vector.vectorDefault[axisName] );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetValue( 'x' );\r\n\t\t\t\tsetValue( 'y' );\r\n\t\t\t\tsetValue( 'z' );\r\n\t\t\t\tsetValue( 'w' );\r\n\r\n\t\t\t}\r\n\t\t\tfunction dislayEl( controller, displayController ) {\r\n\r\n\t\t\t\tif ( controller === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( typeof displayController === \"boolean\" )\r\n\t\t\t\t\tdisplayController = displayController ? 'block' : 'none';\r\n\t\t\t\tvar el = controller.domElement;\r\n\t\t\t\twhile ( el.tagName.toUpperCase() !== \"LI\" ) el = el.parentElement;\r\n\t\t\t\tel.style.display = displayController;\r\n\r\n\t\t\t}\r\n\t\t\tdislayEl( cFunctions.z, dislay );\r\n\t\t\tsetVectorAxis( 'w' );\r\n\r\n\t\t}\r\n\t\tthis.setFunction();\r\n\r\n\t\t/**\r\n\t\t * Display functions folder\r\n\t\t * @param {string|boolean} display 'block' or true - functions folder is visible.\r\n\t\t * <p>'none' or false - functions folder is hide.</p>\r\n\t\t */\r\n\t\tthis.displayFolder = function ( display ) {\r\n\r\n\t\t\tfFunctions.domElement.style.display = typeof display === \"boolean\" ?\r\n\t\t\t\tdisplay ? 'block' : 'none' :\r\n\t\t\t\tdisplay;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t* set focus to controller\r\n\t\t* @param {string} axisName Name of the axis of the controller\r\n\t\t*/\r\n\t\tthis.setFocus = function ( axisName ) {\r\n\r\n\t\t\tcFunctions[axisName].domElement.childNodes[0].focus();\r\n\t\t\tboError = true;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t* update the values of the controllers of the functions\r\n\t\t*/\r\n\t\tthis.update = function ( newVector ) {\r\n\r\n\t\t\tfunction updateAxis( axisName ) {\r\n\r\n\t\t\t\tif ( cFunctions[axisName].getValue() === newVector[axisName] )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcFunctions[axisName].setValue( newVector[axisName] );\r\n\r\n\t\t\t}\r\n\t\t\tupdateAxis( 'x' );\r\n\t\t\tupdateAxis( 'y' );\r\n\t\t\tupdateAxis( 'z' );\r\n\t\t\tupdateAxis( 'w' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default functionsFolder;","/**\r\n * @module GuiSelectPoint\r\n *\r\n * @description A dat.gui based graphical user interface for select a point from the mesh.\r\n * \r\n * @see {@link https://github.com/anhr/dat.gui|dat.gui}, {@link https://threejs.org/docs/index.html#api/en/objects/Mesh|three.js mesh}.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport ScaleController from '../ScaleController.js';\r\n//import ScaleController from 'https://raw.githack.com/anhr/commonNodeJS/master/ScaleController.js';\r\n\r\nimport PositionController from '../PositionController.js';\r\n//import PositionController from 'https://raw.githack.com/anhr/commonNodeJS/master/PositionController.js';\r\n\r\nimport ColorPicker from '../colorpicker/colorpicker.js';\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n\r\n//import Player from '../player/build/player.module.js';\r\n//import Player from '../player/build/player.module.min.js';\r\nimport Player from '../player/player.js';\r\n//import Player from 'https://raw.githack.com/anhr/commonNodeJS/master/player/player.js';\r\n//import Player from 'https://raw.githack.com/anhr/commonNodeJS/master/player/build/player.module.min.js';\r\n\r\nimport functionsFolder from '../functionsFolder.js';\r\nimport { SpriteText } from '../SpriteText/SpriteText.js'\r\nimport {\r\n\r\n\tgetObjectPosition,\r\n\tgetObjectLocalPosition,\r\n\r\n} from '../getPosition.js';\r\n\r\nimport three from '../three.js'\r\n\r\nconst none = 'none', block = 'block';\r\n\r\nclass GuiSelectPoint {\r\n\r\n\t/**\r\n\t * @class A dat.gui based graphical user interface for select a point from the mesh.\r\n\t * @param {Options} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {GUI} [options.dat.dat] [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean|Object} [options.dat.guiSelectPoint] false - do not displays <b>GuiSelectPoint</b>.\r\n\t * @param {Function} [options.dat.guiSelectPoint.point] Callback function to create custom controllers for each point of selected mesh with custom controllers.\r\n\t * <pre>\r\n\t * parameter <b>options</b> See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * parameter <b>dat</b> [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t * parameter <b>fParent</b> parent folder.\r\n\t * example <b>point: function ( options, dat, fMesh ) { return new FermatSpiral.gui( options, dat, fMesh ); },</b>\r\n\t * </pre>\r\n\t * @param {boolean} [options.dat.guiSelectPoint.boDisplayVerticeID] true - display on the scene the point ID near to the point.\r\n\t * @param {AxesHelper} [options.axesHelper] An axis object to visualize axes.\r\n\t * See <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] Your custom getLanguageCode() function.\r\n\t * <pre>\r\n\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t * See the \"Syntax\" paragraph of RFC 4646 {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t * </pre>\r\n\t * @param {object} [options.lang] Object with localized language values\r\n\t * @param {object} [guiParams={}] Followed parameters is allowed.\r\n\t * @param {object} [guiParams.cameraTarget] camera looking at selected point during playing. See the <b>cameraTarget</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html#init\" target=\"_blank\">Player.cameraTarget.init(...)</a> function for details.\r\n\t * @param {THREE.PerspectiveCamera} guiParams.cameraTarget.camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t * @param {Function} [guiParams.pointControls] pointControls( fPoint, dislayEl, getMesh ) Adds the trace \"Display the trace of the point movement\" control checkbox into gui.\r\n\t * <pre>\r\n\t * fPoint - parent folder for new control.\r\n\t * dislayEl( conrtol, true or false ) - function for dislay or hide of the control.\r\n\t * getMesh() returns the mesh, selected in the GuiSelectPoint.\r\n\t * Default is undefined.\r\n\t * </pre>\r\n\t * @param {Function} [guiParams.pointsControls] pointsControls( fPoints, dislayEl, getMesh ) Adds the trace \"Display the trace of the movement of all points of the mesh.\" control checkbox into gui.\r\n\t * <pre>\r\n\t * fPoints - parent folder for new control.\r\n\t * dislayEl( conrtol, true or false ) - function for dislay or hide of the control.\r\n\t * getMesh() returns the mesh, selected in the GuiSelectPoint.\r\n\t * Default is undefined.\r\n\t * </pre>\r\n\t * @param {Function} [guiParams.setIntersection] setIntersection( intersection ) sets the intersection value of myThreejs. Default is undefined\r\n\t * @example\r\n\timport GuiSelectPoint from 'https://raw.githack.com/anhr/commonNodeJS/master/guiSelectPoint/guiSelectPoint.js';\r\n\r\n\tnew GuiSelectPoint( options );\r\n\toptions.guiSelectPoint.add();\r\n\toptions.guiSelectPoint.addMesh( points );\r\n\t */\r\n\tconstructor( options, guiParams = {} ) {\r\n\r\n\t\tconst guiSelectPoint = this, THREE = three.THREE, folders = {};\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'GuiSelectPoint: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tif ( ( options.dat.guiSelectPoint === false ) || !options.dat.gui ) {\r\n\r\n\t\t\t//заменяем все функции на пустышки\r\n\t\t\tthis.add = function ( gui ) { };\r\n\t\t\tthis.addMesh = function ( points ) { };\r\n\t\t\tthis.select = function ( intersect ) { };\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tconst dat = three.dat;//options.dat.dat;\r\n\r\n\t\t//Player changes the guiSelectPoint control's values during playing\r\n\t\toptions.guiSelectPoint = guiSelectPoint;\r\n\r\n\t\tvar cFrustumPoints;\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst getLanguageCode = options.getLanguageCode;\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tmeshs: 'Meshes',\r\n\t\t\tnotSelected: 'Not selected',\r\n\t\t\tselect: 'Select',\r\n\t\t\tposition: 'Position',\r\n\t\t\trotation: 'Rotation',\r\n\t\t\tpoints: 'Points',\r\n\r\n\t\t\tdisplayVerticeID: 'Point ID',\r\n\t\t\tdisplayVerticeIDTitle: 'Display on the scene the point ID near to the point',\r\n\r\n\t\t\tcameraTarget: 'Look',\r\n\t\t\tcameraTargetTitle: 'Choose this point the camera is looking at.',\r\n\r\n\t\t\tpoint: 'Point Local Position',\r\n\t\t\tpointTitle: 'The position attribute of the selected point',\r\n\r\n\t\t\ttrace: 'Trace',\r\n\t\t\ttraceTitle: 'Display the trace of the point movement.',\r\n\t\t\ttraceAllTitle: 'Display the trace of the movement of all points of the mesh.',\r\n\r\n\t\t\tpointWorld: 'Point World Position',\r\n\t\t\tpointWorldTitle: 'The position of the selected point after scaling, moving and rotation of the mesh',\r\n\r\n\t\t\tmesh: 'Mesh',\r\n\t\t\tscale: 'Scale',\r\n\t\t\tcolor: 'Сolor',\r\n\r\n\t\t\topacity: 'Opacity',\r\n\t\t\topacityTitle: 'Float in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultScaleTitle: 'Restore default 3d object scale.',\r\n\t\t\tdefaultPositionTitle: 'Restore default 3d object position.',\r\n\t\t\tdefault3DObjectTitle: 'Restore default settings of all 3d objects.',\r\n\t\t\tdefaultRotationTitle: 'Restore default 3d object rotation.',\r\n\t\t\tdefaultLocalPositionTitle: 'Restore default local position.',\r\n\r\n\t\t\tmoveGroup: 'Move Scene',\r\n\r\n\t\t};\r\n\r\n\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.meshs = '3D объекты';\r\n\t\t\t\tlang.notSelected = 'Не выбран';\r\n\t\t\t\tlang.select = 'Выбрать';\r\n\t\t\t\tlang.position = 'Позиция';\r\n\t\t\t\tlang.rotation = 'Вращение';\r\n\t\t\t\tlang.points = 'Точки';\r\n\r\n\t\t\t\tlang.displayVerticeID = 'Номера точек';\r\n\t\t\t\tlang.displayVerticeIDTitle = 'На сцене возле каждой точки показать ее идентификатор';\r\n\r\n\t\t\t\tlang.cameraTarget = 'Следить';\r\n\t\t\t\tlang.cameraTargetTitle = 'Выберите эту точку, за которой следит камера.',\r\n\r\n\t\t\t\tlang.point = 'Локальная позиция точки';\r\n\t\t\t\tlang.pointTitle = 'Position attribute выбранной точки';\r\n\r\n\t\t\t\tlang.trace = 'Трек';\r\n\t\t\t\tlang.traceTitle = 'Показать трек перемещения точки.';\r\n\t\t\t\tlang.traceAllTitle = 'Показать трек перемещения всех точек выбранного 3D объекта.';\r\n\r\n\t\t\t\tlang.pointWorld = 'Абсолютная позиция точки';\r\n\t\t\t\tlang.pointWorldTitle = 'Позиция выбранной точки после масштабирования, перемещения и вращения 3D объекта';\r\n\r\n\t\t\t\tlang.mesh = '3D объект';\r\n\t\t\t\tlang.scale = 'Масштаб';\r\n\t\t\t\tlang.color = 'Цвет';\r\n\r\n\t\t\t\tlang.opacity = 'Непрозрачность';\r\n\t\t\t\tlang.opacityTitle = 'Число в диапазоне 0,0 - 1,0, указывающее, насколько прозрачен материал. Значение 0.0 означает полностью прозрачный, 1.0 - полностью непрозрачный.';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultScaleTitle = 'Восстановить масштаб 3D объекта по умолчанию.';\r\n\t\t\t\tlang.defaultPositionTitle = 'Восстановить позицию 3D объекта по умолчанию.';\r\n\t\t\t\tlang.default3DObjectTitle = 'Восстановить настройки всех 3D объектов по умолчанию.';\r\n\t\t\t\tlang.defaultRotationTitle = 'Восстановить поворот 3D объекта по умолчанию.';\r\n\t\t\t\tlang.defaultLocalPositionTitle = 'Восстановить локальную позицию точки по умолчанию.';\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\r\n\t\t}\r\n\r\n\t\tvar f3DObjects, fPoint, cRestoreDefaultLocalPosition, fPointWorld, fPoints, cMeshs, fMesh,// mesh,\r\n\t\t\tintersection,\r\n\t\t\tcScaleX, cScaleY, cScaleZ,\r\n\t\t\tcPoints, selectedPointIndex = -1,\r\n\t\t\tcX, cY, cZ, cW, cTrace, cTraceAll, cColor, cOpacity, cCameraTarget,\r\n\t\t\tfuncFolder,\r\n\t\t\tboSetMesh = false,//Для предотвращения лишних вызовов exposePosition если выбрать точку и передвинуть камеру с помошью OrbitControls,\r\n\t\t\tfRotation,\r\n\t\t\tcCustom;//Custom point controllers\r\n\t\tconst _this = this, cPosition = new THREE.Vector3(), cRotations = new THREE.Vector3(), cWorld = new THREE.Vector3();\r\n\t\tfunction displayPointControllers( display ) {\r\n\r\n\t\t\tfPointWorld.domElement.style.display = display;\r\n\t\t\tfPoint.domElement.style.display = display;\r\n\t\t\tif ( cCameraTarget ) {\r\n\r\n\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\tcCameraTarget.domElement.parentElement.parentElement.style.display = mesh && mesh.userData.boFrustumPoints ?\r\n\t\t\t\t\t'none' ://Камера не может следить за frustumPoints\r\n\t\t\t\t\tdisplay;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tif ( options.frustumPoints )\r\n\t\t\tcFrustumPoints = new options.frustumPoints.guiSelectPoint();\r\n\t\t//сейчас exposePosition вызывается только один раз из this.setMesh\r\n\t\tfunction getLiEl(controller) {\r\n\r\n\t\t\tvar el = controller.domElement;\r\n\t\t\twhile (el.tagName.toUpperCase() !== \"LI\") el = el.parentElement;\r\n\t\t\treturn el;\r\n\r\n\t\t}\r\n\r\n\t\t//dislay element\r\n\r\n\t\tfunction dislayEl( controller, displayController ) {\r\n\r\n\t\t\tif ( controller === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tif ( typeof displayController === \"boolean\" )\r\n\t\t\t\tdisplayController = displayController ? 'block' : 'none';\r\n\t\t\telse if ( displayController === undefined )\r\n\t\t\t\tdisplayController = 'none';\r\n\t\t\telse if ( typeof displayController !== \"string\" )\r\n\t\t\t\tdisplayController = 'block';\r\n\t\t\tgetLiEl(controller).style.display = displayController;\r\n\r\n\t\t}\r\n\t\tfunction isDislayEl( controller ) {\r\n\r\n\t\t\tif ( controller === undefined )\r\n\t\t\t\treturn;\r\n\t\t\treturn getLiEl(controller).style.display === none ? false : true;\r\n\r\n\t\t}\r\n\r\n\t\t//readOnly controller\r\n\r\n\t\tconst getInputEl =  ( controller ) => { return controller ? controller.domElement.querySelector( 'input' ) : undefined; }\r\n\t\tconst readOnlyEl = ( controller, boReadOnly ) => {\r\n\r\n\t\t\tconst element = getInputEl( controller );\r\n\t\t\tif ( element ) element.readOnly = boReadOnly;\r\n\t\t\r\n\t\t}\r\n\t\tconst isReadOnlyEl = ( controller ) => {\r\n\t\t\t\r\n\t\t\tconst element = getInputEl( controller );\r\n\t\t\tif ( element ) return element.readOnly;\r\n\t\t\r\n\t\t}\r\n\r\n\t\tfunction exposePosition( selectedPointIndex ) {\r\n\r\n\t\t\tif ( selectedPointIndex === undefined )\r\n\t\t\t\tselectedPointIndex = guiSelectPoint.getSelectedPointIndex();//Эта строка слишком медленно выполняется если число точек frustumPoints велико\r\n\t\t\t//Поэтому selectedPointIndex беру из intersection.index индекс точки, над которй щелнул мышью\r\n\t\t\tif ( selectedPointIndex === -1 )\r\n\t\t\t\treturn;\r\n\r\n\t\t\tconst mesh = cMeshs.__select.options[cMeshs.__select.options.selectedIndex].mesh,\r\n\t\t\t\tposition = getObjectPosition( mesh, selectedPointIndex );\r\n\r\n\t\t\tif ( ( options.axesHelper !== undefined ) )\r\n\r\n\t\t\t\t// && ( ( mesh.userData.isInfo === undefined ) || ( mesh.userData.isInfo() ) ) )\r\n\t\t\t\t//если делать эту проверку, то будут неправильно отображаться пунктирные линии для frustumPoints точки\r\n\t\t\t\t//когда в настройках frustumPoints не стоит галочка info\r\n\t\t\t\t//когда в gui пользователь выбрал точку frustumPoints из списка '3D objects'(этот пункт будет недоступен когда я уберу frustumPoints из списка '3D objects' когда в настройках frustumPoints не стоит галочка info)\r\n\t\t\t\t//и когда пользователь передвигает камеру с помощью orbitControls\r\n\r\n\t\t\t\tif ( ( options.axesHelper !== false ) && ( options.axesHelper !== undefined ) )\r\n\t\t\t\t\toptions.axesHelper.exposePosition( { object: mesh, index: selectedPointIndex } );\r\n\r\n\t\t\tif ( cWorld.x ) cWorld.x.setValue( position.x );\r\n\t\t\tif ( cWorld.y ) cWorld.y.setValue( position.y );\r\n\t\t\tif ( cWorld.z ) cWorld.z.setValue( position.z );\r\n\r\n\t\t\t//Возможно не надо делать такую глубокую проверку. Не тестировал\r\n\t\t\tif(\r\n\t\t\t\tmesh.userData.player &&\r\n\t\t\t\tmesh.userData.player.arrayFuncs\r\n\t\t\t) {\r\n\r\n\t\t\t\tconst selectedPoint = mesh.userData.player.arrayFuncs[selectedPointIndex]\r\n\t\t\t\tif(\r\n\t\t\t\t\tselectedPoint &&\r\n\t\t\t\t\tselectedPoint.controllers\r\n\t\t\t\t) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst controllers = mesh.userData.player.arrayFuncs[selectedPointIndex].controllers;\r\n\t\t\t\t\tif ( controllers.x && controllers.x.controller ) controllers.x.controller.value = position.x;\r\n\t\t\t\t\tif ( controllers.y && controllers.y.controller ) controllers.y.controller.value = position.y;\r\n\t\t\t\t\tif ( controllers.z && controllers.z.controller ) controllers.z.controller.value = position.z;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tthis.exposePosition = exposePosition;\r\n\t\tfunction setValue( controller, v ) {\r\n\r\n\t\t\tif ( !controller )\r\n\t\t\t\treturn;\r\n\t\t\tconst input = getInputEl( controller ),//controller.domElement.querySelector( 'input' ),\r\n\t\t\t\treadOnly = input.readOnly;\r\n\t\t\tinput.readOnly = false;\r\n\t\t\tcontroller.object[controller.property] = v;\r\n\t\t\tif ( controller.__onChange )\r\n\t\t\t\tcontroller.__onChange.call( controller, v );\r\n\t\t\tcontroller.initialValue = v;\r\n\t\t\tcontroller.updateDisplay();\r\n\t\t\tinput.readOnly = readOnly;\r\n\t\t\treturn controller;\r\n\r\n\t\t}\r\n\t\tvar wLimitsDefault;\r\n\t\t/**\r\n\t\t * Sets local position controllers to read-only\r\n\t\t * @param {boolean} boReadOnly true is read-only\r\n\t\t */\r\n\t\tthis.setReadOnlyPosition = function ( boReadOnly ) {\r\n\r\n\t\t\treadOnlyEl( cX, boReadOnly );\r\n\t\t\treadOnlyEl( cY, boReadOnly );\r\n\t\t\treadOnlyEl( cZ, boReadOnly );\r\n\t\t\treadOnlyEl( cW, boReadOnly );\r\n\r\n\t\t}\r\n\t\tfunction setPosition(intersectionSelected) {\r\n\r\n\t\t\tconst player = intersectionSelected.object.userData.player;\r\n\r\n\t\t\tvar boDisplayFuncFolder = 'none';\r\n\t\t\tif (player && player.arrayFuncs) {\r\n\r\n\t\t\t\tfuncFolder.setFunction(player.arrayFuncs[intersectionSelected.index]);\r\n\t\t\t\tboDisplayFuncFolder = 'block';\r\n\r\n\t\t\t}\r\n\t\t\tfuncFolder.displayFolder(boDisplayFuncFolder);\r\n\t\t\t/*Для установки cCameraTarget после выбора точки. Если это оставить то неправильно учтанавливается галочка cCameraTarget если:\r\n\t\t\t1 устанвить cCameraTarget для выбранной точки\r\n\t\t\t2 запустить плеер\r\n\t\t\t3 уброать cCameraTarget\r\n\t\t\t4 запустить плеер. Снова установиться cCameraTarget\r\n\t\t\t*/\r\n\t\t\tif (cCameraTarget) {\r\n\r\n\t\t\t\toptions.playerOptions.cameraTarget.changeTarget(intersectionSelected.object, intersectionSelected.index);\r\n\t\t\t\tcCameraTarget.updateDisplay();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst positionLocal = getObjectLocalPosition(intersectionSelected.object, intersectionSelected.index);\r\n\t\t\tsetValue(cX, positionLocal.x);\r\n\t\t\tsetValue(cY, positionLocal.y);\r\n\t\t\tsetValue(cZ, positionLocal.z);\r\n\r\n\t\t\tif (intersectionSelected.object.userData.gui) intersectionSelected.object.userData.gui.setValues(intersectionSelected.index);\r\n\r\n\t\t\tconst position = getObjectPosition(intersectionSelected.object, intersectionSelected.index);\r\n\t\t\tsetValue(cWorld.x, position.x);\r\n\t\t\tsetValue(cWorld.y, position.y);\r\n\t\t\tsetValue(cWorld.z, position.z);\r\n\r\n\t\t\tvar displayControllerW, displayControllerColor;//, displayControllerOpacity;\r\n\t\t\tif (intersection.object.userData.player && (typeof intersection.object.userData.player.arrayFuncs === \"function\")) {\r\n\r\n\t\t\t\t//Сюда попадает когда пользователь выбироает точку в frustumPoints\r\n\t\t\t\t//console.error( 'arrayFuncs === \"function\" under constraction' );\r\n\r\n\t\t\t}\r\n\t\t\tconst func = player && player.arrayFuncs ? player.arrayFuncs[intersectionSelected.index] : undefined,\r\n\t\t\t\tattributes = intersectionSelected.object.geometry.attributes;\r\n\t\t\tif (!attributes.color) {\r\n\r\n\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\tdisplayControllerColor = none;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst setColorControl = (color) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst strColor = '#' + color.getHexString();\r\n\t\t\t\t\t//Сначала надо установить initialValue потому что для FrustumPoints я устанвил readOnly для cColor.\r\n\t\t\t\t\t//В этом случае я не могу отобразить цвет следующей точки FrustumPoints потому что в режиме readOnly\r\n\t\t\t\t\t//при изменении цвета восстанвливается старый цвет из initialValue.\r\n\t\t\t\t\tcColor.initialValue = strColor;\r\n\t\t\t\t\tcColor.userData = { intersection: intersectionSelected, };\r\n\t\t\t\t\tcColor.setValue(strColor);\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif (attributes.position.itemSize < 4) {\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tintersectionSelected.object.material.vertexColors === true ||\r\n\t\t\t\t\t\t(intersectionSelected.object.material instanceof THREE.ShaderMaterial === true)\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\t\t\tdisplayControllerColor = block;\r\n\t\t\t\t\t\tsetColorControl( new THREE.Color().fromBufferAttribute(attributes.color, intersectionSelected.index) );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tfunction isWObject() { return (typeof func.w === 'object') && (func.w instanceof THREE.Color === false); }\r\n\t\t\t\t\tconst mesh = getMesh(), verticeColor = mesh.userData.myObject ? mesh.userData.myObject.verticeColor(intersectionSelected.index) : undefined;\r\n\t\t\t\t\tvar color = (func === undefined) || (!attributes.color && !attributes.ca) ?\r\n\t\t\t\t\t\tundefined :\r\n\t\t\t\t\t\tArray.isArray(func.w) || (typeof func.w === \"function\") ?\r\n\t\t\t\t\t\t\tPlayer.execFunc(func, 'w', options.time, options) :\r\n\t\t\t\t\t\t\tisWObject() ?\r\n\t\t\t\t\t\t\t\tPlayer.execFunc(func.w, 'func', options.time, options) :\r\n\t\t\t\t\t\t\t\ttypeof func.w === \"string\" ?\r\n\t\t\t\t\t\t\t\t\tPlayer.execFunc(func, 'w', options.time, options) :\r\n\t\t\t\t\t\t\t\t\tverticeColor != undefined ?\r\n\t\t\t\t\t\t\t\t\t\tverticeColor :\r\n\t\t\t\t\t\t\t\t\t\tfunc.w;\r\n\t\t\t\t\tif (Array.isArray(color)) color = new THREE.Color(color[0], color[1], color[2]);\r\n\t\t\t\t\tif (color instanceof THREE.Color) {\r\n\r\n\t\t\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\t\t\tdisplayControllerColor = block;\r\n\r\n\t\t\t\t\t\t//color\r\n\t\t\t\t\t\tif (intersectionSelected.object.userData.player.arrayFuncs === undefined) {\r\n\r\n\t\t\t\t\t\t\tdisplayControllerColor = none;\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tsetColorControl(color);\r\n\t\t\t\t\t\t\tcOpacity.userData = { intersection: intersectionSelected, };\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif (cW === undefined)\r\n\t\t\t\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\tif (color === undefined)\r\n\t\t\t\t\t\t\t\tdisplayControllerW = none;\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tif (!wLimitsDefault) {\r\n\r\n\t\t\t\t\t\t\t\t\twLimitsDefault = {\r\n\r\n\t\t\t\t\t\t\t\t\t\tmin: cW.__min,\r\n\t\t\t\t\t\t\t\t\t\tmax: cW.__max,\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (isWObject()) {\r\n\r\n\t\t\t\t\t\t\t\t\tcW.min(func.w.min !== 'undefined' ? func.w.min : wLimitsDefault.min);\r\n\t\t\t\t\t\t\t\t\tcW.max(func.w.max !== 'undefined' ? func.w.max : wLimitsDefault.max);\r\n\t\t\t\t\t\t\t\t\tif ((cW.__min !== 'undefined') && (cW.__max !== 'undefined'))\r\n\t\t\t\t\t\t\t\t\t\tcW.step((cW.__max - cW.__min) / 100)\r\n\r\n\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\tcW.min(wLimitsDefault.min);\r\n\t\t\t\t\t\t\t\t\tcW.max(wLimitsDefault.max);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tsetValue(cW, color);\r\n\t\t\t\t\t\t\t\tdisplayControllerW = block;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisplayControllerColor = none;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tdislayEl( cW, displayControllerW );\r\n\t\t\tdislayEl( cColor, displayControllerColor );\r\n\r\n\t\t\tconst mesh = getMesh(), boReadOnly = intersectionSelected.object.userData.boFrustumPoints === true ? true : mesh.userData.gui && mesh.userData.gui.isLocalPositionReadOnly ? true : false,\r\n\t\t\t\tboOpacity = ( mesh.userData.myObject && mesh.userData.myObject.isOpacity ) || ( mesh.material.transparent && mesh.material.vertexColors),\r\n\t\t\t\tattributeColor = mesh.geometry.attributes.color;\r\n\t\t\tdislayEl( cOpacity, boOpacity ? block : none );\r\n\t\t\tif ( boOpacity ) {\r\n\r\n\t\t\t\tif ( attributeColor.itemSize != 4 ) console.error( 'GuiSelectPoint.setPosition: Invalid mesh.geometry.attributes.color.itemSize = ' + attributeColor.itemSize);\r\n\t\t\t\tcOpacity.initialValue = attributeColor.array[intersectionSelected.index * attributeColor.itemSize + 3];\r\n\t\t\t\tcOpacity.setValue( cOpacity.initialValue );\r\n\r\n\t\t\t}\r\n\t\t\t_this.setReadOnlyPosition(boReadOnly);\r\n\t\t\treadOnlyEl( cColor, boReadOnly );\r\n\t\t\treadOnlyEl( cOpacity, boReadOnly );\r\n\t\t\tfuncFolder.displayFolder( !boReadOnly );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Specify a maximum, minimum and step value for [NumberController]{@link https://github.com/dataarts/dat.gui/blob/master/API.md#NumberController}.\r\n\t\t * \r\n\t\t * @param {String} axis axis. Currently 'w' axis is available only.\r\n\t\t * @param {object} scale The following <b>NumberController</b> properties are available:\r\n\t\t * @param {object} [scale.min] Minimum allowed value.\r\n\t\t * @param {object} [scale.max] Maximum allowed value.\r\n\t\t * @param {object} [scale.step] Increment by which to change value.\r\n\t\t */\r\n\t\tthis.setAxisControl = function ( axis, scale ) {\r\n\r\n\t\t\tswitch( axis ) {\r\n\r\n\t\t\t\tcase 'w': \r\n\t\t\t\t\tif ( scale.min != undefined ) cW.min(scale.min);\r\n\t\t\t\t\tif ( scale.max != undefined ) cW.max(scale.max);\r\n\t\t\t\t\tif ( scale.step != undefined ) cW.step(scale.step);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'GuiSelectPoint.setAxisControl. Invalid axis: '  + axis);\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t\t/**\r\n\t\t * sets axis name of the controllers\r\n\t\t * @param {String} axis axis. 'x' or 'y' or 'z'.\r\n\t\t * @param {String} name new axis name\r\n\t\t */\r\n\t\tthis.setAxisName = function ( axis, name ) {\r\n\r\n\t\t\t//position\r\n\t\t\tcPosition[axis].name( name );\r\n\t\t\tfolders.position[axis].name = name;\r\n\r\n\t\t\t//scale\r\n\t\t\tconst cScale = axis === 'x' ? cScaleX : axis === 'y' ? cScaleY : axis === 'z' ? cScaleZ : undefined;\r\n\t\t\tcScale.name( name );\r\n\r\n\t\t\t//rotation\r\n\t\t\tconst cRotation = cRotations[axis];\r\n\t\t\tif ( cRotation.name ) cRotation.name( name );\r\n\r\n\t\t}\r\n\t\t/**Sets controllers to position, scale and rotation of the mesh.  If AxesHelper is exist, expose the mesh to the axes. */\r\n\t\tthis.setMesh = function () {\r\n\r\n\t\t\tboSetMesh = true;\r\n\t\t\tsetScaleControllers();\r\n\t\t\tsetPositionControllers();\r\n\t\t\tsetRotationControllers();\r\n\t\t\texposePosition();\r\n\t\t\tboSetMesh = false;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Sets controllers to position, scale and rotation of the mesh.  If AxesHelper is exist, expose the mesh to the axes.\r\n\t\t * @param intersectionSelected [THREE.Raycaster.intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject}\r\n\t\t */\r\n\t\tthis.setPosition = function ( intersectionSelected ) {\r\n\r\n\t\t\tfor ( var i = 0; i < cMeshs.__select.length; i++ ) {\r\n\r\n\t\t\t\tvar option = cMeshs.__select[i];\r\n\t\t\t\tif ( option.selected && Object.is( option.mesh, intersectionSelected.object ) ) {\r\n\r\n\t\t\t\t\tsetPosition( intersectionSelected );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * update the values of the controllers of the world position\r\n\t\t */\r\n\t\tthis.update = function ( boSetInitialValue = false ) {\r\n\r\n\t\t\tconst selectedItem = cMeshs.__select.options[cMeshs.__select.options.selectedIndex];\r\n\t\t\tif ( !selectedItem ) return;\r\n\t\t\tconst mesh = selectedItem.mesh;\r\n\t\t\tif ( !mesh )\r\n\t\t\t\treturn;\r\n\t\t\tconst index = this.getSelectedPointIndex();\r\n\t\t\tif ( index === -1 )\r\n\t\t\t\treturn;\r\n\t\t\tconst position = getObjectPosition( mesh, index );\r\n\t\t\tif( cWorld.x ) cWorld.x.setValue( position.x );\r\n\t\t\tif( cWorld.y ) cWorld.y.setValue( position.y );\r\n\t\t\tif( cWorld.z ) cWorld.z.setValue( position.z );\r\n\t\t\tif( cW && ( position instanceof THREE.Vector4 )) cW.setValue( position.w );\r\n\r\n\t\t\tconst positionLocal = getObjectLocalPosition( mesh, index );\r\n\t\t\tif ( boSetInitialValue ) {\r\n\t\t\t\t\r\n\t\t\t\tif( cX ) cX.initialValue = positionLocal.x;\r\n\t\t\t\tif( cY ) cY.initialValue = positionLocal.y;\r\n\t\t\t\tif( cZ ) cZ.initialValue = positionLocal.z;\r\n\t\t\t\tif( cW ) cW.initialValue = positionLocal.w;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif( cX ) cX.setValue( positionLocal.x );\r\n\t\t\tif( cY ) cY.setValue( positionLocal.y );\r\n\t\t\tif( cZ ) cZ.setValue( positionLocal.z );\r\n\r\n\t\t\tfuncFolder.update( mesh.userData.player.arrayFuncs[index] );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * get index of the mesh in the cMeshs controller\r\n\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}\r\n\t\t * @returns index of selectred mesh.\r\n\t\t */\r\n\t\tthis.getMeshIndex = function ( mesh ) {\r\n\r\n\t\t\tif ( mesh === undefined )\r\n\t\t\t\treturn mesh;\r\n\t\t\tvar index;// = intersectionSelected.object.userData.index;\r\n\t\t\tfor ( index = 0; index < cMeshs.__select.options.length; index++ ) {\r\n\r\n\t\t\t\tvar option = cMeshs.__select.options[index];\r\n\t\t\t\tif ( Object.is( option.mesh, mesh ) )\r\n\t\t\t\t\treturn index;\r\n\r\n\t\t\t}\r\n\t\t\t//Сюда попадает когда Mesh проверяется с помощью THREE.Raycaster находится ли он под мышью, но этот Mesh не внесен в список GuiSelectPoint\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Set a mesh in the mesh's list control\r\n\t\t * @param {number} index index of the mesh in the mesh's list control\r\n\t\t * @param {THREE.Mesh} mesh new [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}\r\n\t\t */\r\n\t\tthis.setIndexMesh = function ( index, mesh ) {\r\n\r\n\t\t\tif ( index === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tcMeshs.__select.options[index].mesh = mesh;\r\n\t\t\tthis.selectPoint( -1 );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Selects a point in the points list control\r\n\t\t * @param {number} index index of the point in the points list control\r\n\t\t */\r\n\t\tthis.selectPoint = function ( index ) {\r\n\r\n\t\t\tcPoints.__onChange( index );\r\n\t\t\tcPoints.__select[index + 1].selected = true;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Removes a mesh from the select point GUI\r\n\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for removing.\r\n\t\t * @param {boolean} [boHideF3DObjects=true] true - hide the 'Meshes' folder if no any mesh exists in the meshs dropdown menu.\r\n\t\t */\r\n\t\tthis.removeMesh = function ( mesh, boHideF3DObjects = true ) {\r\n\r\n\t\t\tconst index = this.getMeshIndex( mesh ),\r\n\t\t\t\tselectedIndex = cMeshs.__select.selectedIndex;\r\n\t\t\tif ( index === undefined ) return;\r\n\t\t\tcMeshs.__select.remove( index );\r\n\t\t\tif ( selectedIndex === index ) {\r\n\r\n\t\t\t\tcPoints.__onChange( -1 );\r\n\t\t\t\t_this.removePoints();\r\n\t\t\t\tcMeshs.__onChange( -1 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( ( cMeshs.__select.options.length < 2 ) && boHideF3DObjects ) f3DObjects.domElement.style.display = 'none';\r\n\r\n\t\t}\r\n\r\n\t\tconst arrayMeshs = [];//сюда попадают все mesh в случае, когда this.addMesh вызывается до вызова this.add\r\n\t\t//тоесть когда GuiSelectPoint еще не добавлен в dat.gui\r\n\r\n\t\t/**\r\n\t\t * Adds new mesh into select point GUI\r\n\t\t * @param {THREE.Mesh} mesh new [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}.\r\n\t\t */\r\n\t\tthis.addMesh = function ( mesh ) {\r\n\r\n\t\t\tif ( !mesh.parent ) {\r\n\r\n\t\t\t\tconsole.error( 'GuiSelectPoint.addMesh: Add mesh into scene first.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( !f3DObjects ) this.add();\r\n\t\t\tf3DObjects.domElement.style.display = 'block';\r\n\t\t\t\r\n\t\t\tif ( !cMeshs ) {\r\n\r\n\t\t\t\t//Test for duplicate item\r\n\t\t\t\tfor ( var i = 0; i < arrayMeshs.length; i++ ) {\r\n\r\n\t\t\t\t\tif ( arrayMeshs[i].uuid === mesh.uuid ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'guiSelectPoint.addMesh: Duplicate mesh: ' + mesh.name );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tarrayMeshs.push( mesh );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Test for duplicate item\r\n\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\tvar option = cMeshs.__select.options[i];\r\n\t\t\t\tif ( mesh.userData.boFrustumPoints && ( option.mesh !== undefined ) && option.mesh.userData.boFrustumPoints )\r\n\t\t\t\t\treturn;//duplicate FrustumPoints. Сюда попадает когда пользователь меняет количество слоев или Y точек в FrustumPoints.\r\n\t\t\t\tif (\r\n\t\t\t\t\t( option.mesh !== undefined ) &&\r\n\t\t\t\t\t( option.mesh.uuid === mesh.uuid )\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tconsole.error( 'guiSelectPoint.addMesh(...): Duplicate mesh.' );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tconst opt = document.createElement( 'option' );\r\n\t\t\topt.innerHTML = cMeshs.__select.length + ' ' + ( mesh.name === '' ? mesh.constructor.name : mesh.name );\r\n\t\t\topt.mesh = mesh;\r\n\t\t\tmesh.userData.default = mesh.userData.default || {\r\n\r\n\t\t\t\tscale: new THREE.Vector3().copy( mesh.scale ),\r\n\t\t\t\tposition: mesh.position instanceof THREE.Vector3 ?\r\n\t\t\t\t\tnew THREE.Vector3().copy( mesh.position ) :\r\n\t\t\t\t\tmesh.position instanceof THREE.Vector4 ? new THREE.Vector4().copy( mesh.position ) : undefined,\r\n\t\t\t\trotation: new THREE.Euler().copy( mesh.rotation ),\r\n\r\n\t\t\t}\r\n\t\t\tcMeshs.__select.appendChild( opt );\r\n\t\t\tdisplayVerticeID( mesh );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * User has selected a point\r\n\t\t * @param {Object} intersectionSelected See [intersectObject]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster.intersectObject}\r\n\t\t */\r\n\t\tthis.select = function ( intersectionSelected ) {\r\n\r\n\t\t\tconst position = getObjectLocalPosition( intersectionSelected.object, intersectionSelected.index );\r\n\t\t\tif ( f3DObjects === undefined ) {\r\n\r\n\t\t\t\tconsole.error( 'Не знаю как сюда попасть' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//f3DObjects.close();//если тут не закрывать папку, то ингода прорпадает скроллинг окна dat.GUI\r\n\t\t\t//for testing:\r\n\t\t\t//Open https://raw.githack.com/anhr/myThreejs/master/Examples/html/\r\n\t\t\t//Set browser window height about 500 pixels.\r\n\t\t\t//Click Full Screen button.\r\n\t\t\t//Open Controls\r\n\t\t\t//Click a point.The \"Meshes\" folder opens and you can see the scrolling of the dat.gui window.\r\n\r\n\t\t\t//select mesh\r\n\t\t\tconst index = this.getMeshIndex( intersectionSelected.object );\r\n\t\t\tif ( !index )\r\n\t\t\t\treturn;//Сюда попадает когда Mesh проверяется с помощью THREE.Raycaster находится ли он под мышью, но этот Mesh не внесен в список GuiSelectPoint\r\n\t\t\tif ( cMeshs.__select[index].selected === false ) {\r\n\r\n\t\t\t\tcMeshs.__select[index].selected = true;\r\n\t\t\t\tcMeshs.__onChange( index - 1 );\r\n\r\n\t\t\t} else if ( cCustom ) {\r\n\r\n\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\tcCustom.object(intersectionSelected.event && intersectionSelected.event.button === 0 ?\r\n\t\t\t\t\t\tmesh :\r\n\t\t\t\t\t\tundefined,//Пользователь нажал не левую кнопку мыши. Надо восстановить выбранный nD объект\r\n\t\t\t\t\tdat, options);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.selectPoint2 = function ( selectedMesh ) {\r\n\r\n\t\t\t\tif ( ( intersectionSelected.index === undefined ) || isNaN( intersectionSelected.index ) )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t//сделал эту проверку потому что не могу придумать как удалить intersectionSelected.index когда пользователь врусную сменил mesh\r\n\t\t\t\tif ( ( selectedMesh !== undefined ) && !Object.is( intersectionSelected.object, selectedMesh ) )\r\n\t\t\t\t\treturn;//Сначала пользователь выбрал точку с помошщью мыши\r\n\t\t\t\t//Потом сменил Meshes/Select\r\n\r\n\t\t\t\tif ( !intersectionSelected.object.userData.boFrustumPoints ) {\r\n\r\n\t\t\t\t\t//fPoints.open();много времени на открытие когда много точек\r\n\t\t\t\t\tconst point = cPoints.__select[intersectionSelected.index + 1];\r\n\t\t\t\t\tif ( point ) point.selected = true;\r\n\r\n\t\t\t\t} else {//FrustumPoints\r\n\r\n\t\t\t\t\tcFrustumPoints.pointIndexes( intersectionSelected.object.userData.pointIndexes( intersectionSelected.index ) );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst block = 'block';\r\n\t\t\t\tdisplayPointControllers( block );\r\n\t\t\t\tintersection = intersectionSelected;\r\n\t\t\t\tif ( guiParams.setIntersection )\r\n\t\t\t\t\tguiParams.setIntersection( intersectionSelected );\r\n\t\t\t\tsetPosition( intersectionSelected );\r\n\r\n\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\tconst line =\r\n\t\t\t\t\t!mesh.userData.player ||\r\n\t\t\t\t\t\t( mesh.userData.player.arrayFuncs === undefined ) ||\r\n\t\t\t\t\t\t( typeof intersection.object.userData.player.arrayFuncs === \"function\" ) ?\r\n\t\t\t\t\t\tundefined :\r\n\t\t\t\t\t\tmesh.userData.player.arrayFuncs[intersectionSelected.index].line;//You can not trace points if you do not defined the mesh.userData.player.arrayFuncs\r\n\t\t\t\tif ( cTrace )\r\n\t\t\t\t\tcTrace.setValue( ( line === undefined ) ?\r\n\t\t\t\t\t\tfalse : line.isVisible() )\r\n\r\n\t\t\t\tcRestoreDefaultLocalPosition.domElement.parentElement.parentElement.style.display =\r\n\t\t\t\t\t!intersection.object.userData.player || ( intersection.object.userData.player.arrayFuncs === undefined ) ?\r\n\t\t\t\t\t\t'none' : block;\r\n\r\n\t\t\t}\r\n\t\t\tthis.selectPoint2( undefined );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Is mesh selected in the GuiSelectPoint?\r\n\t\t * @param {THREE.Mesh} meshCur [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} to be tested\r\n\t\t * @returns true if <b>meshCur</b> is selected.\r\n\t\t */\r\n\t\tthis.isSelectedMesh = function ( meshCur ) { return getMesh() === meshCur }\r\n\t\t/**\r\n\t\t * @returns index of the selected point.\r\n\t\t */\r\n\t\tthis.getSelectedPointIndex = function () {\r\n\r\n\t\t\tif ( ( cFrustumPoints !== undefined ) &&\r\n\t\t\t\tcFrustumPoints.isDisplay() &&//FrustumPoints folder is visible\r\n\t\t\t\toptions.frustumPoints &&\r\n\t\t\t\toptions.frustumPoints.isDisplay()//The cDisplay checkbox of the frustumPoints' is checked\r\n\t\t\t) {\r\n\r\n\t\t\t\tvar selectedIndex = cFrustumPoints.getSelectedIndex();\r\n\t\t\t\treturn selectedIndex === null ? - 1 : selectedIndex;\r\n\r\n\t\t\t}\r\n\t\t\tif ( cPoints === undefined ) {\r\n\r\n\t\t\t\tif ( selectedPointIndex === undefined )\r\n\t\t\t\t\tconsole.error( 'myThreejs.create.onloadScripts.init.guiSelectPoint.getSelectedPointIndex:  selectedPointIndex = ' + selectedPointIndex );\r\n\t\t\t\treturn selectedPointIndex;//options.dat !== true and gui === undefined. Do not use dat.gui\r\n\r\n\t\t\t}\r\n\t\t\tif ( !getMesh() ) return -1; //не выбран 3d объект.\r\n\t\t\tconst index = cPoints.__select.selectedOptions[0].index;\r\n\t\t\treturn index - 1;\r\n\r\n\t\t}\r\n\t\tfunction getMesh() {\r\n\r\n\t\t\tif ( !cMeshs ) {\r\n\r\n\t\t\t\tconsole.error( 'GuiSelectPoint().getSelectedPointIndex().getMesh(): call GuiSelectPoint.add(); first.' );\r\n\t\t\t\treturn undefined;\r\n\r\n\t\t\t}\r\n\t\t\tconst selectedIndex = cMeshs.__select.options.selectedIndex;\r\n\t\t\tif ( selectedIndex !== -1 )\r\n\t\t\t\treturn cMeshs.__select.options[cMeshs.__select.options.selectedIndex].mesh;\r\n\t\t\treturn undefined;\r\n\r\n\t\t}\r\n\t\tfunction isNotSetControllers() {\r\n\r\n\t\t\treturn ( getMesh() === undefined );\r\n\r\n\t\t}\r\n\t\tfunction setScaleControllers() {\r\n\r\n\t\t\tif ( isNotSetControllers() )\r\n\t\t\t\treturn;\r\n\t\t\tconst mesh = getMesh();\r\n\t\t\tif ( cScaleX ) cScaleX.setValue( mesh.scale.x );\r\n\t\t\tif ( cScaleY ) cScaleY.setValue( mesh.scale.y );\r\n\t\t\tif ( cScaleZ ) cScaleZ.setValue( mesh.scale.z );\r\n\r\n\t\t}\r\n\t\tfunction setPositionControllers() {\r\n\r\n\t\t\tif ( isNotSetControllers() )\r\n\t\t\t\treturn;\r\n\t\t\tconst mesh = getMesh();\r\n\t\t\tif ( cPosition.x ) cPosition.x.setValue( mesh.position.x );\r\n\t\t\tif ( cPosition.y ) cPosition.y.setValue( mesh.position.y );\r\n\t\t\tif ( cPosition.z ) cPosition.z.setValue( mesh.position.z );\r\n\r\n\t\t}\r\n\t\tfunction setRotationControllers() {\r\n\r\n\t\t\tif ( isNotSetControllers() )\r\n\t\t\t\treturn;\r\n\t\t\tconst mesh = getMesh();\r\n\t\t\tconst setValue = ( controller, angle ) => {\r\n\r\n\t\t\t\tif ( ( angle < controller.__min ) || ( angle > controller.__max ) ) console.error( 'GuiSelectPoint.setRotationControllers(): Invalid angle = ' + angle + ' range. Available range from ' + controller.__min + ' to ' + controller.__max )\r\n\t\t\t\tcontroller.setValue( angle );\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( cRotations.x ) setValue( cRotations.x, mesh.rotation.x );\r\n\t\t\tif ( cRotations.y ) setValue( cRotations.y, mesh.rotation.y );\r\n\t\t\tif ( cRotations.z ) setValue( cRotations.z, mesh.rotation.z );\r\n\r\n\t\t}\r\n\t\tfunction visibleTraceLine( intersection, value, getMesh ) {\r\n\r\n\t\t\tif ( !intersection || !intersection.object.userData.player || intersection.object.userData.player.arrayFuncs === undefined )\r\n\t\t\t\treturn;\r\n\t\t\tvar index = intersection.index || 0,\r\n\t\t\t\tpoint = intersection.object.userData.player.arrayFuncs[index],\r\n\t\t\t\tline = point === undefined ? undefined : point.line;\r\n\t\t\tif ( ( line !== undefined ) )\r\n\t\t\t\tline.visible( value );\r\n\t\t\tif ( !value )\r\n\t\t\t\treturn;\r\n\t\t\tif ( point.line !== undefined )\r\n\t\t\t\treturn;\r\n\t\t\tpoint.line = new Player.traceLine( options );\r\n\r\n\t\t\t//color\r\n\t\t\tvar color = intersection.object.geometry.attributes.color;\r\n\t\t\tif ( color === undefined )\r\n\t\t\t\tcolor = new THREE.Color( 0xffffff );//white\r\n\t\t\telse {\r\n\r\n\t\t\t\tvar vector = new THREE.Vector3().fromArray( color.array, index * color.itemSize )\r\n\t\t\t\tcolor = new THREE.Color( vector.x, vector.y, vector.z );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpoint.line.addPoint(\r\n\r\n\t\t\t\tgetMesh(), index,\r\n\t\t\t\tcolor\r\n\r\n\t\t\t);\r\n\r\n\t\t}\r\n\r\n\t\tthis.updateScale = function ( axisName ) {\r\n\r\n\t\t\tconst none = 'none', block = 'block', display = options.scales[axisName].isAxis() ? block : none;\r\n\t\t\t\r\n\t\t\t//Rotation\r\n\r\n\t\t\tconst boX = options.scales['x'].isAxis(),\r\n\t\t\t\t boY = options.scales['y'].isAxis(),\r\n\t\t\t\t boZ = options.scales['z'].isAxis();\r\n\t\t\tvar n = 0;//space dimension\r\n\t\t\tif ( boX ) n++;\r\n\t\t\tif ( boY ) n++;\r\n\t\t\tif ( boZ ) n++;\r\n\t\t\tswitch ( n ) {\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif ( fRotation ) fRotation.domElement.style.display = none;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tfRotation.domElement.style.display = block;\r\n\t\t\t\t\tif ( boX && cRotations.x.domElement ) cRotations.x.domElement.parentElement.parentElement.style.display = none;\r\n\t\t\t\t\tif ( boY && cRotations.y.domElement ) cRotations.y.domElement.parentElement.parentElement.style.display = none;\r\n\t\t\t\t\tif ( boZ && cRotations.z.domElement ) cRotations.z.domElement.parentElement.parentElement.style.display = none;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'GuiSelectPoint.updateScale: Invalid space dimension = ' + n );\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif ( !folders.position[axisName] ) {\r\n\r\n\t\t\t\tif ( options.scales[axisName].isAxis() ) console.error( 'GuiSelectPoint.updateScale: Under constraction.' );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t//position\r\n\r\n\t\t\tfolders.position[axisName].domElement.style.display = display;\r\n\t\t\tcWorld[axisName].domElement.parentElement.parentElement.style.display = display;\r\n\r\n\t\t\t//Scale, point local position\r\n\r\n\t\t\tvar c, cScale;\r\n\t\t\tswitch(axisName) {\r\n\r\n\t\t\t\tcase 'x':\r\n\t\t\t\t\tc = cX;\r\n\t\t\t\t\tcScale = cScaleX;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'y':\r\n\t\t\t\t\tc = cY;\r\n\t\t\t\t\tcScale = cScaleY;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'z':\r\n\t\t\t\t\tc = cZ;\r\n\t\t\t\t\tcScale = cScaleZ;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error('GuiSelectPoint.updateScale: Invalid axis name: ' + axisName);\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tc.domElement.parentElement.parentElement.style.display = display;\r\n\t\t\tcScale.domElement.parentElement.parentElement.style.display = display;\r\n\r\n\t\t}\r\n\t\tfunction displayVerticeID( object ) {\r\n\r\n\t\t\tif ( object.userData.boFrustumPoints ) return;\r\n\t\t\tif ( !options.dat.guiSelectPoint.boDisplayVerticeID ) {\r\n\r\n\t\t\t\tfor ( var i = object.children.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\tconst child = object.children[i];\r\n\t\t\t\t\tif ( child.type === 'Sprite' ) object.remove( child );\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif (!object.geometry) return;//Probably this is Group\r\n\t\t\tlet gp = object.geometry.attributes.position;\r\n\t\t\tobject.updateMatrixWorld();\r\n\t\t\tfor ( let i = 0; i < gp.count; i++ ) {\r\n\r\n\t\t\t\tlet p = new THREE.Vector3().fromBufferAttribute( gp, i ); // set p from `position`\r\n\t\t\t\t//\t\t\t\t\t\tobject.localToWorld(p); // p has wordl coords\r\n\t\t\t\tconst spriteText = new SpriteText( i, p, { group: object } );\r\n\t\t\t\tspriteText.userData.pointID = i;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction addPoints( mesh ) {\r\n\r\n\t\t\tfor ( var iPosition = 0; iPosition < mesh.geometry.attributes.position.count; iPosition++ ) {\r\n\r\n\t\t\t\tconst opt = document.createElement( 'option' ),\r\n\t\t\t\t\tname = mesh.userData.player && mesh.userData.player.arrayFuncs ? mesh.userData.player.arrayFuncs[iPosition].name : '';\r\n\t\t\t\topt.innerHTML = iPosition + ( name === undefined ? '' : ' ' + name );\r\n\t\t\t\topt.setAttribute( 'value', iPosition );//Эта строка нужна в случае когда пользователь отменил выбор точки. Иначе при движении камеры будут появляться пунктирные линии, указвающие на несуществующую точку\r\n\t\t\t\tcPoints.__select.appendChild( opt );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction createPlayerArrayFuncs( mesh ) {\r\n\r\n\t\t\tif ( !mesh || mesh.userData.boFrustumPoints ) return;\r\n\t\t\tif ( !mesh.userData.player ) mesh.userData.player = {};\r\n\t\t\tif ( !mesh.userData.player.arrayFuncs && mesh.geometry ) {\r\n\r\n\t\t\t\tconst position = mesh.geometry.attributes.position;\r\n\t\t\t\tmesh.userData.player.arrayFuncs = [];\r\n\t\t\t\tfor ( var i = 0; i < position.count; i++ ) {\r\n\r\n\t\t\t\t\tconst vector = new THREE.Vector4().fromArray( mesh.geometry.attributes.position.array, i * position.itemSize );\r\n\r\n\t\t\t\t\tmesh.userData.player.arrayFuncs.push( vector );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Adds select point GUI into dat.gui folder\r\n\t\t * @param {GUI} [folder] [dat.gui]{@link https://github.com/anhr/dat.gui} folder.\r\n\t\t */\r\n\t\tthis.add = function ( folder ) {\r\n\r\n\t\t\tfolder = folder || options.dat.gui;\r\n\t\t\tif ( !folder )\r\n\t\t\t\treturn;//gui не создан\r\n\t\t\tf3DObjects = folder.addFolder( lang.meshs );\r\n\t\t\tf3DObjects.domElement.style.display = 'none';\r\n\t\t\tvar mesh, buttonScaleDefault, buttonPositionDefault, buttonRotationDefault;\r\n\r\n\t\t\tcMeshs = f3DObjects.add( { Meshs: lang.notSelected }, 'Meshs', { [lang.notSelected]: -1 } ).onChange( function ( value ) {\r\n\r\n\t\t\t\tvalue = parseInt( value );\r\n\r\n\t\t\t\tcPoints.__onChange( -1 );//сбросить настройки точки\r\n\t\t\t\t\r\n\t\t\t\tmesh = getMesh();\r\n\r\n\t\t\t\tconst none = 'none', block = 'block';\r\n\t\t\t\tif (fPoint.fCustomPoint) {\r\n\r\n\t\t\t\t\tfPoint.removeFolder(fPoint.fCustomPoint);\r\n\t\t\t\t\tdelete fPoint.fCustomPoint;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif (mesh && mesh.userData.gui) { fPoint.fCustomPoint = mesh.userData.gui.addControllers(fPoint); }\r\n\t\t\t\t\r\n\t\t\t\tif ( cCustom ) cCustom.object( mesh, dat, value === -1 );//options );\r\n\r\n\t\t\t\tcreatePlayerArrayFuncs( mesh );\r\n\r\n\t\t\t\tvar display;\r\n\t\t\t\tif ( mesh === undefined ) {\r\n\r\n\t\t\t\t\tdisplay = none;\r\n\t\t\t\t\tmesh = undefined;\r\n\t\t\t\t\tif ( options.axesHelper !== undefined )\r\n\t\t\t\t\t\toptions.axesHelper.exposePosition( getObjectPosition( getMesh(), value ) );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconst displayDefaultButtons = mesh.userData.default === undefined ? none : block;\r\n\t\t\t\t\tbuttonScaleDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\t\t\t\t\tbuttonPositionDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\t\t\t\t\tif ( buttonRotationDefault ) buttonRotationDefault.domElement.parentElement.parentElement.style.display = displayDefaultButtons;\r\n\r\n\t\t\t\t\tdisplay = block;\r\n\t\t\t\t\tvar displayPoints = none, displayfPoints = none, displayFrustumPoints = block;\r\n\r\n\t\t\t\t\tcPoints.__onChange( -1 );\r\n\t\t\t\t\t_this.removePoints();\r\n\r\n\t\t\t\t\tif ( mesh.userData.controllers !== undefined ) {\r\n\r\n\t\t\t\t\t\t//FrustumPoints\r\n\t\t\t\t\t\tmesh.userData.controllers();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tdisplayPoints = block;\r\n\t\t\t\t\t\tdisplayFrustumPoints = none;\r\n\r\n\t\t\t\t\t\tif ( mesh.geometry && mesh.geometry.attributes ) {\r\n\r\n\t\t\t\t\t\t\tdisplayfPoints = block;\r\n\t\t\t\t\t\t\taddPoints( mesh );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdislayEl( cPoints, displayPoints );\r\n\t\t\t\t\tif ( cTraceAll ) {\r\n\r\n\t\t\t\t\t\tdislayEl( cTraceAll, options.player ? displayPoints : false );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( cFrustumPoints !== undefined )\r\n\t\t\t\t\t\tcFrustumPoints.display( displayFrustumPoints );\r\n\t\t\t\t\tsetScaleControllers();\r\n\t\t\t\t\tsetPositionControllers();\r\n\t\t\t\t\tsetRotationControllers();\r\n\t\t\t\t\torbitControlsOptions = undefined;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfMesh.domElement.style.display = display;\r\n\r\n\t\t\t\tif ( ( mesh !== undefined ) && ( mesh.userData.traceAll !== undefined ) )\r\n\t\t\t\t\tcTraceAll.setValue( mesh.userData.traceAll );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cMeshs, lang.select );\r\n\r\n\t\t\tfMesh = f3DObjects.addFolder( lang.mesh );\r\n\t\t\tfMesh.domElement.style.display = 'none';\r\n\t\t\tfMesh.open();\r\n\r\n\t\t\t//Scale\r\n\r\n\t\t\tconst fScale = fMesh.addFolder( lang.scale );\r\n\t\t\tfScale.add( new ScaleController( function ( customController, action ) {\r\n\r\n\t\t\t\tconst zoom = customController.controller.getValue();\r\n\t\t\t\tmesh.scale.x = action( mesh.scale.x, zoom );\r\n\t\t\t\tmesh.scale.y = action( mesh.scale.y, zoom );\r\n\t\t\t\tmesh.scale.z = action( mesh.scale.z, zoom );\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\tsetScaleControllers();\r\n\t\t\t\texposePosition();\r\n\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\toptions.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t},\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\t\t\t\tgetLanguageCode: getLanguageCode,\r\n\t\t\t\t\tnewBool: true,\r\n\r\n\t\t\t\t} ) );\r\n\t\t\tconst scale = new THREE.Vector3();\r\n\t\t\tfunction setScale( axisName, value ) {\r\n\r\n\t\t\t\tmesh.scale[axisName] = value;\r\n\t\t\t\tmesh.needsUpdate = true;\r\n\t\t\t\texposePosition();\r\n\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\toptions.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t}\r\n\t\t\tif ( options.scales.x.isAxis() ) {\r\n\r\n\t\t\t\tcScaleX = dat.controllerZeroStep( fScale, scale, 'x', function ( value ) { setScale( 'x', value ); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cScaleX, options.scales.x.name );\r\n\r\n\t\t\t}\r\n\t\t\tif ( options.scales.y.isAxis() ) {\r\n\r\n\t\t\t\tcScaleY = dat.controllerZeroStep( fScale, scale, 'y', function ( value ) { setScale( 'y', value ); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cScaleY, options.scales.y.name );\r\n\r\n\t\t\t}\r\n\t\t\tif ( options.scales.z.isAxis() ) {\r\n\r\n\t\t\t\tcScaleZ = dat.controllerZeroStep( fScale, scale, 'z', function ( value ) { setScale( 'z', value ); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cScaleZ, options.scales.z.name );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Default scale button\r\n\t\t\tbuttonScaleDefault = fScale.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tmesh.scale.copy( mesh.userData.default.scale );\r\n\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\tsetScaleControllers();\r\n\t\t\t\t\texposePosition();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' );\r\n\t\t\tdat.controllerNameAndTitle( buttonScaleDefault, lang.defaultButton, lang.defaultScaleTitle );\r\n\r\n\t\t\t//Position\r\n\r\n\t\t\tconst fPosition = fMesh.addFolder( lang.position );\r\n\r\n\t\t\tfunction addAxisControllers( name ) {\r\n\r\n\t\t\t\tconst scale = options.scales[name];\r\n\t\t\t\tif ( !scale.isAxis() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst axisName = scale.name,\r\n\t\t\t\t\tf = fPosition.addFolder( axisName );\r\n\t\t\t\tfolders.position = folders.position || {};\r\n\t\t\t\tfolders.position[axisName] = f;\r\n\t\t\t\tf.add( new PositionController( function ( shift ) {\r\n\r\n\t\t\t\t\tmesh.position[name] += shift;\r\n\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\tsetPositionControllers();\r\n\t\t\t\t\texposePosition();\r\n\t\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\t\toptions.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t\t}, { getLanguageCode: getLanguageCode, } ) );\r\n\r\n\t\t\t\tfunction setPosition( value ) {\r\n\r\n\t\t\t\t\tmesh.position[name] = value;\r\n\t\t\t\t\tmesh.needsUpdate = true;\r\n\t\t\t\t\texposePosition();\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst position = new THREE.Vector3();\r\n\r\n\t\t\t\tcPosition[name] = dat.controllerZeroStep( f, position, name, function ( value ) { setPosition( value ); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cPosition[name], axisName );\r\n\r\n\t\t\t}\r\n\t\t\taddAxisControllers( 'x' );\r\n\t\t\taddAxisControllers( 'y' );\r\n\t\t\taddAxisControllers( 'z' );\r\n\r\n\t\t\t//Restore default position.\r\n\t\t\tbuttonPositionDefault = fPosition.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tmesh.position.copy( mesh.userData.default.position );\r\n\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\tsetPositionControllers();\r\n\t\t\t\t\texposePosition();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' );\r\n\t\t\tdat.controllerNameAndTitle( buttonPositionDefault, lang.defaultButton, lang.defaultPositionTitle );\r\n\r\n\t\t\t//rotation\r\n\r\n\t\t\tfunction addRotationFolder() {\r\n\r\n\t\t\t\tconst boX = options.scales.x.isAxis(),\r\n\t\t\t\t\tboY = options.scales.y.isAxis(),\r\n\t\t\t\t\tboZ = options.scales.z.isAxis();\r\n\t\t\t\tvar n = 0;//space dimension\r\n\t\t\t\tif ( boX ) n++;\r\n\t\t\t\tif ( boY ) n++;\r\n\t\t\t\tif ( boZ ) n++;\r\n\t\t\t\tif ( n === 1 ) return;\r\n\t\t\t\tfRotation = fMesh.addFolder( lang.rotation );\r\n\t\t\t\tfunction addRotationControllers( name ) {\r\n\r\n\t\t\t\t\tconst scale = options.scales[name];\r\n\t\t\t\t\tcRotations[name] = fRotation.add( new THREE.Vector3(), name, 0, Math.PI * 2, 0.01 ).\r\n\t\t\t\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\t\t\t\tif ( !mesh.userData.boFrustumPoints ) {\r\n\r\n\t\t\t\t\t\t\t\tmesh.rotation[name] = value;\r\n\t\t\t\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif ( !boSetMesh )\r\n\t\t\t\t\t\t\t\texposePosition();\r\n\t\t\t\t\t\t\tif ( options.frustumPoints !== undefined )\r\n\t\t\t\t\t\t\t\toptions.frustumPoints.updateCloudPoint( mesh );\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\tdat.controllerNameAndTitle( cRotations[name], scale.name );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch ( n ) {\r\n\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\taddRotationControllers( !boX ? 'x' : !boY ? 'y' : 'z' );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 3:\r\n\t\t\t\t\t\taddRotationControllers( 'x' );\r\n\t\t\t\t\t\taddRotationControllers( 'y' );\r\n\t\t\t\t\t\taddRotationControllers( 'z' );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'GuiSelectPoint.updateScale: Invalid space dimension = ' + n );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Default rotation button\r\n\t\t\t\tbuttonRotationDefault = fRotation.add( {\r\n\r\n\t\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\t\tmesh.rotation.copy( mesh.userData.default.rotation );\r\n\t\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\t\tsetRotationControllers();\r\n\t\t\t\t\t\texposePosition();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'defaultF' );\r\n\t\t\t\tdat.controllerNameAndTitle( buttonRotationDefault, lang.defaultButton, lang.defaultRotationTitle );\r\n\r\n\t\t\t}\r\n\t\t\taddRotationFolder();\r\n\r\n\t\t\t//Points\r\n\r\n\t\t\tfPoints = fMesh.addFolder( lang.points );\r\n\r\n\t\t\tlet oldMesh;//Нужен когда пользователь сменил выбранный графический объект и когда надо сбрость настройки вершины предыдущего горафического объекта\r\n\t\t\tcPoints = fPoints.add( { Points: lang.notSelected }, 'Points', { [lang.notSelected]: -1 } ).onChange( function ( pointId ) {\r\n\r\n\t\t\t\tpointId = parseInt( pointId );\r\n\t\t\t\tvar display, position;\r\n\t\t\t\tlet mesh = getMesh();\r\n\t\t\t\tif ( mesh && mesh.userData.gui && mesh.userData.gui.reset ) oldMesh = mesh;\r\n\t\t\t\tif ( pointId === -1 ) display = 'none';\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tdisplay = 'block';\r\n\t\t\t\t\t_this.select( { object: mesh, index: pointId } );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( ( options.axesHelper !== false ) && ( options.axesHelper !== undefined ) )\r\n\t\t\t\t\toptions.axesHelper.exposePosition( getObjectPosition( mesh, pointId ) );\r\n\t\t\t\tdisplayPointControllers( display );\r\n\t\t\t\tif ( !mesh || !mesh.userData.gui || !mesh.userData.gui.reset) mesh = oldMesh;\r\n\t\t\t\tif ( mesh && mesh.userData.gui && mesh.userData.gui.reset ) mesh.userData.gui.reset( pointId );\r\n\r\n\t\t\t} );\r\n\t\t\tcPoints.__select[0].selected = true;\r\n\t\t\tdat.controllerNameAndTitle( cPoints, lang.select );\r\n\r\n\t\t\tif ( cFrustumPoints !== undefined )\r\n\t\t\t\tcFrustumPoints.create( fPoints, getLanguageCode() );\r\n\t\t\tif ( guiParams.myThreejs )\r\n\t\t\t\tguiParams.myThreejs.cFrustumPoints = cFrustumPoints\r\n\r\n\t\t\t//display vertice ID\r\n\t\t\t\r\n\t\t\toptions.dat.guiSelectPoint = options.dat.guiSelectPoint || {};\r\n\t\t\toptions.dat.guiSelectPoint.boDisplayVerticeID = options.dat.guiSelectPoint.boDisplayVerticeID || false;\r\n\t\t\tconst cDisplayVerticeID = f3DObjects.add( options.dat.guiSelectPoint, 'boDisplayVerticeID' ).onChange( function ( value ) {\r\n\t\t\t\t\r\n\t\t\t\tfor ( var i = 1; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\tvar option = cMeshs.__select.options[i];\r\n\t\t\t\t\tif ( option.mesh === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'guiSelectPoint: cDisplayVerticeID.onChange. Invalud option.mesh' );\r\n\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdisplayVerticeID( option.mesh );//getMesh() );\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cDisplayVerticeID, lang.displayVerticeID, lang.displayVerticeIDTitle );\r\n\t\t\t\r\n\t\t\t//Custom point controllers \r\n\r\n\t\t\tif ( options.dat && options.dat.guiSelectPoint && options.dat.guiSelectPoint.point ) cCustom = options.dat.guiSelectPoint.point( options, dat, fMesh );\r\n\r\n\t\t\t//Camera target\r\n\t\t\t// Может устанвливаться только если создан проигрыватель options.player,\r\n\t\t\t//потому что при установке птички 'Look' - Следить, вызывается options.player.selectScene()\r\n\t\t\tif ( options.player ) {\r\n\r\n\t\t\t\tvar orbitControlsOptions;\r\n\t\t\t\tif ( guiParams.cameraTarget ) options.playerOptions.cameraTarget.init( guiParams.cameraTarget, options );\r\n\t\t\t\tconst playerCameraTarget = options.playerOptions.cameraTarget.get( options );\r\n\t\t\t\tif ( playerCameraTarget ) {\r\n\r\n\t\t\t\t\tcCameraTarget = fPoints.add( playerCameraTarget, 'boLook' ).onChange( function ( boLook ) {\r\n\r\n\t\t\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\t\t\tif ( mesh.userData.boFrustumPoints ) {\r\n\r\n\t\t\t\t\t\t\tif ( boLook ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.warn( 'guiSelectPoint.cCameraTarget.onChange(...). The camera can not look at the frustum point.' );\r\n\t\t\t\t\t\t\t\tcCameraTarget.setValue( false );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( !mesh.userData.player ) {\r\n\r\n\t\t\t\t\t\t\tmesh.userData.player = { arrayFuncs: [] }\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < mesh.geometry.attributes.position.count; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tmesh.userData.player.arrayFuncs.push( new THREE.Vector3().fromArray( mesh.geometry.attributes.position.array,\r\n\t\t\t\t\t\t\t\t\ti * mesh.geometry.attributes.position.itemSize ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst index = mesh.userData.boFrustumPoints ? cFrustumPoints.getSelectedIndex() : cPoints.__select.options.selectedIndex - 1,\r\n\t\t\t\t\t\t\tpoint = typeof mesh.userData.player.arrayFuncs === \"function\" ?\r\n\t\t\t\t\t\t\t\tnew THREE.Vector3().fromArray( mesh.userData.player.arrayFuncs().attributes.position.array, index * 3 ) :\r\n\t\t\t\t\t\t\t\tmesh.userData.player.arrayFuncs !== undefined ? mesh.userData.player.arrayFuncs[index] :\r\n\t\t\t\t\t\t\t\t\tnew THREE.Vector3().fromArray( mesh.geometry.attributes.position.array, index * 3 );\r\n\r\n\t\t\t\t\t\t//remove boLook from all points\r\n\t\t\t\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst mesh = cMeshs.__select.options[i].mesh;\r\n\t\t\t\t\t\t\tif ( !mesh || !mesh.userData.player || !mesh.userData.player.arrayFuncs )\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\tconst arrayFuncs = mesh.userData.player.arrayFuncs;\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < arrayFuncs.length; j++ )\r\n\t\t\t\t\t\t\t\tif ( arrayFuncs[j].cameraTarget ) arrayFuncs[j].cameraTarget.boLook = false;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( point.cameraTarget ) point.cameraTarget.boLook = boLook;\r\n\t\t\t\t\t\tif ( options.player ) options.player.selectScene();\r\n\t\t\t\t\t\tif ( options.cameraGui ) options.cameraGui.look( boLook );\r\n\t\t\t\t\t\tif ( boLook ) {\r\n\r\n\t\t\t\t\t\t\tif ( !point.cameraTarget ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( playerCameraTarget.boLook === undefined ) Player.cameraTarget2.boLook = false;\r\n\r\n\t\t\t\t\t\t\t\tif ( !orbitControlsOptions ) orbitControlsOptions = {}\r\n\t\t\t\t\t\t\t\tif ( !orbitControlsOptions.target )\r\n\t\t\t\t\t\t\t\t\torbitControlsOptions.target = new THREE.Vector3();\r\n\t\t\t\t\t\t\t\tif ( options.orbitControls )\r\n\t\t\t\t\t\t\t\t\torbitControlsOptions.target.copy( options.orbitControls.target );\r\n\r\n\t\t\t\t\t\t\t\toptions.playerOptions.cameraTarget.changeTarget( mesh, index );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//Если точка имеет индивидуальную cameraTarget, то камера будет следить по этим настройкам\r\n\t\t\t\t\t\tif ( guiParams.cameraTarget ) guiParams.cameraTarget.camera.userData.cameraTargetPoint = point.cameraTarget;\r\n\r\n\t\t\t\t\t\t//\t\t\t\t\tif ( Player.orbitControls ) Player.orbitControls.reset();\r\n\t\t\t\t\t\tif ( options.orbitControls ) options.orbitControls.reset();\r\n\r\n\t\t\t\t\t\tif ( orbitControlsOptions ) {\r\n\r\n\t\t\t\t\t\t\tif ( getCameraTarget() )\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\tif ( Player.orbitControls )\r\n\t\t\t\t\t\t\t\tPlayer.orbitControls.target.copy( orbitControlsOptions.target );\r\n\t\t\t\t\t\t\tguiParams.cameraTarget.camera.lookAt( orbitControlsOptions.target );\r\n\t\t\t\t\t\t\tpoint.cameraTarget = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tdat.controllerNameAndTitle( cCameraTarget, lang.cameraTarget, lang.cameraTargetTitle );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Points attribute position\r\n\t\t\tfPoint = fPoints.addFolder( lang.point );\r\n\t\t\tdat.folderNameAndTitle( fPoint, lang.point, lang.pointTitle );\r\n\r\n\t\t\t//Points world position\r\n\t\t\tfPointWorld = fPoints.addFolder( lang.pointWorld );\r\n\t\t\tdat.folderNameAndTitle( fPointWorld, lang.pointWorld, lang.pointWorldTitle );\r\n\t\t\tfPointWorld.open();\r\n\r\n\t\t\tdisplayPointControllers( 'none' );\r\n\r\n\t\t\tif ( guiParams.pointsControls ) {\r\n\r\n\t\t\t\tguiParams.pointsControls( fPoints, dislayEl, getMesh );\r\n\r\n\t\t\t}\r\n\t\t\tcTraceAll = fPoints.add( { trace: false }, 'trace' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tvar mesh = getMesh();\r\n\t\t\t\tmesh.userData.traceAll = value;\r\n\t\t\t\tfor ( var i = 0; i < mesh.geometry.attributes.position.count; i++ )\r\n\t\t\t\t\tvisibleTraceLine( { object: mesh, index: i }, value, getMesh );\r\n\t\t\t\tcTrace.setValue( value );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cTraceAll, lang.trace, lang.traceAllTitle );\r\n\t\t\t//\t\tdislayEl( cTraceAll, Player.isCreated() );\r\n\t\t\tdislayEl( cTraceAll, options.player );\r\n\r\n\t\t\t//Restore default settings of all 3d objects button.\r\n\t\t\tdat.controllerNameAndTitle( f3DObjects.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < cMeshs.__select.options.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst mesh = cMeshs.__select.options[i].mesh;\r\n\t\t\t\t\t\tif ( !mesh )\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tmesh.scale.copy( mesh.userData.default.scale );\r\n\t\t\t\t\t\tmesh.position.copy( mesh.userData.default.position );\r\n\t\t\t\t\t\tmesh.rotation.copy( mesh.userData.default.rotation );\r\n\t\t\t\t\t\tmesh.needsUpdate = true;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetScaleControllers();\r\n\t\t\t\t\tsetPositionControllers();\r\n\t\t\t\t\tsetRotationControllers();\r\n\t\t\t\t\texposePosition();\r\n\t\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\t\toptions.frustumPoints.onChangeControls();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.default3DObjectTitle );\r\n\t\t\taddPointControllers();\r\n\r\n\t\t\twhile ( arrayMeshs.length > 0 ) {\r\n\r\n\t\t\t\tthis.addMesh( arrayMeshs[arrayMeshs.length - 1] );\r\n\t\t\t\tarrayMeshs.pop();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t/**Removes all points from points list control. */\r\n\t\tthis.removePoints = function () {\r\n\r\n\t\t\t//thanks to https://stackoverflow.com/a/48780352/5175935\r\n\t\t\tcPoints.domElement.querySelectorAll( 'select option' ).forEach( option => option.remove() );\r\n\t\t\tconst opt = document.createElement( 'option' );\r\n\t\t\topt.innerHTML = lang.notSelected;\r\n\t\t\topt.setAttribute( 'value', -1 );//Эта строка нужна в случае когда пользователь отменил выбор точки. Иначе при движении камеры будут появляться пунктирные линии, указвающие на несуществующую точку\r\n\t\t\tcPoints.__select.appendChild( opt );\r\n\r\n\t\t}\r\n\t\t/**Updates points in the points list control. */\r\n\t\tthis.updatePoints = function () {\r\n\r\n\t\t\tconst boDisplayVerticeID = options.dat.guiSelectPoint.boDisplayVerticeID,\r\n\t\t\t\tmesh = getMesh();\r\n\r\n\t\t\t//убрать с холста идентификаторы точек\r\n\t\t\tif ( boDisplayVerticeID ) {\r\n\r\n\t\t\t\toptions.dat.guiSelectPoint.boDisplayVerticeID = false;\r\n\t\t\t\tdisplayVerticeID( mesh );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tcPoints.__onChange( -1 );\r\n\t\t\tthis.removePoints();\r\n\t\t\tmesh.userData.player.arrayFuncs.length = 0;\r\n\t\t\tdelete mesh.userData.player.arrayFuncs;\r\n\t\t\tcreatePlayerArrayFuncs( mesh );\r\n\t\t\taddPoints( mesh );\r\n\r\n\t\t\t//восстановить идентификаторы точек\r\n\t\t\tif ( boDisplayVerticeID ) {\r\n\r\n\t\t\t\toptions.dat.guiSelectPoint.boDisplayVerticeID = true;\r\n\t\t\t\tdisplayVerticeID( mesh );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( mesh.userData.nd ) mesh.userData.nd.update();\r\n\r\n\t\t}\r\n\t\tfunction addPointControllers() {\r\n\r\n\t\t\tfunction isReadOnlyController( controller ) {\r\n\r\n\t\t\t\tif ( controller.boSetValue ) return true;\r\n\t\t\t\tif ( isReadOnlyEl( controller ) ) {\r\n\r\n\t\t\t\t\tif ( controller.getValue() !== controller.initialValue ) {\r\n\r\n\t\t\t\t\t\tif ( controller.boSetValue === undefined ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.boSetValue = true;\r\n\t\t\t\t\t\t\tsetValue( controller, controller.initialValue );\r\n\t\t\t\t\t\t\tcontroller.boSetValue = undefined;\r\n\t\t\t\t\t\t\tcontroller.initialValue = controller.getValue();//Эта строка нужна в случае когда новое зачения невозможно установиь точно таким же, как initialValue\r\n\t\t\t\t\t\t\t//Иначе перепонится стек\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Point's attribute position axes controllers\r\n\r\n\t\t\tfunction axesGui( axisName ) {\r\n\r\n\t\t\t\tvar scale, controller;\r\n\t\t\t\tif ( axisName === 'w' ) {\r\n\r\n\t\t\t\t\t//W axis\r\n\r\n\t\t\t\t\toptions.scales.setW();\r\n\t\t\t\t\tscale = options.scales.w;\r\n\t\t\t\t\tfunction onChange( value ) {\r\n\r\n\t\t\t\t\t\tconst attributes = intersection.object.geometry.attributes,\r\n\t\t\t\t\t\t\ti = intersection.index;\r\n\t\t\t\t\t\tif ( attributes.position.itemSize < 4 ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'guiSelectPoint.addPointControllers().axesGui().controller.onChange(): attributes.position.itemSize = ' + attributes.position.itemSize )\r\n\t\t\t\t\t\t\treturn;//Точка не имеет цвета. Например это вершина куба. Надо скрыть оган управления координатой w\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( options.palette ) Player.setColorAttribute( attributes, i, options.palette.toColor( value, controller.__min, controller.__max ) );\r\n\t\t\t\t\t\tattributes.position.setW( i, value );\r\n\r\n\t\t\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\t\t\toptions.frustumPoints.updateCloudPointItem( intersection.object, intersection.index );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( ( scale.min !== undefined ) && ( scale.max !== undefined ) ) {\r\n\r\n\t\t\t\t\t\tcontroller = fPoint.add( { value: scale.min, }, 'value',\r\n\t\t\t\t\t\t\tscale.min,\r\n\t\t\t\t\t\t\tscale.max,\r\n\t\t\t\t\t\t\t( scale.max - scale.min ) / 100\r\n\t\t\t\t\t\t).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t\tif ( isReadOnlyController( controller ) ) return;\r\n\t\t\t\t\t\t\tonChange( value );\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tif ( options.palette instanceof ColorPicker.palette ) {\r\n\r\n\t\t\t\t\t\t\tcontroller.domElement.querySelector( '.slider-fg' ).style.height = '40%';\r\n\t\t\t\t\t\t\tconst elSlider = controller.domElement.querySelector( '.slider' );\r\n\t\t\t\t\t\t\tColorPicker.create( elSlider, {\r\n\r\n\t\t\t\t\t\t\t\tpalette: options.palette,\r\n\t\t\t\t\t\t\t\tstyle: {\r\n\r\n\t\t\t\t\t\t\t\t\t//border: '2px solid #303030',\r\n\t\t\t\t\t\t\t\t\twidth: '65%',//Непонятно почему без этой строи не видно палиры в http://localhost/anhr/egocentricUniverse/master/Examples/3D.html\r\n\t\t\t\t\t\t\t\t\t//height: elSlider.offsetHeight / 2,//'50%',\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t//onError: function ( message ) { alert( 'Colorpicker error: ' + message ); }\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tcontroller = fPoint.add( { value: 0, }, 'value' ).onChange( function ( value ) { onChange( value ); } );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tscale = ( options.axesHelper === undefined ) || ( options.axesHelper === false ) ? options.scales[axisName] : //если я буду использовать эту строку то экстремумы шкал буду устанавливатся по умолчанию а не текущие\r\n\t\t\t\t\t\toptions.axesHelper.options ? options.axesHelper.options.scales[axisName] : undefined;\r\n\t\t\t\t\tif ( scale.isAxis() )\r\n\t\t\t\t\t\tcontroller = fPoint.add( { value: scale.min, }, 'value',\r\n\t\t\t\t\t\t\tscale.min,\r\n\t\t\t\t\t\t\tscale.max,\r\n\t\t\t\t\t\t\t( scale.max - scale.min ) / 100 ).\r\n\t\t\t\t\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t\t\tconst points = intersection.object;\r\n\r\n\t\t\t\t\t\t\t\tif ( isReadOnlyController( controller ) ) return;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst axesId = axisName === 'x' ? 0 : axisName === 'y' ? 1 : axisName === 'z' ? 2 : axisName === 'w' ? 3 : console.error('axisName:' + axisName);\r\n\r\n\t\t\t\t\t\t\t\tpoints.geometry.attributes.position.array[axesId + intersection.index * points.geometry.attributes.position.itemSize] = value;\r\n\t\t\t\t\t\t\t\tpoints.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\t\texposePosition( intersection.index );\r\n\r\n\t\t\t\t\t\t\t\tif ( options.frustumPoints )\r\n\t\t\t\t\t\t\t\t\toptions.frustumPoints.updateCloudPointItem( points, intersection.index );\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( controller )\r\n\t\t\t\t\tdat.controllerNameAndTitle( controller, scale.name );\r\n\t\t\t\treturn controller;\r\n\r\n\t\t\t}\r\n\t\t\tcX = axesGui( 'x' );\r\n\t\t\tcY = axesGui( 'y' );\r\n\t\t\tcZ = axesGui( 'z' );\r\n\t\t\tcW = axesGui( 'w' );\r\n\t\t\tcColor = fPoint.addColor( { color: '#FFFFFF', }, 'color' ).\r\n\t\t\t\tonChange( function ( value ) {\r\n\r\n\t\t\t\t\t//for testing\r\n\t\t\t\t\t//Go to http://localhost/anhr/commonNodeJS/master/player/Examples/\r\n\t\t\t\t\t//Select 3 Ponts' 3D object\r\n\t\t\t\t\t//Select a point 2\r\n\t\t\t\t\t//Open 'Point's local position'\r\n\t\t\t\t\t//Change 'color'\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( isReadOnlyController( cColor ) ) return;\r\n\t\t\t\t\tif ( cColor.userData === undefined ) return;\r\n\t\t\t\t\tvar intersection = cColor.userData.intersection;\r\n\t\t\t\t\tPlayer.setColorAttribute( intersection.object.geometry.attributes, intersection.index, value );\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cColor, options.scales.w ? options.scales.w.name : lang.color );\r\n\t\t\tcOpacity = fPoint.add( { opasity: 1, }, 'opasity', 0, 1, 0.01 ).\r\n\t\t\t\tonChange( function ( opasity ) {\r\n\r\n\t\t\t\t\tif ( isReadOnlyController( cOpacity ) )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tconst mesh = getMesh();\r\n\t\t\t\t\tif (mesh.userData.myObject) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tmesh.userData.myObject.verticeOpacity(intersection.index, true, opasity);\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!mesh.material.transparent) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'GuiSelectPoint: cOpacity.onChange. Invalid mesh.material.transparent = ' + mesh.material.transparent);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!mesh.material.vertexColors) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'GuiSelectPoint: cOpacity.onChange. Invalid mesh.material.vertexColors = ' + mesh.material.vertexColors);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst color = mesh.geometry.attributes.color;\r\n\t\t\t\t\tif (color.itemSize < 4) return;\r\n\t\t\t\t\tcolor.array[3 + intersection.index * color.itemSize] = opasity;\r\n\t\t\t\t\tcolor.needsUpdate = true;\r\n\r\n\t\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cOpacity, lang.opacity, lang.opacityTitle );\r\n\r\n\t\t\tcTrace = fPoint.add( { trace: false }, 'trace' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tvisibleTraceLine( intersection, value, getMesh );\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( cTrace, lang.trace, lang.traceTitle ); //guiParams\r\n\t\t\tdislayEl( cTrace, options.player );\r\n\r\n\t\t\tif ( guiParams.pointControls ) {\r\n\r\n\t\t\t\tguiParams.pointControls( fPoint, dislayEl, getMesh, intersection );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Point's world position axes controllers\r\n\r\n\t\t\tfunction axesWorldGui( axisName ) {\r\n\r\n\t\t\t\tconst scale = ( options.axesHelper === undefined ) || ( options.axesHelper === false ) ? options.scales[axisName] :\r\n\t\t\t\t\toptions.axesHelper.options ? options.axesHelper.options.scales[axisName] : undefined;\r\n\t\t\t\tif ( !scale.isAxis() )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tconst controller = dat.controllerZeroStep( fPointWorld, { value: scale.min, }, 'value' );\r\n\t\t\t\treadOnlyEl( controller, true );\r\n\t\t\t\tdat.controllerNameAndTitle( controller, scale.name );\r\n\t\t\t\treturn controller;\r\n\r\n\t\t\t}\r\n\t\t\tcWorld.x = axesWorldGui( 'x' );\r\n\t\t\tcWorld.y = axesWorldGui( 'y' );\r\n\t\t\tcWorld.z = axesWorldGui( 'z' );\r\n\r\n\t\t\t//Restore default local position.\r\n\t\t\tcRestoreDefaultLocalPosition = fPoint.add( {\r\n\r\n\t\t\t\tdefaultF: function () {\r\n\r\n\t\t\t\t\tconst positionDefault = intersection.object.userData.player.arrayFuncs[intersection.index],\r\n\t\t\t\t\t\tt = options.time,\r\n\t\t\t\t\t\tsetDefaultValue = ( control, value ) => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( !control ) return;\r\n\t\t\t\t\t\t\tcontrol.setValue(\r\n\t\t\t\t\t\t\t\ttypeof value === \"function\" ?\r\n\t\t\t\t\t\t\t\t\tvalue( t, options.a, options.b ) :\r\n\t\t\t\t\t\t\t\t\ttypeof value === \"string\" ?\r\n\t\t\t\t\t\t\t\t\t\tPlayer.execFunc( { w: value } , 'w', options.time, options ) :\r\n\t\t\t\t\t\t\t\t\t\tvalue\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tsetDefaultValue( cX, positionDefault.x );\r\n\t\t\t\t\tsetDefaultValue( cY, positionDefault.y );\r\n\t\t\t\t\tsetDefaultValue( cZ, positionDefault.z === undefined ? 0 ://default Z axis of 2D point is 0\r\n\t\t\t\t\t\t\tpositionDefault.z );\r\n\r\n\t\t\t\t\tif ( isDislayEl( cOpacity ) ) cOpacity.setValue( cOpacity.initialValue );\r\n\t\t\t\t\tif ( isDislayEl( cColor ) && !isReadOnlyEl( cColor ) ) cColor.setValue( cColor.initialValue );\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( positionDefault.w !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( positionDefault.w.r !== undefined )\r\n\t\t\t\t\t\t\tcColor.setValue( '#' +\r\n\t\t\t\t\t\t\t\tnew THREE.Color( positionDefault.w.r, positionDefault.w.g, positionDefault.w.b ).getHexString() );\r\n\t\t\t\t\t\telse if ( typeof positionDefault.w === \"function\" ) {\r\n\r\n\t\t\t\t\t\t\tsetValue( cW, positionDefault.w( t ) );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t} else if ( positionDefault.w.func ) {\r\n\r\n\t\t\t\t\t\t\tsetValue( cW, positionDefault.w.func( t ) );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst float = parseFloat( positionDefault.w );\r\n\t\t\t\t\t\tif ( float === positionDefault.w ) {\r\n\r\n\t\t\t\t\t\t\tif ( isDislayEl( cW ) ) setValue( cW, positionDefault.w );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else if ( typeof positionDefault.w  === \"string\") {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tsetValue( cW, Player.execFunc( positionDefault , 'w', options.time, options ) );\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else console.error( 'Restore default local position: Invalid W axis.' );\r\n\r\n\t\t\t\t\t} else cColor.setValue( cColor.initialValue );\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' );\r\n\t\t\tdat.controllerNameAndTitle( cRestoreDefaultLocalPosition, lang.defaultButton, lang.defaultLocalPositionTitle );\r\n\r\n\t\t\tfuncFolder = new functionsFolder( fPoint, function ( func, axisName, value ) {\r\n\r\n\t\t\t\tconst mesh = getMesh(),\r\n\t\t\t\t\tindex = cPoints.__select.options.selectedIndex - 1,\r\n\t\t\t\t\tfuncs = mesh.userData.player.arrayFuncs[index];\r\n\t\t\t\tfuncs[axisName] = func;\r\n\r\n\t\t\t\tvar parent = mesh.parent, t = 0;\r\n\t\t\t\twhile ( parent ) {\r\n\r\n\t\t\t\t\tif ( parent.userData.t ) {\r\n\r\n\t\t\t\t\t\tt = parent.userData.t;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tparent = parent.parent;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tvar controller;\r\n\t\t\t\tswitch ( axisName ) {\r\n\r\n\t\t\t\t\tcase 'x':\r\n\t\t\t\t\t\tcontroller = cX;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'y':\r\n\t\t\t\t\t\tcontroller = cY;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'z':\r\n\t\t\t\t\t\tcontroller = cZ;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'w':\r\n\t\t\t\t\t\tif ( func instanceof THREE.Color ) {\r\n\r\n\t\t\t\t\t\t\tcColor.setValue( '#' + func.getHexString() );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcontroller = cW;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error( 'GuiSelectPoint new functionsFolder onFinishChange: axisName = ' + axisName );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tsetValue( controller, Player.execFunc( funcs, axisName, t, options ) );\r\n\r\n\t\t\t\tif ( funcs.controllers ) {\r\n\r\n\t\t\t\t\t//обновить органы управления на веб странице\r\n\t\t\t\t\tconst controllerObject = funcs.controllers[axisName];\r\n\t\t\t\t\tif ( controllerObject && controllerObject.func && controllerObject.func.controller )\r\n\t\t\t\t\t\tcontrollerObject.func.controller.value = value;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\r\n\t\t\t}, options, { x: '', y: '', z: '', w: '' } );/* {\r\n\r\n\t\t\t\tgetLanguageCode: getLanguageCode,\r\n\t\t\t\tTHREE: THREE,\r\n\r\n\t\t\t} );*/\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * get frustum points.\r\n\t\t */\r\n\t\tthis.getFrustumPoints = function () { return cFrustumPoints; }\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default GuiSelectPoint;\r\n","/**\r\n * @module MoveGroupGui\r\n *\r\n * @description Add MoveGroup folder into {@link https://github.com/anhr/dat.gui|dat.gui} for changing group's position, scale and rotation.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport three from './three.js'\r\nimport ScaleController from './ScaleController.js';\r\nimport PositionController from './PositionController.js';\r\n\r\n//import Cookie from './cookieNodeJS/cookie.js';\r\n//import Cookie from 'https://raw.githack.com/anhr/commonNodeJS/master/cookieNodeJS/cookie.js';\r\n\r\nclass MoveGroupGui {\r\n\r\n\t/**\r\n\t * Add MoveGroup folder into {@link https://github.com/anhr/dat.gui|dat.gui} for changing group's position, scale and rotation.\r\n\t * @param {THREE.Group|THREE.Scene} group [THREE.Group]{@link https://threejs.org/docs/index.html?q=group#api/en/objects/Group} or [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} for moving.\r\n\t * @param {object} options the following options are available.\r\n\t * See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {object} [options.axesHelper] <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t * @param {object} [options.scales] axes scales.\r\n\t * See <b>options.scales</b> parameter of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a> class for details.\r\n\t * @param {Cookie} [options.cookie] Your custom cookie function for saving and loading of the MoveGroup settings. Default cookie is not saving settings.\r\n\t * @param {string} [options.cookieName] Name of the cookie is \"MoveGroup\" + options.cookieName.\r\n\t * @param {GuiSelectPoint} [options.guiSelectPoint] A dat.gui based graphical user interface for select a point from the mesh.\r\n\t * See <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a> for details.\r\n\t * @param {GUI} [guiParams.folder] is [dat.GUI]{@link https://github.com/anhr/dat.gui} parent folder.\r\n\t * @param {object} [guiParams={}] Followed parameters is allowed.\r\n\t * @param {object} [guiParams.lang] Object with localized language values\r\n\t * @param {object} [guiParams.lang.moveGroup] use for rename of the MoveGroup folder. Default is 'Move Group'.\r\n\t */\r\n\tconstructor( group, options, guiParams = {} ) {\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'MoveGroupGui: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst gui = guiParams.folder || options.dat.gui;\r\n\t\tif ( !gui || options.dat.moveScene === false )\r\n\t\t\treturn;\r\n\t\tif ( options.axesHelper && options.axesHelper.options )\r\n\t\t\toptions.scales = options.axesHelper.options.scales;\r\n\t\telse options.scales = options.scales || { x: {}, y: {}, z: {}, };\r\n\r\n\r\n//\t\tconst cookie = options.cookie || new Cookie.defaultCookie(),\r\n\t\tconst cookie = options.dat.cookie,\r\n\t\t\tdat = three.dat,//options.dat.dat,\r\n\t\t\tcookieName = 'MoveGroup' + ( options.cookieName ? '_' + options.cookieName : '' ),\r\n\t\t\toptionsGroup = {\r\n\r\n\t\t\t\tscale: group.scale,\r\n\t\t\t\tposition: group.position,\r\n\t\t\t\trotation: group.rotation,\r\n\t\t\t\tx: { zoomMultiplier: 1.2, offset: 0.1, },\r\n\t\t\t\ty: { zoomMultiplier: 1.2, offset: 0.1, },\r\n\t\t\t\tz: { zoomMultiplier: 1.2, offset: 0.1, },\r\n\r\n\t\t\t},\r\n\t\t\tgroupOptionsDefault = JSON.parse( JSON.stringify( optionsGroup ) );\r\n\t\tObject.freeze( groupOptionsDefault );\r\n\t\tcookie.getObject( cookieName, optionsGroup, groupOptionsDefault );\r\n\r\n\t\t//move group from cookie\r\n\t\tgroup.scale.copy( optionsGroup.scale );\r\n\t\tgroup.position.copy( optionsGroup.position );\r\n\r\n\t\t//Restore optionsGroup from group\r\n\t\t//Если не восстановить optionsGroup из group, то после перемещения group это не будет сохраняться в cookie\r\n\t\toptionsGroup.scale = group.scale;\r\n\t\toptionsGroup.position = group.position;\r\n\r\n\t\tfunction setDefault( axisName ) {\r\n\r\n\t\t\tlet scale = options.scales[axisName];\r\n\t\t\tif ( !scale )\r\n\t\t\t\treturn;\r\n\t\t\t\r\n\t\t\toptions.moveGroupGui = options.moveGroupGui || { scales: {} };\r\n\t\t\toptions.moveGroupGui.scales[axisName] = options.moveGroupGui.scales[axisName] || {};\r\n\t\t\toptions.moveGroupGui.scales[axisName].default = function () {\r\n\r\n\t\t\t\tconst scalesControllers = options.scalesControllers[axisName];\r\n\t\t\t\tscalesControllers.scale.setValue( groupOptionsDefault.scale[axisName] );\r\n\t\t\t\tscalesControllers.scaleController.setValue( groupOptionsDefault[axisName].zoomMultiplier );\r\n\t\t\t\tscalesControllers.position.setValue( groupOptionsDefault.position[axisName] );\r\n\t\t\t\tscalesControllers.positionController.setValue( groupOptionsDefault[axisName].offset );\r\n\t\t\t\tscalesControllers.rotation.setValue( groupOptionsDefault.rotation['_' + axisName] );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tsetDefault( 'x' );\r\n\t\tsetDefault( 'y' );\r\n\t\tsetDefault( 'z' );\r\n\r\n\t\t//Localization\r\n\r\n\t\tvar lang = {\r\n\r\n\t\t\tmoveGroup: 'Move Group',\r\n\t\t\tscale: 'Scale',\r\n\t\t\tposition: 'Position',\r\n\t\t\trotation: 'Rotation',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultTitle: 'Move group to default position.',\r\n\r\n\t\t};\r\n\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.moveGroup = 'Переместить группу'; scale\r\n\t\t\t\tlang.scale = 'Масштаб';\r\n\t\t\t\tlang.position = 'Позиция';\r\n\t\t\t\tlang.rotation = 'Вращение';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultTitle = 'Переместить группу в исходное состояние.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tif ( guiParams.lang )\r\n\t\t\tlang.moveGroup = guiParams.lang.moveGroup || lang.moveGroup;\r\n\r\n\t\tfunction axisZoom( axisName, action, zoom ) {\r\n\r\n\t\t\tvar scale = options.scalesControllers[axisName].scale;\r\n\t\t\tif ( !scale )\r\n\t\t\t\treturn;\r\n\t\t\tscale.setValue( action( scale.getValue(), zoom ) );\r\n\t\t\tsetSettings();\r\n\r\n\t\t}\r\n\r\n\t\t//move group folder\r\n\t\tlet fMoveGroup = gui.addFolder( lang.moveGroup );\r\n\r\n\t\tfMoveGroup.add( new ScaleController(\r\n\t\t\tfunction ( customController, action ) {\r\n\r\n\t\t\t\tlet zoom = customController.controller.getValue();\r\n\t\t\t\taxisZoom( 'x', action, zoom );\r\n\t\t\t\taxisZoom( 'y', action, zoom );\r\n\t\t\t\taxisZoom( 'z', action, zoom );\r\n\r\n\t\t\t}, {\r\n\r\n\t\t\tsettings: { zoomMultiplier: 1.1, },\r\n\t\t\tgetLanguageCode: guiParams.getLanguageCode,\r\n\r\n\t\t} ) );\r\n\r\n\t\tfunction setSettings() {\r\n\r\n\t\t\tif ( options.axesHelper )\r\n\t\t\t\toptions.axesHelper.updateAxes();\r\n\t\t\tif ( options.guiSelectPoint )\r\n\t\t\t\toptions.guiSelectPoint.update();\r\n\t\t\tcookie.setObject( cookieName, optionsGroup );\r\n\r\n\t\t}\r\n\r\n\t\tfunction scale( axes, scaleControllers, axisName ) {\r\n\r\n/*\r\n\t\t\tif ( axes === undefined )\r\n\t\t\t\treturn;//Not 3D AxesHelper\r\n\t\t\taxes.name = axes.name || axisName;\r\n*/\t\t\t\r\n\t\t\tif ( !axes.isAxis() ) return;//Not 3D AxesHelper\r\n\r\n\t\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\t\tvar zoom = customController.controller.getValue();\r\n\r\n\t\t\t\taxisZoom( axisName, action, zoom );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscaleControllers.folder = fMoveGroup.addFolder( axes.name );\r\n\r\n\t\t\t//Scale\r\n\r\n\t\t\tscaleControllers.scaleController = scaleControllers.folder.add( new ScaleController( onclick,\r\n\t\t\t\t{ settings: optionsGroup[axisName], getLanguageCode: guiParams.getLanguageCode, } ) ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\toptionsGroup[axisName].zoomMultiplier = value;\r\n\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t} );\r\n\t\t\tscaleControllers.scale = dat.controllerZeroStep( scaleControllers.folder, group.scale, axisName,\r\n\t\t\t\tfunction ( value ) { setSettings(); } );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.scale, lang.scale );\r\n\r\n\t\t\t//Position\r\n\r\n\t\t\tvar positionController = new PositionController( function ( shift ) {\r\n\r\n\t\t\t\tfunction onclick( customController, action ) {\r\n\r\n\t\t\t\t\tvar offset = customController.controller.getValue();\r\n\r\n\r\n\t\t\t\t\tfunction axisOffset( axisName, action, offset ) {\r\n\r\n\t\t\t\t\t\tvar position = options.scalesControllers[axisName].position;\r\n\t\t\t\t\t\tif ( !position )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tposition.setValue( action( position.getValue(), offset ) );\r\n\t\t\t\t\t\tsetSettings();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\taxisOffset( axisName, action, offset );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tonclick( positionController, function ( value, zoom ) {\r\n\r\n\t\t\t\t\tvalue += shift;\r\n\t\t\t\t\treturn value;\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}, { settings: {}, getLanguageCode: guiParams.getLanguageCode, } );\r\n\t\t\tscaleControllers.positionController = scaleControllers.folder.add( positionController ).onChange( function ( value ) {\r\n\r\n\t\t\t\toptionsGroup[axisName].offset = value;\r\n\t\t\t\tsetSettings();\r\n\r\n\t\t\t} );\r\n\t\t\tscaleControllers.position = dat.controllerZeroStep( scaleControllers.folder, group.position, axisName,\r\n\t\t\t\tfunction ( value ) { setSettings(); } );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.position, lang.position );\r\n\r\n\t\t\t//rotation\r\n\r\n\t\t\tscaleControllers.rotation = scaleControllers.folder.add( group.rotation, axisName, 0, Math.PI * 2, 1 / 360 ).\r\n\t\t\t\tonChange( function ( value ) { setSettings(); } );\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.rotation, lang.rotation );\r\n\r\n\t\t\t//Default button\r\n\t\t\tdat.controllerNameAndTitle( scaleControllers.folder.add( {\r\n\r\n\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\toptions.moveGroupGui.scales[axisName].default();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\t}\r\n\t\toptions.scalesControllers = { x: {}, y: {}, z: {}, w: {} };//, t: {}, };\r\n\t\tfunction windowRange() {\r\n\r\n\t\t\toptions.cookie.setObject( cookieName, options.scales );\r\n\r\n\t\t}\r\n\t\tif ( options.scales ) {\r\n\r\n\t\t\tscale( options.scales.x,\r\n\t\t\t\toptions.scalesControllers.x, 'x' );\r\n\t\t\tscale( options.scales.y,\r\n\t\t\t\toptions.scalesControllers.y, 'y' );\r\n\t\t\tscale( options.scales.z,\r\n\t\t\t\toptions.scalesControllers.z, 'z' );\r\n\r\n\t\t}\r\n\r\n\t\t//default button\r\n\t\tvar defaultParams = {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tif ( options.moveGroupGui.scales.x ) options.moveGroupGui.scales.x.default();\r\n\t\t\t\tif ( options.moveGroupGui.scales.y ) options.moveGroupGui.scales.y.default();\r\n\t\t\t\tif ( options.moveGroupGui.scales.z ) options.moveGroupGui.scales.z.default();\r\n\r\n\t\t\t},\r\n\r\n\t\t};\r\n\t\tdat.controllerNameAndTitle( fMoveGroup.add( defaultParams, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t}\r\n\r\n}\r\nexport default MoveGroupGui;","/**\r\n * @module CameraGui\r\n * @description [Camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} graphical user interface.\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport functionsFolder from './functionsFolder.js';\r\nimport Player from './player/player.js';\r\nimport three from './three.js'\r\n\r\nclass CameraGui {\r\n\r\n\t/**\r\n\t * [Camera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera} settings graphical user interface\r\n\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t * @param {Options} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * The following options are available.\r\n\t * @param {OrbitControls} [options.orbitControls] [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}.\r\n\t * @param {Function} [options.getLanguageCode=language code of your browser] returns the \"primary language\" subtag of the version of the browser.\r\n\t * @param {object} [options.scales={}] axes scales.\r\n\t * See the <b>options.scales</b> parameter of the <a href=\"../../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {GUI} [gui] is [new dat.GUI(...)]{@link https://github.com/anhr/dat.gui} parent folder.\r\n\t*/\r\n\tconstructor( camera, options, gui ) {\r\n\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'CameraGui: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tgui = gui || options.dat.gui;\r\n\t\tif ( !gui || options.dat.cameraGui === false )\r\n\t\t\treturn;\r\n\t\tconst dat = three.dat,//options.dat.dat,\r\n\t\t\tTHREE = three.THREE;\r\n\t\toptions.cameraGui = this;\r\n\r\n\t\t//Обновить значения органов управления когда пользователь с помощью мыши передвинул камеру\r\n\t\tif ( options.orbitControls )\r\n\t\t\toptions.orbitControls.addEventListener( 'change', function () {\r\n\r\n\t\t\t\tupdate();\r\n\r\n\t\t\t} );\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tcamera: 'Camera',\r\n\r\n\t\t\tposition: 'Position',\r\n\t\t\tpositionTitle: 'Camera position',\r\n\r\n\t\t\tdistanceToCamera: 'Distance',\r\n\t\t\tdistanceToCameraTitle: 'Distance from the camera to the point at which the camera is looking',\r\n\r\n\t\t\tlook: 'Look',\r\n\t\t\tlookTitle: 'Camera is look at a selected point during playing.',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultTitle: 'Restore default camera settings.',\r\n\r\n\t\t};\r\n\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.camera = 'Камера';\r\n\r\n\t\t\t\tlang.position = 'Позиция';\r\n\t\t\t\tlang.positionTitle = 'Позиция камеры';\r\n\r\n\t\t\t\tlang.distanceToCamera = 'Расстояние';\r\n\t\t\t\tlang.distanceToCameraTitle = 'Расстояние между камерой и точкой, на которую она смотрит.',\r\n\r\n\t\t\t\tlang.look = 'Следить';\r\n\t\t\t\tlang.lookTitle = 'Камера следит за выбранной точкой во время проигрывания.';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultTitle = 'Восстановить настройки камеры по умолчанию.';\r\n\r\n\t\t\t\tbreak;\r\n\t\t\tdefault://Custom language\r\n\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t\tconst fCamera = gui.addFolder( lang.camera ),\r\n\t\t\tfPosition = fCamera.addFolder( lang.position ),\r\n\t\t\tcontrollersPosition = {\r\n\r\n\t\t\t\tx: options.scales.x ? dat.controllerZeroStep( fPosition, camera.position, 'x', function ( value ) {\r\n\r\n\t\t\t\t\tcamera.position.x = value;\r\n\r\n\t\t\t\t} ) : undefined,\r\n\t\t\t\ty: options.scales.y ? dat.controllerZeroStep( fPosition, camera.position, 'y', function ( value ) {\r\n\r\n\t\t\t\t\tcamera.position.y = value;\r\n\r\n\t\t\t\t} ) : undefined,\r\n\r\n\t\t\t\tz: options.scales.z ? dat.controllerZeroStep( fPosition, camera.position, 'z', function ( value ) {\r\n\r\n\t\t\t\t\tcamera.position.z = value;\r\n\r\n\t\t\t\t} ) : undefined,\r\n\r\n\t\t\t};\r\n\t\tdat.folderNameAndTitle( fPosition, lang.position, lang.positionTitle );\r\n\t\tif ( controllersPosition.x ) dat.controllerNameAndTitle( controllersPosition.x, options.scales.x.name );\r\n\t\tif ( controllersPosition.y ) dat.controllerNameAndTitle( controllersPosition.y, options.scales.y.name );\r\n\t\tif ( controllersPosition.z ) dat.controllerNameAndTitle( controllersPosition.z, options.scales.z.name );\r\n\r\n\t\tvar controllersDistance, defaultDistance, funcFolder, controllerLook;\r\n\r\n\t\t//Camera target\r\n\t\t// Может устанвливаться только если создан проигрыватель options.player,\r\n\t\t//потому что при установке птички 'Look' - Следить в guiSelectPoint, вызывается options.player.selectScene()\r\n\t\tif ( options.player ) {\r\n\r\n\t\t\toptions.playerOptions.cameraTarget.init( { camera: camera }, options );\r\n\t\t\tconst cameraTarget = options.playerOptions.cameraTarget.get();\r\n\t\t\tcontrollerLook = fCamera.add( cameraTarget, 'boLook' ).onChange( function ( boLook ) {\r\n\r\n\t\t\t\tif ( options.player ) {\r\n\r\n\t\t\t\t\tcameraTarget.boMaual = true;\r\n\t\t\t\t\toptions.player.selectScene();\r\n\t\t\t\t\tcameraTarget.boMaual = false;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( boLook )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( options.orbitControls )\r\n\t\t\t\t\toptions.orbitControls.reset();//обязательно вызвать controls.saveState();\r\n\r\n\t\t\t} );\r\n\t\t\tdat.controllerNameAndTitle( controllerLook, lang.look, lang.lookTitle );\r\n\r\n\t\t\tconst fDistanceToCamera = fCamera.addFolder( lang.distanceToCamera ),\r\n\t\t\t\tdistance = {\r\n\r\n\t\t\t\t\tx: Player.execFunc( cameraTarget.distanceToCamera, 'x', undefined, options ),\r\n\t\t\t\t\ty: Player.execFunc( cameraTarget.distanceToCamera, 'y', undefined, options ),\r\n\t\t\t\t\tz: Player.execFunc( cameraTarget.distanceToCamera, 'z', undefined, options ),\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\tfunction setDistance( axisName, value ) {\r\n\r\n\t\t\t\tif ( isNaN( value ) ) return;\r\n\t\t\t\tif ( camera.userData.cameraTarget ) camera.userData.cameraTarget.distanceToCameraCur[axisName] = value;\r\n\t\t\t\tcameraTarget.distanceToCameraCur[axisName] = value;\r\n\t\t\t\tcameraTarget.setCameraPosition();\r\n\t\t\t\tupdate();\r\n\r\n\t\t\t}\r\n\t\t\tcontrollersDistance = {\r\n\r\n\t\t\t\tx: dat.controllerZeroStep( fDistanceToCamera, distance, 'x', function ( value ) {\r\n\r\n\t\t\t\t\tsetDistance( 'x', value );\r\n\r\n\t\t\t\t} ),\r\n\t\t\t\ty: dat.controllerZeroStep( fDistanceToCamera, distance, 'y', function ( value ) {\r\n\r\n\t\t\t\t\tsetDistance( 'y', value );\r\n\r\n\t\t\t\t} ),\r\n\r\n\t\t\t\tz: dat.controllerZeroStep( fDistanceToCamera, distance, 'z', function ( value ) {\r\n\r\n\t\t\t\t\tsetDistance( 'z', value );\r\n\r\n\t\t\t\t} ),\r\n\r\n\t\t\t};\r\n\t\t\tdefaultDistance = { x: distance.x, y: distance.y, z: distance.z };\r\n\t\t\tdat.folderNameAndTitle( fDistanceToCamera, lang.distanceToCamera, lang.distanceToCameraTitle );\r\n\t\t\tif ( options.scales.x ) dat.controllerNameAndTitle( controllersDistance.x, options.scales.x.name );\r\n\t\t\tif ( options.scales.y ) dat.controllerNameAndTitle( controllersDistance.y, options.scales.y.name );\r\n\t\t\tif ( options.scales.z ) dat.controllerNameAndTitle( controllersDistance.z, options.scales.z.name );\r\n\r\n\t\t\tfuncFolder = new functionsFolder( fDistanceToCamera, function ( func, axisName ) {\r\n\r\n\t\t\t\tconst cameraTarget = options.playerOptions.cameraTarget.get();\r\n\t\t\t\tcameraTarget.distanceToCamera[axisName] = func;\r\n\t\t\t\tconst value = Player.execFunc( cameraTarget.distanceToCamera, axisName, options.time );\r\n\t\t\t\tcontrollersDistance[axisName].setValue( value, true );\r\n\t\t\t\toptions.playerOptions.cameraTarget.init( { camera: camera }, options );\r\n\r\n\t\t\t}, options, cameraTarget.distanceToCamera );\r\n\r\n\t\t}\r\n\r\n\t\t//Default button\r\n\t\tconst defaultPosition = { x: camera.position.x, y: camera.position.y, z: camera.position.z },\r\n\t\t\tdefaultTarget = options.orbitControls ?\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tx: options.orbitControls.target.x,\r\n\t\t\t\t\ty: options.orbitControls.target.y,\r\n\t\t\t\t\tz: options.orbitControls.target.z,\r\n\r\n\t\t\t\t} :\r\n\t\t\t\t{ x: 0, y: 0, z: 0 };//default camera look at zero coordinate\r\n\t\tdat.controllerNameAndTitle( fCamera.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tcontrollersPosition.x.setValue( defaultPosition.x );\r\n\t\t\t\tcontrollersPosition.y.setValue( defaultPosition.y );\r\n\t\t\t\tcontrollersPosition.z.setValue( defaultPosition.z );\r\n\r\n\t\t\t\tcamera.position.copy( defaultPosition );\r\n\t\t\t\tcamera.lookAt( defaultTarget );\r\n\t\t\t\tif ( options.orbitControls ) {\r\n\r\n\t\t\t\t\toptions.orbitControls.target.copy( defaultTarget );\r\n\t\t\t\t\toptions.orbitControls.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( controllersDistance ) {\r\n\r\n\t\t\t\t\tcontrollersDistance.x.setValue( defaultDistance.x );\r\n\t\t\t\t\tcontrollersDistance.y.setValue( defaultDistance.y );\r\n\t\t\t\t\tcontrollersDistance.z.setValue( defaultDistance.z );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\r\n\t\tfunction update() {\r\n\r\n\t\t\tconst cameraTarget = options.playerOptions.cameraTarget.get( options );\r\n\t\t\t\r\n\t\t\tif ( controllersPosition.x ) controllersPosition.x.setValue( camera.position.x );\r\n\t\t\tif ( controllersPosition.y ) controllersPosition.y.setValue( camera.position.y );\r\n\t\t\tif ( controllersPosition.z ) controllersPosition.z.setValue( camera.position.z );\r\n\r\n\t\t\tif ( controllersDistance ) {\r\n\r\n\t\t\t\tconst distanceToCamera = cameraTarget.getDistanceToCamera()\r\n\t\t\t\tif ( controllersDistance.x ) controllersDistance.x.setValue( distanceToCamera.x );\r\n\t\t\t\tif ( controllersDistance.y ) controllersDistance.y.setValue( distanceToCamera.y );\r\n\t\t\t\tif ( controllersDistance.z ) controllersDistance.z.setValue( distanceToCamera.z );\r\n\r\n\t\t\t}\r\n\t\t\tif ( funcFolder ) funcFolder.setFunction( cameraTarget.distanceToCamera );\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t\t* Update camera controls.\r\n\t\t\t*/\r\n\t\tthis.update = function () { update(); }\r\n\t\t/**\r\n\t\t\t* Look at selected point\r\n\t\t\t* @param {boolean} [boLook=true] true - look at selected point\r\n\t\t\t*/\r\n\t\tthis.look = function ( boLook = true ) {\r\n\r\n//\t\t\t\tif ( controllerLook && ( controllerLook.getValue() !== boLook ) )\r\n\t\t\tif ( controllerLook ) {\r\n\r\n//\t\t\t\t\tcontrollerLook.setValue( boLook );\r\n\t\t\t\tcontrollerLook.object[controllerLook.property] = boLook;\r\n\t\t\t\tcontrollerLook.updateDisplay();\r\n\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default CameraGui;","/**\r\n * FolderPoint\r\n *\r\n * GUI for changing point settings.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nimport three from './three.js'\r\n\r\nimport PositionController from './PositionController.js';\r\n\r\n/**\r\n * @callback setSize\r\n * @description Set size of the point\r\n * @param {number} value new size.\r\n * */\r\n\r\n/**\r\n * GUI for changing point settings.\r\n * @param {Object} point point options.\r\n * @param {number} point.size point size.\r\n * @param {setSize} setSize Set size of the point\r\n * @param {Options} options See the <b>options</b> parameter of the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n * @param {Object} [settings={}] the following settings are available\r\n * @param {GUI} [settings.folder] parent folder. See [GUI]{@link https://github.com/anhr/dat.gui}.\r\n * @param {Object} [settings.defaultPoint={}] default point options. Restore point options if user has clicked \"Default\" button\r\n * @param {number} [settings.defaultPoint.size=point.size] point size.\r\n * @param {number} [settings.PCOptions={}] See options parameter of the <a href=\"../../jsdoc/PositionController/PositionController.html\" target=\"_blank\">PositionController</a>\r\n * @param {Object} [settings.PCOptions.min=0.01] Minimal offset.\r\n * @param {Object} [settings.PCOptions.max=1] Maximal offset.\r\n * @param {Object} [settings.PCOptions.step=0.01] step of offset.\r\n * @param {Object} [settings.PCOptions.settings={}] time settings.\r\n * @param {Object} [settings.PCOptions.settings.offset=1]\r\n */\r\nclass FolderPoint {\r\n\r\n\tconstructor( point, setSize, options, settings = {} ) {\r\n\r\n\t\tconst dat = three.dat;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'FolderPoint: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tconst gui = settings.folder || options.dat.gui;\r\n\t\tif ( !gui || options.dat.folderPoint === false )\r\n\t\t\treturn;\r\n\r\n\t\toptions.dat.folderPoint = this;\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tpointSettings: 'Point',\r\n\r\n\t\t\tsize: 'Size',\r\n\t\t\tsizeTitle: 'Size of the point with \"ShaderMaterial\" material',\r\n\r\n\t\t\tdefaultButton: 'Default',\r\n\t\t\tdefaultPointTitle: 'Restore point.',\r\n\r\n\t\t};\r\n\r\n\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\t\t\t\tlang.pointSettings = 'Точка';\r\n\r\n\t\t\t\tlang.size = 'Размер';\r\n\t\t\t\tlang.sizeTitle = 'Размер точки с материалом типа \"ShaderMaterial\"';\r\n\r\n\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\tlang.defaultPointTitle = 'Восстановить точку';\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\t\tconst defaultPoint = settings.defaultPoint || {};\r\n\t\tif ( defaultPoint.size === undefined ) defaultPoint.size = point.size;\r\n\r\n\t\tconst PCOptions = settings.PCOptions || {};\r\n\r\n\t\tif ( PCOptions.min === undefined ) PCOptions.min = 0.01;\r\n\t\tif ( PCOptions.max === undefined ) PCOptions.max = 1;\r\n\t\tPCOptions.settings = PCOptions.settings || {};\r\n\t\tif ( PCOptions.settings.offset === undefined ) PCOptions.settings.offset = 1;//0.1;\r\n\t\tif ( PCOptions.step === undefined ) PCOptions.step = 0.01;\r\n\t\tPCOptions.getLanguageCode = PCOptions.getLanguageCode || settings.getLanguageCode || options.getLanguageCode;\r\n\r\n\t\tvar fPoint = gui.addFolder( lang.pointSettings ),\r\n\t\t\tfSize = fPoint.addFolder( lang.size );\r\n\t\tdat.folderNameAndTitle( fSize, lang.size, lang.sizeTitle );\r\n\t\tthis.display = function ( display ) { fPoint.domElement.style.display = display; }\r\n\r\n\t\tfSize.add( new PositionController( function ( shift ) { setSize( point.size + shift ); }, PCOptions ) );\r\n\r\n\t\t//size\r\n\t\tthis.size = dat.controllerZeroStep( fSize, point, 'size', function ( value ) {\r\n\r\n\t\t\tsetSize( value );\r\n\r\n\t\t} );\r\n\t\tdat.controllerNameAndTitle( this.size, lang.size, lang.sizeTitle );\r\n\r\n\t\t//point default button\r\n\t\tdat.controllerNameAndTitle( fPoint.add( {\r\n\r\n\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\tsetSize( defaultPoint.size );\r\n\r\n\t\t\t},\r\n\r\n\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultPointTitle );\r\n\r\n\t}\r\n\r\n}\r\nexport default FolderPoint;","/**\r\n * frustumPoints\r\n * \r\n * Array of points, statically fixed in front of the camera.\r\n * I use frustumPoints for displaying of the clouds around points.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n//import MyThree from '../myThree/myThree.js';\r\nimport MyPoints from '../myPoints/myPoints.js';\r\n\r\nimport clearThree from '../clearThree.js';\r\n//import { dat } from '../dat/dat.module.js';\r\n\r\nimport { getWorldPosition } from '../getPosition.js';\r\n\r\nimport three from '../three.js'\r\nimport FolderPoint from '../folderPoint.js'\r\n\r\n//memory limit\r\n//import roughSizeOfObject from '../../commonNodeJS/master/SizeOfObject.js';\r\n\r\nimport Options from '../Options.js'\r\n\r\nvar debug = {\r\n\r\n\tnotHiddingFrustumPoints: true, //Точки не скрываются когда пересчитываются их координаты когда пользователь поворачивает сцену\r\n\t//notMoveFrustumPoints: true,//Точки двигаются относительно камеры вместе с остальными 3D объектами когда пользователь поворачивает сцену\r\n\t//linesiInMono: true,//Возможность показать линии в отсутсвии стерео режима\r\n\r\n};\r\n//Standard normal distributionю. Нормальное распределение\r\n//https://en.wikipedia.org/wiki/Normal_distribution\r\nfunction getStandardNormalDistribution( x ) {\r\n\r\n\tconst standardDeviation = 0.1;//чем больше среднеквадратическое отклонение, тем шире пик нормального распределения\r\n\tconst res = Math.exp( -0.5 * x * x / ( standardDeviation * standardDeviation ) );// / Math.sqrt( 2 * Math.PI );\r\n\t//console.warn( 'x = ' + x + ' y = ' + res );\r\n\treturn res;\r\n\r\n}\r\n\r\nclass FrustumPoints\r\n{\r\n\t/**\r\n\t * Create a `FrustumPoints` instance.\r\n\t * @param {THREE.PerspectiveCamera} camera [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}\r\n\t * @param {THREE.Group} group [group]{@link https://threejs.org/docs/index.html?q=Gro#api/en/objects/Group} of objects to which a new FrustumPoints will be added\r\n\t * @param {DOM} canvas The Graphics [Canvas]{@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/canvas} element to draw graphics and animations.\r\n\t * @param {object} [settings={}] the following settings are available\r\n\t * @param {Options} [settings.options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean|OrbitControls} [settings.options.orbitControls] <pre>false - do not add the [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}. Allow the camera to orbit around a target.\r\n\t * Or <b>OrbitControls</b> instance.\r\n\t * </pre>\r\n\t * @param {object} [settings.options.dat] use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * See <b>options.dat</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {object} [settings.options.scales] axes scales.\r\n\t * See <b>options.scales</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean|GuiSelectPoint} [settings.options.guiSelectPoint] <pre>false - do not displays the <a href=\"../../guiSelectPoint/jsdoc/module-GuiSelectPoint.html\" target=\"_blank\">Select Point</a>. [dat.gui]{@link https://github.com/dataarts/dat.gui} based graphical user interface for select a point from the mesh.\r\n\t * Or <b>GuiSelectPoint</b> instance.\r\n\t * </pre>\r\n\t * @param {object} [settings.options.raycaster] for [Raycaster]{@link https://threejs.org/docs/index.html#api/en/core/Raycaster}.\r\n\t * @param {MyThree.ColorPicker.palette|boolean|number} [settings.options.palette] Points сolor.\r\n\t * See <b>options.palette</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {Function|string} [settings.options.getLanguageCode=language code of your browser] Your custom <b>getLanguageCode()</b> function or language code string.\r\n\t * See <b>options.getLanguageCode</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean|AxesHelper} [settings.options.axesHelper] <pre>false - do not add the <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t * Or <b>AxesHelper</b> instance.\r\n\t * </pre>\r\n\t * @param {object} [settings.options.frustumPoints] <b>FrustumPoints</b> options. undefined - do not create a <b>FrustumPoints</b> instance.\r\n\t * @param {object} [settings.options.frustumPoints.point={}] points options.\r\n\t * @param {number} [settings.options.frustumPoints.point.size=0] Size of each frustum point.\r\n\t * @param {boolean} [settings.options.frustumPoints.display=true] true - display frustum points.\r\n\t * @param {boolean} [settings.options.frustumPoints.info=false] true - display information about frustum point if user move mouse over or click this point.\r\n\t *\r\n\t * @param {object} [settings.options.frustumPoints.stereo] stereo mode options\r\n\t * @param {number} [settings.options.frustumPoints.stereo.hide=0] Hide the nearby to the camera points in percentage to all points for more comfortable visualisation.\r\n\t * @param {number} [settings.options.frustumPoints.stereo.opacity=0.3] Float in the range of 0.0 - 1.0 indicating how transparent the lines is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t *\r\n\t * @param {number} [settings.options.frustumPoints.zCount=50] The count of layers of the frustum of the camera's field of view.\r\n\t * @param {number} [settings.options.frustumPoints.yCount=30] The count of vertical points for each z level of the  frustum of the camera's field of view.\r\n\t *\r\n\t * @param {number} [settings.options.frustumPoints.near=0] Shift of the frustum layer near to the camera in percents.\r\n\t * <pre>\r\n\t * 0 percents - no shift.\r\n\t * 100 percents - ближний к камере слой усеченной пирамиды приблизился к дальнему от камеры слою усеченной пирамиды.\r\n\t * </pre>\r\n\t * @param {number} [settings.options.frustumPoints.far=0] Shift of the frustum layer far to the camera in percents.\r\n\t * <pre>\r\n\t * 0 percents - no shift.\r\n\t * 100 percents - дальний от камеры слоем усеченной пирамиды приблизился к ближнему к камере слою усеченной пирамиды.\r\n\t * </pre>\r\n\t * @param {number} [settings.options.frustumPoints.base=100] Scale of the base of the frustum points in percents.\r\n\t * <pre>\r\n\t * 0 base is null\r\n\t * 100 no scale\r\n\t * </pre>\r\n\t * @param {boolean} [settings.options.frustumPoints.square=false] true - Square base of the frustum points.\r\n\t */\r\n\tconstructor( camera, group, canvas, settings = {} ) {\r\n\r\n\t\tconst THREE = three.THREE;\r\n\t\tsettings.options = settings.options || new Options();\r\n\t\tconst options = settings.options;\r\n\t\tif ( !options.boOptions ) {\r\n\r\n\t\t\tconsole.error( 'FrustumPoints: call options = new Options( options ) first' );\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\t\tif ( !options.frustumPoints ) return;\r\n\r\n\t\t//Непонятно почему frustumPoints не видны если не выполнить эту команду\r\n\t\t//https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/webglcontextlost_event\r\n\t\tthis.gl = canvas.getContext('webgl');\r\n\r\n\t\tthis.getOptions = function () { return options; }\r\n\t\tconst optionsShaderMaterial = options.frustumPoints;\r\n\t\toptions.frustumPoints = this;\r\n\r\n\t\tconst _arrayCloud = []//Массив координат точек, имеющих облако вокруг себя\r\n\t\t\t\t\t\t\t//координаты точек сгруппированы в группы отдельно для каждого THREE.Points\r\n\t\tvar _guiSelectPoint, _names, _points;\r\n\t\t_arrayCloud.getCloudsCount = function () {\r\n\r\n\t\t\tvar count = 0;\r\n\t\t\tfor ( var i = 0; i < _arrayCloud.length; i++ ) {\r\n\r\n\t\t\t\tvar arrayVectors = _arrayCloud[i];\r\n\t\t\t\tcount += arrayVectors.length;\r\n\r\n\t\t\t}\r\n\t\t\treturn count;\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Pushes to clouds array all points from <b>geometry.attributes.position</b>\r\n\t\t * @param {THREE.BufferGeometry|THREE.Points} geometry [THREE.BufferGeometry]{@link https://threejs.org/docs/index.html?q=BufferGeometry#api/en/core/BufferGeometry}\r\n\t\t * or [THREE.Points]{@link https://threejs.org/docs/index.html?q=Poin#api/en/objects/Points}\r\n\t\t * @returns index of the new array item\r\n\t\t */\r\n\t\tthis.pushArrayCloud = function ( geometry ) {\r\n\r\n\t\t\tvar points;\r\n\t\t\tif ( geometry.geometry ) {\r\n\r\n\t\t\t\tpoints = geometry;\r\n\t\t\t\tgeometry = geometry.geometry;\r\n\r\n\t\t\t}\r\n\t\t\tif ( geometry.attributes.position.itemSize !== 4 ) {\r\n\r\n\t\t\t\tconsole.error( 'FrustumPoints.pushArrayCloud: Invalid geometry.attributes.position.itemSize = ' + geometry.attributes.position.itemSize );\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\t//Массив точек, имеющих облако _arrayCloud, разбил на группы points\r\n\t\t\t//В каждой группе points содержатся все точки, из одного mesh\r\n\t\t\t//Это сделал потому что если одновременно имеются точки с \r\n\t\t\t// shaderMaterial и без shaderMaterial, то порядок добавления точек в _arrayCloud\r\n\t\t\t// Не совпадает с порядком расположения mesh в group\r\n\t\t\t// потому что точки без shaderMaterial добавляются сразу после создания\r\n\t\t\t// а точки с shaderMaterial добаляются только после вызова loadShaderText в function getShaderMaterialPoints\r\n\t\t\tconst index = _arrayCloud.getCloudsCount(),\r\n\t\t\t\tarrayPoints = [];\r\n\t\t\t_arrayCloud.push( arrayPoints );\r\n\t\t\tfor ( var i = 0; i < geometry.attributes.position.count; i++ ) {\r\n\r\n\t\t\t\tconst point = new THREE.Vector4().fromArray( geometry.attributes.position.array, i * geometry.attributes.position.itemSize );\r\n\r\n\t\t\t\t//Здесь коррекитровка point.w не имеет эффекта. Она коррекитруется в FrustumPoints.cloud.updateMesh\r\n//\t\t\t\tpoint.w *= options.scales.w.max;\r\n\r\n\t\t\t\tarrayPoints.push( point );\r\n\r\n\t\t\t}\r\n\t\t\tif ( points ) points.userData.cloud = { indexArray: index, }\r\n\t\t\treturn index;\r\n\r\n\t\t}\r\n\r\n\t\t/** create points\r\n\t\t * @param {THREE.WebGLRenderer} renderer [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}.\r\n\t\t */\r\n\t\tthis.create = function ( renderer ) {\r\n\r\n\t\t\t//если нет точек с облаком, то облако нужно создавать что бы его было видно в guiSelectPoint\r\n\t\t\t//однако в этом случае в консоли появятся сообщения:\r\n\t\t\t//\r\n\t\t\t//warning X3557: loop only executes for 0 iteration(s), consider removing [loop]\r\n\t\t\t//warning X3557: loop doesn't seem to do anything, consider removing [loop]\r\n\t\t\t//WebGL: INVALID_OPERATION: texImage2D: ArrayBufferView not big enough for request\r\n\t\t\t//\r\n\t\t\t//Это означает что из D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\frustumPoints\\vertex.c\r\n\t\t\t//нужно удалить цикл\r\n\t\t\t//for ( float i = 0.; i < cloudPointsWidth; i++ )\r\n\t\t\t//\r\n\t\t\tif ( _arrayCloud.length === 0 )\r\n\t\t\t\treturn undefined;//нет точек с облаком. Поэтому нет смысла создавать frustumPoints\r\n\r\n\t\t\tconst shaderMaterial = {}, zeroPoint = new THREE.Vector3(), cameraDistanceDefault = camera.position.distanceTo( zeroPoint ), _this = this,// lines = []\r\n\t\t\t\tgroupFrustumPoints = new THREE.Group();\r\n\r\n\t\t\tsettings.optionsShaderMaterial = settings.optionsShaderMaterial || {};\r\n\r\n\t\t\toptionsShaderMaterial.point = optionsShaderMaterial.point || {};\r\n\t\t\toptionsShaderMaterial.point.size = optionsShaderMaterial.point.size || 0.01;//Size of each frustum point\r\n\r\n\t\t\toptionsShaderMaterial.display = optionsShaderMaterial.display === undefined ? true : optionsShaderMaterial.display;//true - display frustum points\r\n\t\t\toptionsShaderMaterial.info = optionsShaderMaterial.info !== undefined ? optionsShaderMaterial.info : false;//true - display information about frustum point if user move mouse over or click this point.\r\n\r\n\t\t\t//Stereo\r\n\t\t\toptionsShaderMaterial.stereo = optionsShaderMaterial.stereo || {};\r\n\t\t\toptionsShaderMaterial.stereo.hide = optionsShaderMaterial.stereo.hide || 0;//Hide the nearby to the camera points in percentage to all points for more comfortable visualisation.\r\n\t\t\toptionsShaderMaterial.stereo.opacity = optionsShaderMaterial.stereo.opacity || 0.3;//Float in the range of 0.0 - 1.0 indicating how transparent the lines is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.'\r\n\r\n\t\t\toptionsShaderMaterial.zCount = optionsShaderMaterial.zCount || 50;//The count of layers of the frustum of the camera's field of view.\r\n\t\t\toptionsShaderMaterial.yCount = optionsShaderMaterial.yCount || 30;//The count of vertical points for each z level of the  frustum of the camera's field of view.\r\n\r\n\t\t\t//изменение размеров усеченной пирамиды FrustumPoints\r\n\r\n\t\t\toptionsShaderMaterial.near = optionsShaderMaterial.near || 0;//Shift of the frustum layer near to the camera in percents.\r\n\t\t\t//0 percents - no shift.\r\n\t\t\t//100 percents - ближний к камере слой усеченной пирамиды приблизился к дальнему от камеры слою усеченной пирамиды\r\n\t\t\toptionsShaderMaterial.far = optionsShaderMaterial.far || 0;//Shift of the frustum layer far to the camera in percents.\r\n\t\t\t//0 percents - no shift.\r\n\t\t\t//100 percents - дальний от камеры слоем усеченной пирамиды приблизился к ближнему к камере слою усеченной пирамиды\r\n\t\t\toptionsShaderMaterial.base = optionsShaderMaterial.base || 100;//Scale of the base of the frustum points in percents.\r\n\t\t\t//0 base is null\r\n\t\t\t//100 no scale\r\n\t\t\toptionsShaderMaterial.square = optionsShaderMaterial.square !== undefined ? optionsShaderMaterial.square : false; //true - Square base of the frustum points.\r\n\r\n\t\t\tconst cookie = options.dat.cookie,\r\n\t\t\t\tcookieName = options.dat ? options.dat.getCookieName( 'FrustumPoints' ) : 'FrustumPoints';\r\n\r\n\t\t\tObject.freeze( optionsShaderMaterial );\r\n\t\t\tif ( cookie ) cookie.getObject( cookieName, shaderMaterial, optionsShaderMaterial );\r\n\r\n\t\t\t//оставить shaderMaterial.stereo по умолчанию потому что сейчас lines не использую\r\n\t\t\t//и возможно в cookie сохранились зачения shaderMaterial.stereo от старых версий этой программы\r\n\t\t\t//\t\tshaderMaterial.stereo.lines = optionsShaderMaterial.stereo.lines;\r\n\t\t\tif ( shaderMaterial.stereo ) {\r\n\r\n\t\t\t\tshaderMaterial.stereo.hide = optionsShaderMaterial.stereo.hide;\r\n\t\t\t\tshaderMaterial.stereo.opacity = optionsShaderMaterial.stereo.opacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar cloud = function () {\r\n\r\n\t\t\t\tvar uniforms;\r\n\t\t\t\tvar distanceTableWidth;//distanceTable points count\r\n\t\t\t\tthis.create = function ( _uniforms ) {\r\n\r\n\t\t\t\t\tuniforms = _uniforms;\r\n\r\n\t\t\t\t\t//индекс палитры надо пересчитывать в зависимости от min and max key of the options.scales.w\r\n\t\t\t\t\t//В D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\frustumPoints\\vertex.c\r\n\t\t\t\t\t//сначала вычисляется paletteIndex,\r\n\t\t\t\t\t//который равен сумме индексов цветов всех точек cloudPoint.w \r\n\t\t\t\t\t//помноженное на растояние fDistance от точки имеющей облако до текущей точки frustumPoint.\r\n\t\t\t\t\t//Индексы cloudPoint.w находятся в диапазоне min and max key of the options.scales.w\r\n\t\t\t\t\t//paletteIndex это координата x в палитре palette в D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\frustumPoints\\vertex.c\r\n\t\t\t\t\t//которая имеет тип sampler2D https://www.khronos.org/opengl/wiki/Sampler_(GLSL)#Sampler_types\r\n\t\t\t\t\t//которая имеет текстуру 2D texture.\r\n\t\t\t\t\t//Диапазон paletteIndex должен быть в предплах от 0 до 1 https://www.khronos.org/opengl/wiki/Sampler_(GLSL)#Texture_coordinates\r\n\t\t\t\t\t//Получаем пропорции:\r\n\t\t\t\t\t//Если w = options.scales.w.min то paletteIndex = 0.\r\n\t\t\t\t\t//Если w = options.scales.w.max то paletteIndex = 1.\r\n\t\t\t\t\tif ( !options.scales.w ) options.scales.setW();\r\n\t\t\t\t\tconst max = options.scales.w.max, min = options.scales.w.min;\r\n\t\t\t\t\t//w = ( w - min ) / ( max - min ) = w / ( max - min ) - min / ( max - min ) = w / (1+1) + 1 / (1+1) = w * 0.5 + 0.5 ;\r\n\t\t\t\t\tuniforms.paletteA = { value: 1 / ( max - min ) };//0.5 };\r\n\t\t\t\t\tuniforms.paletteB = { value: - min / ( max - min ) };//0.5 };\r\n\r\n\t\t\t\t\t//array of all points with cloud\r\n\t\t\t\t\tthis.cloudPoints = new this.addUniforms( THREE.RGBAFormat, _arrayCloud.getCloudsCount(), 'cloudPoints' );\r\n\r\n\t\t\t\t\t//function of distance between points. Use for creating of the cloud around point\r\n\t\t\t\t\t//distanceTable is THREE.DataTexture\r\n\t\t\t\t\t//\twidth = distanceTableWidth( distanceTable points count )\r\n\t\t\t\t\t//\theight = 2\r\n\t\t\t\t\t//THREE.DataTexture contains two lines:\r\n\t\t\t\t\t//\tEvery line have x from 0 to width - 1\r\n\t\t\t\t\t//\tFirst line (y = 0) is function of distance\r\n\t\t\t\t\t//\tSecond line (y = 1) is distance from cloud point to frustum point\r\n\t\t\t\t\t//Такая структура distanceTable позволяет неравномерно распределять точки по дистанции\r\n\t\t\t\t\t//Если function of distance меняется быстро, то надо наставить побольше точек\r\n\t\t\t\t\t//Если function of distance почти не меняется, точек можно поставить поменьше\r\n\t\t\t\t\t//Это позволит поставить последнюю точку на достаточно большой дистанции\r\n\t\t\t\t\t//и таким образом можно учитывать малое влияние облака на большом расстоянии.\r\n\t\t\t\t\tdistanceTableWidth = 256;//distanceTable points count\r\n\t\t\t\t\tconst pointLength = 2;//Every point contains two coordinates\r\n\t\t\t\t\tnew this.addUniforms( THREE.LuminanceFormat,//RGFormat,//RGBFormat,\r\n\t\t\t\t\t\tdistanceTableWidth, 'distanceTable', {\r\n\r\n\t\t\t\t\t\theight: pointLength,\r\n\t\t\t\t\t\tonReady: function ( data, itemSize, updateItem ) {\r\n\r\n\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t//var linePoints = [];\r\n\t\t\t\t\t\t\t////////////////////////////\r\n\t\t\t\t\t\t\tvar fDistancePrev, x = 0;\r\n\t\t\t\t\t\t\tconst dDistanceMax = 0.035;\r\n\t\t\t\t\t\t\tvar dx = 0.5 / ( distanceTableWidth - 1 ); const ddx = 1.001;\r\n\t\t\t\t\t\t\t//dx = 0.00196078431372549\r\n\t\t\t\t\t\t\t//ddx\txmax\r\n\t\t\t\t\t\t\t//1.001\t0.5686435272529023 y = 9.515363374066325e-8\r\n\t\t\t\t\t\t\t//var dx = 1.5 / ( distanceTableWidth - 1 ); const ddx = 1.001;\r\n\t\t\t\t\t\t\t//dx = 0.0058823529411764705\r\n\t\t\t\t\t\t\t//ddx\txmax\r\n\t\t\t\t\t\t\t//1.001\t1.686899158126089 y = 1.614196454247848e-62\r\n\t\t\t\t\t\t\t//1.01\t5.688013140820184\r\n\t\t\t\t\t\t\t//1.05\t11783.008823594038\r\n\t\t\t\t\t\t\t//1.1\t285390429.9744771\r\n\t\t\t\t\t\t\t//var dx = 2/ ( distanceTableWidth - 1 ); const ddx = 1.001;\r\n\t\t\t\t\t\t\t//dx = 0.00784313725490196\r\n\t\t\t\t\t\t\t//ddx\txmax\r\n\t\t\t\t\t\t\t//1.001\t2.2149519380160148 y = 2.932926014021469e-107\r\n\t\t\t\t\t\t\t//1.01\t7.0082200110085715\r\n\t\t\t\t\t\t\t//1.05\t12925.219146819716\r\n\t\t\t\t\t\t\t//1.1\t314479812.6420277\r\n\t\t\t\t\t\t\t//var dx = 20/ ( distanceTableWidth - 1 ); const ddx = 1.1;\r\n\t\t\t\t\t\t\t//dx = 0.0784313725490196\r\n\t\t\t\t\t\t\t//ddx\txmax\r\n\t\t\t\t\t\t\t//1.001\t22.56677751344284 y = 0\r\n\t\t\t\t\t\t\t//1.1\t11942365647.747343 y = 0\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < distanceTableWidth; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tvar fDistance = getStandardNormalDistribution( x );\r\n\t\t\t\t\t\t\t\t//console.warn( 'dx = ' + dx );\r\n\t\t\t\t\t\t\t\tx += dx;\r\n\t\t\t\t\t\t\t\tif ( fDistancePrev !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( Math.abs( fDistancePrev - fDistance ) > dDistanceMax )\r\n\t\t\t\t\t\t\t\t\t\tdx /= ddx;\r\n\t\t\t\t\t\t\t\t\telse dx *= ddx;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tfDistancePrev = fDistance;\r\n\r\n\t\t\t\t\t\t\t\tupdateItem( i, fDistance );//function of distance\r\n\t\t\t\t\t\t\t\tupdateItem( i + distanceTableWidth, x );//distance from cloud point to frustum point\r\n\r\n\t\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t\t//if ( linePoints !== undefined )\r\n\t\t\t\t\t\t\t\t//\tlinePoints.push( new THREE.Vector3( x, fDistance, 0 ) );\r\n\t\t\t\t\t\t\t\t////////////////////////////\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\tif ( linePoints !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t//group.add( new THREE.Line( new THREE.BufferGeometry().setFromPoints( linePoints ), new THREE.LineBasicMaterial( {\r\n\t\t\t\t\t\t\t\t//\tcolor: 0x0000ff\r\n\t\t\t\t\t\t\t\t//} ) ) );\r\n\t\t\t\t\t\t\t\tgroup.add( new THREE.Points( new THREE.BufferGeometry().setFromPoints( linePoints ),\r\n\t\t\t\t\t\t\t\t\tnew THREE.PointsMaterial( { color: 0xffffff, alphaTest: 0.5 } ) ) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t////////////////////////////\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.addUniforms = function ( format, width, key, optionsAddUniforms ) {\r\n\r\n\t\t\t\t\toptionsAddUniforms = optionsAddUniforms || {};\r\n\t\t\t\t\t//format = RGBAFormat,//LuminanceFormat,//Available formats https://threejs.org/docs/index.html#api/en/constants/Textures\r\n\t\t\t\t\t//D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\three.js\\dev\\src\\constants.js\r\n\t\t\t\t\tconst itemSize = format === THREE.RGBAFormat ? 4 : format === THREE.RGBFormat ? 3 : format === THREE.LuminanceFormat ? 1 : NaN;\r\n\t\t\t\t\tconst height = optionsAddUniforms.height || 1,//format === THREE.LuminanceFormat ? 1 : 2,\r\n\t\t\t\t\t\tsize = width * height,\r\n\t\t\t\t\t\ttype = THREE.FloatType,\r\n\t\t\t\t\t\tdata = type === THREE.FloatType ? new Float32Array( itemSize * size ) : new Uint8Array( itemSize * size );\r\n\t\t\t\t\t/*Uncaught TypeError: Right-hand side of 'instanceof' is not callable\r\n\t\t\t\t\tif( !this instanceof cloud )\r\n\t\t\t\t\t\tconsole.error('');\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tif ( this.addUniforms !== undefined )\r\n\t\t\t\t\t\tconsole.error( 'Please use \"new this.addUniforms(...)\"' );\r\n\t\t\t\t\tthis.updateItem = function ( i, vector ) {\r\n\r\n\t\t\t\t\t\tvar x, y, z, w;\r\n\t\t\t\t\t\tif ( typeof vector === \"number\" )\r\n\t\t\t\t\t\t\tx = vector;\r\n\t\t\t\t\t\telse if ( vector.x === undefined ) {\r\n\r\n\t\t\t\t\t\t\tx = vector.r;\r\n\t\t\t\t\t\t\ty = vector.g;\r\n\t\t\t\t\t\t\tz = vector.b;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tw = 1//remove warning : THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tx = vector.x;\r\n\t\t\t\t\t\t\ty = vector.y;\r\n\t\t\t\t\t\t\tz = vector.z;\r\n\t\t\t\t\t\t\tif ( isNaN( vector.w ) )\r\n\t\t\t\t\t\t\t\tconsole.error( 'frustumPoints.create.cloud.addUniforms.updateItem: vector.w = ' + vector.w + '. Probably you use THREE.Color for w coordinate of the point with cloud.' );\r\n\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t//w это координата x в палитре palette в D:\\My documents\\MyProjects\\webgl\\three.js\\GitHub\\commonNodeJS\\master\\frustumPoints\\vertex.c\r\n\t\t\t\t\t\t\t//которая имеет тип sampler2D https://www.khronos.org/opengl/wiki/Sampler_(GLSL)#Sampler_types\r\n\t\t\t\t\t\t\t//которая имеет текстуру 2D texture.\r\n\t\t\t\t\t\t\t//Диапазон w должен быть в предплах от 0 до 1 https://www.khronos.org/opengl/wiki/Sampler_(GLSL)#Texture_coordinates\r\n\t\t\t\t\t\t\t//Получаем пропорции:\r\n\t\t\t\t\t\t\t//Если vector.w = options.scales.w.min то w = 0.\r\n\t\t\t\t\t\t\t//Если vector.w = options.scales.w.max то w = 1.\r\n\t\t\t\t\t\t\tconst max = options.scales.w.max, min = options.scales.w.min;\r\n\t\t\t\t\t\t\tw = ( vector.w - min ) / ( max - min );\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tw = vector.w;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst vectorSize = y === undefined ? 1 : z === undefined ? 2 : w === undefined ? 3 : 4,\r\n\t\t\t\t\t\t\tstride = i * itemSize;\r\n\t\t\t\t\t\tif ( vectorSize !== itemSize )\r\n\t\t\t\t\t\t\tconsole.error( 'frustumPoints.create.cloud.addUniforms.updateItem: vectorSize = ' + vectorSize + ' !== itemSize = ' + itemSize );\r\n\t\t\t\t\t\tdata[stride] = x;\r\n\t\t\t\t\t\tif ( itemSize > 1 ) {\r\n\r\n\t\t\t\t\t\t\tdata[stride + 1] = y;\r\n\t\t\t\t\t\t\tif ( itemSize > 2 ) {\r\n\r\n\t\t\t\t\t\t\t\tdata[stride + 2] = z;\r\n\t\t\t\t\t\t\t\tif ( itemSize > 3 )\r\n\t\t\t\t\t\t\t\t\tdata[stride + 3] = w;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( optionsAddUniforms.onReady !== undefined )\r\n\t\t\t\t\t\toptionsAddUniforms.onReady( data, itemSize, this.updateItem );\r\n\r\n\t\t\t\t\tuniforms[key] = {\r\n\r\n\t\t\t\t\t\tvalue: new THREE.DataTexture( data,\r\n\t\t\t\t\t\t\twidth, height, format, type )\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\t\tuniforms[key].value.needsUpdate = true;\r\n\r\n\t\t\t\t\treturn itemSize;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.editShaderText = function ( shaderText ) {\r\n\r\n\t\t\t\t\tvar scloudPointsWidth = 0;\r\n\t\t\t\t\tfor ( var i = 0; i < _arrayCloud.length; i++ ) {\r\n\r\n\t\t\t\t\t\tvar arrayVectors = _arrayCloud[i];\r\n\t\t\t\t\t\tscloudPointsWidth += arrayVectors.length;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tshaderText.vertex = shaderText.vertex.replace( '%scloudPointsWidth', scloudPointsWidth + '.' );\r\n\t\t\t\t\tshaderText.vertex = shaderText.vertex.replace( '%distanceTableWidth', distanceTableWidth + '.' );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis.updateMesh = function ( mesh ) {\r\n\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\t( mesh.userData.cloud === undefined )\r\n\t\t\t\t\t\t|| !this.cloudPoints//Пользователь убрал галочку в 'Display' - 'Display or hide Frustum Points.'\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tfor ( var i = 0; i < mesh.geometry.attributes.position.count; i++ ) {\r\n\r\n\t\t\t\t\t\tconst point = new THREE.Vector4().fromArray( mesh.geometry.attributes.position.array, i * mesh.geometry.attributes.position.itemSize );\r\n\t\t\t\t\t\tthis.cloudPoints.updateItem( mesh.userData.cloud.indexArray + i, getWorldPosition( mesh, point ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\t\t\tcloud = new cloud();\r\n\t\t\tgroup.add( groupFrustumPoints );\r\n\r\n\t\t\tfunction setPointsParams() {\r\n\r\n\t\t\t\tfunction set() {\r\n\r\n\t\t\t\t\tif ( !_points )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t_points.position.copy( camera.position );\r\n\t\t\t\t\t_points.rotation.set( camera.rotation.x, camera.rotation.y, camera.rotation.z );\r\n\t\t\t\t\tvar scale = camera.position.distanceTo( zeroPoint ) / cameraDistanceDefault;\r\n\t\t\t\t\t_points.scale.x = scale;\r\n\t\t\t\t\t_points.scale.y = scale;\r\n\t\t\t\t\t_points.scale.z = scale;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tset();\r\n\t\t\t\t/*\r\n\t\t\t\tconsole.warn( '_points.position: ' + _points.position.x + ' ' + _points.position.y + ' ' + _points.position.z +\r\n\t\t\t\t' _points.scale: ' + _points.scale.x + ' ' + _points.scale.y + ' ' + _points.scale.z +\r\n\t\t\t\t' _points.rotation: ' + _points.rotation.x + ' ' + _points.rotation.y + ' ' + _points.rotation.z );\r\n\t\t\t\t*/\r\n\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.setMesh();\r\n\r\n\t\t\t}\r\n\t\t\tfunction update( onReady ) {\r\n\r\n\t\t\t\tif ( _points === undefined ) {\r\n\r\n\t\t\t\t\tprogress( onReady );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * The user has moved the camera\r\n\t\t\t * @event\r\n\t\t\t * */\r\n\t\t\tthis.onChangeControls = function () {\r\n\r\n\t\t\t\tif ( !debug.notHiddingFrustumPoints ) {\r\n\r\n\t\t\t\t\t//Updating of the canvas is too slow if FrustumPoints count is very big (about 'Z Count' = 50 and 'Y Count' = 30).\r\n\t\t\t\t\t//I am hidding all points during  changing of the contdrol and show it again after 500 msec for resolving of the problem.\r\n\t\t\t\t\tif ( timeoutControls === undefined ) {\r\n\r\n\t\t\t\t\t\tgroup.remove( _points );\r\n\t\t\t\t\t\tgroup.remove( groupFrustumPoints );\r\n\t\t\t\t\t\toptions.raycaster.removeParticle( _points );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tclearTimeout( timeoutControls );\r\n\t\t\t\t\ttimeoutControls = setTimeout( function () {\r\n\r\n\t\t\t\t\t\tgroup.add( groupFrustumPoints );\r\n\t\t\t\t\t\tif ( shaderMaterial.info )\r\n\t\t\t\t\t\t\toptions.raycaster.addParticle( _points );\r\n\r\n\t\t\t\t\t\tclearTimeout( timeoutControls );\r\n\t\t\t\t\t\ttimeoutControls = undefined;\r\n\r\n\t\t\t\t\t\tif ( !debug.notMoveFrustumPoints ) {\r\n\r\n\t\t\t\t\t\t\t_this.update();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 500 );\r\n\r\n\t\t\t\t} else if ( !debug.notMoveFrustumPoints ) {\r\n\r\n\t\t\t\t\t_this.update();\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tfunction progress( onReady ) {\r\n\r\n\t\t\t\tif ( !shaderMaterial.display )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\tconst cameraPerspectiveHelper = new THREE.CameraHelper( camera );\r\n\r\n\t\t\t\tvar array, indexArray = 0;\r\n\r\n\t\t\t\tfunction getPoint( pointName ) {\r\n\r\n\t\t\t\t\tvar points = cameraPerspectiveHelper.pointMap[pointName],\r\n\t\t\t\t\t\tposition = cameraPerspectiveHelper.geometry.attributes.position;\r\n\t\t\t\t\treturn new THREE.Vector3().fromArray( position.array, points[0] * position.itemSize )\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//near точки ближней к камере плоскости усеченной пирамиды\r\n\t\t\t\tconst point_n1 = getPoint( 'n1' ),\r\n\t\t\t\t\tpoint_n2 = getPoint( 'n2' ),\r\n\t\t\t\t\tpoint_n3 = getPoint( 'n3' );\r\n\r\n\t\t\t\t//far точки основания пирамиды\r\n\r\n\t\t\t\tconst point_f1 = getPoint( 'f1' ),\r\n\t\t\t\t\tpoint_f2 = getPoint( 'f2' ),\r\n\t\t\t\t\tpoint_f3 = getPoint( 'f3' );\r\n\r\n\t\t\t\t//изменение размеров усеченной пирамиды FrustumPoints\r\n\r\n\t\t\t\t//Scale of the base of the frustum points.\r\n\t\t\t\tpoint_n1.x = ( point_n1.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_n2.x = ( point_n2.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_n3.x = ( point_n3.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_n1.y = ( point_n1.y * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_n2.y = ( point_n2.y * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_n3.y = ( point_n3.y * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f1.x = ( point_f1.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f2.x = ( point_f2.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f3.x = ( point_f3.x * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f1.y = ( point_f1.y * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f2.y = ( point_f2.y * shaderMaterial.base ) / 100;\r\n\t\t\t\tpoint_f3.y = ( point_f3.y * shaderMaterial.base ) / 100;\r\n\r\n\t\t\t\t//Square base of the frustum points.\r\n\t\t\t\tif ( shaderMaterial.square ) {\r\n\r\n\t\t\t\t\tpoint_n1.x /= camera.aspect;\r\n\t\t\t\t\tpoint_n2.x /= camera.aspect;\r\n\t\t\t\t\tpoint_n3.x /= camera.aspect;\r\n\t\t\t\t\tpoint_f1.x /= camera.aspect;\r\n\t\t\t\t\tpoint_f2.x /= camera.aspect;\r\n\t\t\t\t\tpoint_f3.x /= camera.aspect;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst pointn1x = point_n1.x, pointn2x = point_n2.x, pointn3x = point_n3.x,\r\n\t\t\t\t\tpointn1y = point_n1.y, pointn2y = point_n2.y, pointn3y = point_n3.y,\r\n\t\t\t\t\tpointn1z = point_n1.z;\r\n\t\t\t\t//Shift of the frustum layer near to the camera\r\n\t\t\t\tpoint_n1.x = point_n1.x + ( ( point_f1.x - point_n1.x ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n2.x = point_n2.x + ( ( point_f2.x - point_n2.x ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n3.x = point_n3.x + ( ( point_f3.x - point_n3.x ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n1.y = point_n1.y + ( ( point_f1.y - point_n1.y ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n2.y = point_n2.y + ( ( point_f2.y - point_n2.y ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n3.y = point_n3.y + ( ( point_f3.y - point_n3.y ) * shaderMaterial.near ) / 100;\r\n\t\t\t\tpoint_n1.z = point_n2.z = point_n3.z = point_n1.z + ( ( point_f1.z - point_n1.z ) * shaderMaterial.near ) / 100;\r\n\t\t\t\t//Shift of the frustum layer far to the camera\r\n\t\t\t\tpoint_f1.x = point_f1.x + ( ( pointn1x - point_f1.x ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f2.x = point_f2.x + ( ( pointn2x - point_f2.x ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f3.x = point_f3.x + ( ( pointn3x - point_f3.x ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f1.y = point_f1.y + ( ( pointn1y - point_f1.y ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f2.y = point_f2.y + ( ( pointn2y - point_f2.y ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f3.y = point_f3.y + ( ( pointn3y - point_f3.y ) * shaderMaterial.far ) / 100;\r\n\t\t\t\tpoint_f1.z = point_f2.z = point_f3.z = point_f1.z + ( ( pointn1z - point_f1.z ) * shaderMaterial.far ) / 100;\r\n\r\n\t\t\t\tconst pointStart = new THREE.Vector3().copy( point_n1 );\r\n\r\n\t\t\t\tfunction sqrtInt( value ) {\r\n\r\n\t\t\t\t\tconst a = parseInt( Math.sqrt( zCount - 1 ) );\r\n\t\t\t\t\treturn parseInt( value / a ) * a;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst zCount = shaderMaterial.zCount,\r\n\t\t\t\t\tzStep = ( point_f1.z - point_n1.z ) / ( ( zCount - 1 ) * ( zCount - 1 ) );\r\n\r\n\t\t\t\t//смещение по оси x\r\n\t\t\t\tvar zx = 0;\r\n\t\t\t\tconst yCount = shaderMaterial.yCount,\r\n\t\t\t\t\txCount = yCount * ( shaderMaterial.square ? 1 : parseInt( camera.aspect ) );\r\n\t\t\t\tvar zy = 0;//смещение по оси y\r\n\r\n\t\t\t\t//You can see the Chrome memory crash if you has set very big shaderMaterial.zCount or  shaderMaterial.yCount. (about 900000).\r\n\t\t\t\t//Unfortunately you cannot to catch memory crash. https://stackoverflow.com/questions/44531357/how-to-catch-and-handle-chrome-memory-crash\r\n\t\t\t\t//Instead I temporary set shaderMaterial.zCount to default value and restore it after creating of all z levels.\r\n\t\t\t\t//Now you can see default shaderMaterial.zCount after memory crash and reloading of the wab page.\r\n\t\t\t\tshaderMaterial.zCount = optionsShaderMaterial.zCount;\r\n\t\t\t\tshaderMaterial.yCount = optionsShaderMaterial.yCount;\r\n\r\n\t\t\t\tconst zStart = parseInt( ( zCount * shaderMaterial.stereo.hide ) / 100 ),\r\n\t\t\t\t\tzEnd = zStart + zCount - 1;\r\n\t\t\t\tfunction Z( z ) {\r\n\r\n\t\t\t\t\t//console.warn( 'z ' + z );\r\n\t\t\t\t\tconst ynStep = ( point_n3.y - point_n1.y ) / ( yCount - 1 ),\r\n\t\t\t\t\t\tyfStep = ( point_f3.y - point_f1.y ) / ( yCount - 1 ),\r\n\t\t\t\t\t\tyStep = ( ( yfStep - ynStep ) / ( ( zCount - 1 ) * ( zCount - 1 ) ) ) * z * z + ynStep,\r\n\t\t\t\t\t\tsqrtZCount = parseInt( Math.sqrt( zCount ) ),\r\n\t\t\t\t\t\tyzStep = yStep / ( sqrtZCount + parseInt( Math.sqrt( zCount - ( sqrtZCount * sqrtZCount ) ) ) ),//координату точки надо немного сдвинуть в зависимости от z что бы точки не накладывались друг на друга\r\n\r\n\t\t\t\t\t\txnStep = ( point_n2.x - point_n1.x ) / ( xCount - 1 ),\r\n\t\t\t\t\t\txfStep = ( point_f2.x - point_f1.x ) / ( xCount - 1 ),\r\n\t\t\t\t\t\txStep = ( ( xfStep - xnStep ) / ( ( zCount - 1 ) * ( zCount - 1 ) ) ) * z * z + xnStep,\r\n\t\t\t\t\t\txzStep = xStep / parseInt( Math.sqrt( zCount ) );//координату точки надо немного сдвинуть в зависимости от z что бы точки не накладывались друг на друга\r\n\t\t\t\t\tpointStart.y = - yStep * ( yCount - 1 ) / 2;\r\n\t\t\t\t\tpointStart.x = - xStep * ( xCount - 1 ) / 2;\r\n\t\t\t\t\tfor ( var y = 0; y < yCount; y++ ) {\r\n\r\n\t\t\t\t\t\tfor ( var x = 0; x < xCount; x++ )\r\n\t\t\t\t\t\t\tif ( z >= zStart ) {\r\n\r\n\t\t\t\t\t\t\t\tfunction addPoint( point ) {\r\n\r\n\t\t\t\t\t\t\t\t\t_names.push(\r\n\r\n\t\t\t\t\t\t\t\t\t\tx === 0 ?\r\n\t\t\t\t\t\t\t\t\t\t\ty === 0 ? { y: y, z: z } : { y: y } :\r\n\t\t\t\t\t\t\t\t\t\t\tx\r\n\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\tarray[indexArray] = point.x;\r\n\t\t\t\t\t\t\t\t\tindexArray++;\r\n\t\t\t\t\t\t\t\t\tarray[indexArray] = point.y;\r\n\t\t\t\t\t\t\t\t\tindexArray++;\r\n\t\t\t\t\t\t\t\t\tarray[indexArray] = point.z;\r\n\t\t\t\t\t\t\t\t\tindexArray++;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\taddPoint( new THREE.Vector3(\r\n\r\n\t\t\t\t\t\t\t\t\tpointStart.x + xStep * x + xzStep * zx,\r\n\t\t\t\t\t\t\t\t\tpointStart.y + yStep * y + yzStep * zy,\r\n\t\t\t\t\t\t\t\t\tpointStart.z + zStep * z * z\r\n\r\n\t\t\t\t\t\t\t\t) );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tzx++;\r\n\t\t\t\t\tif ( zx >= parseInt( Math.sqrt( zCount ) ) ) {\r\n\r\n\t\t\t\t\t\tzx = 0;\r\n\t\t\t\t\t\tzy++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfunction eachZ( zStart, zEnd ) {\r\n\r\n\t\t\t\t\tif ( zStart > zEnd )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tZ( zStart );\r\n\t\t\t\t\tif ( zStart >= zEnd )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tZ( zEnd );\r\n\t\t\t\t\tvar zMid = parseInt( ( zStart + zEnd ) / 2 );\r\n\t\t\t\t\tif ( zMid === zStart )\r\n\t\t\t\t\t\treturn;//for testing set 'Z Count' = 6\r\n\t\t\t\t\tZ( zMid );\r\n\t\t\t\t\teachZ( zStart + 1, zMid - 1 );\r\n\t\t\t\t\teachZ( zMid + 1, zEnd - 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//For Chrome memory crash see above.\r\n\t\t\t\tshaderMaterial.zCount = zCount;\r\n\t\t\t\tshaderMaterial.yCount = yCount;\r\n\r\n\t\t\t\t//если оставить эту строку то когда произойдет переполнение памяти, веб страница вечно будет не открываться\r\n\t\t\t\t//for testing set 'Z Count' = 100 and 'Y count' = 1000\r\n\t\t\t\t//saveSettings();\r\n\r\n\t\t\t\tremovePoints( true );\r\n\r\n\t\t\t\tconst itemSize = 3;\r\n\t\t\t\t_this.pointIndexes = function ( pointIndex ) {\r\n\r\n\t\t\t\t\tif ( _names === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.error( '_names = ' + _names );//сюда попадает в отладочной версии\r\n\t\t\t\t\t\treturn undefined;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name = _names[pointIndex], x, y, z, index = pointIndex;\r\n\t\t\t\t\tfunction getObject() {\r\n\r\n\t\t\t\t\t\tindex--;\r\n\t\t\t\t\t\twhile ( ( index >= 0 ) && ( typeof _names[index] !== \"object\" ) )\r\n\t\t\t\t\t\t\tindex--;\r\n\t\t\t\t\t\tname = _names[index];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfunction getZ() {\r\n\r\n\t\t\t\t\t\twhile ( ( index >= 0 ) && ( name.z === undefined ) )\r\n\t\t\t\t\t\t\tgetObject();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( typeof name === \"object\" ) {\r\n\r\n\t\t\t\t\t\tx = 0;\r\n\t\t\t\t\t\ty = name.y;\r\n\t\t\t\t\t\tgetZ();\r\n\t\t\t\t\t\tz = name.z;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tx = name;\r\n\t\t\t\t\t\tgetObject();\r\n\t\t\t\t\t\ty = name.y;\r\n\t\t\t\t\t\tgetZ();\r\n\t\t\t\t\t\tz = name.z;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn { x: x, y: y, z: z };\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n\t\t\t\t//Такая же функция есть в myPoints.js но если ее использовать то она будет возвращать путь на myPoints.js\r\n\t\t\t\tconst getCurrentScript = function () {\r\n\r\n\t\t\t\t\tif ( document.currentScript && ( document.currentScript.src !== '' ) )\r\n\t\t\t\t\t\treturn document.currentScript.src;\r\n\t\t\t\t\tconst scripts = document.getElementsByTagName( 'script' ),\r\n\t\t\t\t\t\tstr = scripts[scripts.length - 1].src;\r\n\t\t\t\t\tif ( str !== '' )\r\n\t\t\t\t\t\treturn src;\r\n\t\t\t\t\t//Thanks to https://stackoverflow.com/a/42594856/5175935\r\n\t\t\t\t\treturn new Error().stack.match( /(https?:[^:]*)/ )[0];\r\n\r\n\t\t\t\t};\r\n\t\t\t\t//Thanks to https://stackoverflow.com/a/27369985/5175935\r\n\t\t\t\tconst getCurrentScriptPath = function () {\r\n\t\t\t\t\tconst script = getCurrentScript(),\r\n\t\t\t\t\t\tpath = script.substring( 0, script.lastIndexOf( '/' ) );\r\n\t\t\t\t\treturn path;\r\n\t\t\t\t};\r\n\t\t\t\t//console.warn( 'getCurrentScriptPath = ' + getCurrentScriptPath() );\r\n\t\t\t\tvar path = getCurrentScriptPath();\r\n\t\t\t\tvar cameraPositionDefault = new THREE.Vector3( camera.position.x, camera.position.y, camera.position.z );\r\n\t\t\t\tvar cameraQuaternionDefault = new THREE.Vector4( camera.quaternion.x, camera.quaternion.y, camera.quaternion.z, camera.quaternion.w );\r\n\r\n\t\t\t\t//сделал это приравниванеие что бы избежать двойного создания массива точек frustumPoints MyThree.MyPoints(...)\r\n\t\t\t\t//Если это произойдет, то непонятно почему для каждой точки будет создано два облака\r\n\t\t\t\t//Одно облако верное\r\n\t\t\t\t//Второе находится строго между точкой и камерой\r\n\t\t\t\t//Второе облако можно увидеть если повернуть камеру с помощью orbitControl\r\n\t\t\t\t//Сюда попадает по второму разу если вызвать stereoEffect.gui(...)\r\n\t\t\t\t_points = false;\r\n\r\n\t\t\t\tnew MyPoints( function () {\r\n\r\n\t\t\t\t\tvar geometry = new THREE.BufferGeometry(),\r\n\t\t\t\t\t\tgeometryLength = ( zEnd - zStart + 1 ) * xCount * yCount;\r\n\r\n\t\t\t\t\tarray = new Float32Array( geometryLength * itemSize );\r\n\t\t\t\t\tindexArray = 0;\r\n\t\t\t\t\t_names = null;\r\n\t\t\t\t\t_names = [];\r\n\r\n\t\t\t\t\teachZ( zStart, zEnd );\r\n\r\n\t\t\t\t\tgeometry.setAttribute( 'position', new THREE.BufferAttribute( array, itemSize ) );\r\n\r\n\t\t\t\t\treturn geometry;\r\n\r\n\t\t\t\t}, group, {\r\n\r\n\t\t\t\t\toptions: options,\r\n\t\t\t\t\tpointsOptions: {\r\n\r\n\t\t\t\t\t\tname: 'frustum points',\r\n\t\t\t\t\t\tshaderMaterial: shaderMaterial,\r\n\t\t\t\t\t\tboFrustumPoints: true,\r\n\t\t\t\t\t\tposition: camera.position,\r\n\t\t\t\t\t\tscale: camera.scale,\r\n\t\t\t\t\t\trotation: camera.rotation,\r\n\t\t\t\t\t\topacity: true,\r\n\t\t\t\t\t\tpointIndexes: function ( pointIndex ) { return _this.pointIndexes( pointIndex ); },\r\n\t\t\t\t\t\tpath: {\r\n\r\n\t\t\t\t\t\t\tvertex: path + '/frustumPoints/vertex.c',\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpointName: function ( pointIndex ) {\r\n\r\n\t\t\t\t\t\t\tvar indexes = _this.pointIndexes( pointIndex );\r\n\t\t\t\t\t\t\tif ( indexes === undefined )\r\n\t\t\t\t\t\t\t\treturn indexes;\r\n\t\t\t\t\t\t\treturn 'x = ' + indexes.x + ', y = ' + indexes.y + ', z = ' + ( indexes.z + zStart ) + ', i = ' + pointIndex;\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcontrollers: function () {\r\n\r\n\t\t\t\t\t\t\tif ( _guiSelectPoint ) _guiSelectPoint.appendChild( { xCount: xCount, yCount: yCount, zCount: zCount, } );\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tuniforms: function ( uniforms ) {\r\n\r\n\t\t\t\t\t\t\tcloud.create( uniforms );\r\n\r\n\t\t\t\t\t\t\t//rotate the quaternion vector to 180 degrees\r\n\t\t\t\t\t\t\tcameraQuaternionDefault.x = - cameraQuaternionDefault.x;\r\n\t\t\t\t\t\t\tcameraQuaternionDefault.y = - cameraQuaternionDefault.y;\r\n\t\t\t\t\t\t\tcameraQuaternionDefault.z = - cameraQuaternionDefault.z;\r\n\r\n\t\t\t\t\t\t\tcameraPositionDefault.applyQuaternion( cameraQuaternionDefault );\r\n\r\n\t\t\t\t\t\t\tuniforms.cameraPositionDefault = { value: cameraPositionDefault };\r\n\t\t\t\t\t\t\tuniforms.cameraQuaternion = { value: camera.quaternion };\r\n\r\n\t\t\t\t\t\t\t//palette\r\n\t\t\t\t\t\t\t//ВНИМАНИЕ!!! Для того, что бы палитра передалась в vertex надо добавить\r\n\t\t\t\t\t\t\t//points.material.uniforms.palette.value.needsUpdate = true;\r\n\t\t\t\t\t\t\t//в getShaderMaterialPoints.loadShaderText\r\n\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tnew cloud.addUniforms(THREE.RGBAFormat, 256, 'palette', {\r\n\r\n\t\t\t\t\t\t\t\tonReady: function ( data, itemSize, updateItem ) {\r\n\r\n\t\t\t\t\t\t\t\t\toptions.scales.setW();\r\n\t\t\t\t\t\t\t\t\tconst min = options.scales.w.min, max = options.scales.w.max;\r\n\t\t\t\t\t\t\t\t\tconst size = data.length / itemSize;\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < size; i++ )\r\n\t\t\t\t\t\t\t\t\t\tupdateItem( i, options.palette.toColor( ( max - min ) * i / ( size - 1 ) + min, min, max ) );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\treturn cloud;\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonReady: function ( points ) {\r\n\r\n\t\t\t\t\t\t\t_points = points;\r\n\t\t\t\t\t\t\t_points.userData.isInfo = function () { return shaderMaterial.info; }\r\n\r\n\t\t\t\t\t\t\tif ( shaderMaterial.info && options.raycaster )\r\n\t\t\t\t\t\t\t\toptions.raycaster.addParticle( _points );\r\n\r\n\t\t\t\t\t\t\tif ( !shaderMaterial.display )\r\n\t\t\t\t\t\t\t\tremovePoints();\r\n\t\t\t\t\t\t\tpointOpacity = _points === undefined ?\r\n\t\t\t\t\t\t\t\t1.0 :\r\n\t\t\t\t\t\t\t\t_points.userData.shaderMaterial === undefined ? shaderMaterial.point.opacity : _points.userData.shaderMaterial.point.opacity;\r\n\r\n\t\t\t\t\t\t\tif ( onReady !== undefined )\r\n\t\t\t\t\t\t\t\tonReady();//Пользователь изменил настройки frustumPoints\r\n\r\n\t\t\t\t\t\t\t//когда задан параметр cameraTarget у MyThree то нужно передвинуть frustumPoints после того как созданы points\r\n\t\t\t\t\t\t\t_this.update();\r\n\r\n\t\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.addMesh( _points );\r\n\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tupdate();\r\n\t\t\tvar pointOpacity;\r\n\t\t\t/** Moves frustum points in front of the camera. */\r\n\t\t\tthis.update = function ( onReady ) {\r\n\r\n\t\t\t\tupdate( onReady );\r\n\r\n\t\t\t\t//Эта команда нужна в случае изменения размера окна браузера когда canvas на весь экран\r\n\t\t\t\tsetPointsParams();\r\n\r\n\t\t\t\tvar cameraQuaternionDefault = new THREE.Vector4( camera.quaternion.x, camera.quaternion.y, camera.quaternion.z, camera.quaternion.w );\r\n\r\n\t\t\t\tif ( !_points )\r\n\t\t\t\t\treturn;//User has changed 'Z Count' of the frustumPoints\r\n\r\n\t\t\t\t_points.material.uniforms.cameraPositionDefault.value.copy( camera.position );\r\n\r\n\t\t\t\t//rotate the quaternion vector to 180 degrees\r\n\t\t\t\tcameraQuaternionDefault.x = - cameraQuaternionDefault.x;\r\n\t\t\t\tcameraQuaternionDefault.y = - cameraQuaternionDefault.y;\r\n\t\t\t\tcameraQuaternionDefault.z = - cameraQuaternionDefault.z;\r\n\r\n\t\t\t\t_points.material.uniforms.cameraPositionDefault.value.applyQuaternion( cameraQuaternionDefault );\r\n\r\n\t\t\t}\r\n\t\t\t/** \r\n\t\t\t *  @returns true - frustum points is created and visible.\r\n\t\t\t *  <p>false - frustum points have been removed.</p>\r\n\t\t\t * */\r\n\t\t\tthis.isDisplay = function () { return shaderMaterial.display; }\r\n\t\t\t/** Updates the cloud's points according new position of the all points of the all meshes\r\n\t\t\t * of the group of objects to which a new FrustumPoints has been added. */\r\n\t\t\tthis.updateCloudPoints = function () {\r\n\r\n\t\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\t\tif ( !mesh.userData.cloud )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tif ( mesh.geometry.attributes.position.itemSize !== 4 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'mesh.geometry.attributes.position.itemSize = ' + mesh.geometry.attributes.position.itemSize );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcloud.updateMesh( mesh );\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tneedsUpdate();\r\n\r\n\t\t\t}\r\n\t\t\tfunction needsUpdate() {\r\n\r\n\t\t\t\tif ( _points )\r\n\t\t\t\t\t_points.material.uniforms.cloudPoints.value.needsUpdate = true;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * \r\n\t\t\t * @param {THREE.Mesh} mesh [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}\r\n\t\t\t */\r\n\t\t\tthis.updateCloudPoint = function ( mesh ) {\r\n\r\n\t\t\t\tcloud.updateMesh( mesh );\r\n\t\t\t\tneedsUpdate();\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * The user has changed selected point.\r\n\t\t\t * @event\r\n\t\t\t * @param {THREE.Points} points [Points]{@link https://threejs.org/docs/index.html?q=Poin#api/en/objects/Points}\r\n\t\t\t * @param {number} i index of the point from <b>points</b> for udating\r\n\t\t\t */\r\n\t\t\tthis.updateCloudPointItem = function ( points, i ) {\r\n\r\n\t\t\t\tif ( points.userData.cloud === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( points.geometry.attributes.position.itemSize !== 4 )\r\n\t\t\t\t\tconsole.error( 'points.geometry.attributes.position.itemSize = ' + points.geometry.attributes.position.itemSize );\r\n\t\t\t\tcloud.cloudPoints.updateItem( points.userData.cloud.indexArray + i,\r\n\t\t\t\t\tgetWorldPosition( points,\r\n\t\t\t\t\t\tnew THREE.Vector4().fromArray( points.geometry.attributes.position.array, i * points.geometry.attributes.position.itemSize ) ),\r\n\t\t\t\t\ttrue );\r\n\t\t\t\tneedsUpdate();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Convert all points with cloud, but not shaderMaterial from local to world positions\r\n\t\t\t// i.e. calculate scales, positions and rotation of the points.\r\n\t\t\t//Converting of all points with cloud and shaderMaterial see getShaderMaterialPoints function in the myPoints.js file\r\n\t\t\t//\t\tthis.updateCloudPoints();\r\n\r\n\t\t\tfunction removePoints( notRemoveMesh ) {\r\n\r\n\t\t\t\tif ( _points === undefined )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tif ( !notRemoveMesh && options.guiSelectPoint )\r\n\t\t\t\t\toptions.guiSelectPoint.removeMesh( _points );//не удаляю frustumPoints из списка Meshes потому что сюда попадает только если пользователь изменил число точек frustumPoints.\r\n\t\t\t\t//В этом случае создается новый frustumPoints, который надо присоеденить к старому frustumPoints из списка Meshes.\r\n\t\t\t\t//Если я удалю frustumPoints из списка Meshes а потом добавлю туда новый frustumPoints,\r\n\t\t\t\t//то изменится индекс frustumPoints в списке Meshes\r\n\t\t\t\t//и тогда неверно будет выполняться function update() в frustumPoints и как результат буде неверный список Ponts списке Meshes\r\n\t\t\t\t//for testing\r\n\t\t\t\t//Select in the canvas any point, but not frustum point.\r\n\t\t\t\t//Now you can see your selected point in the in the Meshes/Points/Select list in the gui.\r\n\t\t\t\t//Change Settings/Frustum Points/Z count in the gui.\r\n\t\t\t\t//Now your selected point is deselected.\r\n\t\t\t\t//Select in the canvas your point again.\r\n\t\t\t\t//Now yiou can see \"Cannot read property 'selected' of undefined\" error message in the console.\r\n\t\t\t\t//Try to select your point in the gui. You can not to do it because your point is not exists in the Meshes/Points/Select list. Instead you see all Frustum Points in the Meshs/Points/Select list.\r\n\r\n\t\t\t\tgroup.remove( _points );\r\n\t\t\t\trenderer.renderLists.dispose();\r\n\t\t\t\tclearThree( _points );\r\n\t\t\t\t_points = undefined;\r\n\r\n\t\t\t}\r\n\t\t\t/** Called from animate loop for rendering.\r\n\t\t\t * @see {@link https://threejs.org/docs/index.html?q=animate#manual/en/introduction/Creating-a-scene|Rendering the scene}*/\r\n\t\t\tthis.animate = function () {\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t!_points ||\r\n\t\t\t\t\t( _points.userData.shaderMaterial === undefined ) ||\r\n\t\t\t\t\t(\r\n\t\t\t\t\t\t( pointOpacity === _points.userData.shaderMaterial.point.opacity ) )\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tpointOpacity = _points.userData.shaderMaterial.point.opacity;\r\n\t\t\t\t_points.material.uniforms.opacity.value = _points.userData.shaderMaterial.point.opacity;\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/** update \"frustum points\" item in the <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a>.*/\r\n\t\t\tthis.updateGuiSelectPoint = function () {\r\n\r\n\r\n\t\t\t\t//Не помню почему не удаляю старый points из списка cMeshs, но если так делать, то будут какие то запутанные косяки.\r\n\t\t\t\t//Поэтому не удаляю points из списка cMeshs а только получаю индекс points в этом списке.\r\n\t\t\t\tconst index = options.guiSelectPoint ? options.guiSelectPoint.getMeshIndex( _points ) : undefined;\r\n\r\n\t\t\t\tupdate();\r\n\r\n\t\t\t\t//затем заменяю указатель на старый points в списке cMeshs на новый.\r\n\t\t\t\tif ( index ) options.guiSelectPoint.setIndexMesh( index, _points );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t* @callback FolderPoint\r\n\t\t\t* @param {object} folder parent folder\r\n\t\t\t* @param {function} setSettings save points setting to the cookie\r\n\t\t\t*/\r\n\r\n\t\t\t/**\r\n\t\t\t * Adds FrustumPoints folder into dat.GUI.\r\n\t\t\t * See [dat.GUI API]{@link https://github.com/dataarts/dat.gui/blob/master/API.md}.\r\n\t\t\t * @param {object} [folder] parent folder\r\n\t\t\t */\r\n\t\t\tthis.gui = function ( folder ) {\r\n\r\n\t\t\t\tconst dat = three.dat;//options.dat.dat;\r\n\r\n\t\t\t\tfolder = folder || options.dat.gui;\r\n\t\t\t\tif ( !folder || options.dat.guiFrustumPoints === false )\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\tfrustumPoints: 'Frustum Points',\r\n\t\t\t\t\tfrustumPointsTitle: 'A cloud of the fixed points in front of the camera for describe the properties of space.',\r\n\r\n\t\t\t\t\tdisplay: 'Display',\r\n\t\t\t\t\tdisplayTitle: 'Display or hide Frustum Points.',\r\n\r\n\t\t\t\t\tinfo: 'Information',\r\n\t\t\t\t\tinfoTitle: 'Display information about frustum point if user move mouse over or click this point.',\r\n\r\n\t\t\t\t\tstereo: 'Stereo',\r\n\t\t\t\t\tstereoTitle: 'Frustum Points setting for stereo mode of the canvas',\r\n\r\n\t\t\t\t\thide: 'Hide Nearby Points',\r\n\t\t\t\t\thideTitle: 'Hide the nearby to the camera points in percentage to all points for more comfortable visualisation.',\r\n\r\n\t\t\t\t\topacity: 'Opacity',\r\n\t\t\t\t\topacityTitle: 'Float in the range of 0.0 - 1.0 indicating how transparent the lines is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.',\r\n\r\n\t\t\t\t\tnear: 'Near Layer',\r\n\t\t\t\t\tnearTitle: 'Shift of the frustum layer near to the camera in percents.',\r\n\r\n\t\t\t\t\tfar: 'Far Layer',\r\n\t\t\t\t\tfarTitle: 'Shift of the frustum layer far to the camera in percents.',\r\n\r\n\t\t\t\t\tbase: 'Scale',\r\n\t\t\t\t\tbaseTitle: 'Scale of the base of the frustum points in percents.',\r\n\r\n\t\t\t\t\tsquare: 'Square Base',\r\n\t\t\t\t\tsquareTitle: 'Square base of the frustum points.',\r\n\r\n\t\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\t\tdefaultTitle: 'Restore default Frustum Points settings.',\r\n\r\n\t\t\t\t\tzCount: 'Z Count',\r\n\t\t\t\t\tzCountTitle: \"The count of layers of the frustum of the camera's field of view.\",\r\n\r\n\t\t\t\t\tyCount: 'Y Count',\r\n\t\t\t\t\tyCountTitle: \"The count of vertical points for each z level of the  frustum of the camera's field of view.\",\r\n\r\n\t\t\t\t};\r\n\t\t\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\tlang.frustumPoints = 'Неподвижные точки';\r\n\t\t\t\t\t\tlang.frustumPointsTitle = 'Облако точек перед камерой для описания свойств пространства';\r\n\r\n\t\t\t\t\t\tlang.display = 'Показать';\r\n\t\t\t\t\t\tlang.displayTitle = 'Показать или скрыть неподвижные точки.';\r\n\r\n\t\t\t\t\t\tlang.info = 'Информация';\r\n\t\t\t\t\t\tlang.infoTitle = 'Отображать информацию о неподвижной точке, если пользователь наведет курсор мыши или щелкнет эту точку.';\r\n\r\n\t\t\t\t\t\tlang.stereo = 'Стерео';\r\n\t\t\t\t\t\tlang.stereoTitle = 'Настройки неподвижных точек для стерео режима холста';\r\n\r\n\t\t\t\t\t\tlang.hide = 'Близкие точки';\r\n\t\t\t\t\t\tlang.hideTitle = 'Скрыть близкие к камере точки в процентах ко всем точкам для более удобной визуализации.';\r\n\r\n\t\t\t\t\t\tlang.opacity = 'Непрозрачность';\r\n\t\t\t\t\t\tlang.opacityTitle = 'Число в диапазоне 0.0 - 1.0, указывающее, насколько прозрачены линии. Значение 0.0 означает полностью прозрачный, 1.0 - полностью непрозрачный.';\r\n\r\n\t\t\t\t\t\tlang.near = 'Ближний слой';\r\n\t\t\t\t\t\tlang.nearTitle = 'Смещение ближайшего к камере слоя точек в процентах.';\r\n\r\n\t\t\t\t\t\tlang.far = 'Дальний слой';\r\n\t\t\t\t\t\tlang.farTitle = 'Смещение дальнего от камеры слоя точек в процентах.';\r\n\r\n\t\t\t\t\t\tlang.base = 'Масштаб';\r\n\t\t\t\t\t\tlang.baseTitle = 'Масштаб неподвижных точек в процентах.';\r\n\r\n\t\t\t\t\t\tlang.square = 'Квадратное основание';\r\n\t\t\t\t\t\tlang.squareTitle = 'Неподвиждые точки образуют пирамиду с квадратным основанием.';\r\n\r\n\t\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\t\tlang.defaultTitle = 'Восстановить настройки неподвижных точек.';\r\n\r\n\t\t\t\t\t\tlang.zCount = 'Z cлои';\r\n\t\t\t\t\t\tlang.zCountTitle = 'Количество слоев усеченной пирамиды, образующей поле зрения камеры';\r\n\r\n\t\t\t\t\t\tlang.yCount = 'Y точки';\r\n\t\t\t\t\t\tlang.yCountTitle = \"Количество вертикальных точек в каждом слое усеченной пирамиды, образующей поле зрения камеры.\";\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault://Custom language\r\n\t\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != languageCode ) )\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction saveSettings() {\r\n\r\n\t\t\t\t\tcookie.setObject( cookieName, shaderMaterial );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst fFrustumPoints = folder.addFolder( lang.frustumPoints );\r\n\t\t\t\tdat.folderNameAndTitle( fFrustumPoints, lang.frustumPoints, lang.frustumPointsTitle );\r\n\r\n\t\t\t\tfunction displayControllers( value ) {\r\n\r\n\t\t\t\t\tvar display = value ? 'block' : 'none';\r\n\t\t\t\t\tfolderPoint.display( display );\r\n\t\t\t\t\tcZCount.__li.style.display = display;\r\n\t\t\t\t\tcYCount.__li.style.display = display;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t//Display frustumPoints\r\n\t\t\t\tconst cDisplay = fFrustumPoints.add( shaderMaterial, 'display' ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tif ( shaderMaterial.display ) {\r\n\r\n\t\t\t\t\t\tupdate();\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( options.raycaster ) options.raycaster.removeParticle( _points );\r\n\t\t\t\t\t\tremovePoints();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdisplayControllers( shaderMaterial.display );\r\n\t\t\t\t\tsaveSettings();\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( cDisplay, lang.display, lang.displayTitle );\r\n\r\n\t\t\t\t//FrustumPoints info.\r\n\t\t\t\t//Display information about frustum point if user move mouse over or click this point.\r\n\t\t\t\tconst cInfo = !options.raycaster ? undefined : fFrustumPoints.add( shaderMaterial, 'info' ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\tif ( _points === undefined ) {\r\n\r\n\t\t\t\t\t\tsaveSettings();\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( shaderMaterial.info ) {\r\n\r\n\t\t\t\t\t\tif ( options.raycaster ) options.raycaster.addParticle( _points );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.selectPoint( -1 );\r\n\t\t\t\t\t\tif ( options.raycaster ) options.raycaster.removeParticle( _points );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsaveSettings();\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tif ( cInfo ) dat.controllerNameAndTitle( cInfo, lang.info, lang.infoTitle );\r\n\r\n\t\t\t\t//Shift of the frustum layer near to the camera in percents\r\n\t\t\t\tconst cNear = fFrustumPoints.add( shaderMaterial, 'near', 0, 100, 1 ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cNear, lang.near, lang.nearTitle );\r\n\r\n\t\t\t\t//Shift of the frustum layer far to the camera in percents\r\n\t\t\t\tconst cFar = fFrustumPoints.add( shaderMaterial, 'far', 0, 100, 1 ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cFar, lang.far, lang.farTitle );\r\n\r\n\t\t\t\t//Scale of the base of the frustum points in percents.\r\n\t\t\t\tconst cBase = fFrustumPoints.add( shaderMaterial, 'base', 0, 100, 1 ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cBase, lang.base, lang.baseTitle );\r\n\r\n\t\t\t\t//Square base of the frustum points.\r\n\t\t\t\tconst cSquare = fFrustumPoints.add( shaderMaterial, 'square' ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cSquare, lang.square, lang.squareTitle );\r\n\r\n\t\t\t\tconst folderPoint = new FolderPoint( shaderMaterial.point, function ( value ) {\r\n\r\n\t\t\t\t\t//Не помню зачем это написал\r\n\t\t\t\t\tif ( value === undefined ) {\r\n\r\n\t\t\t\t\t\tconsole.warn( 'under constraction' );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( value < 0 )\r\n\t\t\t\t\t\tvalue = 0;\r\n\r\n\t\t\t\t\t_points.material.uniforms.pointSize.value = value;\r\n\r\n\t\t\t\t\tfolderPoint.size.setValue( value );\r\n\t\t\t\t\tshaderMaterial.point.size = value;\r\n\t\t\t\t\tsaveSettings();\r\n\r\n\t\t\t\t}, new Options( { dat: {gui: options.dat.gui } } ), {\r\n\r\n\t\t\t\t\tfolder: fFrustumPoints,\r\n\t\t\t\t\tdefaultPoint: { size: 0.01 },\r\n\t\t\t\t\tPCOptions: {\r\n\r\n\t\t\t\t\t\tsettings: { offset: 0.1 },\r\n\t\t\t\t\t\tmax: 0.1,\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tvar toUpdate = true,//Когда пользователь нажимает кнопку Default надо установить toUpdate = false\r\n\t\t\t\t\t//что бы несколько раз не вызывался _this.update(); чтобы быстрее работало\r\n\t\t\t\t\tcanUpdate = true,\r\n\t\t\t\t\t_this = this;\r\n\r\n\t\t\t\tfunction update() {\r\n\r\n\t\t\t\t\tif ( !toUpdate || !canUpdate )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tcanUpdate = false;\r\n\r\n\t\t\t\t\t//Не помню почему не удаляю старый points из списка cMeshs, но если так делать, то будут какие то запутанные косяки.\r\n\t\t\t\t\t//Поэтому не удаляю points из списка cMeshs а только получаю индекс points в этом списке.\r\n\t\t\t\t\tconst index = options.guiSelectPoint ? options.guiSelectPoint.getMeshIndex( _points ) : undefined;\r\n\r\n\t\t\t\t\tif ( options.raycaster ) options.raycaster.removeParticle( _points );\r\n\t\t\t\t\tremovePoints( true );\r\n\r\n\t\t\t\t\t_this.update( function () {\r\n\r\n\t\t\t\t\t\t//затем заменяю указатель на старый points в списке cMeshs на новый.\r\n\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.setIndexMesh( index, _points );\r\n\r\n\t\t\t\t\t\tsaveSettings();\r\n\t\t\t\t\t\tcanUpdate = true;\r\n\r\n\t\t\t\t\t\t_points.userData.controllers();\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//zCount\r\n\t\t\t\tconst cZCount = fFrustumPoints.add( shaderMaterial, 'zCount' ).min( 3 ).step( 1 ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cZCount, lang.zCount, lang.zCountTitle );\r\n\r\n\t\t\t\t//yCount\r\n\t\t\t\tconst cYCount = fFrustumPoints.add( shaderMaterial, 'yCount' ).min( 3 ).step( 1 ).onChange( function ( value ) { update(); } );\r\n\t\t\t\tdat.controllerNameAndTitle( cYCount, lang.yCount, lang.yCountTitle );\r\n\r\n\t\t\t\t//Default button\r\n\t\t\t\tdat.controllerNameAndTitle( fFrustumPoints.add( {\r\n\r\n\t\t\t\t\tdefaultF: function ( value ) {\r\n\r\n\t\t\t\t\t\ttoUpdate = false;\r\n\r\n\t\t\t\t\t\tcDisplay.setValue( optionsShaderMaterial.display );\r\n\t\t\t\t\t\tif ( cInfo ) cInfo.setValue( optionsShaderMaterial.info );\r\n\r\n\t\t\t\t\t\tcNear.setValue( optionsShaderMaterial.near );\r\n\t\t\t\t\t\tcFar.setValue( optionsShaderMaterial.far );\r\n\t\t\t\t\t\tcBase.setValue( optionsShaderMaterial.base );\r\n\t\t\t\t\t\tcSquare.setValue( optionsShaderMaterial.square );\r\n\r\n\t\t\t\t\t\tfolderPoint.size.setValue( optionsShaderMaterial.point.size );\r\n\r\n\t\t\t\t\t\tcZCount.setValue( optionsShaderMaterial.zCount );\r\n\t\t\t\t\t\tcYCount.setValue( optionsShaderMaterial.yCount );\r\n\r\n\t\t\t\t\t\ttoUpdate = true;\r\n\t\t\t\t\t\tupdate();\r\n\t\t\t\t\t\tsaveSettings();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}, 'defaultF' ), lang.defaultButton, lang.defaultTitle );\r\n\t\t\t\tdisplayControllers( shaderMaterial.display );\r\n\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\r\n\t\t}\r\n\r\n\t\t/** @class [GUI]{@link https://github.com/anhr/dat.gui} for select a frustum point.\r\n\t\t *  Uses in the <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">guiSelectPoint</a>.\r\n\t\t */\r\n\t\tthis.guiSelectPoint = function () {\r\n\r\n\t\t\tvar cFrustumPointsX = null, cFrustumPointsY = null, cFrustumPointsZ = null;\r\n\t\t\t_guiSelectPoint = this;\r\n\t\t\t/**\r\n\t\t\t * create controls\r\n\t\t\t * @param {GUI} fPoints parent folder. See [GUI]{@link https://github.com/anhr/dat.gui}.\r\n\t\t\t * @param {string} languageCode Localization. The \"primary language\" subtag of the language version of the browser.\r\n\t\t\t * <pre>\r\n\t\t\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t\t\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t\t\t * </pre>\r\n\t\t\t */\r\n\t\t\tthis.create = function ( fPoints, languageCode ) {\r\n\r\n\t\t\t\tconst dat = three.dat;//options.dat.dat;\r\n\t\t\t\tfunction frustumPointsControl( name ) {\r\n\r\n\r\n\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\t\tnotSelected: 'Not selected',\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tswitch ( languageCode ) {\r\n\r\n\t\t\t\t\t\tcase 'ru'://Russian language\r\n\t\t\t\t\t\t\tlang.notSelected = 'Не выбран';\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst controller = fPoints.add( { Points: lang.notSelected }, 'Points', { [lang.notSelected]: -1 } ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\tconst index = _guiSelectPoint.getSelectedIndex();\r\n\t\t\t\t\t\tif ( index === null ) {\r\n\r\n\t\t\t\t\t\t\tif ( options.axesHelper ) options.axesHelper.exposePosition();\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\toptions.guiSelectPoint.select( { object: _points, index: index } );\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tcontroller.__select[0].selected = true;\r\n\t\t\t\t\t//Не стоит переименовывать шкалы потому что шкала frustumPoints не совпадает со общей шкалой\r\n\t\t\t\t\t//\t\t\tdat.controllerNameAndTitle( controller, scales[name].name ? scales[name].name : name );\r\n\t\t\t\t\tdat.controllerNameAndTitle( controller, name );\r\n\t\t\t\t\treturn controller;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcFrustumPointsX = frustumPointsControl( 'x' );\r\n\t\t\t\tcFrustumPointsY = frustumPointsControl( 'y' );\r\n\t\t\t\tcFrustumPointsZ = frustumPointsControl( 'z' );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Append new item into controller\r\n\t\t\t * @param {object} count Count of points in the FrustumPoints\r\n\t\t\t * @param {number} count.xCount Count of rows of the points in the x axis\r\n\t\t\t * @param {number} count.yCount Count of rows of the points in the y axis\r\n\t\t\t * @param {number} count.zCount Count of layers of the points in the z axis\r\n\t\t\t */\r\n\t\t\tthis.appendChild = function ( count ) {\r\n\r\n\t\t\t\tfunction appendChild( cFrustumPoint, count ) {\r\n\r\n\t\t\t\t\t//thanks to https://stackoverflow.com/a/48780352/5175935\r\n\t\t\t\t\tcFrustumPoint.domElement.querySelectorAll( 'select option' ).forEach( option => { if ( option.value != '-1' ) option.remove() } );\r\n\r\n\t\t\t\t\tfor ( var i = 0; i < count; i++ ) {\r\n\r\n\t\t\t\t\t\tvar opt = document.createElement( 'option' );\r\n\t\t\t\t\t\topt.innerHTML = i;\r\n\t\t\t\t\t\tcFrustumPoint.__select.appendChild( opt );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcFrustumPoint.setValue( -1 );//если не выбрать ни одной точки,\r\n\t\t\t\t\t\t//то при повторном выборе frustumPoints в списке cMeshs выберется точка, которая была выбрана прошлый раз.\r\n\t\t\t\t\t\t//Но индекс этой выбранной точки почему то не будет выбран в cFrustumPoints\r\n\t\t\t\t\t\t//Для проверки\r\n\t\t\t\t\t\t//выбрать точку frustumPoints в guiSelectPoint. Если есть оси кооддинат, то от выбранной точки появятся пунктирные линии.\r\n\t\t\t\t\t\t//Выбрать точку не frustumPoints в guiSelectPoint.\r\n\t\t\t\t\t\t//Опять выбрать точку frustumPoints в guiSelectPoint. Раньше появлялись пунктирные линии, но в огранах управления почемуто это точка не выбиралась.\r\n\r\n\t\t\t\t}\r\n\t\t\t\tappendChild( cFrustumPointsX, count.xCount );\r\n\t\t\t\tappendChild( cFrustumPointsY, count.yCount );\r\n\t\t\t\tappendChild( cFrustumPointsZ, count.zCount );\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * Sets to the controls the indexes of the selected frustum point.\r\n\t\t\t * @param {object} index\r\n\t\t\t * @param {object} index.x index of the x row of selected frustum point\r\n\t\t\t * @param {object} index.y index of the y row of selected frustum point\r\n\t\t\t * @param {object} index.z index of the z layer of selected frustum point\r\n\t\t\t */\r\n\t\t\tthis.pointIndexes = function ( index ) {\r\n\r\n\t\t\t\tif ( index === undefined )\r\n\t\t\t\t\treturn;//Сюда попадает в отладочной версии когда не заданы имена точек\r\n\t\t\t\tif ( parseInt( cFrustumPointsX.getValue() ) !== index.x )\r\n\t\t\t\t\tcFrustumPointsX.setValue( index.x );\r\n\t\t\t\tif ( parseInt( cFrustumPointsY.getValue() ) !== index.y )\r\n\t\t\t\t\tcFrustumPointsY.setValue( index.y );\r\n\t\t\t\tif ( parseInt( cFrustumPointsZ.getValue() ) !== index.z )\r\n\t\t\t\t\tcFrustumPointsZ.setValue( index.z );\r\n\r\n\t\t\t};\r\n\t\t\t/**\r\n\t\t\t * @returns frustum point index selected by user from controls.\r\n\t\t\t * <p>null if user have not selected any point.</p>\r\n\t\t\t */\r\n\t\t\tthis.getSelectedIndex = function () {\r\n\r\n\t\t\t\tif ( _names === undefined ) {\r\n\r\n\t\t\t\t\tconsole.warn( 'Сюда попадает во время отладки когда не задаю имени каждой точки или когда the cDisplay checkbox of the frustumPoints is not checked' );\r\n\t\t\t\t\treturn null;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst x = parseInt( cFrustumPointsX.getValue() ),\r\n\t\t\t\t\ty = parseInt( cFrustumPointsY.getValue() ),\r\n\t\t\t\t\tz = parseInt( cFrustumPointsZ.getValue() );\r\n\t\t\t\tif ( isNaN( x ) || ( x === -1 ) || isNaN( y ) || ( y === -1 ) || isNaN( z ) || ( z === -1 ) )\r\n\t\t\t\t\treturn null;\r\n\t\t\t\tfor ( var i = 0; i < _names.length; i++ ) {\r\n\r\n\t\t\t\t\tvar name = _names[i];\r\n\t\t\t\t\tif ( ( typeof name !== \"object\" ) || ( name.z === undefined ) || ( name.z !== z ) )\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\tfor ( ; i < _names.length; i++ ) {\r\n\r\n\t\t\t\t\t\tname = _names[i];\r\n\t\t\t\t\t\tif ( ( typeof name !== \"object\" ) || ( name.y !== y ) )\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tfor ( ; i < _names.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tname = _names[i];\r\n\t\t\t\t\t\t\tif ( typeof name === \"object\" ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( ( x === 0 ) && ( name.y === y ) ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//Сюда попадает когда в guiSelectPoint пользователь выбрал frustum Point с коодинатами 0,0,0,\r\n\t\t\t\t\t\t\t\t\treturn i;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( name === x ) {\r\n\r\n\t\t\t\t\t\t\t\t//console.warn( 'x = ' + x + ', y = ' + y + ', z = ' + z + ', i = ' + i );\r\n\t\t\t\t\t\t\t\treturn i;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconsole.error( 'FrustumPoints.selectPoint: not selected' );\r\n\t\t\t\treturn null;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * Display or hide the <b>FrustumPoints</b> controls.\r\n\t\t\t * @param {string} display 'block' - display\r\n\t\t\t * <p>'none' - hide</p>\r\n\t\t\t */\r\n\t\t\tthis.display = function ( display ) {\r\n\r\n\t\t\t\tcFrustumPointsX.domElement.parentElement.parentElement.style.display = display;\r\n\t\t\t\tcFrustumPointsY.domElement.parentElement.parentElement.style.display = display;\r\n\t\t\t\tcFrustumPointsZ.domElement.parentElement.parentElement.style.display = display;\r\n\r\n\t\t\t}\r\n\t\t\t/**\r\n\t\t\t * Is FrustumPoints controls visible?\r\n\t\t\t * @returns true - FrustumPoints controls is visible.\r\n\t\t\t * */\r\n\t\t\tthis.isDisplay = function () {\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t( cFrustumPointsX.domElement.parentElement.parentElement.style.display !== cFrustumPointsY.domElement.parentElement.parentElement.style.display )\r\n\t\t\t\t\t|| ( cFrustumPointsX.domElement.parentElement.parentElement.style.display !== cFrustumPointsZ.domElement.parentElement.parentElement.style.display )\r\n\t\t\t\t)\r\n\t\t\t\t\tconsole.error( 'cFrustumPointsF.isDisplay failed!' );\r\n\t\t\t\treturn cFrustumPointsX.domElement.parentElement.parentElement.style.display !== 'none';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t//делаю затычки на случай пустого _arrayCloud = [] массива координат точек, имеющих облако вокруг себя.\r\n\t\t//Другими словми если в программе нет ни одной точки с облаком вокруг себя.\r\n\t\t//В этом случае точки FrustumPoints не создаются\r\n\t\tthis.gui = function () { console.warn( 'FrustumPoints.gui(): First, call FrustumPoints.pushArrayCloud(...) for push a points to the clouds array and call FrustumPoints.create(...).' ); }\r\n\t\tthis.animate = function () { }\r\n\t\tthis.updateGuiSelectPoint = function () { }\r\n\t\tthis.isDisplay = function () { }\r\n\t\tthis.onChangeControls = function () { }\r\n\t\tthis.updateCloudPoints = function () { }\r\n\t\tthis.updateCloudPoint = function () { }\r\n\t\tthis.updateCloudPointItem = function () { }\r\n\r\n\t}\r\n\r\n }\r\n\r\nexport default FrustumPoints;\r\n","/**\r\n * @module pointLight\r\n * @description A light that gets emitted from a single point in all directions.\r\n * @see [PointLight]{@link https://threejs.org/docs/index.html?q=pointLight#api/en/lights/PointLight}\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport three from './three.js'\r\nimport MyPoints from './myPoints/myPoints.js';\r\nimport Options from './Options.js'\r\n\r\nclass pointLight {\r\n\r\n\t/**\r\n\t * A light that gets emitted from a single point in all directions.\r\n\t * @see [PointLight]{@link https://threejs.org/docs/index.html?q=pointLight#api/en/lights/PointLight}\r\n\t * @param {THREE.Group|THREE.Scene} scene [Group]{@link https://threejs.org/docs/index.html?q=gr#api/en/objects/Group} or [Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the <b>pointLight</b>.\r\n\t * @param {object} [settings={}] the following settings are available\r\n\t * @param {Options} [settings.options=new Options()] <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a> instance. The following options are available.\r\n\t * See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {boolean} [settings.options.pointLight] false - do not use <b>pointLight</b>.\r\n\t * @param {object} [settings.options.dat] use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * See <b>options.dat</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {object} [settings.options.dat.pointLightGui] false - do not adds a <b>pointLight</b> folder. Have effect only if <b>options.pointLight !== false</b>.\r\n\t * @param {number} [settings.options.scale] is 1\r\n\t * @param {THREE.Vector3} [settings.position] light position. Default is zero position.\r\n\t */\r\n\tconstructor( scene, settings = {} ) {\r\n\r\n\t\tconst options = new Options( settings.options );\r\n\t\tif ( options.pointLight === false ) {\r\n\r\n\t\t\tthis.add = function (){ }\r\n\t\t\tthis.controls = function (){ }\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tconst dat = three.dat,\r\n\t\t\tTHREE = three.THREE,\r\n\t\t\tstrLight = 'mathBoxLight',\r\n\t\t\tcontrollers = {},\r\n\t\t\tmultiplier = 2 * options.scale,//options.scale is 1\r\n\t\t\tposition = settings.position || new THREE.Vector3();// 0.5 * options.scale, 0.5 * options.scale, 0.5 * options.scale );\r\n\t\tconst light = new THREE.PointLight( 0xffffff, 1 );\r\n\t\tlight.position.copy( position );\r\n\t\tlight.name = strLight;\r\n\t\tscene.add( light );\r\n\t\t/**\r\n\t\t * Adds the folder of the light settings into [gui]{@link https://github.com/anhr/dat.gui}.\r\n\t\t * @param {object} [guiParams={}] Followed parameters is allowed.\r\n\t\t * @param {THREE.Group|THREE.Scene} [guiParams.group] [Group]{@link https://threejs.org/docs/index.html?q=gr#api/en/objects/Group} or [Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene} of the light point.\r\n\t\t * @param {GUI} [guiParams.folder] parent folder\r\n\t\t * @param {string} [guiParams.folderName] folder name\r\n\t\t */\r\n\t\tthis.controls = function ( guiParams = {} ) {\r\n\r\n\t\t\tconst group = guiParams.group || scene, folder = guiParams.folder || options.dat.gui, folderName = guiParams.folderName;\r\n\r\n\t\t\tif ( folder === undefined || ( options.dat.pointLightGui === false ) )\r\n\t\t\t\treturn;\r\n\r\n\t\t\t//Localization\r\n\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tlight: 'Light',\r\n\t\t\t\tdisplayLight: 'Display',\r\n\t\t\t\tdisplayLightTitle: 'Display or hide the light source.',\r\n\r\n\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\trestoreLightTitle: 'Restore position of the light source',\r\n\r\n\t\t\t};\r\n\t\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.light = 'Свет';\r\n\t\t\t\t\tlang.displayLight = 'Показать';\r\n\t\t\t\t\tlang.displayLightTitle = 'Показать или скрыть источник света.';\r\n\r\n\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\tlang.restoreLightTitle = 'Восстановить положение источника света';\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault://Custom language\r\n\t\t\t\t\tif ( ( options.lang === undefined ) || ( options.lang.languageCode != _languageCode ) )\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\tObject.keys( options.lang ).forEach( function ( key ) {\r\n\r\n\t\t\t\t\t\tif ( lang[key] === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tlang[key] = options.lang[key];\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst scales = options.scales, fLight = folder.addFolder( folderName || lang.light );\r\n\t\t\tvar lightSource;\r\n\r\n\t\t\t//displayLight\r\n\t\t\tdat.controllerNameAndTitle( fLight.add( { display: false }, 'display' ).onChange( function ( value ) {\r\n\r\n\t\t\t\tif ( value ) {\r\n\r\n\t\t\t\t\tnew MyPoints( light.position, group, { pointsOptions: {\r\n\r\n\t\t\t\t\t\tonReady( points ) { lightSource = points; }\r\n\r\n\t\t\t\t\t} } );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tgroup.remove( lightSource );\r\n\t\t\t\t\t//delete lightSource;//Parsing error: Deleting local variable in strict mode\r\n\t\t\t\t\tlightSource = undefined;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} ), lang.displayLight, lang.displayLightTitle );\r\n\r\n\t\t\t//move light\r\n\t\t\tfunction guiLightAxis( axesName ) {\r\n\r\n\t\t\t\tconst scale = scales[axesName];\r\n\t\t\t\tif ( !scale )\r\n\t\t\t\t\treturn;\r\n\t\t\t\tcontrollers[axesName] =\r\n\t\t\t\t\tfLight.add( light.position, axesName, scale.min * multiplier, scale.max * multiplier )\r\n\t\t\t\t\t\t.onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\t\tif ( lightSource === undefined )\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\tconst i = 0,\r\n\t\t\t\t\t\t\t\titemSize = lightSource.geometry.attributes.position.itemSize,\r\n\t\t\t\t\t\t\t\tpoint = new THREE.Vector3().fromArray( lightSource.geometry.attributes.position.array, i * itemSize );\r\n\t\t\t\t\t\t\tpoint[axesName] = value;\r\n\t\t\t\t\t\t\tpoint.toArray( lightSource.geometry.attributes.position.array, i * itemSize );\r\n\t\t\t\t\t\t\t//\t\t\t\t\t\t\t\t\t\tlightSource.geometry.attributes.position.array[axesId] = value;\r\n\t\t\t\t\t\t\tlightSource.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t} );\r\n\t\t\t\tdat.controllerNameAndTitle( controllers[axesName], scale.name );\r\n\r\n\t\t\t}\r\n\t\t\tguiLightAxis( 'x' );\r\n\t\t\tguiLightAxis( 'y' );\r\n\t\t\tguiLightAxis( 'z' );\r\n\r\n\t\t\tvar restore = {\r\n\r\n\t\t\t\trestore: function () {\r\n\r\n\t\t\t\t\tcontrollers.x.setValue( position.x );\r\n\t\t\t\t\tcontrollers.y.setValue( position.y );\r\n\t\t\t\t\tcontrollers.z.setValue( position.z );\r\n\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tdat.controllerNameAndTitle( fLight.add( restore, 'restore' ), lang.defaultButton, lang.restoreLightTitle );\r\n\r\n\t\t};\r\n\t\treturn this;\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default pointLight;","/**\r\n * @module ProgressBar\r\n * @description Creates a [progress bar element]{@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range} on your web page.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\nclass ProgressBar {\r\n\r\n\t/**\r\n\t * set new value of the progress bar\r\n\t */\r\n\tset value(value) { this.setValue(value); }\r\n\r\n\t/**\r\n\t * Creates a [progress bar element]{@link https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/range} on your web page.\r\n\t * @param {HTMLElement} [elParent] parent element. <b>ProgressBar</b> is not visible if <b>elParent</b> is undefined.\r\n\t * @param {Function} step The <b>step(progressBar, i)</b> function to be executed asynchronous during progress.\r\n\t * <pre>\r\n\t * parameter <b>progressBar</b>: this ProgressBar instance.\r\n\t * parameter <b>i</b>: current iteration index.\r\n\t * parameter <b>params</b>: User defined parameters that can passed from <b>params</b> of the <b><a href=\"#step\">step</a></b> method.\r\n\t * </pre>\r\n\t * @param {object} [settings={}] The following settings are available\r\n\t * @param {string} [settings.sTitle=\"\"] Progress bar title.\r\n\t * @param {number} [settings.min=0] The lowest value in the range of permitted values.\r\n\t * @param {number} [settings.max=1] The greatest value in the range of permitted values.\r\n\t * @param {number} [settings.iterationCount] Count of calling of the <b>step</b> function from <b>settings.min</b> to <b>settings.iterationCount</b>.\r\n\t * @param {number} [settings.timeoutPeriod=0] You can call the <b>step</b> function asynchronous or directly.\r\n\t * Directly calling of the <b>step</b> function decreases the execute time but your web page froze during executing.\r\n\t * For example if <b>timeoutPeriod</b> parameter is 3, then the <b>step</b> function will be called 3 times directly and one time asynchronous.\r\n\t * If <b>timeoutPeriod</b> parameter is 0, then the <b>step</b> function will be called permanently as asynchronous.\r\n\t */\r\n\tconstructor(elParent, step, settings = {}) {\r\n\r\n\t\tlet cProgress, elProgress, elTitle;\r\n\t\tif (elParent) {\r\n\t\t\t\r\n\t\t\telTitle = document.createElement('div');\r\n\t\t\telProgress = document.createElement('div');\r\n\t\t\tcProgress = document.createElement('input'),\r\n\t\t\telProgress.style.backgroundColor = 'white';\r\n\t\t\telProgress.style.margin = '2px';\r\n\t\t\telProgress.style.padding = '2px';\r\n\t\t\telTitle.innerHTML = settings.sTitle || '';\r\n\t\t\telTitle.style.color = 'black';\r\n\t\t\telProgress.appendChild(elTitle);\r\n\t\t\tif (settings.min === undefined) settings.min = 0;\r\n\t\t\tcProgress.min = settings.min;\r\n\t\t\tcProgress.max = settings.max != undefined ? settings.max : settings.iterationCount != undefined ? settings.iterationCount : 1;\r\n\t\t\tcProgress.type = \"range\";\r\n\t\t\tcProgress.disabled = true;\r\n\t\t\telProgress.appendChild(cProgress);\r\n\t\r\n\t\t\tlet elcontainer;\r\n\t\t\tconst containerName = 'ProgressContainer';\r\n\t\t\tfor (let i = 0; i < elParent.children.length; i++) {\r\n\t\r\n\t\t\t\tconst child = elParent.children[i];\r\n\t\t\t\tif (child.name && (child.name === containerName)) {\r\n\t\r\n\t\t\t\t\telcontainer = child;\r\n\t\t\t\t\tbreak;\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t}\r\n\t\t\tif (!elcontainer) {\r\n\t\r\n\t\t\t\telcontainer = document.createElement('table');\r\n\t\t\t\telcontainer.name = containerName;\r\n\t\t\t\telcontainer.style.position = 'absolute';\r\n\t\t\t\telcontainer.style.top = 0;\r\n\t\t\t\telcontainer.style.left = 0;\r\n\t\t\t\telParent.appendChild(elcontainer);\r\n\t\r\n\t\t\t}\r\n\t\t\tconst elRow = document.createElement('tr');\r\n\t\t\telRow.appendChild(elProgress);\r\n\t\t\telcontainer.appendChild(elRow);\r\n\r\n\t\t}\r\n\t\tthis.setValue = (value) => { if (cProgress) cProgress.value = value; }\r\n\t\t\r\n\t\tif (settings.timeoutPeriod === undefined) settings.timeoutPeriod = 0;\r\n\t\tlet timeoutPeriod = settings.timeoutPeriod;//таймер можно запускать через определенный период что бы экономилось время выполнения\r\n\t\tlet i = settings.iterationCount != undefined ? settings.min : undefined;\r\n\t\t\r\n\t\t/**\r\n\t\t * Execute the next step asynchronously.\r\n\t\t * @param {Object} [params] User defined parameters that will be passed to the <b>params</b> of the <b>step</b> function of the <b>ProgressBar</b> constructor.\r\n\t\t */\r\n\t\tthis.step = (params) => {\r\n\r\n\t\t\tconst iteration = () => {\r\n\t\t\t\t\r\n\t\t\t\tstep(this, i, params);\r\n\t\t\t\tif (i === undefined) return;\r\n\t\t\t\tthis.value = i;\r\n\t\t\t\ti++;\r\n\t\t\t\tif (i < settings.iterationCount)\r\n\t\t\t\t\tthis.step();\r\n\t\t\t\telse this.remove();\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif (timeoutPeriod < settings.timeoutPeriod) {\r\n\r\n\t\t\t\ttimeoutPeriod++;\r\n\t\t\t\titeration();\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\ttimeoutPeriod = 0;\r\n\t\t\t\twindow.setTimeout(() => {\r\n\t\t\t\t\t\r\n\t\t\t\t\titeration();\r\n\t\t\t\t\r\n\t\t\t\t}, 0);\r\n\r\n\t\t\t}\r\n\t\t\t//window.requestAnimationFrame(step);//время выполнения увеличивается на треть\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * remove progress bar from your web page.\r\n\t\t **/\r\n\t\tthis.remove = () => { if (elProgress) elProgress.parentElement.remove(); };\r\n  \r\n\t\tthis.step();\r\n\r\n\t\t/**\r\n\t\t * set new step function\r\n\t\t * @param {function} stepFunction New step function. See the ProgressBar constructor's <b>step</b> parameter.\r\n\t\t */\r\n\t\tthis.newStep = (stepFunction) => { step = stepFunction; }\r\n\r\n\t\t/**\r\n\t\t * set new title\r\n\t\t * @param {string} newTitle\r\n\t\t */\r\n\t\tthis.title = (newTitle) => { elTitle.innerHTML = newTitle; }\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default ProgressBar;\r\n","/**\r\n * @module Intersections\r\n * @description Creates an intersection lines for graphic objects.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n * \r\n * @see [How to detect collision in three.js?]{@link https://newbedev.com/how-to-detect-collision-in-three-js}\r\n * @see [Collision detection example]{@link http://stemkoski.github.io/Three.js/Collision-Detection.html}\r\n * @see [Three JS - Find all points where a mesh intersects a plane]{@link https://stackoverflow.com/questions/42348495/three-js-find-all-points-where-a-mesh-intersects-a-plane}\r\n*/\r\n\r\nimport three from '../three.js'\r\nimport ProgressBar from '../ProgressBar/ProgressBar.js'\r\n\r\n//debug\r\n//import { SpriteText } from '../SpriteText/SpriteText.js'\r\n\r\nclass Intersections {\r\n\r\n\t/**\r\n\t * Creates an intersection lines for graphic objects.\r\n\t * @param {THREE.Mesh} object [graphic object]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh} for which the intersection lines with other objects will be obtained.\r\n\t * @param {THREE.Mesh|array} intersectMeshList <b>THREE.Mesh</b> - [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}, which intersects with <b>object</b>.\r\n\t * <pre>\r\n\t * <b>array</b> - array of intersect graphic objects. Every item is:\r\n\t *\t<b>THREE.Mesh</b> - [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}, which intersects with <b>object</b>.\r\n\t *\tor <b>object</b> - object keys is:\r\n\t *\t\t<b>mesh</b> - [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}, which intersects with <b>object</b>.\r\n\t *\t\t<b>color</b> - intersection lines [color]{@link https://en.wikipedia.org/wiki/Web_colors#Hex_triplet}.\r\n\t *\t\t\tExamples: <b>0xffffff</b>, <b>'yellow'</b>. Default is white.\r\n\t * <pre>\r\n\t * @param {object} [settings] the following settings are available:\r\n\t * @param {THREE.Scene} [settings.scene] [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t * @param {THREE.WebGLRenderer} [settings.renderer] [THREE.WebGLRenderer]{@link https://threejs.org/docs/index.html?q=WebGLRenderer#api/en/renderers/WebGLRenderer}.\r\n\t * @param {function} [settings.onReady] Callback function that called if intersection lines is ready and that take as input an array of all intersect lines.\r\n\t * <pre>\r\n\t * <b>function( intersectionLines )</b>\r\n\t *\t<b>intersectionLines</b> - array of all intersect lines.\r\n\t *\tEvery item of array is object. Object keys is:\r\n\t *\t\t<b>mesh</b> - [Mech]{@link https://threejs.org/docs/index.html#api/en/objects/Mesh}, which intersects with <b>object</b>.\r\n\t *\t\t<b>points</b> - array of [points]{@link https://threejs.org/docs/index.html?q=Vect#api/en/math/Vector3} of intersection line.\r\n\t *\t\t<b>color</b> - intersection line color.\r\n\t *\t\t\tDefault is white.\r\n\t * </pre>\r\n\t */\r\n\tconstructor( object, intersectMeshList, settings = {} ) {\r\n\r\n\t\tconst THREE = three.THREE, options = three.options || {}, scene = settings.scene || three.group;\r\n\t\tif ( object instanceof THREE.Mesh === false ) object = object.mesh;\r\n\t\tconst positions =  object.geometry.attributes.position;\r\n\r\n\t\tif ( !Array.isArray( intersectMeshList ) ) intersectMeshList = [intersectMeshList];\r\n\t\tconst collidableMeshList = [], arrayIntersectLinesColor = [];\r\n\t\tintersectMeshList.forEach( function ( item ) {\r\n\r\n\t\t\tif ( item instanceof THREE.Mesh ) {\r\n\r\n\t\t\t\tcollidableMeshList.push( item );\r\n\t\t\t\tarrayIntersectLinesColor.push( 0xffffff );//white\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tcollidableMeshList.push( item.mesh );\r\n\t\t\t\tarrayIntersectLinesColor.push( item.color || 0xffffff );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\t//У некоторых геометрических фигур нет object.geometry.index. Например THREE.TetrahedronGeometry\r\n\t\tif ( !object.geometry.index ) {\r\n\r\n\t\t\tconst array = [];\r\n\t\t\tfor ( var i = 0; i < positions.count; i++ ) array.push( i );\r\n\t\t\tobject.geometry.index = new THREE.Uint16BufferAttribute( array, 1 );\r\n\r\n\t\t}\r\n\r\n\t\t//debug\r\n\t\t//var currentdate = new Date();\r\n\r\n\t\t//ищщем точки, которые совпадают или почти совпадают с небольшой погрешностью\r\n\t\t//что бы у них был одинаковый индекс\r\n\t\tfor ( let i = 1; i < object.geometry.index.count; i++ ) {\r\n\r\n\t\t\tconst point1 = new THREE.Vector3().fromBufferAttribute( positions, object.geometry.index.array[i] );\r\n\t\t\t//console.log( 'index: ' + object.geometry.index.array[i] );\r\n\t\t\t//console.log( point1 );\r\n\t\t\tfor ( let j = i - 1; j >= 0; j-- ) {\r\n\r\n\t\t\t\tconst point2 = new THREE.Vector3().fromBufferAttribute( positions, object.geometry.index.array[j] );\r\n\r\n\t\t\t\t// @returns\r\n\t\t\t\t// \t0 координаты совпадают\r\n\t\t\t\t// \t1 коодинаты с маленьким отклонением\r\n\t\t\t\t// \t4 коодинаты с большим отклонением\r\n\t\t\t\tfunction Delta( a, b ) {\r\n\r\n\t\t\t\t\tconst d = Math.abs( a - b )\r\n\t\t\t\t\tif ( d === 0 ) return 0;\r\n\t\t\t\t\t//\t\t\t\t\tif ( ( d > 0 ) && ( d <= 7.347880586115415e-16 ) ) return 1;\r\n\t\t\t\t\t//\t\t\t\tif ( ( d > 0 ) && ( d <= 3.1840817637818772e-15 ) ) return 1;\r\n\t\t\t\t\t//\t\t\t\tif ( ( d > 0 ) && ( d <= 3.394278283598952e-15 ) ) return 1;//use THREE.SphereGeometry for testing\r\n\t\t\t\t\tif ( ( d > 0 ) && ( d <= 4e-15 ) ) return 1;//use THREE.SphereGeometry for testing\r\n\t\t\t\t\t//\t\t\t\t\tif ( ( d > 0 ) && ( d <= 3.e-10 ) ) return 1;\r\n\t\t\t\t\treturn 4;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst res = Delta( point2.x, point1.x ) + Delta( point2.y, point1.y ) + Delta( point2.z, point1.z );\r\n\t\t\t\t//0 координаты совпадают\r\n\t\t\t\t//1,2,3 одна, две или три коодинаты с маленьким отклонением. Остальные совпадают.\r\n\t\t\t\t//4 есть хоть одна коодината с большим отклонением\r\n\t\t\t\t//if ( ( res > 0 ) && ( res < 4 ) )\r\n\t\t\t\tif ( res < 4 ) {\r\n\r\n\t\t\t\t\tobject.geometry.index.array[i] = object.geometry.index.array[j];\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tfunction arrayIntersectionsPush( intersection, array ) {\r\n\r\n\t\t\tconst point1 = intersection.point;\r\n\t\t\tfor ( var i = 0; i < array.length; i++ ) {\r\n\r\n\t\t\t\tfunction isSameAxis( axis1, axis2 ) { return axis1 === axis2 }\r\n\t\t\t\tconst point2 = array[i].point;\r\n\t\t\t\tif ( isSameAxis( point1.x, point2.x ) && isSameAxis( point1.y, point2.y ) && isSameAxis( point1.z, point2.z ) )\r\n\t\t\t\t\treturn;//не надо добавлять точки с одинаковым положением\r\n\r\n\t\t\t}\r\n\t\t\tarray.push( intersection );\r\n\r\n\t\t}\r\n\r\n\t\t//точки пересечения одного тела с другим могут образовывать несколько замкнутых линий ( Loops ).\r\n\t\t//Например пересечение тора с плоскостью.\r\n\t\t//Здесь перечислены все обнруженные Loops точек пересечения.\r\n\t\tconst intersectionLines = [],\r\n\r\n\t\t\t//Список граней, имеющих линии пересечения. Нужен что бы во врнмя построения линий пересечения не искать по всем граням.\r\n\t\t\tarrayIntersectFaces = [];\r\n\r\n\t\tconst edges = [];//список ребер\r\n\t\t//Заполнить список ребер\r\n\t\tfor ( var index = 0; index < object.geometry.index.count; index += 3 ) {\r\n\r\n\t\t\tclass Edge {\r\n\r\n\t\t\t\tconstructor( index, index2 ) {\r\n\r\n\t\t\t\t\tfunction Vertex( index ) {\r\n\r\n\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\tif ( typeof SpriteText !== \"undefined\" ) var spriteText;\r\n\r\n\t\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\t\tget index() {\r\n\r\n\t\t\t\t\t\t\t\tif ( index >= object.geometry.index.array.length )\r\n\t\t\t\t\t\t\t\t\tindex = 0;//сюда попадает когда ищу индекс второй точки ребра edge.vertex2\r\n\t\t\t\t\t\t\t\t//и когда ребро последнее в объекте.\r\n\t\t\t\t\t\t\t\t//Я предполагаю что вторая точка ребра edge.vertex2 это первая точка в object.geometry.index\r\n\t\t\t\t\t\t\t\t//Для проверки использовать const geometry = new THREE.BufferGeometry();\r\n\t\t\t\t\t\t\t\tconst i = object.geometry.index.array[index];\r\n\t\t\t\t\t\t\t\tif ( i === undefined )\r\n\t\t\t\t\t\t\t\t\tconsole.error( 'Intersections.createIntersections.Edge.Vertex: i = ' + i );\r\n\t\t\t\t\t\t\t\treturn i;\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tget pointLocal() {\r\n\r\n\t\t\t\t\t\t\t\tconst vertex = positions.itemSize === 3 ? new THREE.Vector3() : positions.itemSize === 4 ? new THREE.Vector3() : undefined;\r\n\t\t\t\t\t\t\t\treturn vertex.fromBufferAttribute( positions, this.index );\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tget point() {\r\n\r\n\t\t\t\t\t\t\t\tconst point = this.pointLocal.applyMatrix4( object.matrix );\r\n\r\n\t\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t\tif ( typeof SpriteText !== \"undefined\" && !spriteText ) {\r\n\r\n\t\t\t\t\t\t\t\t\tspriteText = new SpriteText( this.index, this.pointLocal );\r\n\t\t\t\t\t\t\t\t\tobject.add( spriteText );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\treturn point;\r\n\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\t\tvar vertex1, vertex2, collisionResultsOriginPoint, intersectionObject;\r\n\r\n\t\t\t\t\t//индексы точек пересечения, положение которых совпадает с положением точек пересечения на соседних ребрах грани.\r\n\t\t\t\t\t//Эти точи пересечения надо игнорировать, что бы количество точек пересечения на грани было четным.\r\n\t\t\t\t\t//Подробности в Face.intersections\r\n\t\t\t\t\tconst arraySpliceIntersection = [],\r\n\t\t\t\t\t\tarray = [];//только точки пересечения, которые нужно учитывать\r\n\r\n\t\t\t\t\tthis.spliceIntersection = function ( index, uuid ) {\r\n\r\n\t\t\t\t\t\tarraySpliceIntersection.push( { index: index, uuid: uuid, } );\r\n\t\t\t\t\t\tarray.length = 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\t\t\t\t\t\tintersection: {\r\n\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\tif ( !collisionResultsOriginPoint ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst direction = this.vertex2.point.clone().sub( this.vertex1.point ).clone().normalize(),\r\n\t\t\t\t\t\t\t\t\t\trayOriginPoint = new THREE.Raycaster( this.vertex1.point, direction, 0,\r\n\t\t\t\t\t\t\t\t\t\t\tthis.vertex2.point.distanceTo( this.vertex1.point ) );\r\n\r\n\t\t\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t\t\t//Если это не делать, то получу ошибку\r\n\t\t\t\t\t\t\t\t\t//three.module.js:28094 THREE.Sprite: \"Raycaster.camera\" needs to be set in order to raycast against sprites.\r\n\t\t\t\t\t\t\t\t\t//когда new Intersections вызывается несколько раз с разными object\r\n\t\t\t\t\t\t\t\t\t//и когда SpriteText используется для указания индекса вершины\r\n\t\t\t\t\t\t\t\t\tif ( typeof SpriteText !== \"undefined\" ) rayOriginPoint.camera = options.camera;\r\n\r\n\t\t\t\t\t\t\t\t\t//array - список точек пересечения, возвращенный THREE.Raycaster.intersectObjects\r\n\t\t\t\t\t\t\t\t\t//collisionResultsOriginPoint.length === 0 пересечений не обнаружено\r\n\t\t\t\t\t\t\t\t\t//undefined - точка пересечения еще не вычислялась\r\n\t\t\t\t\t\t\t\t\t//collisionResultsOriginPoint[i] = false - уже добавлен в arrayIntersectLine\r\n\t\t\t\t\t\t\t\t\tcollisionResultsOriginPoint = rayOriginPoint.intersectObjects( collidableMeshList );//, false );//recursive = false на тот случай когда для отладки в пересекаемые объекты добавляю текст с номером вершины\r\n\r\n\t\t\t\t\t\t\t\t\tif ( !this.faces )\r\n\t\t\t\t\t\t\t\t\t\tconsole.error( 'edge ' + this.vertex1.index + ' ' + this.vertex2.index + ' intersects ' + collisionResultsOriginPoint.length )\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvar res;\r\n\t\t\t\t\t\t\t\tif ( this.intersectionObject ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( array.length === 0 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t//Надо вывести только точки пересечения с объектом this.intersectionObject\r\n\t\t\t\t\t\t\t\t\t\t//и если в начале или конце соседнего ребра нет точки пересечения с такми же положением\r\n\t\t\t\t\t\t\t\t\t\tconst intersectionObject = this.intersectionObject;\r\n\t\t\t\t\t\t\t\t\t\tcollisionResultsOriginPoint.forEach( function ( intersection, index ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( intersection.object.uuid === intersectionObject.uuid ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tarrayIntersectionsPush( intersection, array );\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\t\t\t//не добавлять точку пересечения в array если в другом ребре грани есть точка пересечения с тем же положением\r\n\t\t\t\t\t\t\t\t\t\tif ( arraySpliceIntersection.length > 1 )\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'under construction' );//надо рассотировать arraySpliceIntersection так что бы из array сначала удалялись элементы с наибольшим индексом. Иначе не те элементы будут удаляться\r\n\t\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < arraySpliceIntersection.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( arraySpliceIntersection[i].uuid === intersectionObject.uuid )\r\n\t\t\t\t\t\t\t\t\t\t\t\tarray.splice( arraySpliceIntersection[i].index, 1 );\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tres = array;\r\n\r\n\t\t\t\t\t\t\t\t} else res = collisionResultsOriginPoint;\r\n\t\t\t\t\t\t\t\treturn res;\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tset: function ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t\tthis.vertex1.update = undefined;\r\n\t\t\t\t\t\t\t\tthis.vertex2.update = undefined;\r\n\r\n\t\t\t\t\t\t\t\tcollisionResultsOriginPoint = intersection;\r\n\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tintersectionObject: {\r\n\r\n\t\t\t\t\t\t\tget: function () { return intersectionObject; },\r\n\t\t\t\t\t\t\tset: function ( intersectionObjectNew ) {\r\n\r\n\t\t\t\t\t\t\t\tintersectionObject = intersectionObjectNew;\r\n\t\t\t\t\t\t\t\tarraySpliceIntersection.length = 0;\r\n\t\t\t\t\t\t\t\tarray.length = 0;\r\n\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvertex1: {\r\n\r\n\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\tif ( !vertex1 )\r\n\t\t\t\t\t\t\t\t\tvertex1 = Vertex( index );\r\n\t\t\t\t\t\t\t\treturn vertex1;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvertex2: {\r\n\r\n\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\tif ( !vertex2 )\r\n\t\t\t\t\t\t\t\t\tvertex2 = Vertex( index2 );\r\n\t\t\t\t\t\t\t\treturn vertex2;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tthis.isCollision = function () { return collisionResultsOriginPoint.length > 0; }\r\n\t\t\t\t\tthis.isSame = function ( edge ) {\r\n\r\n\t\t\t\t\t\t//Если сделать const boSame\r\n\t\t\t\t\t\t//то появится ошибка\r\n\t\t\t\t\t\t//[!] (babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/Intersections/Intersections.js: \"boSame\" is read-only\r\n\t\t\t\t\t\t//во время создания файлов myThree\\build\r\n\t\t\t\t\t\t//npm run build\r\n\t\t\t\t\t\tvar boSame = ( ( this.vertex1.index === edge.vertex1.index ) && ( this.vertex2.index === edge.vertex2.index ) ) ||\r\n\t\t\t\t\t\t\t( ( this.vertex1.index === edge.vertex2.index ) && ( this.vertex2.index === edge.vertex1.index ) );\r\n\t\t\t\t\t\tif ( boSame === undefined ) boSame = false;\r\n\t\t\t\t\t\treturn boSame;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tvar edge = new Edge( index, index + 1 );\r\n\t\t\tedges.push( edge );\r\n\t\t\tedge = new Edge( index + 1, index + 2 )\r\n\t\t\tedges.push( edge );\r\n\r\n\t\t\t//Если поменять порядок индексов, то в edges появятся одинаковые ребра,\r\n\t\t\t//которые будут отличатся только переставленными edge.vector1 и edge.vector2\r\n\t\t\t//а это приведет к тому что в некоторых случаях не будет пересечения с объектом\r\n\t\t\t//если ребро пересекается с объектом одним из концов непонятно почему.\r\n\t\t\t//Как результат, могут появиться разрывы в линии пересечения.\r\n\t\t\t//Для проверки в примере установить plane( 'plane', new THREE.PlaneGeometry( 30, 30 ) ).rotation.y = Math.PI / 2;\r\n\t\t\t//и const objGeom = new THREE.DodecahedronGeometry( 10, 0 );\r\n\t\t\t//и obj.position.z = 8.9;\r\n\t\t\tedge = new Edge( index, index + 2 );\r\n\t\t\tedges.push( edge );\r\n\r\n\t\t}\r\n\r\n\t\t//список граней\r\n\t\tconst faces = [];\r\n\r\n\t\t//Progress window\r\n\t\tconst renderer = options.renderer || settings.renderer;\r\n//\t\tvar elProgress, cProgress;\r\n\t\tlet progressBar;\r\n\t\tif ( renderer ) {\r\n\r\n\t\t\tconst elCanvas = renderer.domElement, elContainer = elCanvas.parentElement;\r\n\t\t\tif ( elContainer.tagName !== \"DIV\" ) {\r\n\r\n\t\t\t\tconsole.error( 'Intersections: elContainer.tagName = ' + elContainer.tagName );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tconst container = \"container\";\r\n\t\t\tif ( !elContainer.classList.contains( container ) ) elContainer.classList.add( container );\r\n\t\t\tconst lang = { progressTitle: 'Intersections preparing.<br>Wait please...', };\r\n\t\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.progressTitle = 'Подготовка пересечений.<br>Пожалуйста подождите...';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t\tprogressBar = new ProgressBar(elContainer, step, {\r\n\r\n\t\t\t\tsTitle: lang.progressTitle,\r\n\t\t\t\tmax: object.geometry.index.count,\r\n\t\t\t\t\r\n\t\t\t});\r\n/*\t\t\t\r\n\t\t\telProgress = document.createElement( 'div' );\r\n\t\t\tcProgress = document.createElement( 'input' );\r\n\t\t\tconst elTitle = document.createElement( 'div' );\r\n\t\t\telProgress.style.position = 'absolute';\r\n\t\t\telProgress.style.top = 0;\r\n\t\t\telProgress.style.left = 0;\r\n\t\t\telProgress.style.backgroundColor = 'white';\r\n\t\t\telProgress.style.margin = '2px';\r\n\t\t\telProgress.style.padding = '2px';\r\n\t\t\tconst lang = { progressTitle: 'Intersections preparing.<br>Wait please...', };\r\n\t\t\tswitch ( options.getLanguageCode() ) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.progressTitle = 'Подготовка пересечений.<br>Пожалуйста подождите...';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\t\t\telTitle.innerHTML = lang.progressTitle;\r\n\t\t\telTitle.style.color = 'black';\r\n\t\t\telProgress.appendChild( elTitle );\r\n\t\t\tcProgress.min = \"0\";\r\n\t\t\tcProgress.max = object.geometry.index.count;\r\n\t\t\tcProgress.type = \"range\";\r\n\t\t\tcProgress.disabled = true;\r\n\t\t\telProgress.appendChild( cProgress );\r\n\t\t\telContainer.appendChild( elProgress );\r\n*/   \r\n\r\n\t\t}\r\n\r\n\t\t//Заполнить список граней\r\n\t\tindex = 0;\r\n\t\tfunction step( timestamp ) {\r\n\r\n/*\t\t\t\r\n\t\t\tif ( cProgress )\r\n\t\t\t\tcProgress.value = index;\r\n*/\t\r\n\t\t\tif (progressBar) progressBar.value = index;\r\n\t\t\tif ( index >= object.geometry.index.count ) {\r\n\r\n/*\t\t\t\t\r\n\t\t\t\tif ( elProgress )\r\n\t\t\t\t\telProgress.remove();\r\n*/\t \r\n\t\t\t\tprogressBar.remove();\r\n\t\t\t\tboCreateIntersections = true;\r\n\t\t\t\tsetTimeout( function () { createIntersections(); }, 0 );//Таймаут нужен что бы установился matrixWorld объектов из collidableMeshList.\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tclass Face {\r\n\r\n\t\t\t\t/* *\r\n\t\t\t\t * [Face]{@link https://threejs.org/docs/index.html?q=Fa#examples/en/math/convexhull/Face}\r\n\t\t\t\t * @param {number} index index of vertices of the face <b>from object.geometry.index</b>\r\n\t\t\t\t * @param {number} id identifier of the face in the <b>faces</b> array.\r\n\t\t\t\t */\r\n\t\t\t\tconstructor( index ) {\r\n\r\n\t\t\t\t\tconst vectorIndex = new THREE.Vector3(),\r\n\t\t\t\t\t\tarrayIntersectLines = [];//линии пересечения грани. каждый элемент содержит ребро и индекс начала и конца линии пересечения\r\n\t\t\t\t\tvectorIndex.fromBufferAttribute( object.geometry.index, index );\r\n\t\t\t\t\tObject.defineProperties( this, {\r\n\r\n\r\n\t\t\t\t\t\tfaceEdges: { get: function () { return faceEdges; } },//прилегающие к грани ребра\r\n\t\t\t\t\t\tid: { get: function () { return vectorIndex; } },\r\n\r\n\t\t\t\t\t\t//for debugging\r\n\t\t\t\t\t\tname: { get: function () { return 'Face ' + vectorIndex.x + ', ' + vectorIndex.y + ', ' + vectorIndex.z; } },\r\n\r\n\t\t\t\t\t\tvertices: {\r\n\r\n\t\t\t\t\t\t\tget: function () {\r\n\r\n\t\t\t\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\t\t\t\tvertex1: faceEdges.edge1.vertex1,\r\n\t\t\t\t\t\t\t\t\tvertex2: faceEdges.edge1.vertex2,\r\n\t\t\t\t\t\t\t\t\tget vertex3() {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( !faceEdges.edge3 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.error( 'faceEdges.edge3 = ' + faceEdges.edge3 );\r\n\t\t\t\t\t\t\t\t\t\t\tif ( faceEdges.edge1.vertex1.index === faceEdges.edge2.vertex1.index )\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn faceEdges.edge2.vertex2;\r\n\t\t\t\t\t\t\t\t\t\t\tif ( faceEdges.edge1.vertex1.index === faceEdges.edge2.vertex2.index )\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn faceEdges.edge2.vertex1;\r\n\t\t\t\t\t\t\t\t\t\t\tif ( faceEdges.edge1.vertex2.index === faceEdges.edge2.vertex1.index )\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn faceEdges.edge2.vertex2;\r\n\t\t\t\t\t\t\t\t\t\t\tif ( faceEdges.edge1.vertex2.index === faceEdges.edge2.vertex2.index )\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn faceEdges.edge2.vertex1;\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn ( faceEdges.edge1.vertex1.index !== faceEdges.edge3.vertex1.index ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t( faceEdges.edge1.vertex2.index !== faceEdges.edge3.vertex1.index ) ?\r\n\t\t\t\t\t\t\t\t\t\t\tfaceEdges.edge3.vertex1 : faceEdges.edge3.vertex2;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\t//прилегающие к грани ребра\r\n\t\t\t\t\tfunction emtyIntersection() {\r\n\t\t\t\t\t\treturn {\r\n\r\n\t\t\t\t\t\t\tintersection: [],\r\n\t\t\t\t\t\t\tisSame: function () { return true; },\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst intersectionEdges = {};//список ребер, имеющих пересечения\r\n\t\t\t\t\t//список всех ребер грани\r\n\t\t\t\t\tconst faceEdges = {\r\n\r\n\t\t\t\t\t\tset edge1( edge1 ) { intersectionEdges.edge1 = edge1; },\r\n\t\t\t\t\t\tget edge1() {\r\n\r\n\t\t\t\t\t\t\tif ( intersectionEdges.edge1 ) return intersectionEdges.edge1;\r\n\t\t\t\t\t\t\treturn emtyIntersection();\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset edge2( edge2 ) { intersectionEdges.edge2 = edge2; },\r\n\t\t\t\t\t\tget edge2() {\r\n\r\n\t\t\t\t\t\t\tif ( intersectionEdges.edge2 ) return intersectionEdges.edge2;\r\n\t\t\t\t\t\t\treturn emtyIntersection();\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset edge3( edge3 ) { intersectionEdges.edge3 = edge3; },\r\n\t\t\t\t\t\tget edge3() {\r\n\r\n\t\t\t\t\t\t\tif ( intersectionEdges.edge3 ) return intersectionEdges.edge3;\r\n\t\t\t\t\t\t\treturn emtyIntersection();\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget intersectionObjects() {\r\n\r\n\t\t\t\t\t\t\tconst intersectionObjects = [];\r\n\t\t\t\t\t\t\tfunction getObects( intersections ) {\r\n\r\n\t\t\t\t\t\t\t\tintersections.forEach( function ( intersection ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar boAdded = false;\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < intersectionObjects.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( intersection.object.uuid === intersectionObjects[i].uuid ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tboAdded = true;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif ( !boAdded ) intersectionObjects.push( intersection.object );\r\n\r\n\t\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgetObects( faceEdges.edge1.intersection );\r\n\t\t\t\t\t\t\tgetObects( faceEdges.edge2.intersection );\r\n\t\t\t\t\t\t\tgetObects( faceEdges.edge3.intersection );\r\n\t\t\t\t\t\t\treturn intersectionObjects;\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset intersectionObject( intersectionObject ) {\r\n\r\n\t\t\t\t\t\t\tfaceEdges.edge1.intersectionObject = intersectionObject;\r\n\t\t\t\t\t\t\tfaceEdges.edge2.intersectionObject = intersectionObject;\r\n\t\t\t\t\t\t\tfaceEdges.edge3.intersectionObject = intersectionObject;\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget intersectionObject() { return faceEdges.edge1.intersectionObject; },\r\n\r\n\t\t\t\t\t}; \r\n\r\n\t\t\t\t\t//Каждый face имеет три вершины vectorIndex\r\n\t\t\t\t\t//в этом цикле из списка всех ребер edges, полученных из object.geometry.index,\r\n\t\t\t\t\t//для face ищем три ребра faceEdges.edge1, faceEdges.edge2, faceEdges.edge3\r\n\t\t\t\t\t//и для каждого ребра ищем два face, которым принадлежит это ребро edge.faces.face1 и edge.faces.face2\r\n\t\t\t\t\tfor ( var i = edges.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\t\tconst edge = edges[i],\r\n\t\t\t\t\t\t\tvertex1Index = edge.vertex1.index,//object.geometry.index.array[edge.vertex1.index],\r\n\t\t\t\t\t\t\tvertex2Index = edge.vertex2.index;//object.geometry.index.array[edge.vertex2.index];\r\n\t\t\t\t\t\tfunction setFace( face ) {\r\n\r\n\t\t\t\t\t\t\tif ( !edge.faces ) edge.faces = {}\r\n\t\t\t\t\t\t\tif ( !edge.faces.face1 ) edge.faces.face1 = face;\r\n\t\t\t\t\t\t\telse if ( !edge.faces.face2 ) {\r\n\r\n\t\t\t\t\t\t\t\tedge.faces.face2 = face;\r\n\t\t\t\t\t\t\t\t//edges2.pop();\r\n\r\n\t\t\t\t\t\t\t} else console.error( 'Face: too many edge.faces' );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t( vectorIndex.x === vertex1Index ) && ( vectorIndex.y === vertex2Index ) ||\r\n\t\t\t\t\t\t\t( vectorIndex.x === vertex2Index ) && ( vectorIndex.y === vertex1Index )\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tif ( !faceEdges.edge1.isSame( edge ) ) console.error( 'Face: duplicate faceEdges.edge1' );\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tfaceEdges.edge1 = edge;\r\n\t\t\t\t\t\t\t\tsetFace( this );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t( vectorIndex.z === vertex1Index ) && ( vectorIndex.y === vertex2Index ) ||\r\n\t\t\t\t\t\t\t( vectorIndex.z === vertex2Index ) && ( vectorIndex.y === vertex1Index )\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tconst boSame = faceEdges.edge2.isSame( edge );\r\n\t\t\t\t\t\t\tif ( !boSame ) console.error( 'Face: duplicate faceEdges.edge2' );\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tfaceEdges.edge2 = edge;\r\n\t\t\t\t\t\t\t\tsetFace( this );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t( vectorIndex.z === vertex1Index ) && ( vectorIndex.x === vertex2Index ) ||\r\n\t\t\t\t\t\t\t( vectorIndex.z === vertex2Index ) && ( vectorIndex.x === vertex1Index )\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tif ( !faceEdges.edge3.isSame( edge ) ) console.error( 'Face: duplicate faceEdges.edge3' );\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tfaceEdges.edge3 = edge;\r\n\t\t\t\t\t\t\t\tsetFace( this );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.isCollision = function () {\r\n\r\n\t\t\t\t\t\treturn faceEdges.edge1.intersection.length || faceEdges.edge2.intersection.length || faceEdges.edge3.intersection.length;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.nextIntersectPoint = function ( point ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < arrayIntersectLines.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tfunction returnPoint( point ) {\r\n\r\n\t\t\t\t\t\t\t\tarrayIntersectLines.splice( i, 1 );\r\n\t\t\t\t\t\t\t\treturn point;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst intersectLine = arrayIntersectLines[i],\r\n\t\t\t\t\t\t\t\tuuid = point.uuid;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tpoint.edge.isSame( intersectLine.point1.edge ) &&\r\n\t\t\t\t\t\t\t\t( point.intersectionIndex === intersectLine.point1.intersectionIndex ) &&\r\n\t\t\t\t\t\t\t\t( uuid === intersectLine.point1.uuid )\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\treturn returnPoint( intersectLine.point2 );\r\n\t\t\t\t\t\t\telse if (\r\n\t\t\t\t\t\t\t\tpoint.edge.isSame( intersectLine.point2.edge ) &&\r\n\t\t\t\t\t\t\t\t( point.intersectionIndex === intersectLine.point2.intersectionIndex ) &&\r\n\t\t\t\t\t\t\t\t( uuid === intersectLine.point2.uuid )\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\treturn returnPoint( intersectLine.point1 );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.intersectLines = function () { return arrayIntersectLines; }\r\n\t\t\t\t\t//если эта грань имеет пересечения с объектом, то строим линии пересечения грани с объектом\r\n\t\t\t\t\tthis.intersections = function () {\r\n\r\n\t\t\t\t\t\t//список объектов пересечения \r\n\t\t\t\t\t\t//Внимание! Нельзя удадять intersectionObjects потому что размер массива faceEdges.intersectionObjects меняется при\r\n\t\t\t\t\t\t//изменении faceEdges.intersectionObject и тогда могут быть пропущены некторые линии пересечения грани с объектом\r\n\t\t\t\t\t\tconst intersectionObjects = faceEdges.intersectionObjects;\r\n\r\n\t\t\t\t\t\t//Для каждого объекта пересечения делаем отдельные линии пересечения\r\n\t\t\t\t\t\tfor ( var iIntersectionObject = 0; iIntersectionObject < intersectionObjects.length; iIntersectionObject++ ) {\r\n\r\n\t\t\t\t\t\t\t//Линии переаечения начинаем строить с faceEdges.edge1.vertex1.\r\n\t\t\t\t\t\t\tfaceEdges.intersectionObject = intersectionObjects[iIntersectionObject];\r\n\t\t\t\t\t\t\tif ( !this.isCollision() )\r\n\t\t\t\t\t\t\t\tcontinue;//не пересекается\r\n\r\n\t\t\t\t\t\t\t//Надо убрать точки пересечения с одинаковыми координатами но в разных ребрах.\r\n\t\t\t\t\t\t\t//Это может произойти если начало или конец ребра пересекается с объектом\r\n\t\t\t\t\t\t\t//Тогда одна и таже точка будет в начале одного ребра и в конце другого\r\n\t\t\t\t\t\t\t//и количество точек будет нечетным. А это означает что грань вроде бы попала на край объекта\r\n\t\t\t\t\t\t\t//а я не рисую линию пересечения на краю объекта потому что не знаю как это делать\r\n\t\t\t\t\t\t\tfor ( var i = faceEdges.edge1.intersection.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\t\t\t\tfor ( var j = faceEdges.edge2.intersection.length - 1; j >= 0; j-- ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( ( faceEdges.edge1.intersection.length > i ) && ( faceEdges.edge2.intersection.length > j ) &&\r\n\t\t\t\t\t\t\t\t\t\t\tequals( faceEdges.edge1.intersection[i].point, faceEdges.edge2.intersection[j].point ) )\r\n\t\t\t\t\t\t\t\t\t\tfaceEdges.edge2.spliceIntersection( j, faceEdges.intersectionObject.uuid );\r\n\t\t\t\t\t\t\t\t\tfor ( var k = faceEdges.edge3.intersection.length - 1; k >= 0; k-- ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( ( faceEdges.edge1.intersection.length > i ) && ( faceEdges.edge3.intersection.length > k ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t\tequals( faceEdges.edge1.intersection[i].point, faceEdges.edge3.intersection[k].point ) )\r\n\t\t\t\t\t\t\t\t\t\t\tfaceEdges.edge3.spliceIntersection( k, faceEdges.intersectionObject.uuid );\r\n\t\t\t\t\t\t\t\t\t\tif ( ( faceEdges.edge2.intersection.length > j ) && ( faceEdges.edge3.intersection.length > k ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t\tequals( faceEdges.edge2.intersection[j].point, faceEdges.edge3.intersection[k].point ) )\r\n\t\t\t\t\t\t\t\t\t\t\tfaceEdges.edge3.spliceIntersection( k, faceEdges.intersectionObject.uuid );\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tfunction isOdd( num ) { return num % 2; }\r\n\t\t\t\t\t\t\tfunction isOddOrZero( num ) { return isOdd( num ); }\r\n\r\n\t\t\t\t\t\t\tfunction arrayIntersectionsPushEdge( vertexIndex, edge ) {\r\n\r\n\t\t\t\t\t\t\t\tswitch ( vertexIndex ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase edge.vertex1.index:\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < edge.intersection.length; i++ )\r\n\t\t\t\t\t\t\t\t\t\t\tarrayPushEdge( edge, i );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase edge.vertex2.index:\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor ( var i = edge.intersection.length - 1; i >= 0; i-- )\r\n\t\t\t\t\t\t\t\t\t\t\tarrayPushEdge( edge, i );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tdefault: console.error( 'Face.intersections: arrayIntersections push failed!' );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfunction arrayIntersectionsPushEdge3( vertexIndex ) { arrayIntersectionsPushEdge( vertexIndex, faceEdges.edge3 ); }\r\n\t\t\t\t\t\t\tfunction arrayIntersectionsPushEdge2( vertexIndex ) { arrayIntersectionsPushEdge( vertexIndex, faceEdges.edge2 ); }\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst arrayIntersections = [];//Все точки пересечения, начиная с faceEdges.edge1\r\n\t\t\t\t\t\t\tfunction arrayPushEdge( edge, intersectionIndex )\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tconst intersection = edge.intersection[intersectionIndex];\r\n\t\t\t\t\t\t\t\tarrayIntersections.push( {\r\n\r\n\t\t\t\t\t\t\t\t\tget edge() { return edge; },\r\n\t\t\t\t\t\t\t\t\tget intersectionIndex() { return intersectionIndex; },\r\n\t\t\t\t\t\t\t\t\tget uuid() { return intersection.object.uuid; },\r\n\t\t\t\t\t\t\t\t\tget faces() { return edge.faces; },\r\n\t\t\t\t\t\t\t\t\tget point() { return intersection.point; },\r\n\t\t\t\t\t\t\t\t\tget intersection() { return intersection; },\r\n\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar lastEdge;//ребро, которое имеет общую точку с faceEdges.edge1.vertex1\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < faceEdges.edge1.intersection.length; i++ )\r\n\t\t\t\t\t\t\t\tarrayPushEdge( faceEdges.edge1, i );\r\n\t\t\t\t\t\t\tswitch ( faceEdges.edge1.vertex2.index ) {\r\n\r\n\t\t\t\t\t\t\t\tcase faceEdges.edge2.vertex1.index:\r\n\r\n\t\t\t\t\t\t\t\t\tlastEdge = faceEdges.edge3;\r\n\t\t\t\t\t\t\t\t\t//первая точка пересечения в faceEdges.edge2.intersection находтся ближе к faceEdges.edge1.vertex2\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < faceEdges.edge2.intersection.length; i++ )\r\n\t\t\t\t\t\t\t\t\t\tarrayPushEdge( faceEdges.edge2, i );\r\n\t\t\t\t\t\t\t\t\tarrayIntersectionsPushEdge3( faceEdges.edge2.vertex2.index );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase faceEdges.edge2.vertex2.index:\r\n\r\n\t\t\t\t\t\t\t\t\tlastEdge = faceEdges.edge3;\r\n\t\t\t\t\t\t\t\t\t//первая точка пересечения в faceEdges.edge2.intersection находтся дальше от faceEdges.edge1.vertex2\r\n\t\t\t\t\t\t\t\t\tfor ( var i = faceEdges.edge2.intersection.length - 1; i >= 0; i-- )\r\n\t\t\t\t\t\t\t\t\t\tarrayPushEdge( faceEdges.edge2, i );\r\n\t\t\t\t\t\t\t\t\tarrayIntersectionsPushEdge3( faceEdges.edge2.vertex1.index );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase faceEdges.edge3.vertex1.index:\r\n\r\n\t\t\t\t\t\t\t\t\tlastEdge = faceEdges.edge2;\r\n\t\t\t\t\t\t\t\t\t//первая точка пересечения в faceEdges.edge3.intersection находтся ближе к faceEdges.edge1.vertex2\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < faceEdges.edge3.intersection.length; i++ )\r\n\t\t\t\t\t\t\t\t\t\tarrayPushEdge( faceEdges.edge3, i );\r\n\t\t\t\t\t\t\t\t\tarrayIntersectionsPushEdge2( faceEdges.edge3.vertex2.index );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tcase faceEdges.edge3.vertex2.index:\r\n\r\n\t\t\t\t\t\t\t\t\tlastEdge = faceEdges.edge2;\r\n\t\t\t\t\t\t\t\t\t//первая точка пересечения в faceEdges.edge3.intersection находтся дальше от faceEdges.edge1.vertex2\r\n\t\t\t\t\t\t\t\t\tfor ( var i = faceEdges.edge3.intersection.length - 1; i >= 0; i-- )\r\n\t\t\t\t\t\t\t\t\t\tarrayPushEdge( faceEdges.edge3, i );\r\n\t\t\t\t\t\t\t\t\tarrayIntersectionsPushEdge2( faceEdges.edge3.vertex1.index );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\tdefault: console.error( 'Face.intersections: arrayIntersections push failed!' );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst intersectionCount = arrayIntersections.length;\r\n\t\t\t\t\t\t\tif ( isOdd( intersectionCount ) ) {\r\n\r\n\t\t\t\t\t\t\t\t//console.log( 'Нечетное количество точек пересечения. Край объекта' );\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfunction addIntersectLine( point1, point2 ) { arrayIntersectLines.push( { point1: point1, point2: point2 } ); }\r\n\r\n\t\t\t\t\t\t\t//Найти в списке граней, имеющих линии пересечения список граней для текущего объекта пересечения faceEdges.intersectionObject\r\n\t\t\t\t\t\t\tlet arrayMesh;\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < arrayIntersectFaces.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( arrayIntersectFaces[i].mesh.uuid === faceEdges.intersectionObject.uuid ) {\r\n\r\n\t\t\t\t\t\t\t\t\tarrayMesh = arrayIntersectFaces[i];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//Если этого списка нет, то добавить его\r\n\t\t\t\t\t\t\tif ( !arrayMesh ) {\r\n\r\n\t\t\t\t\t\t\t\tarrayMesh = [];\r\n\t\t\t\t\t\t\t\tarrayMesh.mesh = faceEdges.intersectionObject;\r\n\t\t\t\t\t\t\t\tarrayIntersectFaces.push( arrayMesh );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tarrayMesh.push( this );\r\n\r\n\t\t\t\t\t\t\tif ( intersectionCount === 2 )\r\n\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[0], arrayIntersections[1] );\r\n\t\t\t\t\t\t\telse if ( !isOddOrZero( faceEdges.edge1.intersection.length ) || !isOddOrZero( lastEdge.intersection.length ) ) {\r\n\r\n\t\t\t\t\t\t\t\t//faceEdges.edge1.vertex1 нахоится снаружи объекта.\r\n\r\n\t\t\t\t\t\t\t\t//Возможно грань персекается с вершиной объекта в которой сходится 3 грани.\r\n\t\t\t\t\t\t\t\t//Другими словами грань как бы надета на вершину пирамиды\r\n\t\t\t\t\t\t\t\tvar boDetected = false;\r\n\t\t\t\t\t\t\t\tif ( intersectionCount === 6 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tfunction equalFaces( face1, face2 ) { return ( face1.a === face2.a ) && ( face1.b === face2.b ) && ( face1.c === face2.c ); }\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[0].intersection.face, arrayIntersections[5].intersection.face ) &&\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[1].intersection.face, arrayIntersections[2].intersection.face ) &&\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[3].intersection.face, arrayIntersections[4].intersection.face )\r\n\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[0], arrayIntersections[5] );\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[1], arrayIntersections[2] );\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[3], arrayIntersections[4] );\r\n\t\t\t\t\t\t\t\t\t\tboDetected = true;\r\n\r\n\t\t\t\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[0].intersection.face, arrayIntersections[1].intersection.face ) &&\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[2].intersection.face, arrayIntersections[3].intersection.face ) &&\r\n\t\t\t\t\t\t\t\t\t\tequalFaces( arrayIntersections[4].intersection.face, arrayIntersections[5].intersection.face )\r\n\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error( 'under constraction' );\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[0], arrayIntersections[1] );\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[2], arrayIntersections[3] );\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[4], arrayIntersections[5] );\r\n\t\t\t\t\t\t\t\t\t\tboDetected = true;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( !boDetected ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//Тогда первую линию пересечения проводим через ближайшие к faceEdges.edge1.vertex1 точки пересечения\r\n\t\t\t\t\t\t\t\t\t//console.log( faceEdges.intersectionObject.name + ' faceEdges.edge1.vertex1 нахоится снаружи объекта.' );\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < intersectionCount / 2; i++ )\r\n\t\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[i], arrayIntersections[intersectionCount - 1 - i] );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t//faceEdges.edge1.vertex1 нахоится внутри объекта.\r\n\t\t\t\t\t\t\t\t//Тогда сегметы линий пересечения делаем последовательно из точек arrayIntersections\r\n\t\t\t\t\t\t\t\t//console.log( faceEdges.intersectionObject.name + ' faceEdges.edge1.vertex1 нахоится внутри объекта.' );\r\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < intersectionCount; i += 2 )\r\n\t\t\t\t\t\t\t\t\taddIntersectLine( arrayIntersections[i], arrayIntersections[i + 1] );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfaceEdges.intersectionObject = undefined;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tfaces.push( new Face( index, faces.length ) );\r\n\r\n\t\t\tindex += 3;\r\n//\t\t\tsetTimeout( function () { step(); }, 0 );\r\n\t\t\tprogressBar.step();\r\n\r\n\t\t}\r\n//\t\tsetTimeout( function () { step(); }, 0 );\r\n\r\n\t\tfunction equals( point1, point2 ) {\r\n\r\n\t\t\treturn point1.distanceTo( point2 ) <= 9.0e-10;//8.881784197001252e-16;\r\n\r\n\t\t}\r\n\r\n\t\tvar boCreateIntersections = false;\r\n\t\tfunction createIntersections() {\r\n\r\n\t\t\tif ( !boCreateIntersections ) return;\r\n\r\n\t\t\tarrayIntersectFaces.length = 0;\r\n\r\n\t\t\t//Удалить линии пересечения\r\n\t\t\tfor ( var i = intersectionLines.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t//https://stackoverflow.com/a/68004442/5175935\r\n\t\t\t\tfunction removeObject3D( object3D ) {\r\n\r\n\t\t\t\t\tif ( !( object3D instanceof THREE.Object3D ) ) return false;\r\n\r\n\t\t\t\t\t// for better memory management and performance\r\n\t\t\t\t\tobject3D.geometry.dispose();\r\n\t\t\t\t\tif ( object3D.material instanceof Array ) {\r\n\t\t\t\t\t\t// for better memory management and performance\r\n\t\t\t\t\t\tobject3D.material.forEach( material => material.dispose() );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// for better memory management and performance\r\n\t\t\t\t\t\tobject3D.material.dispose();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tobject3D.removeFromParent(); // the parent might be the scene or another Object3D, but it is sure to be removed this way\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst arrayIntersectLine = intersectionLines[i];\r\n\t\t\t\tif ( arrayIntersectLine.intersectLine ) {\r\n\r\n\t\t\t\t\tremoveObject3D( arrayIntersectLine.intersectLine );\r\n\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.removeMesh( arrayIntersectLine.intersectLine );\r\n\t\t\t\t\tarrayIntersectLine.intersectLine = null;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( arrayIntersectLine.intersectPoints ) {\r\n\r\n\t\t\t\t\tremoveObject3D( arrayIntersectLine.intersectPoints );\r\n\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.removeMesh( arrayIntersectLine.intersectPoints );\r\n\t\t\t\t\tarrayIntersectLine.intersectPoints = null;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tintersectionLines.pop();\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//ищем точки пересечения\r\n\t\t\tedges.forEach( function ( edge ) {\r\n\r\n\t\t\t\tedge.intersection = undefined;\r\n\t\t\t\tedge.intersection;\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//Строим линии пересечения с гранью\r\n\t\t\tfaces.forEach( function ( face ) { face.intersections(); } );\r\n\r\n\t\t\t//строим линию пересечения с объектом\r\n\t\t\tarrayIntersectFaces.forEach( function ( meshLines ) {\r\n\r\n\t\t\t\tmeshLines.forEach( function ( face ) {\r\n\r\n\t\t\t\t\tconst arrayIntersectLines = face.intersectLines();\r\n\t\t\t\t\tfor ( var i = arrayIntersectLines.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\t\tconst line = arrayIntersectLines[i];\r\n\t\t\t\t\t\tif ( !line )\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tif ( meshLines.mesh.uuid !== line.point1.uuid )\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\tarrayIntersectLines.splice( i, 1 );\r\n\t\t\t\t\t\tconst points = [line.point1.point];\r\n\t\t\t\t\t\tvar point = line.point2, faceNext = face,\r\n\t\t\t\t\t\t\tboPush = true;//false - добавлять новую точку в начало points\r\n\t\t\t\t\t\twhile ( true ) {\r\n\r\n\t\t\t\t\t\t\tif ( boPush ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( !equals( points[points.length - 1], point.point ) )//не добавлять две одинаковые точки подряд\r\n\t\t\t\t\t\t\t\t\tpoints.push( point.point );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tif ( !equals( points[0], point.point ) )//не добавлять две одинаковые точки подряд\r\n\t\t\t\t\t\t\t\t\tpoints.unshift( point.point );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst faces = point.faces;\r\n\t\t\t\t\t\t\tif ( faceNext.id.equals( faces.face1.id ) )\r\n\t\t\t\t\t\t\t\tfaceNext = faces.face2;\r\n\t\t\t\t\t\t\telse if ( faceNext.id.equals( faces.face2.id ) )\r\n\t\t\t\t\t\t\t\tfaceNext = faces.face1;\r\n\t\t\t\t\t\t\telse console.error( 'Intersections.createIntersections: get twin face failed' );\r\n\t\t\t\t\t\t\tif ( !faceNext )\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tvar pointEnd = point;\r\n\t\t\t\t\t\t\tpoint = faceNext.nextIntersectPoint( point );\r\n\t\t\t\t\t\t\tif ( !point ) {\r\n\r\n\t\t\t\t\t\t\t\tconst vertexId = equals( pointEnd.point, pointEnd.edge.vertex1.point ) ?\r\n\t\t\t\t\t\t\t\t\tpointEnd.edge.vertex1.index : equals( pointEnd.point, pointEnd.edge.vertex2.point ) ?\r\n\t\t\t\t\t\t\t\t\t\tpointEnd.edge.vertex2.index : undefined;\r\n\t\t\t\t\t\t\t\tfaceNext = undefined;\r\n\t\t\t\t\t\t\t\tif ( vertexId ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//Текущая точка линии пересечения не находится на соседней грани \r\n\t\t\t\t\t\t\t\t\t//и совпадает с одной из вершин ребра pointEnd.edge.\r\n\t\t\t\t\t\t\t\t\t//Поэтому продолжение линии пересечения надо искать на гранях, имеющих общие вершины с pointEnd.edge\r\n\t\t\t\t\t\t\t\t\tfor ( var iIntersectFaces = 0; iIntersectFaces < arrayIntersectFaces.length; iIntersectFaces++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( pointEnd.uuid !== arrayIntersectFaces[iIntersectFaces].mesh.uuid )\r\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t\tfor ( var jIntersectFaces = 0; jIntersectFaces < arrayIntersectFaces[iIntersectFaces].length; jIntersectFaces++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst face = arrayIntersectFaces[iIntersectFaces][jIntersectFaces];\r\n\t\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge1.vertex1.index === vertexId ) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge1.vertex2.index === vertexId ) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge2.vertex1.index === vertexId ) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge2.vertex2.index === vertexId ) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge3.vertex1.index === vertexId ) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t( face.faceEdges.edge3.vertex2.index === vertexId )\r\n\t\t\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst intersectLines = face.intersectLines();\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor ( var k = 0; k < intersectLines.length; k++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst line2 = intersectLines[k];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( equals( pointEnd.point, line2.point1.point ) )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoint = line2.point1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\telse if ( equals( pointEnd.point, line2.point2.point ) )\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoint = line2.point2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ( point ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfaceNext = face;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoint = faceNext.nextIntersectPoint( point );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( faceNext ) break;//обнаружена грань, имеющая общую вершину с pointEnd.edge\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif ( faceNext ) break;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( !faceNext ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//не нашел ни одной грани у которой точка пересечения проходит через вершину и равна последней точке в points\r\n\t\t\t\t\t\t\t\t\t//Может быть линию персечения нужно достроить с другого конца первой точки?\r\n\t\t\t\t\t\t\t\t\tpointEnd = line.point1;\r\n\t\t\t\t\t\t\t\t\tconst face1IntersectLines = pointEnd.faces.face1.intersectLines(),\r\n\t\t\t\t\t\t\t\t\t\tface = face1IntersectLines.length ? pointEnd.faces.face1 : pointEnd.faces.face2,\r\n\t\t\t\t\t\t\t\t\t\tintersectLines = face.intersectLines();\r\n\t\t\t\t\t\t\t\t\tfor ( var iIntersectLines = 0; iIntersectLines < intersectLines.length; iIntersectLines++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst intersectLine = intersectLines[iIntersectLines];\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t( intersectLine.point1.uuid === pointEnd.uuid ) &&\r\n\t\t\t\t\t\t\t\t\t\t\tintersectLine.point1.edge.isSame( pointEnd.edge ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t( intersectLine.point1.intersectionIndex === pointEnd.intersectionIndex )\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\tpoint = intersectLine.point1;\r\n\t\t\t\t\t\t\t\t\t\telse if (\r\n\t\t\t\t\t\t\t\t\t\t\t( intersectLine.point2.uuid === pointEnd.uuid ) &&\r\n\t\t\t\t\t\t\t\t\t\t\tintersectLine.point2.edge.isSame( pointEnd.edge ) &&\r\n\t\t\t\t\t\t\t\t\t\t\t( intersectLine.point2.intersectionIndex === pointEnd.intersectionIndex )\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\tpoint = intersectLine.point2;\r\n\t\t\t\t\t\t\t\t\t\tif ( point ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//обнаружена грань, имеющая линию пересечения, которая является продолжением первой точки линии пересечения\r\n\t\t\t\t\t\t\t\t\t\t\tfaceNext = face;\r\n\t\t\t\t\t\t\t\t\t\t\tpoint = faceNext.nextIntersectPoint( point );\r\n\t\t\t\t\t\t\t\t\t\t\tboPush = false;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif ( !faceNext ) break;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( points.length > 1 ) {//не добавлять линию с количеством точек меньше 2\r\n\r\n\t\t\t\t\t\t\tvar color = 0xffffff;\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < collidableMeshList.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( collidableMeshList[i].uuid === meshLines.mesh.uuid ) {\r\n\r\n\t\t\t\t\t\t\t\t\tcolor = arrayIntersectLinesColor[i];\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst arrayIntersectLine = {\r\n\r\n\t\t\t\t\t\t\t\tintersectLine: new THREE.Line( new THREE.BufferGeometry().setFromPoints( points ),\r\n\t\t\t\t\t\t\t\t\tnew THREE.LineBasicMaterial( { color: color } ) ),\r\n\t\t\t\t\t\t\t\tmesh: meshLines.mesh,//с этим объектом пересекается\r\n\t\t\t\t\t\t\t\tcolor: color,\r\n\t\t\t\t\t\t\t\tpoints: points,\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tintersectionLines.push( arrayIntersectLine );\r\n\t\t\t\t\t\t\tscene.add( arrayIntersectLine.intersectLine );\r\n\t\t\t\t\t\t\tif ( options.guiSelectPoint ) {\r\n\r\n\t\t\t\t\t\t\t\tarrayIntersectLine.intersectLine.name =\r\n\t\t\t\t\t\t\t\t\t( arrayIntersectLine.mesh.name === '' ? intersectionLines.length : arrayIntersectLine.mesh.name ) +\r\n\t\t\t\t\t\t\t\t\t'-' + ( object.name === '' ? 'intersection' : object.name );\r\n\t\t\t\t\t\t\t\toptions.guiSelectPoint.addMesh( arrayIntersectLine.intersectLine );\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t} );\r\n\t\t\tif ( settings.onReady ) settings.onReady( intersectionLines );\r\n\r\n\t\t}\r\n//\t\tsetTimeout( function () { createIntersections(); }, 0 );//Таймаут нужен что бы установился matrixWorld объектов из collidableMeshList.\r\n\t\t//Иначе линии пересечения будут строиться без учета реального положения, повррота и масштаба объектов из collidableMeshList.\r\n\r\n\t\t//список всех объектов, которые могут перемещаться и сталкиваться\r\n\t\tconst arrayMovingObjects = [object];\r\n\t\tcollidableMeshList.forEach( function ( object ) { arrayMovingObjects.push( object ); } );\r\n\t\tarrayMovingObjects.forEach( function ( object ) {\r\n\r\n\t\t\tobject.userData.position = object.position.clone();\r\n\t\t\tobject.userData.rotation = object.rotation.clone();\r\n\t\t\tobject.userData.scale = object.scale.clone();\r\n\r\n\t\t} );\r\n\t\tfunction movingObjects() {\r\n\r\n\t\t\tfor ( var i = 0; i < arrayMovingObjects.length; i++ ) {\r\n\r\n\t\t\t\tconst object = arrayMovingObjects[i];\r\n\t\t\t\tif (\r\n\t\t\t\t\t!object.userData.position.equals( object.position ) ||\r\n\t\t\t\t\t!object.userData.rotation.equals( object.rotation ) ||\r\n\t\t\t\t\t!object.userData.scale.equals( object.scale )\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\tobject.userData.position = object.position.clone();\r\n\t\t\t\t\tobject.userData.rotation = object.rotation.clone();\r\n\t\t\t\t\tobject.userData.scale = object.scale.clone();\r\n\r\n\t\t\t\t\tcreateIntersections();\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\twindow.requestAnimationFrame( movingObjects );\r\n\r\n\t\t}\r\n\t\twindow.requestAnimationFrame( movingObjects );\r\n\r\n\t}\r\n\r\n}\r\nexport default Intersections;\r\n","/**\r\n * @module TreeView\r\n * @description Tree view with CSS and JavaScript. Thanks to [Learn how to create a tree view with CSS and JavaScript.]{@link https://www.w3schools.com/howto/howto_js_treeview.asp}\r\n * \r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n */\r\n\r\nimport cookie from '../cookieNodeJS/cookie.js';\r\n\r\nclass TreeView {\r\n\r\n\t/**\r\n\t * @class Tree view with CSS and JavaScript. Thanks to [Learn how to create a tree view with CSS and JavaScript.]{@link https://www.w3schools.com/howto/howto_js_treeview.asp}\r\n\t * @param {object} [settings={}] the following settings are available:\r\n\t * @param {boolean} [settings.animate] true - allows you to open/close a tree branch smoothly.\r\n\t * @param {string} [settings.paddingInlineStart=\"40px\"] right shift of the tree branch. Example: \"10px\"\r\n\t * @param {boolean} [settings.cookie] true - remember the open/close tree branch state after closing of the web page.\r\n\t */\r\n\tconstructor( settings = {} ) {\r\n\r\n\t\t//https://www.w3schools.com/howto/howto_js_treeview.asp\r\n\r\n\t\tconst toggler = document.getElementsByClassName( \"caret\" ), cookieName = 'TreeView_';\r\n\t\tvar i, id = 1;\r\n\t\tfor ( i = 0; i < toggler.length; i++ ) {\r\n\r\n\t\t\tconst elNested = toggler[i].parentElement.querySelector( \".nested\" ),\r\n\t\t\t\tboHide = elNested.classList.contains('hide');\r\n\t\t\tif ( settings.animate !== undefined ) {\r\n\t\t\t\t\r\n\t\t\t\telNested.style.display = boHide ? 'none' : 'block';\r\n\t\t\t\telNested.classList.add( 'b-toggle' );\r\n\r\n\t\t\t}\r\n\t\t\tif ( settings.paddingInlineStart !== undefined ) elNested.style.paddingInlineStart = settings.paddingInlineStart;\r\n\t\t\tlet boBranchOpen = settings.open ? settings.open : false;\r\n\t\t\tif ( settings.cookie ) {\r\n\r\n\t\t\t\tif ( elNested.id === '' ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst branchId = 'branch_' + id;\r\n\t\t\t\t\tid++;\r\n\t\t\t\t\tif ( document.getElementById( branchId ) ) console.error( 'duplicate branch id: ' + branchId );\r\n\t\t\t\t\telse elNested.id = branchId;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch( cookie.get( cookieName + elNested.id ) ) {\r\n\r\n\t\t\t\t\tcase 'false': boBranchOpen = false; break;\r\n\t\t\t\t\tcase 'true': boBranchOpen = true; break;\r\n\t\t\t\t\tcase '': break;\r\n\t\t\t\t\tdefault: console.error( 'TreeView: Invalid cookie value' );\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( ( boBranchOpen !== undefined ) && ( boBranchOpen === boHide ) ) {\r\n\t\t\t\t\r\n\t\t\t\telNested.classList.toggle( \"hide\" );\r\n\t\t\t\telNested.classList.toggle( \"active\" );\r\n\t\t\t\telNested.style.display = boHide ? 'block' : 'none';\r\n\r\n\t\t\t}\r\n\t\t\tif ( !elNested.classList.contains('hide') ) {\r\n\t\t\t\t\r\n\t\t\t\tconst classList = elNested.parentElement.querySelector( \".caret\" ).classList;\r\n\t\t\t\tif ( !classList.contains( \"caret-down\" ) ) classList.toggle( \"caret-down\" );\r\n\r\n\t\t\t}\r\n\t\t\ttoggler[i].addEventListener( \"click\", function () {\r\n\r\n\t\t\t\tconst elNested = this.parentElement.querySelector( \".nested\" );\r\n\r\n\t\t\t\t//если не менять elNested.style.display то в режиме animation при закрытии ветки ветка будет невидима,\r\n\t\t\t\t//но она будет загораживать часть нижних веток и поэтому открывать и закрывать нижние ветки можно будет только если щелкнуть в левой части ветки\r\n\t\t\t\t//elNested.boTimeout нужен что бы не было ложного срабатывания setTimeout когда пользователь быстро закрыл и снова открыл ветку\r\n\t\t\t\tif ( elNested.classList.contains( 'hide' ) ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\telNested.style.display = 'block';\r\n\t\t\t\t\telNested.boTimeout = false;\r\n\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\t\r\n\t\t\t\t\telNested.boTimeout = true;\r\n\t\t\t\t\tsetTimeout( function() { if ( elNested.boTimeout ) elNested.style.display = 'none'; }, 1000 );\r\n\r\n\t\t\t\t}\r\n/*\t\t\t\t\r\n\t\t\t\t\tboHide = elNested.classList.contains( 'hide' );\r\n\t\t\t\telNested.style.display = boHide ? 'block' : 'none';\r\n\t\t\t\tsetTimeout( function () { elNested.style.display = boHide ? 'none' : 'block'; }, 1000 );\r\n*/\r\n\t\t\t\telNested.classList.toggle( \"hide\" );\r\n\t\t\t\telNested.classList.toggle( \"active\" );\r\n\t\t\t\telNested.style.maxHeight = this.parentElement.querySelector( \".active\" ) ? elNested.offsetHeight + 'px' : '';\r\n\t\t\t\tthis.classList.toggle( \"caret-down\" );\r\n\r\n\t\t\t\tif ( settings.cookie )\r\n\t\t\t\t\tcookie.set( cookieName + elNested.id, !elNested.classList.contains( 'hide' ) );\r\n\r\n\t\t\t\t//если не выполнить эту команду, то меню на холсте будет состоять из двух строк\r\n\t\t\t\tif ( elNested.myThree ) elNested.myThree.setSize();// 300, 150 );\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Sets a canvas in the tree branch\r\n\t\t * @param {number} branchId tree branch identifier\r\n\t\t * @param {MyThree} myThree <a href=\"../../myThree/jsdoc/index.html\" target=\"_blank\">MyThree</a> instance.\r\n\t\t * @param {object} [settings={}] the following settings are available:\r\n\t\t * @param {number} [settings.width=300] width of the canvas\r\n\t\t * @param {number} [settings.height=150] height of the canvas\r\n\t\t */\r\n\t\tthis.setCanvas = function ( branchId, myThree, settings = {} ) {\r\n\r\n\t\t\t//если не выполнить эту команду, то холст будет пустой\r\n\t\t\tsettings.size = settings.size || {};\r\n\t\t\tif ( settings.size.width === undefined ) settings.size.width = 300;\r\n\t\t\tif ( settings.size.height === undefined ) settings.size.height = 150;\r\n\t\t\tmyThree.setSize( settings.size );\r\n\t\t\tdocument.getElementById( branchId ).myThree = myThree;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\nexport default TreeView;\r\n","/**\r\n * @module MyThree\r\n * @description I use MyThree in my projects for displaying of my 3D objects in the canvas.\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n */\r\n\r\nimport Player from '../player/player.js';\r\nimport MyPoints from '../myPoints/myPoints.js';\r\n\r\nimport StereoEffect from '../StereoEffect/StereoEffect.js';\r\n//import StereoEffect from 'https://raw.githack.com/anhr/commonNodeJS/master/StereoEffect/StereoEffect.js';\r\n\r\nimport CanvasMenu from '../canvasMenu/canvasMenu.js';\r\n//import CanvasMenu from 'https://raw.githack.com/anhr/commonNodeJS/master/canvasMenu/canvasMenu.js';\r\n\r\nimport { getLanguageCode } from '../lang.js';\r\n//import { getLanguageCode } from 'https://raw.githack.com/anhr/commonNodeJS/master/lang.js';\r\n\r\nimport AxesHelper from '../AxesHelper/AxesHelper.js';\r\n//import AxesHelper from 'https://raw.githack.com/anhr/commonNodeJS/master/AxesHelper/AxesHelper.js';\r\nimport AxesHelperGui from '../AxesHelper/AxesHelperGui.js';\r\n//import AxesHelperGui from 'https://raw.githack.com/anhr/commonNodeJS/master/AxesHelper/AxesHelperGui.js';\r\n\r\nimport OrbitControlsGui from '../OrbitControls/OrbitControlsGui.js';\r\n//import OrbitControlsGui from 'http://localhost/anhr/commonNodeJS/master/OrbitControls/OrbitControlsGui.js';\r\n//import OrbitControlsGui from 'https://raw.githack.com/anhr/commonNodeJS/master/OrbitControls/OrbitControlsGui.js';\r\n\r\nimport { dat } from '../dat/dat.module.js';\r\n\r\nimport GuiSelectPoint from '../guiSelectPoint/guiSelectPoint.js';\r\n\r\nimport { getWorldPosition } from '../getPosition.js';\r\n\r\nimport { SpriteTextGui } from '../SpriteText/SpriteTextGui.js';\r\n\r\nimport ColorPicker from '../colorpicker/colorpicker.js';\r\n//import ColorPicker from 'https://raw.githack.com/anhr/commonNodeJS/master/colorpicker/colorpicker.js';\r\n\r\nimport MoveGroupGui from '../MoveGroupGui.js';\r\n\r\nimport CameraGui from '../CameraGui.js';\r\n//import CameraGui from 'https://raw.githack.com/anhr/commonNodeJS/master/CameraGui.js';\r\n\r\nimport { getObjectPosition } from '../getPosition.js';\r\n\r\n//https://github.com/mrdoob/stats.js/\r\n//import Stats from '../../../three.js/dev/examples/jsm/libs/stats.module.js';\r\n\r\nimport FrustumPoints from '../frustumPoints/frustumPoints.js';\r\nimport three from '../three.js'\r\nif ( typeof dat !== 'undefined' )\r\n\tthree.dat =  dat;\r\n\r\nimport FolderPoint from '../folderPoint.js'\r\n\r\n/*проверка duplicate THREE\r\n//import * as THREE2 from 'https://threejs.org/build/three.module.js';\r\nimport * as THREE2 from '../../../three.js/dev/build/three.module.js';\r\nthree.THREE = THREE2;\r\n*/\r\n\r\nimport Options from '../Options.js'\r\n\r\nimport pointLight from '../pointLight.js'\r\n\r\nfunction arrayContainersF() {\r\n\r\n\tconst array = [];\r\n\tthis.push = function ( elContainer ) {\r\n\r\n\t\tarray.push( elContainer );\r\n\r\n\t};\r\n\tthis.display = function ( elContainer, fullScreen ) {\r\n\r\n\t\tarray.forEach( function ( itemElContainer ) {\r\n\r\n\t\t\titemElContainer.style.display = ( itemElContainer === elContainer ) || !fullScreen ? 'block' : 'none';\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\tObject.defineProperties( this, {\r\n\r\n\t\t/**\r\n\t\t * getter\r\n\t\t */\r\n\t\tlength: {\r\n\r\n\t\t\tget: function () {\r\n\r\n\t\t\t\treturn array.length;\r\n\r\n\t\t\t},\r\n\r\n\t\t},\r\n\r\n\t} );\r\n\r\n};\r\nconst arrayContainers = new arrayContainersF();\r\n\r\n/*\r\n * if you asynhronous creates two or more myThreejs same time, then you will receive the error message:\r\n * \r\n * Uncaught ReferenceError: WEBGL is not defined\r\n * \r\n * For resolving of the issue I have remembers myThreejs parameters in the arrayCreates\r\n * and creates next myThreejs only after creating of previous myThreejs.\r\n */\r\nvar arrayCreates = [];\r\n\r\n/**\r\n * @callback createXDobjects\r\n * @param {THREE.Group} group [group]{@link https://threejs.org/docs/index.html?q=Gro#api/en/objects/Group} of objects to which a new XD object will be added\r\n * @param {Options} options See <a href=\"../../jsdoc/Options/index.html\" target=\"_blank\">Options</a>. Followed parameters is allowed.\r\n * @param {THREE.PerspectiveCamera} [options.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n * @param {object} [options.frustumPoints] <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a> instance.\r\n * @param {object} [options.point] point settings. See <b>options.point</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> for details.\r\n * @param {Player} [options.player] <a href=\"../../Player/jsdoc/index.html\" target=\"_blank\">Player</a> instance. Playing of 3D ojbects in my projects.\r\n * @param {GuiSelectPoint} [options.guiSelectPoint] <a href=\"../../guiSelectPoint/jsdoc/index.html\" target=\"_blank\">GuiSelectPoint</a> instance.\r\n * @param {Options.raycaster.EventListeners} [options.eventListeners] <a href=\"../../jsdoc/Options/Raycaster_EventListeners.html\" target=\"_blank\">Options.raycaster.EventListeners</a> instance.\r\n * Mouse events listeners for [Raycaster]{@link https://threejs.org/docs/index.html?q=Raycaster#api/en/core/Raycaster} instance.\r\n * @param {THREE.WebGLRenderer} [options.renderer] [WebGLRenderer]{@link https://threejs.org/docs/index.html#api/en/renderers/WebGLRenderer}\r\n*/\r\n\r\nclass MyThree {\r\n\r\n\t/**\r\n\t * @description I use MyThree in my projects for displaying of my 3D objects in the canvas.\r\n\t * @param {createXDobjects} [createXDobjects] <a href=\"../../myThree/jsdoc/module-MyThree.html#~createXDobjects\" target=\"_blank\">callback</a> creates my 3D objects.\r\n\t * @param {Object} [options] See <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a>.\r\n\t * The following options are available:\r\n\t * @param {HTMLElement|string} [options.elContainer=document.getElementById( \"containerDSE\" ) or a new div element, child of body] If an HTMLElement, then a HTMLElement, contains a canvas and HTMLElement with id=\"iframe-goes-in-here\" for gui.\r\n\t * <pre>\r\n\t * If a string, then is id of the HTMLElement.\r\n\t * Examples of the <b>elContainer</b>:\r\n\t * <b>&lt;div class=\"container\" id=\"containerDSE\"&gt;\r\n\t * \t&lt;canvas id=\"canvas\" style=\"background-color:black\"&gt;&lt;/canvas&gt;\r\n\t * &lt;/div&gt</b>;\r\n\t * or\r\n\t * <b>&lt;div class=\"container\" id=\"containerDSE\"&gt;\r\n\t * &lt;/div&gt;</b>\r\n\t * New canvas is created inside of the div tag.\r\n\t * </pre>\r\n\t * \r\n\t * @param {THREE.PerspectiveCamera} [options.camera] [PerspectiveCamera]{@link https://threejs.org/docs/index.html#api/en/cameras/PerspectiveCamera}.\r\n\t * @param {THREE.Vector3} [options.camera.position=new THREE.Vector3( 0.4, 0.4, 2 )] camera position.\r\n\t * @param {THREE.Vector3} [options.camera.scale=new THREE.Vector3( 1, 1, 1 )] camera scale.\r\n\t * @param {Number} [options.camera.fov=70] Camera frustum vertical field of view. See [fov]{@link https://threejs.org/docs/?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.fov}.\r\n\t * @param {Number} [options.camera.aspect=window.innerWidth / window.innerHeight] Camera frustum aspect ratio. See [aspect]{@link https://threejs.org/docs/?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.aspect}.\r\n\t * @param {Number} [options.camera.near=0.01] Camera frustum near plane. See [near]{@link https://threejs.org/docs/?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.near}.\r\n\t * @param {Number} [options.camera.far=10] Camera frustum far plane. See [far]{@link https://threejs.org/docs/?q=PerspectiveCamera#api/en/cameras/PerspectiveCamera.far}.\r\n\t * \r\n\t * @param {THREE.Scene} [options.scene] [Scene]{@link https://threejs.org/docs/index.html#api/en/scenes/Scene}.\r\n\t * @param {THREE.Vector3} [options.scene.position=new THREE.Vector3( 0, 0, 0 )] scene position.\r\n\t * @param {boolean|object} [options.orbitControls] false - do not add the [OrbitControls]{@link https://threejs.org/docs/index.html#examples/en/controls/OrbitControls}. Allow the camera to orbit around a target.\r\n\t * <pre>\r\n\t * or\r\n\t * </pre>\r\n\t * @param {boolean} [options.orbitControls.enableRotate=true] Enable or disable horizontal and vertical rotation of the camera.\r\n\t * @param {boolean} [options.axesHelper] false - do not add the <a href=\"../../AxesHelper/jsdoc/index.html\" target=\"_blank\">AxesHelper</a>.\r\n\t * @param {boolean} [options.canvasMenu] false - do not create a <a href=\"../../canvasMenu/jsdoc/index.html\" target=\"_blank\">canvasMenu</a> instance.\r\n\t * @param {boolean} [options.stereoEffect] false - do not use <a href=\"../../StereoEffect/jsdoc/index.html\" target=\"_blank\">StereoEffect</a>.\r\n\t * @param {boolean|Object} [options.pointLight] false - do not use <a href=\"../../jsdoc/pointLight/index.html\" target=\"_blank\">pointLight</a>.\r\n\t * @param {Object} [options.pointLight.pointLight1] First <b>pointLight</b> settings.\r\n\t * @param {THREE.Vector3} [options.pointLight.pointLight1.position] <b>pointLight</b> position.\r\n\t * @param {Object} [options.pointLight.pointLight2] Second <b>pointLight</b> settings.\r\n\t * @param {THREE.Vector3} [options.pointLight.pointLight2.position] <b>pointLight</b> position.\r\n\t * @param {object} [options.spriteText] spriteText options. See <a href=\"../../SpriteText/jsdoc/module-SpriteText.html\" target=\"_blank\">SpriteText</a> <b>options</b> parameter for details.\r\n\t *\r\n\t * @param {boolean} [options.player] false - do not create a <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> instance.\r\n\t * @param {object} [options.playerOptions] See <b>settings.options.playerOptions</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.html\" target=\"_blank\">Player</a>.\r\n\t *\r\n\t * @param {Function|string} [options.getLanguageCode=language code of your browser] Your custom <b>getLanguageCode()</b> function or language code string.\r\n\t * <pre>\r\n\t * returns the \"primary language\" subtag of the language version of the browser.\r\n\t * Examples: \"en\" - English language, \"ru\" Russian.\r\n\t * See the {@link https://tools.ietf.org/html/rfc4646#section-2.1|rfc4646 2.1 Syntax} for details.\r\n\t * You can import { getLanguageCode } from '../../commonNodeJS/master/lang.js';\r\n\t * Currently available follow language code strings:\r\n\t *\t\"en\" - English language,\r\n\t *\t\"ru\" - Russian.\r\n\t * </pre>\r\n\t * @param {object|boolean} [options.dat] use dat-gui JavaScript Controller Library. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * <p>false - do not use dat-gui.</p>\r\n\t * @param {GUI} options.dat.dat [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {GUI} [options.dat.gui] new [dat.GUI()]{@link https://github.com/dataarts/dat.gui} instance.\r\n\t * <p>\r\n\t * undefined - do not use <b>dat-gui JavaScript Controller Library<b>. [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * </p>\r\n\t * @param {HTMLtag} [options.dat.parent] Parent of the canvas. Use if you want to see <b>dat.gui</b> inside of the canvas if canvas is not full screen.\r\n\t * @param {boolean} [options.dat.cookie] false - do not save to cookie all user settings\r\n\t * @param {string} [options.dat.cookieName] Name of the cookie.\r\n\t * @param {boolean} [options.dat.orbitControlsGui] false - do not adds a <a href=\"../../OrbitControls/jsdoc/\" target=\"_blank\">OrbitControlsGui</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [options.dat.axesHelperGui] false - do not adds a <a href=\"../../AxesHelper/jsdoc/module-AxesHelperGui.html\" target=\"_blank\">AxesHelperGui</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [options.dat.playerGui] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player.html#gui\" target=\"_blank\">Player controllers</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [options.dat.playController] false - do not adds a <a href=\"../../player/jsdoc/module-Player-Player_PlayController_PlayController.html\" target=\"_blank\">PlayController</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [options.dat.stereoEffectsGui] false - do not adds <a href=\"../../StereoEffect/jsdoc/module-StereoEffect-StereoEffect.html#gui\" target=\"_blank\">Stereo Effects folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean|Object} [options.dat.guiSelectPoint] false - do not displays the <a href=\"../../guiSelectPoint/jsdoc/module-GuiSelectPoint.html\" target=\"_blank\">Select Point</a>. [dat.gui]{@link https://github.com/dataarts/dat.gui} based graphical user interface for select a point from the mesh.\r\n\t * @param {Function} [options.dat.guiSelectPoint.point] Callback function to create custom controllers for each point of selected mesh with custom controllers.\r\n\t * <pre>\r\n\t * parameter <b>options</b> See <b>options</b> parameter above.\r\n\t * parameter <b>dat</b> [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t * parameter <b>fParent</b> parent folder.\r\n\t * example <b>point: function ( options, dat, fMesh ) { return new FermatSpiral.gui( options, dat, fMesh ); },</b>\r\n\t * </pre>\r\n\t * @param {boolean} [options.dat.guiSelectPoint.boDisplayVerticeID] true - display on the scene the point ID near to the point.\r\n\t * @param {boolean} [options.dat.guiFrustumPoints] false - do not adds <a href=\"../../FrustumPoints/jsdoc/FrustumPoints.html#gui\" target=\"_blank\">Frustum Points folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {boolean} [options.dat.cameraGui] false - do not adds <a href=\"../../jsdoc/CameraGui/module-CameraGui-CameraGui.html\" target=\"_blank\">Camera folder</a> into [dat.gui]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {object} [options.dat.moveScene] false - do not displays the <a href=\"../../jsdoc/MoveGroupGui/index.html\" target=\"_blank\">move group gui</a>.\r\n\t * @param {object} [options.dat.spriteTextGui] false - do not displays the <a href=\"../../SpriteText/jsdoc/module-SpriteTextGui.html\" target=\"_blank\">SpriteTextGui</a>.\r\n\t * @param {object} [options.dat.folderPoint] false - do not adds a <a href=\"../../jsdoc/folderPoint\" target=\"_blank\">Point settings</a> folder.\r\n\t * @param {object} [options.dat.pointLightGui] false - do not adds a [PointLight]{@link https://threejs.org/docs/index.html?q=PointLight#api/en/lights/PointLight} folder.\r\n\t * @param {object} [options.cameraTarget] camera looking at selected point during playing. See the <b>cameraTarget</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.cameraTarget.html#init\" target=\"_blank\">Player.cameraTarget.init(...)</a> function for details.\r\n\t * @param {object} [options.frustumPoints] Creates a <a href=\"../../frustumPoints/jsdoc/index.html\" target=\"_blank\">FrustumPoints</a> instance.\r\n\t * See <b>settings.options.frustumPoints</b> parameter of <a href=\"../../frustumPoints/jsdoc/FrustumPoints.html\" target=\"_blank\">FrustumPoints</a> class.\r\n\t * @param {MyThree.ColorPicker.palette|boolean|number|String} [options.palette=true] Points сolor.\r\n\t * <pre>\r\n\t * <b>MyThree.ColorPicker.palette</b> - is <b>new ColorPicker.palette( ... )</b>\r\n\t * See <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">ColorPicker</a> for details.\r\n\t * <b>boolean</b>: true - <b>new ColorPicker.palette( { palette: ColorPicker.paletteIndexes.BGYW } )</b>;\r\n\t * <b>number</b>: is <b>MyThree.ColorPicker.paletteIndexes</b>. See <a href=\"../../colorpicker/jsdoc/module-ColorPicker.html#~paletteIndexes\" target=\"_blank\">ColorPicker.paletteIndexes</a> for details.\r\n\t * <b>String</b> - color name. See list of available color names in the <b>_colorKeywords</b> object in the [Color.js]{@link https://github.com/mrdoob/three.js/blob/dev/src/math/Color.js} file. Example: 'red'.\r\n\t * See <a href=\"../../jsdoc/Options/Options.html#setPalette\" target=\"_blank\">Options.setPalette</a>.\r\n\t * </pre>\r\n\t * @param {object} [options.canvas] <b>canvas</b> properties\r\n\t * @param {number} [options.canvas.width] width of the canvas\r\n\t * @param {number} [options.canvas.height] height of the canvas\r\n\t * @param {boolean} [options.canvas.fullScreen] default is full screen. false - no full screen\r\n\t * @param {boolean} [options.canvas.noButtonFullScreen] true - hide Full Screen button. default - Full Screen button is visible.\r\n\t * @param {number} [options.a=1] Can be use as 'a' parameter of the <b>Function</b>. See <b>options.a</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t * @param {number} [options.b=0] Can be use as 'b' parameter of the <b>Function</b>. See <b>options.b</b> parameter of the <a href=\"../../player/jsdoc/module-Player-Player.execFunc.html\" target=\"_blank\">Player.execFunc</a>.\r\n\t * @param {object} [options.point] point settings. See <a href=\"../../jsdoc/Options/global.html#point\" target=\"_blank\">Options.point</a> for details.\r\n\t * @param {object} [options.stats] Use JavaScript Performance Monitor. [stats]{@link https://github.com/mrdoob/stats.js/} .\r\n\t * @param {object} [options.scales] axes scales.\r\n\t * See <b>options.scales</b> of the <a href=\"../../AxesHelper/jsdoc/module-AxesHelper-AxesHelper.html\" target=\"_blank\">AxesHelper</a>.\r\n\t *\r\n\t * @param {object} [options.scales.w] <b>w</b> axis options. See <a href=\"../../jsdoc/Options/Options.html#setW\" target=\"_blank\">Options.setW(options)</a> <b>options.scales.w</b> for details.\r\n\t * @param {object} [options.controllers] Controllers list.\r\n\t * <pre>\r\n\t * User can see and edit some parameters on the web page.\r\n\t * See <a href=\"../../jsdoc/Options/global.html#controllers\" target=\"_blank\">controllers</a> of the <b>Options</b>.\r\n\t * </pre>\r\n\t * @param {Object} [options.controllers.t] current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time.\r\n\t * @param {HTMLElement|string} [options.controllers.t.controller='time'] <b>input</b> element of current <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a> time\r\n\t * or <b>id</b> of the time <b>input</b> element.\r\n\t * @param {HTMLElement|string} [options.controllers.t.elName='tName'] <b>span</b> element of the <b>Player</b> time name. See <b>settings.options.playerOptions.name</b > parameter of <a href = \"../../player/jsdoc/module-Player-Player.html\" target = \"_blank\" >Player</a>\r\n\t * <pre>\r\n\t * or <b>id</b> of the <b>span</b> element.\r\n\t * </pre>\r\n\t * @param {Object} [options.controllers.player] <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player's</a> buttons on the web page.\r\n\t * See <a href=\"../../player/jsdoc/module-Player-Player.html#createControllersButtons\" target=\"_blank\">player.createControllersButtons(options)</a> for details.\r\n\t * @param {HTMLElement|string} [options.controllers.player.prev='prev'] <b>input</b> element of the button type. Go to previous animation scene.\r\n\t * <pre>\r\n\t * or element <b>id</b>.\r\n\t * </pre>\r\n\t * @param {HTMLElement|string} [options.controllers.player.play='play'] <b>input</b> element of the button type. Start/stop of the playing.\r\n\t * <pre>\r\n\t * or element <b>id</b>.\r\n\t * </pre>\r\n\t * @param {HTMLElement|string} [options.controllers.player.next='next'] <b>input</b> element of the button type. Go to next animation scene.\r\n\t * <pre>\r\n\t * or element <b>id</b>.\r\n\t * </pre>\r\n\t * @param {event} [options.onSelectScene] New time of the <a href=\"../../player/jsdoc/index.html\" target=\"_blank\">Player</a>.\r\n\t * @param {string} [options.title] text in the top left corner of the canvas.\r\n\t */\r\n\tconstructor( createXDobjects, options ) {\r\n\r\n\t\toptions = options || {};\r\n\r\n\t\tconst THREE = three.THREE;\r\n\r\n\t\tvar myThreejs = this;\r\n\r\n\t\tarrayCreates.push( {\r\n\r\n\t\t\tcreateXDobjects: createXDobjects,\r\n\t\t\toptions: options,\r\n\r\n\t\t} );\r\n\t\tif ( arrayCreates.length > 1 )\r\n\t\t\treturn;\r\n\t\t\r\n\t\tvar camera, group, scene, canvas;\r\n\r\n\t\tvar elContainer = options.elContainer === undefined ? document.getElementById( \"containerDSE\" ) :\r\n\t\t\ttypeof options.elContainer === \"string\" ? document.getElementById( options.elContainer ) : options.elContainer;\r\n\t\tif ( elContainer === null ) {\r\n\r\n\t\t\tif ( typeof options.elContainer === \"string\" )\r\n\t\t\t\tconsole.warn( 'The ' + options.elContainer + ' element was not detected.' );\r\n\t\t\telContainer = document.createElement( 'div' );\r\n\t\t\tdocument.querySelector( 'body' ).appendChild( elContainer );\r\n\r\n\t\t}\r\n\t\tarrayContainers.push( elContainer );\r\n\t\tif ( !elContainer.querySelector('canvas') ) {\r\n\t\t\t\r\n\t\t\telContainer.innerHTML = '';\r\n\t\t\tconst elDiv = document.createElement( 'div' );\r\n\t\t\telDiv.className = 'container';\r\n\t\t\telDiv.appendChild( document.createElement( 'canvas' ) );\r\n\t\t\telContainer.appendChild( elDiv );\r\n\t\t\telContainer = elDiv;\r\n\r\n\t\t}\r\n\r\n\t\tif ( three.dat && ( options.dat !== false ) ) {\r\n\r\n\t\t\toptions.dat = options.dat || {};\r\n\t\t\toptions.dat.parent = elContainer;\r\n\r\n\t\t}\r\n\r\n\t\tif ( options.title ) {\r\n\t\t\t\r\n\t\t\tconst elDiv = document.createElement( 'div' );\r\n\t\t\telDiv.style.position = 'absolute';\r\n\t\t\telDiv.style.top = '0px';\r\n\t\t\telDiv.style.color = 'white';\r\n\t\t\telDiv.style.padding = '3px';\r\n\t\t\telDiv.innerHTML = options.title;\r\n\t\t\telContainer.appendChild( elDiv );\r\n\r\n\t\t}\r\n\r\n\t\toptions = new Options( options );\r\n\r\n\t\t/**\r\n\t\t* Save scale, position and rotation to the userData.default of the mesh\r\n\t\t* @param {THREE.Object3D} mesh\r\n\t\t*/\r\n\t\toptions.saveMeshDefault = function ( mesh ) {\r\n\r\n\t\t\tmesh.userData.default = mesh.userData.default || {};\r\n\r\n\t\t\tmesh.userData.default.scale = new THREE.Vector3();\r\n\t\t\tmesh.userData.default.scale.copy( mesh.scale );\r\n\r\n\t\t\tmesh.userData.default.position = new THREE.Vector3();\r\n\t\t\tmesh.userData.default.position.copy( mesh.position );\r\n\r\n\t\t\tmesh.userData.default.rotation = new THREE.Euler();\r\n\t\t\tmesh.userData.default.rotation.copy( mesh.rotation );\r\n\r\n\t\t}\r\n\r\n\t\t//point size\r\n\t\tconst defaultPoint = {},\r\n\r\n\t\t\t//uses only if stereo effects does not exists\r\n\t\t\tmouse = new THREE.Vector2();\r\n\r\n\t\tvar renderer,\r\n\r\n\t\t\t//перенес в options.dat\r\n\t\t\t//mouseenter = false,//true - мышка находится над gui или canvasMenu\r\n\t\t\t//В этом случае не надо обрабатывать событие elContainer 'pointerdown'\r\n\t\t\t//по которому выбирается точка на canvas.\r\n\t\t\t//В противном случае если пользователь щелкнет на gui, то он может случайно выбрать точку на canvas.\r\n\t\t\t//Тогда открывается папка Meshes и все органы управления сдвигаются вниз. Это неудобно.\r\n\t\t\t//И вообще нехорошо когда выбирается точка когда пользователь не хочет это делать.\r\n\r\n\t\t\tfOptions,//canvasMenu,  axesHelper,// INTERSECTED = [], scale = options.scale, colorsHelper = 0x80,\r\n\t\t\trendererSizeDefault, cameraPosition,//gui, fullScreen,\r\n\r\n\t\t\t//point size\r\n\t\t\tpointSize, \r\n\r\n\t\t\tstats,\r\n\r\n\t\t\t//https://www.khronos.org/webgl/wiki/HandlingContextLost\r\n\t\t\trequestId;\r\n\r\n\t\tcanvas = elContainer.querySelector( 'canvas' );\r\n\t\tif ( !canvas ) {\r\n\r\n\t\t\tcanvas = document.createElement( 'canvas' );\r\n\t\t\telContainer.appendChild( canvas );\r\n\r\n\t\t}\r\n\r\n\t\tfunction isFullScreen() {\r\n\r\n\t\t\tif ( options.canvasMenu ) return options.canvasMenu.isFullScreen();\r\n\t\t\tif ( options.canvas ) return options.canvas.fullScreen !== false;\r\n\t\t\treturn true;\r\n\r\n\t\t}\r\n\t\t//https://www.khronos.org/webgl/wiki/HandlingContextLost\r\n\r\n\t\tconst elImg = elContainer.querySelector('img');\r\n\t\tif ( elImg ) elContainer.removeChild( elImg );\r\n\r\n\t\tif ( typeof WebGLDebugUtils !== 'undefined' )\r\n\t\t\tcanvas = WebGLDebugUtils.makeLostContextSimulatingCanvas( canvas );\r\n\r\n\t\t//https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/webglcontextlost_event\r\n\t\tcanvas.addEventListener( \"webglcontextlost\", function ( event ) {\r\n\r\n\t\t\tevent.preventDefault();\r\n\t\t\tif ( requestId !== undefined )\r\n\t\t\t\twindow.cancelAnimationFrame( requestId );\r\n\t\t\telse console.error( 'myThreejs.create.onloadScripts: requestId = ' + requestId );\r\n\t\t\tclearThree( scene );\r\n\r\n\t\t\t//Не могу выполнить npm run build Получаю ошибку\r\n\t\t\t//(babel plugin) SyntaxError: D:/My documents/MyProjects/webgl/three.js/GitHub/commonNodeJS/master/myThree/myThree.js: \"raycaster\" is read-only\r\n//\t\t\t\traycaster = undefined;\r\n\r\n\t\t\trendererSizeDefault.onFullScreenToggle( true );\r\n\t\t\talert( lang.webglcontextlost );\r\n\r\n\t\t}, false );\r\n\t\tcanvas.addEventListener( \"webglcontextrestored\", function () {\r\n\r\n\t\t\tconsole.warn( 'webglcontextrestored' );\r\n\t\t\tinit();\r\n\t\t\tanimate();\r\n\r\n\t\t}, false );\r\n\r\n\t\t//\r\n\r\n\t\tinit();\r\n\t\tanimate();\r\n\r\n\t\tfunction init() {\r\n\r\n\t\t\t// CAMERA\r\n\r\n//\t\t\t\tcamera = new THREE.PerspectiveCamera( 70, window.innerWidth / window.innerHeight, 0.01, 10 );\r\n\t\t\tcamera = new THREE.PerspectiveCamera( options.camera.fov || 70,\r\n\t\t\t\toptions.camera.aspect || window.innerWidth / window.innerHeight,\r\n\t\t\t\toptions.camera.near || 0.01,\r\n\t\t\t\toptions.camera.far || 10 );\r\n\t\t\tcamera.position.copy( options.camera.position );\r\n\t\t\tcamera.scale.copy( options.camera.scale );\r\n\r\n\t\t\t//для возврата созданной камеры обратно в код, который вызвал new MyThree\r\n\t\t\t//В частности это используется для создания точки, за которой будет следить камера\r\n\t\t\toptions.camera = camera;\r\n\r\n\t\t\toptions.point.sizePointsMaterial = 100;//size of points with material is not ShaderMaterial is options.point.size / options.point.sizePointsMaterial\r\n\r\n\t\t\t//добавляю camera.userData.default что бы изменять положение камеры во время проигрывания\r\n\t\t\tif ( options.cameraTarget ) {\r\n\t\r\n\t\t\t\toptions.cameraTarget.camera = camera;\r\n\t\t\t\toptions.playerOptions.cameraTarget.init( options.cameraTarget, options );\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t\t// SCENE\r\n\r\n\t\t\tscene = new THREE.Scene();\r\n\t\t\tscene.background = new THREE.Color( 0x000000 );\r\n\t\t\tscene.fog = new THREE.Fog( 0x000000, 250, 1400 );\r\n\t\t\tscene.userData.optionsSpriteText = {\r\n\r\n\t\t\t\ttextHeight: 0.04,\r\n\t\t\t\t//fov: camera.fov,\r\n\t\t\t\t/*\r\n\t\t\t\trect: {\r\n\t\r\n\t\t\t\t\tdisplayRect: true,\r\n\t\t\t\t\tborderRadius: 15,\r\n\t\r\n\t\t\t\t},\r\n\t\t\t\t*/\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgroup = new THREE.Group();\r\n\t\t\tscene.add( group );\r\n\r\n\t\t\tconst gl = new FrustumPoints( camera, group, canvas, {\r\n\r\n\t\t\t\toptions: options,\r\n\r\n\t\t\t} ).gl;\r\n\r\n\t\t\t//\r\n\r\n\t\t\trenderer = new THREE.WebGLRenderer( {\r\n\r\n\t\t\t\tantialias: true,\r\n\t\t\t\tcanvas: canvas,\r\n\t\t\t\tcontext: gl,\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//если не выполнить эту команду то в http://localhost/anhr/commonNodeJS/master/fermatSpiral/Examples/\r\n\t\t\t//холст будет не на весь экран потомучто там не используется меню\r\n\t\t\trenderer.setSize( window.innerWidth, window.innerHeight );\r\n\t\t\t\r\n\t\t\toptions.renderer = renderer;\r\n\r\n\t\t\toptions.cursor = renderer.domElement.style.cursor;\r\n\r\n\t\t\tif ( options.stereoEffect !== false ) {\r\n\r\n\t\t\t\toptions.stereoEffect = options.stereoEffect || {};\r\n\t\t\t\toptions.stereoEffect.rememberSize = true;//remember default size of the canvas. Resize of the canvas to full screen for stereo mode and restore to default size if no stereo effacts.\r\n\r\n\t\t\t}\r\n\t\t\tnew StereoEffect( renderer, options );\r\n\t\t\toptions.eventListeners = new Options.raycaster.EventListeners( camera, renderer, { options: options, scene: scene, } );\r\n\r\n\t\t\tfunction removeTraceLines() {\r\n\r\n\t\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\t\tif ( ( mesh.userData.player === undefined ) || ( mesh.userData.player.arrayFuncs === undefined ) || ( typeof mesh.userData.player.arrayFuncs === \"function\" ) )\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\tmesh.userData.player.arrayFuncs.forEach( function ( vector ) {\r\n\r\n\t\t\t\t\t\tif ( vector.line === undefined )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tvector.line.remove();\r\n\t\t\t\t\t\tvector.line = new Player.traceLine( options );\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Light\r\n\r\n\t\t\tconst pointLight1 = new pointLight( scene, {\r\n\r\n\t\t\t\toptions: options, \r\n\t\t\t\tposition: options.pointLight && options.pointLight.pointLight1 && options.pointLight.pointLight1.position ? options.pointLight.pointLight1.position :\r\n\t\t\t\t\tnew THREE.Vector3( 2 * options.scale, 2 * options.scale, 2 * options.scale ),\r\n\r\n\t\t\t} );\r\n\t\t\tconst pointLight2 = new pointLight( scene, {\r\n\r\n\t\t\t\toptions: options, \r\n\t\t\t\tposition: options.pointLight && options.pointLight.pointLight2 && options.pointLight.pointLight2.position ? options.pointLight.pointLight2.position :\r\n\t\t\t\t\tnew THREE.Vector3( -2 * options.scale, -2 * options.scale, -2 * options.scale ),\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//\r\n\r\n\t\t\t//dat-gui JavaScript Controller Library\r\n\t\t\t//https://github.com/dataarts/dat.gui\r\n\t\t\tif ( ( options.dat.gui ) ) {\r\n\r\n\t\t\t\t//for debugging\r\n\t\t\t\tif ( typeof WebGLDebugUtils !== \"undefined\" )\r\n\t\t\t\t\toptions.dat.gui.add( {\r\n\r\n\t\t\t\t\t\tloseContext: function ( value ) {\r\n\r\n\t\t\t\t\t\t\tcanvas.loseContext();\r\n\t\t\t\t\t\t\t//https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/webglcontextlost_event\r\n\t\t\t\t\t\t\t//gl.getExtension( 'WEBGL_lose_context' ).loseContext();\r\n\r\n\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t}, 'loseContext' );\r\n\r\n\t\t\t\t//Close gui window\r\n\t\t\t\tif ( options.dat.gui.__closeButton.click !== undefined )//for compatibility with Safari 5.1.7 for Windows\r\n\t\t\t\t\toptions.dat.gui.__closeButton.click();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tnew Player( group, {\r\n\r\n\t\t\t\tonSelectScene: function ( index, t ) {\r\n\r\n\t\t\t\t\toptions.boPlayer = true;\r\n\t\t\t\t\tif ( options.frustumPoints !== undefined ) options.frustumPoints.updateCloudPoints();\r\n\t\t\t\t\tif ( options.onSelectScene !== undefined ) return options.onSelectScene( index, t );\r\n\r\n\t\t\t\t},\r\n\t\t\t\toptions: options,\r\n\t\t\t\tcameraTarget: { camera: camera, },\r\n\t\t\t\tonChangeScaleT: function ( scale ) {\r\n\r\n\t\t\t\t\tif ( options.player !== undefined )\r\n\t\t\t\t\t\toptions.player.onChangeScale( scale );\r\n\t\t\t\t\tremoveTraceLines();\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t} );\r\n\t\t\tif ( options.player ) new options.player.PlayController();// gui );//, getLanguageCode );\r\n\r\n\t\t\tif ( options.dat.gui ) {\r\n\r\n\t\t\t\tfOptions = options.dat.gui.addFolder( lang.settings );\r\n\t\t\t\tif ( options.player )\r\n\t\t\t\t\toptions.player.gui( fOptions );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//Settings for all SpriteText added to scene and child groups\r\n\t\t\tif ( fOptions )\r\n\t\t\t\tSpriteTextGui( scene, options, {\r\n\r\n\t\t\t\t\t//settings: { zoomMultiplier: 1.5, },\r\n\t\t\t\t\tfolder: fOptions,\r\n\t\t\t\t\toptions: {\r\n\r\n\t\t\t\t\t\t//rotation: 0,\r\n\t\t\t\t\t\t//textHeight: 0.1 * scale,//0.05,\r\n\t\t\t\t\t\ttextHeight: 0.05,\r\n\r\n\t\t\t\t\t\t//Camera frustum vertical field of view, from bottom to top of view, in degrees. Default is 50.\r\n\t\t\t\t\t\t//Вертикальное поле обзора камеры, снизу вверх, в градусах.\r\n\t\t\t\t\t\t//Если добавить эту настройку, то видимый размер текста не будет зависить от изменения camera.fov.\r\n\t\t\t\t\t\t//Тогда textHeight будет вычисляться как options.fov * textHeight / 50\r\n\t\t\t\t\t\t//Если не определить поле textHeight (см. выше) то textHeight = 0.04,\r\n\t\t\t\t\t\tfov: camera.fov,\r\n\r\n\t\t\t\t\t\t//sizeAttenuation: false,//true,//Whether the size of the sprite is attenuated by the camera depth. (Perspective camera only.) Default is false.\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\tif ( options.stereoEffect ) {\r\n\r\n\t\t\t\toptions.stereoEffect.gui( {\r\n\r\n\t\t\t\t\tfolder: fOptions,\r\n\t\t\t\t\tonChangeMode: function ( mode ) {\r\n\r\n\t\t\t\t\t\tswitch ( mode ) {\r\n\r\n\t\t\t\t\t\t\tcase StereoEffect.spatialMultiplexsIndexs.Mono:\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase StereoEffect.spatialMultiplexsIndexs.SbS:\r\n\t\t\t\t\t\t\tcase StereoEffect.spatialMultiplexsIndexs.TaB:\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault: console.error( 'myThreejs: Invalid spatialMultiplexIndex = ' + mode );\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( options.frustumPoints !== undefined )\r\n\t\t\t\t\t\t\toptions.frustumPoints.updateGuiSelectPoint();\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tfunction getRendererSize() {\r\n\r\n\t\t\t\tvar style = {\r\n\r\n\t\t\t\t\tposition: renderer.domElement.style.position,\r\n\t\t\t\t\tleft: renderer.domElement.style.left,\r\n\t\t\t\t\ttop: renderer.domElement.style.top,\r\n\t\t\t\t\twidth: renderer.domElement.style.width,\r\n\t\t\t\t\theight: renderer.domElement.style.height,\r\n\r\n\t\t\t\t},\r\n\t\t\t\t\tsizeOriginal = new THREE.Vector2();\r\n\t\t\t\trenderer.getSize( sizeOriginal );\r\n\t\t\t\treturn {\r\n\r\n\t\t\t\t\tonFullScreenToggle: function ( fs ) {\r\n\r\n\t\t\t\t\t\tarrayContainers.display( elContainer.parentElement, !fs );\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t};\r\n\t\t\trendererSizeDefault = getRendererSize();\r\n\r\n\t\t\trenderer.setSize( ( options.canvas !== undefined ) && ( options.canvas.width !== undefined ) ? options.canvas.width : canvas.clientWidth,\r\n\t\t\t\t( options.canvas !== undefined ) && ( options.canvas.height !== undefined ) ? options.canvas.height : canvas.clientHeight );\r\n\r\n\t\t\t//CanvasMenu вызываю после renderer.setSize\r\n\t\t\t//потому что если задан options.canvas.fullScreen = true,\r\n\t\t\t//то CanvasMenu изменяет размер renderer до fullScreen\r\n\t\t\tnew CanvasMenu( renderer, {\r\n\r\n\t\t\t\tfullScreen: {\r\n\r\n\t\t\t\t\tfullScreen: options.canvas.fullScreen,\r\n\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\tarrayContainersLength: function() { return arrayContainers.length; },\r\n\t\t\t\t\tonFullScreenToggle: function ( fullScreen ) {\r\n\r\n\t\t\t\t\t\trendererSizeDefault.onFullScreenToggle( fullScreen );\r\n\r\n\t\t\t\t\t\t//скрыть controllers.w.position.elSlider of arrayFuncs типа colorpicker если canvas на весь экран\r\n\t\t\t\t\t\t//иначе colorpicker будет виден в canvas\r\n\t\t\t\t\t\tfunction onFullScreenToggle( group, fullScreen ) {\r\n\r\n\t\t\t\t\t\t\t//если не делать этот setTimeout и если canvas по умолчанию на весь экран, то сквозь canvas будет видна палтра elSlider\r\n\t\t\t\t\t\t\t//которую я рисую на веб станице если в настройках точек будет указана\r\n\t\t\t\t\t\t\tsetTimeout( function () {\r\n\r\n\t\t\t\t\t\t\t\tfunction recursion( children ) {\r\n\r\n\t\t\t\t\t\t\t\t\tchildren.forEach( function ( mesh ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\trecursion( mesh.children );\r\n\t\t\t\t\t\t\t\t\t\tif ( mesh instanceof THREE.Group ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tonFullScreenToggle( mesh, fullScreen );\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif ( ( mesh.userData.player === undefined ) || ( mesh.userData.player.arrayFuncs === undefined ) || ( typeof mesh.userData.player.arrayFuncs === \"function\" ) )\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\tmesh.userData.player.arrayFuncs.forEach( function ( vector ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( vector.controllers && vector.controllers.w && vector.controllers.w.position && vector.controllers.w.position.elSlider )\r\n\t\t\t\t\t\t\t\t\t\t\t\tvector.controllers.w.position.elSlider.style.display = fullScreen ? 'block' : 'none';\r\n\t\t\t\t\t\t\t\t\t\t\tif ( vector.line === undefined )\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t\tvector.line.remove();\r\n\t\t\t\t\t\t\t\t\t\t\tvector.line = new Player.traceLine( options );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\trecursion( group.children );\r\n\r\n\t\t\t\t\t\t\t}, 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonFullScreenToggle( scene, fullScreen );\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t},\r\n\t\t\t\toptions: options,\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t//use orbit controls allow the camera to orbit around a target. https://threejs.org/docs/index.html#examples/en/controls/OrbitControls\r\n\t\t\toptions.createOrbitControls( camera, renderer, scene );\r\n\r\n\t\t\tif ( fOptions ) {\r\n\t\t\t\t\r\n\t\t\t\tnew GuiSelectPoint( options, {\r\n\r\n\t\t\t\t\tcameraTarget: {\r\n\r\n\t\t\t\t\t\tcamera: camera,\r\n\t\t\t\t\t\torbitControls: options.orbitControls,//controls,\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\t//displays the trace of the movement of all points of the mesh\r\n\t\t\t\t\tpointsControls: function ( fPoints, dislayEl, getMesh ) { },\r\n\t\t\t\t\t//displays the trace of the point movement\r\n\t\t\t\t\tpointControls: function ( fPoint, dislayEl, getMesh ) { },\r\n\r\n\t\t\t\t} );\r\n\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.add();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tdefaultPoint.size = options.point.size;\r\n\r\n\t\t\tconst pointName = options.dat ? options.dat.getCookieName('Point') : 'Point';\r\n\t\t\tif ( options.dat ) options.dat.cookie.getObject( pointName, options.point, options.point );\r\n//\t\t\tthree.options = options;//See Options constructor\r\n\t\t\tthree.group = group;\r\n\r\n\t\t\tif ( createXDobjects ) createXDobjects( group, options );\r\n\r\n\t\t\t//вызываю после createXDobjects для того что бы была возможность редактировать настройки AxesHelper. Например в классе nD\r\n\t\t\tnew AxesHelper( scene, options );\r\n\r\n\t\t\tif ( options.frustumPoints ) options.frustumPoints.create( renderer );\r\n\r\n\t\t\t//На случай когда указана точка, за которой следит камера и когда Player не создан\r\n\t\t\tif ( !options.player ) {\r\n\r\n\t\t\t\tPlayer.selectPlayScene( group, { options: options } );//, Player.getTime(), 0 );\r\n\r\n\t\t\t}\r\n\t\t\toptions.boPlayer = false;\r\n\r\n\t\t\t//default setting for each 3D object\r\n\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\toptions.saveMeshDefault( mesh );\r\n\r\n\t\t\t} );\r\n\t\t\tif ( options.dat.gui ) {\r\n\r\n\t\t\t\tAxesHelperGui( options, fOptions );\r\n\r\n\t\t\t\tnew MoveGroupGui( group, options, {\r\n\r\n\t\t\t\t\tfolder: fOptions,\r\n\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t//OrbitControls gui\r\n\r\n\t\t\t\tif ( options.orbitControls !== false ) {\r\n\r\n\t\t\t\t\tnew OrbitControlsGui( options, fOptions );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//camera gui\r\n\r\n\t\t\t\tnew CameraGui( camera, options, fOptions );\r\n\r\n\t\t\t\t// light\r\n\r\n//\t\t\t\tconst scales = options.axesHelper === false ? options.scales : options.axesHelper.options.scales;\r\n\t\t\t\tpointLight1.controls( { group: group, folder: fOptions, folderName: lang.light + ' 1' } );\r\n\t\t\t\tpointLight2.controls( { group: group, folder: fOptions, folderName: lang.light + ' 2' } );\r\n\r\n\t\t\t\t//point\r\n\r\n\t\t\t\tconst folderPoint = new FolderPoint( options.point, function ( value ) {\r\n\r\n\t\t\t\t\tif ( value === undefined )\r\n\t\t\t\t\t\tvalue = options.point.size;\r\n\t\t\t\t\tif ( value < 0 )\r\n\t\t\t\t\t\tvalue = 0;\r\n\t\t\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\t\t\tif ( ( mesh.type !== 'Points' ) || mesh.userData.boFrustumPoints )\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tif ( mesh.material.uniforms === undefined )\r\n\t\t\t\t\t\t\tmesh.material.size = value / options.point.sizePointsMaterial;//PointsMaterial\r\n\t\t\t\t\t\telse mesh.material.uniforms.pointSize.value = value;//shaderMaterial\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tfolderPoint.size.setValue( value );\r\n\t\t\t\t\toptions.point.size = value;\r\n\t\t\t\t\toptions.dat.cookie.setObject( pointName, options.point );\r\n\r\n\t\t\t\t}, options, {\r\n\r\n\t\t\t\t\t\tfolder: fOptions,\r\n\t\t\t\t\t\tdefaultPoint: defaultPoint,\r\n\r\n\t\t\t\t} )\r\n\r\n\t\t\t\t//Frustum points\r\n\t\t\t\tif ( options.frustumPoints )// && options.dat.guiFrustumPoints )\r\n\t\t\t\t\toptions.frustumPoints.gui( fOptions );\r\n\r\n\t\t\t\toptions.restoreSceneController( camera, scene );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//https://github.com/mrdoob/stats.js/\r\n\t\t\tif ( options.stats !== undefined ) {\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tstats = new Stats();\r\n\t\t\t\t\telContainer.appendChild( stats.dom );\r\n\r\n\t\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\t\tconsole.error( e + \". Please import Stats from '../../../three.js/dev/examples/jsm/libs/stats.module.js';\" );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\twindow.addEventListener( 'resize', onResize, false );\r\n\r\n\t\t}\r\n\t\tfunction onResize() {\r\n\r\n\t\t\tvar size;\r\n\t\t\tif ( isFullScreen() )\r\n\t\t\t\tsize = new THREE.Vector2( window.innerWidth, window.innerHeight );\r\n\t\t\telse {\r\n\r\n\t\t\t\tsize = new THREE.Vector2();\r\n\t\t\t\trenderer.getSize( size );\r\n\r\n\t\t\t}\r\n\t\t\tcamera.aspect = size.x / size.y;\r\n\t\t\tcamera.updateProjectionMatrix();\r\n\r\n\t\t\trenderer.setSize( size.x, size.y );\r\n\t\t\tif ( options.frustumPoints !== undefined )\r\n\t\t\t\toptions.frustumPoints.update();\r\n\r\n\t\t}\r\n\t\tfunction onObjectMouseDown( position, intersection ) {\r\n\r\n\t\t\tif ( ( options.axesHelper !== undefined ) && ( intersection.object.type === \"Points\" ) )\r\n\t\t\t\toptions.axesHelper.exposePosition( position );\r\n\t\t\telse alert( 'You are clicked the \"' + intersection.object.type + '\" type object.'\r\n\t\t\t\t+ ( intersection.index === undefined ? '' : ' Index = ' + intersection.index + '.' )\r\n\t\t\t\t+ ' Position( x: ' + position.x + ', y: ' + position.y + ', z: ' + position.z + ' )' );\r\n\r\n\t\t}\r\n\t\tfunction animate() {\r\n\r\n\t\t\tif ( stats !== undefined )\r\n\t\t\t\tstats.begin();\r\n\r\n\t\t\trequestId = requestAnimationFrame( animate );\r\n\r\n\t\t\trender();\r\n\r\n\t\t\tif ( stats !== undefined )\r\n\t\t\t\tstats.end();\r\n\r\n\t\t}\r\n\t\tfunction render() {\r\n\r\n\t\t\tif ( !options.stereoEffect || !options.stereoEffect.render )\r\n\t\t\t\trenderer.render( scene, camera );\r\n\t\t\telse options.stereoEffect.render( scene, camera );\r\n\t\t\tif ( cameraPosition === undefined )\r\n\t\t\t\tcameraPosition = new THREE.Vector3();\r\n\t\t\tif ( pointSize === undefined )\r\n\t\t\t\tpointSize = options.point.size;\r\n\t\t\tif (\r\n\t\t\t\t!cameraPosition.equals( camera.position ) ||\r\n\t\t\t\t( pointSize != options.point.size ) ||\r\n\t\t\t\t( ( options.frustumPoints !== undefined ) && options.frustumPoints.animate() )\r\n\t\t\t) {\r\n\r\n\t\t\t\tcameraPosition.copy( camera.position );\r\n\t\t\t\tpointSize = options.point.size;\r\n\r\n\t\t\t\tgroup.children.forEach( function ( mesh ) {\r\n\r\n\t\t\t\t\tif ( mesh instanceof THREE.Points === false )\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\tif ( mesh.geometry.attributes.size === undefined ) {\r\n\r\n\t\t\t\t\t\tmesh.material.size = pointSize / options.point.sizePointsMaterial;\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( options.point.opacity !== undefined )\r\n\t\t\t\t\t\tmesh.material.uniforms.opacity.value = options.point.opacity;\r\n\r\n\t\t\t\t\t//scale\r\n\t\t\t\t\tvar scale = myPoints.getGlobalScale( mesh );\r\n\t\t\t\t\tvar cameraPosition = new THREE.Vector3( camera.position.x / scale.x, camera.position.y / scale.y, camera.position.z / scale.z );\r\n\t\t\t\t\tscale = ( scale.x + scale.y + scale.z ) / 3;\r\n\r\n\t\t\t\t\t//set size of points with ShaderMaterial\r\n\t\t\t\t\t//https://threejs.org/docs/index.html#api/en/materials/ShaderMaterial\r\n\t\t\t\t\t//Example https://threejs.org/examples/?q=points#webgl_custom_attributes_points2\r\n\r\n\t\t\t\t\t//points with ShaderMaterial\r\n\t\t\t\t\tfor ( var i = 0; i < mesh.geometry.attributes.position.count; i++ ) {\r\n\r\n\t\t\t\t\t\tvar position = getObjectPosition( mesh, i ),//getObjectLocalPosition( mesh, i ),\r\n\t\t\t\t\t\t\tposition3d = new THREE.Vector3( position.x, position.y, position.z ),\r\n\t\t\t\t\t\t\tdistance = position3d.distanceTo( cameraPosition ),\r\n\t\t\t\t\t\t\ty = 1;\r\n\t\t\t\t\t\t//дальние точки очень маленькие\r\n\t\t\t\t\t\t//\tangle = cameraPosition.angleTo( position3d ),\r\n\t\t\t\t\t\t//\tcameraFov = ( Math.PI / 180 ) * 0.5 * camera.fov,\r\n\t\t\t\t\t\t//\ty = 1 - 0.4 * ( angle / cameraFov );\r\n\r\n\t\t\t\t\t\tmesh.geometry.attributes.size.setX( i, Math.tan(\r\n\r\n\t\t\t\t\t\t\tmesh.userData.shaderMaterial.point !== undefined &&\r\n\t\t\t\t\t\t\t\tmesh.userData.shaderMaterial.point.size !== undefined ?\r\n\t\t\t\t\t\t\t\tmesh.userData.shaderMaterial.point.size : options.point.size\r\n\r\n\t\t\t\t\t\t) * distance * scale * y );\r\n\t\t\t\t\t\tmesh.geometry.attributes.size.needsUpdate = true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Sets the size of the canvas\r\n\t\t * @param {number|object} width width of the canvas.\r\n\t\t * <pre>\r\n\t\t * If <b>width</b> is object, followed keys is available:\r\n\t\t * </pre>\r\n\t\t * @param {number} width.width width of the canvas\r\n\t\t * @param {number} width.height height of the canvas\r\n\t\t * @param {number} height height of the canvas\r\n\t\t */\r\n\t\tthis.setSize = function ( width, height ) {\r\n\r\n\t\t\tif ( typeof width === \"object\" ) {\r\n\r\n\t\t\t\theight = width.height;\r\n\t\t\t\twidth = width.width;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( width === undefined ) {\r\n\r\n\t\t\t\t//Используется в treeView.js для открытия ветки с холстом\r\n\t\t\t\tconst target = { set: function( width, height ) {\r\n\r\n\t\t\t\t\trenderer.setSize( width, height );\r\n\t\t\t\t\t\r\n\t\t\t\t}};\r\n\t\t\t\trenderer.getSize( target );\r\n\t\t\t\treturn;\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\trenderer.setSize( width, height );\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tarrayCreates.shift();\r\n\t\tvar params = arrayCreates.shift();\r\n\t\tif ( params === undefined )\r\n\t\t\treturn;\r\n\t\tmyThreejs.create( params.createXDobjects, params.options );\r\n\r\n\t}\r\n\r\n}\r\n\r\nMyThree.release = 'v1.3';\r\n\r\n//Localization\r\n\r\nconst lang = {\r\n\r\n\tdefaultButton: 'Default',\r\n\r\n\tsettings: 'Settings',\r\n\twebglcontextlost: 'The user agent has detected that the drawing buffer associated with a WebGLRenderingContext object has been lost.',\r\n\r\n\tlight: 'Light',\r\n\r\n\topacity: 'Opacity',\r\n\r\n};\r\n\r\nswitch ( getLanguageCode() ) {\r\n\r\n\tcase 'ru'://Russian language\r\n\r\n\t\tlang.defaultButton = 'Восстановить';\r\n\t\tlang.name = 'Имя';\r\n\t\tlang.settings = 'Настройки';\r\n\t\tlang.webglcontextlost = 'Пользовательский агент обнаружил, что буфер рисунка, связанный с объектом WebGLRenderingContext, потерян.';\r\n\r\n\t\tlang.light = 'Свет';\r\n\r\n\t\tlang.opacity = 'Непрозрачность';\r\n\t\tbreak;\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description Creating the new [THREE.Points]{@link https://threejs.org/docs/index.html?q=poi#api/en/objects/Points} and adding it into group.\r\n * @see <a href=\"../../myPoints/jsdoc/index.html\" target=\"_blank\">MyPoints</a>.\r\n */\r\nMyThree.MyPoints = MyPoints;\r\n\r\n/** @namespace */\r\nMyThree.StereoEffect = {\r\n\r\n\t/**\r\n\t * Enumeration of available stereo modes.\r\n\t * @see <a href=\"../../StereoEffect/jsdoc/module-StereoEffect.html#~spatialMultiplexsIndexs\" target=\"_blank\">StereoEffect.spatialMultiplexsIndexs</a> for details.\r\n\t * @inner\r\n\t */\r\n\tspatialMultiplexsIndexs: StereoEffect.spatialMultiplexsIndexs,\r\n\r\n}\r\n/** @namespace\r\n * @description Pure JavaScript color picker.\r\n * @see <a href=\"../../colorpicker/jsdoc/index.html\" target=\"_blank\">ColorPicker</a>.\r\n */\r\nMyThree.ColorPicker = ColorPicker;\r\n\r\n/** @namespace\r\n * @description gets position of the vector in world coordinates, taking into account the position, scale and rotation of the 3D object\r\n * @param {THREE.Object3D} object\r\n * @param {THREE.Vector3} pos local position\r\n * @returns world position\r\n * @see <a href=\"../../guiSelectPoint/jsdoc/module-GuiSelectPoint.html#~getWorldPosition\" target=\"_blank\">getWorldPosition</a>.\r\n */\r\nMyThree.getWorldPosition = getWorldPosition;\r\n\r\n/** @namespace\r\n * @description Limits angles of rotations of the mesh between 0 and 360 degrees.\r\n * @param {THREE.Euler} rotation angles for limitation\r\n */\r\nMyThree.limitAngles = function ( rotation ) {\r\n\r\n\tfunction limitAngle( axisName ) {\r\n\r\n\t\twhile ( rotation[axisName] > Math.PI * 2 )\r\n\t\t\trotation[axisName] -= Math.PI * 2\r\n\r\n\t}\r\n\tlimitAngle( 'x' );\r\n\tlimitAngle( 'y' );\r\n\tlimitAngle( 'z' );\r\n\r\n}\r\n\r\n/** @namespace\r\n * @description 3D objects animation.\r\n * @see <a href=\"../../Player/jsdoc/index.html\" target=\"_blank\">Player</a> class.\r\n */\r\nMyThree.Player = Player;\r\n\r\n/** @namespace\r\n * @description class for [THREE]{@link https://github.com/anhr/three.js} and [dat.GUI(...)]{@link https://github.com/anhr/dat.gui} variables.\r\n * @see <a href=\"../../jsdoc/three/index.html\" target=\"_blank\">three</a> class.\r\n */\r\nMyThree.three = three;\r\n\r\n/** @namespace\r\n * @description Options.\r\n * @see <a href=\"../../jsdoc/Options/index.html\" target=\"_blank\">Options</a> class.\r\n */\r\nMyThree.Options = Options;\r\n\r\nwindow.__myThree__ = window.__myThree__ || {};\r\nif ( window.__myThree__.boMyThree )\r\n\tconsole.error( 'myThree: duplicate myThree. Please use one instance of the myThree class.' )\r\nwindow.__myThree__.boMyThree = true;\r\n\r\nimport Intersections from '../intersections/intersections.js'\r\n/** @namespace\r\n * @description Creates an intersection line for graphic objects.\r\n * @see <a href=\"../../intersections/jsdoc/index.html\" target=\"_blank\">Intersections</a>.\r\n */\r\nMyThree.Intersections = Intersections;\r\n\r\nimport TreeView from '../treeView/treeView.js';\r\nMyThree.TreeView = TreeView;\r\n\r\n\r\nexport default MyThree;\r\n","/**\r\n* @module Matrix\r\n* @description A matrix (plural matrices) is a rectangular array or table of numbers, arranged in rows and columns, which is used to represent a mathematical object or a property of such an object.\r\n* @see [Matrix (mathematics)]{@link https://en.wikipedia.org/wiki/Matrix_(mathematics)}\r\n* @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n*\r\n* @copyright 2011 Data Arts Team, Google Creative Lab\r\n*\r\n* @license under the Apache License, Version 2.0 (the \"License\");\r\n* you may not use this file except in compliance with the License.\r\n* You may obtain a copy of the License at\r\n*\r\n* http://www.apache.org/licenses/LICENSE-2.0\r\n* \r\n* */\r\n\r\nclass Matrix {\r\n\r\n\t/** @class\r\n\t * A matrix (plural matrices) is a rectangular array or table of numbers, arranged in rows and columns, which is used to represent a mathematical object or a property of such an object.\r\n\t * @see [Matrix (mathematics)]{@link https://en.wikipedia.org/wiki/Matrix_(mathematics)}\r\n\t * @param {Array} a 2-dimensional array that initializes the matrix.\r\n\t * @example\r\n\t * const matrix = new Matrix( [[1, 2],[3, 4]] );\r\n\t * */\r\n\tconstructor( a ) {\r\n\r\n\t\t/**\r\n\t\t* Multiplies this matrix by another matrix\r\n\t\t* @param {Matrix|Array} b multiplication matrix or 2-dimensional array that is the matrix or 1-dimensional array that is the vector.\r\n\t\t* @returns new matrix as result of multiplication of matrices.\r\n\t\t* @see [Matrix multiplication]{@link https://en.wikipedia.org/wiki/Matrix_multiplication}\r\n\t\t* @example\r\n\t\t* const matrix = new Matrix( [[1, 2], [3, 4], [5, 6]] );\r\n\t\t* const res = matrix.multiply( [[7, 8, 9, 10], [11, 12, 13,14] );\r\n\t\t* res is : [[29, 32, 35, 38], [65, 72, 79, 86], [101, 112, 123, 134]]\r\n\t\t*/\r\n\t\tthis.multiply = function ( b ) { };//Эту функцию засунул что бы построить jsdoc\r\n\t\t/**\r\n\t\t * calls a function for each row in the matrix.\r\n\t\t * @see [JavaScript Array forEach()]{@link https://www.w3schools.com/jsref/jsref_foreach.asp}\r\n\t\t * */\r\n\t\tthis.forEach = function () { };//Эту функцию засунул что бы построить jsdoc\r\n\r\n\t\t/**\r\n\t\t * returns the number of rows in the matrix.\r\n\t\t * */\r\n\t\tthis.length;//Эту переменную засунул что бы построить jsdoc\r\n\t\treturn new Proxy( a, {\r\n\r\n\t\t\tget: function ( target, name ) {\r\n\r\n\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\treturn target[i];\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t//case \"isMatrix\": return true;\r\n\t\t\t\t\tcase \"length\": return target.length;\r\n\t\t\t\t\tcase 'forEach': return target.forEach;\r\n\t\t\t\t\tcase \"multiply\":\r\n\t\t\t\t\t\treturn function ( b ) {\r\n\r\n\t\t\t\t\t\t\tconst c = [],//multiply matrix\r\n\t\t\t\t\t\t\t\tl = a.length,//количество строк a\r\n\t\t\t\t\t\t\t\tm = a[0].length,//количество столбцов a равно количество строк b\r\n\t\t\t\t\t\t\t\tn = Array.isArray( b[0] ) ? b[0].length : 1;//количество столбцов b\r\n\t\t\t\t\t\t\tif ( m !== b.length ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error('Matrix: Dimension mismatch in multiplication. Matrix A columns (' + m + ') must match Matrix B rows (' + b.length + ')');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( n === 1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//b is vector\r\n\t\t\t\t\t\t\t\t\tvar s = 0;\r\n\t\t\t\t\t\t\t\t\tfor ( var k = 0; k < m; k++ ) s = s + a[i][k] * b[k];\r\n\t\t\t\t\t\t\t\t\tc[i] = s;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else for ( var j = 0; j < n; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//b is matrix\r\n\t\t\t\t\t\t\t\t\tvar s = 0;\r\n\t\t\t\t\t\t\t\t\tfor ( var k = 0; k < m; k++ ) s = s + a[i][k] * b[k][j]\r\n\t\t\t\t\t\t\t\t\tc[i] = c[i] || [];\r\n\t\t\t\t\t\t\t\t\tc[i][j] = s;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n/*\r\n\t\t\t\t\t\t\tif ( !Array.isArray( b[0] ) ){\r\n\r\n\t\t\t\t\t\t\t\t//b is vector\r\n\t\t\t\t\t\t\t\tconst t = [];\r\n\t\t\t\t\t\t\t\tb.forEach( item => t.push( [item] ) )\r\n\t\t\t\t\t\t\t\tb = t;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst c = [],//multiply matrix\r\n\t\t\t\t\t\t\t\tl = a.length,//количество строк a\r\n\t\t\t\t\t\t\t\tm = a[0].length;//количество столбцов a равно количество строк b\r\n\t\t\t\t\t\t\tvar n;\r\n\t\t\t\t\t\t\tn = b[0].length;//количество столбцов b\r\n\t\t\t\t\t\t\tif ( m !== b.length ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error('Matrix: Dimension mismatch in multiplication. Matrix A columns (' + m + ') must match Matrix B rows (' + b.length + ')');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < l; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tfor ( var j = 0; j < n; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tvar s = 0;\r\n\t\t\t\t\t\t\t\t\tfor ( var k = 0; k < m; k++ ) s = s + a[i][k] * b[k][j]\r\n\t\t\t\t\t\t\t\t\tc[i] = c[i] || [];\r\n\t\t\t\t\t\t\t\t\tc[i][j] = s;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n*/\r\n\t\t\t\t\t\t\treturn new Matrix( c );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tdefault: console.error( 'Matrix: Invalid name: ' + name );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\ttarget[i] = value;\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n}\r\nconst Matrix2 = new Proxy( [], {\r\n\r\n\tget: function ( target, name, args ) {\r\n\r\n\t\tconst i = parseInt( name );\r\n\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\treturn [target[i]];\r\n\r\n\t\t}\r\n\t\tswitch ( name ) {\r\n\r\n/*\r\n\t\t\tcase 'push': return target.push;\r\n\t\t\tcase 'length': return target.length;\r\n\t\t\tcase 'forEach': return target.forEach;\r\n\t\t\tcase 'isProxy': return true;\r\n\t\t\tcase 'boPositionError': return target.boPositionError;\r\n\t\t\tcase 'target': return target;\r\n\t\t\tcase \"reset\":\r\n\t\t\t\treturn function () {\r\n\r\n\t\t\t\t\ttarget.forEach( item => item.positionWorld = undefined );\r\n\r\n\t\t\t\t}\r\n*/\r\n\t\t\tcase \"multiply\":\r\n\t\t\t\treturn function ( i ) {\r\n\r\n\t\t\t\t\tconst v = [];\r\n\t\t\t\t\treturn v;\r\n\r\n\t\t\t\t}\r\n\t\t\tdefault: console.error( 'Matrix: Invalid name: ' + name );\r\n\r\n\t\t}\r\n\r\n\t},\r\n\tset: function ( target, name, value ) {\r\n\r\n\t\ttarget[name] = value;\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n} );\r\nexport default Matrix;\r\n","/**\r\n * @module MyMath\r\n * @description Math library.\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n * \r\n*/\r\n\r\n/*\r\nimport three from '../three.js'\r\n\r\nimport MyThree from '../myThree/myThree.js';\r\n//import MyThree from '../../build/myThree.module.js';\r\n//import MyThree from '../../build/myThree.module.min.js';\r\n*/\r\nimport Matrix from './matrix/matrix.js';\r\n\r\nconst MyMath = { Matrix: Matrix, }\r\nexport default MyMath;\r\n","/**\r\n * @module ND\r\n * @description N-dimensional graphics\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n * \r\n * @see [4D Geometry Viewer]{@link https://github.com/anhr/humke-4d-geometry}\r\n * @see [Tesseract]{@link https://ciechanow.ski/tesseract/}\r\n * @see [4D-Shapes]{@link https://artemonigiri.github.io/4D-Shapes/}\r\n * @see [The Regular Polychora]{@link https://www.qfbox.info/4d/regular}\r\n*/\r\n\r\nimport three from '../three.js'\r\nimport Options from '../Options.js'\r\nimport PositionController from '../PositionController.js';\r\nimport MyMath from '../myMath/myMath.js'\r\nimport MyObject from '../myObject.js'\r\n\r\n/*\r\ndimention\tgeometry\tpoints\tedges\tfaces\tbodyes\t4D objects\r\n1\t\t\tline\t\t2\t\t0\r\n2\t\t\ttriangle\t3\t\t3\t\t1\r\n3\t\t\ttetrahedron\t4\t\t6\t\t4\t\t1\r\n4\t\t\tpentatope\t5\t\t10\t\t10\t\t5\t\t1\r\n*/\r\n\r\nclass ND extends MyObject {\r\n\r\n\t/**\r\n\t * N-dimensional graphics.\r\n\t * Creates an N-dimensional graphic object,\r\n\t * checks for a collision between an n-dimensional plane and an n-dimensional graphics object and returns the (n-1)-dimensional intersection geometry if a collision was occurs.\r\n\t * @param {number} n space dimension of the graphical object.\r\n\t * @param {object} [settings={}] The following settings are available\r\n\t * @param {object} [settings.object] geometry, position and rotation of the n-dimensional graphical object.\r\n\t * @param {String} [settings.object.name] name of n-dimensional graphical object.\r\n\t * @param {number|String|object} [settings.object.color='lime'] color of N-dimensional graphic object.\r\n\t * <pre>\r\n\t * number - [Hex triplet]{@link https://en.wikipedia.org/wiki/Web_colors#Hex_triplet} color. Example: 0xffffff - white color\r\n\t * String - color name. See list of available color names in the <b>_colorKeywords</b> object in the [Color.js]{@link https://github.com/mrdoob/three.js/blob/dev/src/math/Color.js} file.\r\n\t * object - Sets the color separately for each vertice.\r\n\t *\tYou can choose one way for setting of the vertice color from two available:\r\n\t *\t\r\n\t *\t1. Set the fourth <b>w</b> coordinate of each vertex in a range from\r\n\t *\t\t<b>settings.options.scales.w.min</b> to\r\n\t *\t\t<b>settings.options.scales.w.max</b>\r\n\t *\t\t\r\n\t *\t\t<b>w</b> coordinate is index of palette color. See <a href=\"../../colorpicker/jsdoc/module-ColorPicker-ColorPicker.html#toColor\" target=\"_blank\">toColor</a> method from <b>ColorPicker</b> class.\r\n\t *\t\tExample:\r\n\t *\t\tsettings.object.geometry.position: [\r\n\t *\t\t\t//pyramid\r\n\t *\t\t\t[0,-0.9428090415820634,0.33333333333333326, 1],\r\n\t *\t\t\t[0.8164965662730563,0.4714045207910317,0.33333333333333326, 0.5],\r\n\t *\t\t\t[-0.8164965662730563,0.4714045207910317,0.33333333333333326, 0],\r\n\t *\t\t\t[7.32733549761259e-9,4.230438555019589e-9,-1.0, -1.0],\r\n\t *\t\t],\r\n\t *\t\r\n\t *\t2. Set a <b>settings.object.geometry.colors</b> array. \r\n\t * Have effect only if <b>settings.object.geometry.colors</b> are not defined.\r\n\t * </pre>\r\n\t * @param {boolean|object} [settings.object.faces] true or object - display the n-dimensional graphical object faces instead of edges.\r\n\t * @param {float} [settings.object.faces.opacity=0.5] color Float in the range of 0.0 - 1.0 indicating how transparent the material is.\r\n\t * A value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t * If the <b>transparent</b> property is not set to true, the material will remain fully opaque and this value will only affect its color.\r\n\t * See [Material.opacity]{@link https://threejs.org/docs/#api/en/materials/Material.opacity}.\r\n\t * @param {boolean} [settings.object.faces.transparent= true] Defines whether this material is transparent.\r\n\t * This has an effect on rendering as transparent objects need special treatment and are rendered after non-transparent objects.\r\n\t * When set to true, the extent to which the material is transparent is controlled by setting its <b>opacity</b> property.\r\n\t * See [Material.transparent]{@link https://threejs.org/docs/#api/en/materials/Material.transparent}.\r\n\t * @param {Array|Object} [settings.object.geometry] Array of vertices and indices of the n-dimensional graphical object.\r\n\t * <pre>\r\n\t * Every item of array is n-dimensional vector of vertice of object.\r\n\t * Or Object. See object's keys below.\r\n\t * </pre>\r\n\t * @param {Array} [settings.object.geometry.position] Array of vertices of the n-dimensional graphical object.\r\n\t * <pre>\r\n\t * Every item of array is n-dimensional vector of vertice of object.\r\n\t * For example, if you want to create a tetrahedron, then you need to create an array of 4 vertices.\r\n\t * <b>settings.object.geometry.position: [\r\n\t * \t[-0.6, 0.1, 0.8],//0\r\n\t * \t[0.7, 0.5, 0.9],//1\r\n\t * \t[0, -0.4, 0.8],//2\r\n\t * \t[0, 0, -0.6]//3\r\n\t * ]</b>,\r\n\t * </pre>\r\n\t * @param {Array} [settings.object.geometry.colors] Array of colors for the each vertex.\r\n\t * <pre>\r\n\t * Every vertex is associated with 3 values of the <b>colors</b> array.\r\n\t * Each value of the <b>colors</b> array is red or green or blue color of the particular vertex in range from 0 to 1.\r\n\t * \r\n\t * 0 is no color.\r\n\t * 1 is full color.\r\n\t * \r\n\t * For example:\r\n\t * settings.object.geometry.colors: [\r\n\t * \t1, 0, 0,//red color of the <b>position[0]</b> vertex.\r\n\t * \t0, 1, 0,//green color of the <b>position[1]</b> vertex.\r\n\t * \t0, 0, 1,//blue color of the <b>position[2]</b> vertex.\r\n\t * \t1, 1, 1,//white color of the <b>position[3]</b> vertex.\r\n\t * ],\r\n\t * Have effect only if <b>settings.object.geometry.position</b> points are not <b>THREE.Vector4</b> type.\r\n\t * See <b>arrayFuncs</b> parametr of the <a href=\"../../player/jsdoc/module-Player-Player.getPoints.html\" target=\"_blank\">Player.getPoints(...)</a> for details.\r\n\t * </pre>\r\n\t * @param {array} [settings.object.geometry.opacity] array of opacities for the each vertex. Each item of array is float value in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t * @param {Array} [settings.object.geometry.boRememberPosition=true] true - Remember vertex positions for higher performance. As result, new vertex positions have no effect.\r\n\t * @param {Array} [settings.object.geometry.indices] Array of <b>indices</b> of vertices of the n-dimensional graphical object.\r\n\t * Allows for vertices to be re-used across multiple segments.\r\n\t * <pre>\r\n\t * <b>Indices</b> is divided to segments:\r\n\t * \r\n\t * <b>indices[0]</b> is edges. Every edge is two indexes of the edge's vertices. Used in 1D objects and higher.\r\n\t * <b>indices[1]</b> is faces. Every face is three indexes of the edges from <b>indices[0]</b>. Used in 3D objects and higher.\r\n\t * <b>indices[2]</b> is bodies. Every bodie is four face indexes from <b>indices[1]</b>. Used in 4D objects and higher.\r\n\t * For example:\r\n\t * \r\n\t * <b>n</b> = 1 line.\r\n\t * <b>settings.object.geometry.position</b> = [\r\n\t *\t[-0.5, 1],//0\r\n\t *\t[0.5]//1\r\n\t *]\r\n\t * <b>settings.object.geometry.indices</b> = [\r\n\t *\t[\r\n\t *\t\t0,//index of the settings.object.geometry.position[0] = [-0.5, 1]\r\n\t *\t\t1,//index of the settings.object.geometry.position[1] = [0.5]\r\n\t *\t]//0\r\n\t *]//0\r\n\t *\r\n\t * <b>n</b> = 2 triangle\r\n\t * <b>settings.object.geometry.position</b> = [\r\n\t *\t[-0.7, 0.2],//0\r\n\t *\t[0.8, 0.6],//1\r\n\t *\t[0.1, -0.5]//2\r\n\t *],\r\n\t * //edges\r\n\t * <b>settings.object.geometry.indices[0]</b> = [\r\n\t *\t[0, 1],//0 index of the settings.object.geometry.positions [-0.7, 0.2] and [0.8, 0.6]\r\n\t *\t[0, 2],//1 index of the settings.object.geometry.positions [-0.7, 0.2] and [0.1, -0.5]\r\n\t *\t[1, 2] //2 index of the settings.object.geometry.positions [0.8, 0.6] and [0.1, -0.5]\r\n\t *]\r\n\t *\r\n\t * <b>n</b> = 3 tetrahedron.\r\n\t * <b>settings.object.geometry.position</b> = [\r\n\t *\t[0.8, -0.6, 0.1],//0\r\n\t * \t[0.9, 0.7, 0.5],//1\r\n\t * \t[0.8, 0, -0.4],//2\r\n\t * \t[-0.6, 0.1, 0.1]//3\r\n\t * ],\r\n\t * //edges\r\n\t * <b>settings.object.geometry.indices[0]</b> = [\r\n\t *\t[0, 1]//0 index of the settings.object.geometry.positions [0.8, -0.6, 0.1] and [0.9, 0.7, 0.5]\r\n\t *\t[0, 2]//1 index of the settings.object.geometry.positions [0.8, -0.6, 0.1] and [0.8, 0, -0.4]\r\n\t *\t[0, 3]//2 index of the settings.object.geometry.positions [0.8, -0.6, 0.1] and [-0.6, 0.1, 0.1]\r\n\t *\t[1, 2]//3 index of the settings.object.geometry.positions [0.9, 0.7, 0.5] and [0.8, 0, -0.4]\r\n\t *\t[1, 3]//4 index of the settings.object.geometry.positions [0.9, 0.7, 0.5] and [-0.6, 0.1, 0.1]\r\n\t *\t[2, 3]//5 index of the settings.object.geometry.positions [0.8, 0, -0.4] and [-0.6, 0.1, 0.1]\r\n\t *]\r\n\t * //faces. Indices of the edges <b>settings.object.geometry.indices[0]</b>\r\n\t * <b>settings.object.geometry.indices[1]</b> = [\r\n\t *\t[0, 1, 3]//tetrahedron's face 0\r\n\t *\t[0, 2, 4]//tetrahedron's face 1\r\n\t *\t[3, 4, 5]//tetrahedron's face 2\r\n\t *\t[1, 2, 5]//tetrahedron's face 3\r\n\t *]\r\n\t *\r\n\t * <b>n</b> = 4 pentachoron [5-cell]{@link https://en.wikipedia.org/wiki/5-cell}.\r\n\t * <b>settings.object.geometry.position</b> = [\r\n\t *\t[0.8, -0.6, 0.1, -0.85],//0\r\n\t *\t[0.9, 0.7, 0.5, -0.55],//1\r\n\t *\t[0.8, 0, -0.4, 0],//2\r\n\t *\t[-0.6, 0.1, -0.3, 0.55],//3\r\n\t *\t[-0.5, 0.2, 0.3, 0.85],//4\r\n\t * ],\r\n\t * //edges\r\n\t * <b>settings.object.geometry.indices[0]</b> = [\r\n\t *\t[0, 1]//0 index of the settings.object.geometry.positions [0.8, -0.6, 0.1, -0.85] and [0.9, 0.7, 0.5, -0.55]\r\n\t *\t[0, 2]//1 index of the settings.object.geometry.positions [0.8, -0.6, 0.1, -0.85] and [0.8, 0, -0.4, 0]\r\n\t *\t[0, 3]//2 index of the settings.object.geometry.positions [0.8, -0.6, 0.1, -0.85] and [-0.6, 0.1, -0.3, 0.55]\r\n\t *\t[0, 4]//3 index of the settings.object.geometry.positions [0.8, -0.6, 0.1, -0.85] and [-0.5, 0.2, 0.3, 0.85]\r\n\t *\t[1, 2]//4 index of the settings.object.geometry.positions [0.9, 0.7, 0.5, -0.55] and [0.8, 0, -0.4, 0]\r\n\t *\t[1, 3]//5 index of the settings.object.geometry.positions [0.9, 0.7, 0.5, -0.55] and [-0.6, 0.1, -0.3, 0.55]\r\n\t *\t[1, 4]//6 index of the settings.object.geometry.positions [0.9, 0.7, 0.5, -0.55] and [-0.5, 0.2, 0.3, 0.85]\r\n\t *\t[2, 3]//7 index of the settings.object.geometry.positions [0.8, 0, -0.4, 0] and [-0.6, 0.1, -0.3, 0.55]\r\n\t *\t[2, 4]//8 index of the settings.object.geometry.positions [0.8, 0, -0.4, 0] and [-0.5, 0.2, 0.3, 0.85]\r\n\t *\t[3, 4]//9 index of the settings.object.geometry.positions [-0.6, 0.1, 0.1, 0.55] and [-0.5, 0.2, 0.3, 0.85]\r\n\t *]\r\n\t * //faces. Indices of the edges <b>settings.object.geometry.indices[0]</b>\r\n\t * <b>settings.object.geometry.indices[1]</b> = [\r\n\t *\t[7, 8, 9],//0 no 0, 1 vertices\r\n\t *\t[5, 6, 9],//1 no 0, 2 vertices\r\n\t *\t[4, 6, 8],//2 no 0, 3 vertices\r\n\t *\t[4, 5, 7],//3 no 0, 4 vertices\r\n\t *\t[2, 3, 9],//4 no 1, 2 vertices\r\n\t *\t[1, 3, 8],//5 no 1, 3 vertices\r\n\t *\t[1, 2, 7],//6 no 1, 4 vertices\r\n\t *\t[0, 3, 6],//7 no 2, 3 vertices\r\n\t *\t[0, 2, 5],//8 no 2, 4 vertices\r\n\t *\t[0, 1, 4],//9 no 3, 4 vertices\r\n\t *]\r\n\t * //bodies. Indices of the faces <b>settings.object.geometry.indices[1]</b>\r\n\t * <b>settings.object.geometry.indices[2]</b> = [\r\n\t * [2, 1, 3, 0],//0 no 0 vertice\r\n\t * [5, 6, 4, 0],//1 no 1 vertice\r\n\t * [8, 7, 1, 4],//2 no 2 vertice\r\n\t * [9, 7, 2, 5],//3 no 3 vertice\r\n\t * [9, 8, 3, 6],//4 no 4 vertice\r\n\t *]\r\n\t * </pre>\r\n\t * @param {Array|number} [settings.object.position] Array - position of the n-dimensional graphical object in n-dimensional coordinates.\r\n\t * <pre>\r\n\t * number - position of the 0 coordinate of the n-dimensional graphical object.\r\n\t * <pre>\r\n\t * @param {Array|number} [settings.object.rotation] Array - rotation in radians of the n-dimensional graphical object in n-dimensional coordinates.\r\n\t * <table>\r\n\t\t <tr><td><b>n</b> space dimension</td><td>Array index</td><td>Axis of rotation</td><td>Axis type</td><td>Note</td></tr>\r\n\t\t <tr><td>0</td><td></td><td></td><td></td><td>no rotation</td></tr>\r\n\t\t <tr><td>1</td><td></td><td></td><td></td><td>no rotation</td></tr>\r\n\t\t <tr><td>2</td><td>0</td><td></td><td></td><td>No effect for 2-dimensional space</td></tr>\r\n\t\t <tr><td></td><td>1</td><td></td><td></td><td>No effect for 2-dimensional space</td></tr>\r\n\t\t <tr><td></td><td>2</td><td>2(z)</td><td>point</td><td></td></tr>\r\n\t\t <tr><td>3</td><td>0</td><td>0(x)</td><td>line</td><td></td></tr>\r\n\t\t <tr><td></td><td>1</td><td>1(y)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>2</td><td>2(z)</td><td></td><td></td></tr>\r\n\t\t <tr><td>4</td><td>0</td><td>0, 1(xy)</td><td>plane</td><td></td></tr>\r\n\t\t <tr><td></td><td>1</td><td>0, 2(xz)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>2</td><td>0, 3(xw)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>3</td><td>1, 2(yz)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>4</td><td>1, 3(yw)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>5</td><td>2, 3(zw)</td><td></td><td></td></tr>\r\n\t\t <tr><td>5</td><td>0</td><td>0, 1, 2(xyz)</td><td>3D space</td><td></td></tr>\r\n\t\t <tr><td></td><td>1</td><td>0, 1, 3(xyw)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>2</td><td>0, 1, 4(xy4)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>3</td><td>0, 2, 3(xzw)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>4</td><td>0, 2, 4(xz4)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>5</td><td>0, 3, 4(xw4)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>6</td><td>1, 2, 3(yzw)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>7</td><td>1, 2, 4(yz4)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>8</td><td>1, 3, 4(yw4)</td><td></td><td></td></tr>\r\n\t\t <tr><td></td><td>9</td><td>2, 3, 4(zw4)</td><td></td><td></td></tr>\r\n\t\t</table>\r\n\t * <pre>\r\n\t * number - rotation in radians around axis 0 or rotation around axis 2 for 2D objects i.e. space dimension n = 2.\r\n\t * See [Can rotations in 4D be given an explicit matrix form?]{@link https://math.stackexchange.com/questions/1402362/can-rotations-in-4d-be-given-an-explicit-matrix-form}, [Rotation matrix]{@link https://en.wikipedia.org/wiki/Rotation_matrix}.\r\n\t * Examples:\r\n\t * <b>n = 4</b>, <b>rotation = [Math.PI / 5, 1, 2, 3, 4, 5]</b>\r\n\t * rotation around 0, 1(xy) plane is Math.PI / 5 radians.\r\n\t * rotation around 0, 2(xz) plane is 1 radian.\r\n\t * etc.\r\n\t *\r\n\t * <b>n = 4</b>, <b>rotation = Math.PI / 5</b>\r\n\t * rotation around 0, 1(xy) plane is Math.PI / 5 radians.\r\n\t *\r\n\t * <b>n = 2</b>, <b>rotation = [0, 0, Math.PI / 4]</b>\r\n\t * rotation around 2(z) point is Math.PI / 4 radians.\r\n\t *\r\n\t * <b>n = 2</b>, <b>rotation = Math.PI / 5</b>\r\n\t * rotation around 2(z) point is Math.PI / 5 radians.\r\n\t * <pre>\r\n\t * @param {Array} [settings.object.geometry.iAxes] array of indices of the axes.\r\n\t * For example if <b>iAxes</b> is [1,2], then axis 1 interpret as axis 0 and axis 2 interpret as axis 1.\r\n\t * As result, you can rotate axes around another axis to 90 degrees.\r\n\t * In example above you have rotated axis 1 and 2 around axis 0 to 90 degrees.\r\n\t * @param {Boolean} [settings.plane=false] true - create <b>vectorPlane</b>. See <b>settings.vectorPlane</b> below.\r\n\t * @param {Array} [settings.vectorPlane] n-dimensional position of the panel\r\n\t * intersecting with the <b>settings.object.geometry</b> n-dimensional graphical object. Available only if <b>settings.plane</b> is true.\r\n\t * @param {THREE.Scene} [settings.scene] [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}.\r\n\t * Define <b>scene</b> if you want visualise n-dimensional plane and n-dimensional object to 3-D space of the <b>scene</b>.\r\n\t * @param {Options} [settings.options] See <a href=\"../../jsdoc/Options/Options.html\" target=\"_blank\">Options</a>.\r\n\t * Uses only if <b>scene</b> is defined.\r\n\t * @param {Event} [settings.onIntersection] Plane and object intersection event.\r\n\t * The <b>onIntersection</b> function parameter is the (n-1)-dimensional geometry of the intersection if a collision occurred, or undefined if a collision did not occur.\r\n\t * @see [4D Geometry Viewer]{@link https://github.com/anhr/humke-4d-geometry}\r\n\t * @see [Tesseract]{@link https://ciechanow.ski/tesseract/}\r\n\t * @see [4D-Shapes]{@link https://artemonigiri.github.io/4D-Shapes/}\r\n\t * @see [The Regular Polychora]{@link https://www.qfbox.info/4d/regular}\r\n\t */\r\n\tconstructor( n, settings ) {\r\n\r\n\t\tsuper( settings );\r\n\t\tconst options = settings.options, _ND = this;\r\n\t\tsettings.object.raycaster = settings.object.raycaster || {};\r\n\t\tsettings.object.raycaster.text = settings.object.raycaster.text || function( intersection ) {\r\n\r\n\r\n\t\t\t//Localization\r\n\r\n\t\t\tconst getLanguageCode = settings.options.getLanguageCode;\r\n\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tpointId: \"point Id\",\r\n\t\t\t\tedgeId: \"edge Id\",\r\n\t\t\t\tfaceId: \"face Id\",\r\n\t\t\t\tbodyId: \"body Id\",\r\n\t\t\t\tsegmentId: \"segment Id\",\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\t\tswitch (_languageCode) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.pointId = 'Индекс точки';\r\n\t\t\t\t\tlang.edgeId = 'Индекс ребра';\r\n\t\t\t\t\tlang.faceId = 'Индекс грани';\r\n\t\t\t\t\tlang.bodyId = 'Индекс тела';\r\n\t\t\t\t\tlang.segmentId = 'Индекс сегмента';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst index = intersection.object.geometry.index, edge = [\r\n\t\t\t\t\tindex.getX(intersection.indexNew),\r\n\t\t\t\t\tindex.getY(intersection.indexNew)\r\n\t\t\t\t],\r\n\t\t\t\tindices = intersection.object.userData.geometry.indices;\r\n\t\t\tedges = indices[0];\r\n\r\n\t\t\t//find point id\r\n\t\t\tvar minDistance = Infinity, pointId;\r\n\t\t\tfunction distance ( i ) {\r\n\r\n\t\t\t\tconst pointIndex = edge[i],\r\n\t\t\t\t\tdistance = intersection.point.distanceTo( new THREE.Vector3().fromBufferAttribute( intersection.object.geometry.attributes.position, pointIndex ) );\r\n\t\t\t\tif ( minDistance > distance  ) {\r\n\t\r\n\t\t\t\t\tminDistance = distance;\r\n\t\t\t\t\tpointId = pointIndex;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tdistance ( 0 );\r\n\t\t\tdistance ( 1 );\r\n\t\t\tvar text = '\\n' + lang.pointId + ': ' + pointId;\r\n\t\t\t\r\n\t\t\t//Find edge index\r\n\t\t\tfor ( var segmentIndex = 0; segmentIndex < edges.length; segmentIndex++ ) {\r\n\r\n\t\t\t\tconst edgeCur = edges[segmentIndex];\r\n\t\t\t\tif (\r\n\t\t\t\t\t( ( edgeCur[0] === edge[0] ) && ( edgeCur[1] === edge[1] ) ) ||\r\n\t\t\t\t\t( ( edgeCur[0] === edge[1] ) && ( edgeCur[1] === edge[0] ) )\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\ttext += '\\n' + lang.edgeId + ': ' + segmentIndex;\r\n\t\t\t\t\tedges.selected = segmentIndex;\r\n\t\t\t\t\t\r\n\t\t\t\t\t//find segment id.\r\n\t\t\t\t\t//indices[1] is faces\r\n\t\t\t\t\t//indices[2] is bodies\r\n\t\t\t\t\tvar detectedIndex;//индекс элемента текушего сегмента segment = indices[indicesSegment]\r\n\t\t\t\t\t\t//в котором встечается индекс segmentIndex выбранного сегмента перудыдущего уровня\r\n\t\t\t\t\tfor ( var indicesSegment = 1; indicesSegment < indices.length; indicesSegment++ ) {\r\n\r\n\t\t\t\t\t\tconst segment = indices[indicesSegment];//текуший сегмент\r\n\t\t\t\t\t\t//Встречаются ли в текушем сегменте segment индекс segmentIndex выбранного сегмента перудыдущего уровня\r\n\t\t\t\t\t\tsegment.forEach( ( segmentItem, segmentIndexCur ) => {\r\n\r\n\t\t\t\t\t\t\t//найти в текущем элементе сегмента segmentItem индекс segmentIndex выбранного сегмента перудыдущего уровня\r\n\t\t\t\t\t\t\t//и присвоить detectedIndex = segmentIndexCur равному индексу текущего элемента сегмента\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < segmentItem.length; i++ ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//segmentIndex индекс выбранного сегмента перудыдущего уровня\r\n\t\t\t\t\t\t\t\t//для segment = indices[1] is faces это индекс выбранного edge\r\n\t\t\t\t\t\t\t\t//для segment = indices[2] is bodies это индекс выбранного face\r\n\t\t\t\t\t\t\t\tif ( segmentItem[i] === segmentIndex ) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t//if ( detectedIndex != undefined ) console.log( 'Duplicate segment: ' + i );\r\n\t\t\t\t\t\t\t\t\tdetectedIndex = segmentIndexCur;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tif ( detectedIndex === undefined ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.error( 'ND: mouse move. Index of segment was not detected' );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tsegmentIndex = detectedIndex;\r\n\t\t\t\t\t\t\tvar segmentName;\r\n\t\t\t\t\t\t\tswitch( indicesSegment ) {//индекс ткушего сегмета\r\n\r\n\t\t\t\t\t\t\t\tcase 1: segmentName = lang.faceId; break;\r\n\t\t\t\t\t\t\t\tcase 2: segmentName = lang.bodyId; break;\r\n\t\t\t\t\t\t\t\tdefault: segmentName = lang.segmentId;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttext += '\\n' + segmentName + ': ' + segmentIndex;\r\n\t\t\t\t\t\t\tsegment.selected = segmentIndex;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst segment = indices[indices.length - 1][segmentIndex];\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\treturn text;\r\n\t\t\t\r\n\t\t};\r\n\t\tsettings.object.name = settings.object.name || 'Object';\r\n\t\tif ( settings.object.aObjects ) settings.object.aObjects.nD = this;\r\n\t\tsettings.object.geometry = settings.object.geometry || {};\r\n\t\tif ( settings.object.geometry instanceof Array ) {\r\n\r\n\t\t\tconst position = settings.object.geometry;\r\n\t\t\tsettings.object.geometry = { position: position, }\r\n\r\n\t\t}\r\n\t\tsettings.object.geometry.position = settings.object.geometry.position || [];\r\n\r\n\t\tclass Vector extends ND.VectorN {\r\n\r\n\t\t\t/* *\r\n\t\t\t * @description\r\n\t\t\t * <pre>\r\n\t\t\t * An n-dimensional vector is point in an n-dimensional space.\r\n\t\t\t * The length of an array is the dimension of the space.\r\n\t\t\t * @param {Array} [array=0] array of the values for appropriate axes.\r\n\t\t\t * </pre>\r\n\t\t\t * @example //Creates a point in 2-dimensional space. -5 is value for 0 axis and 7.8 is value for 1 axis.\r\n\t\t\t * const vector = new ND.Vector( [-5, 7.8] );\r\n\t\t\t * const point = vector.point;//THREE.Vector3( -5, 7.8, 0 )\r\n\t\t\t * const vector0 = vector[0]//-5\r\n\t\t\t * const vector1 = vector[1]//7.8\r\n\t\t\t */\r\n\t\t\tconstructor( array = 0, vectorSettings = {} ) {\r\n\r\n\t\t\t\tarray = super(n, array).array;\r\n\t\t\t\tconst _this = this;\r\n\r\n\t\t\t\t//https://stackoverflow.com/questions/2449182/getter-setter-on-javascript-array\r\n\t\t\t\treturn new Proxy( array, {\r\n\r\n\t\t\t\t\tget: function ( target, name ) {\r\n\r\n\t\t\t\t\t\tvar i = parseInt( name );\r\n\t\t\t\t\t\tif ( isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\t\t/* *\r\n\t\t\t\t\t\t\t\t* @description\r\n\t\t\t\t\t\t\t\t* <pre>\r\n\t\t\t\t\t\t\t\t* <b><a href=\"./NDVector.ND.Vector.html\" target=\"_blank\">ND.Vector</a>.point</b>.\r\n\t\t\t\t\t\t\t\t* Projection of the <b>ND.Vector</b> object into 3D space.\r\n\t\t\t\t\t\t\t\t* Returns <b>THREE.Vector3</b> object.\r\n\t\t\t\t\t\t\t\t* Projection of 1-dimensional vector into 3D space: <b>THREE.Vector3( vector[0], 0, 0 ) </b>.\r\n\t\t\t\t\t\t\t\t* Projection of 2-dimensional vector into 3D space: <b>THREE.Vector3( vector[0], vector[1], 0 ) </b>.\r\n\t\t\t\t\t\t\t\t* Projection of 3-dimensional vector into 3D space: <b>THREE.Vector3( vector[0], vector[1], vector[2] ) </b>.\r\n\t\t\t\t\t\t\t\t* </pre>\r\n\t\t\t\t\t\t\t\t* @See <a href=\"./NDVector.ND.Vector.html\" target=\"_blank\">ND.Vector</a>\r\n\t\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\tcase \"point\":\r\n\t\t\t\t\t\t\t\t\tconst THREE = three.THREE;\r\n\t\t\t\t\t\t\t\t\tif ((typeof settings.object.color === \"object\") && (array.length >= 4))\r\n\t\t\t\t\t\t\t\t\t\treturn new THREE.Vector4( this.get( undefined, 0 ), this.get( undefined, 1 ), this.get( undefined, 2 ), this.get( undefined, 3 ) );//цвет каждой вершины зависить от оси w этой вершины\r\n\t\t\t\t\t\t\t\t\treturn new THREE.Vector3( this.get( undefined, 0 ), this.get( undefined, 1 ), this.get( undefined, 2 ) );//Цвет всех вершин определяется из settings.object.color или из settings.object.geometry.colors или одинаковый по умолчанию\r\n\t\t\t\t\t\t\t\tdefault: {\r\n\r\n\t\t\t\t\t\t\t\t\treturn _this[name];\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( i >= n )\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\tif ( ( array.length > n ) && settings.object.geometry.iAxes && ( i < settings.object.geometry.iAxes.length ) )\r\n\t\t\t\t\t\t\ti = settings.object.geometry.iAxes[i];\r\n\t\t\t\t\t\treturn array[i];\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( i >= array.length ) {\r\n\t\r\n\t\t\t\t\t\t\t\tarray.push( value );\r\n\t\t\t\t\t\t\t\treturn array.length;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tarray[i] = value;\r\n\t\t\t\t\t\t\t_ND.intersection();\r\n\t\t\t\t\t\t\tif ( vectorSettings.onChange ) vectorSettings.onChange();\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tswitch ( name ) {\r\n\t\r\n\t\t\t\t\t\t\tcase 'onChange':\r\n\t\t\t\t\t\t\t\tvectorSettings.onChange = value;\r\n\t\t\t\t\t\t\t\treturn vectorSettings.onChange;\r\n\t\t\t\t\t\t\tdefault: console.error( 'ND: Vector set. Invalid name: ' + name );\r\n\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t\tpush( value ) { console.error( 'ND.Vector.push() unavailable' ); }\r\n\t\t\tpop() { console.error( 'ND.Vector.pop() unavailable' ); }\r\n\r\n\t\t}\r\n\r\n\t\tfunction update() {\r\n\t\t\t\r\n\t\t\t_ND.intersection();\r\n\t\t\tobject3D.geometry.attributes.position.array = new THREE.BufferGeometry().setFromPoints( geometry.D3.points ).attributes.position.array;\r\n\t\t\tobject3D.geometry.attributes.position.needsUpdate = true;\r\n\t\t\tif (options.guiSelectPoint) options.guiSelectPoint.update();\r\n\t\t\tobject3D.children.forEach( child => {\r\n\t\t\t\t\r\n\t\t\t\tif ( child.type === 'Sprite' ) child.position.copy( geometry.D3.points[child.userData.pointID] );\r\n\t\t\t\t\t\r\n\t\t\t} );\r\n\t\t\t\r\n\t\t}\r\n\t\tfunction proxyPosition() {\r\n\r\n\t\t\tif ( settings.object.position && settings.object.position.isProxy ) return settings.object.position;\r\n\t\t\treturn new Proxy( settings.object.position ? settings.object.position instanceof Array ? settings.object.position : [settings.object.position] : [], {\r\n\r\n\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\tif ( target instanceof Array ) {\r\n\r\n\t\t\t\t\t\t\tif ( i < target.length && ( target[i] !== undefined ) )\r\n\t\t\t\t\t\t\t\treturn target[i];\r\n\t\t\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn target;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\t\tcase 'folders':\r\n\t\t\t\t\t\t\ttarget.folders = target.folders || [];\r\n\t\t\t\t\t\t\treturn target.folders;\r\n\t\t\t\t\t\tcase 'arguments': return;//for dat.GUI\r\n\t\t\t\t\t\tcase 'clear': return function () {\r\n\r\n\t\t\t\t\t\t\ttarget.forEach( ( pos, i ) => target[i] = 0 );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'forEach': return target.forEach;\r\n\t\t\t\t\t\tcase 'length': return target.length;\r\n\t\t\t\t\t\tdefault: console.error( 'ND: settings.object.position Proxy. Invalid name: ' + name );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\ttarget[name] = value;\r\n\r\n\t\t\t\t\tsettings.object.geometry.position.reset();\r\n\r\n\t\t\t\t\tconst input = target.folders[name].cPosition.domElement.querySelector( 'input' );\r\n\t\t\t\t\tif ( parseFloat( input.value ) !== value ) {\r\n\r\n\t\t\t\t\t\tinput.value = value;\r\n\t\t\t\t\t\tupdate();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tsettings.object.position = proxyPosition();\r\n\r\n\t\tfunction proxyRotation() {\r\n\r\n\t\t\tif ( settings.object.rotation && settings.object.rotation.isProxy ) return settings.object.rotation;\r\n\t\t\treturn new Proxy( settings.object.rotation ? settings.object.rotation instanceof Array ? settings.object.rotation : [settings.object.rotation] : [], {\r\n\r\n\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\tif ( target instanceof Array ) {\r\n\r\n\t\t\t\t\t\t\tif ( i < target.length && ( target[i] !== undefined ) ) return target[i];\r\n\t\t\t\t\t\t\treturn 0;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn target;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\t\tcase 'boUseRotation': return target.boUseRotation;\r\n\t\t\t\t\t\tcase 'folders':\r\n\t\t\t\t\t\t\ttarget.folders = target.folders || [];\r\n\t\t\t\t\t\t\treturn target.folders;\r\n\t\t\t\t\t\tcase 'trigonometry':\r\n\t\t\t\t\t\t\tif ( !target.trigonometry ) {\r\n\r\n\t\t\t\t\t\t\t\ttarget.trigonometry = new Proxy( [], {\r\n\r\n\t\t\t\t\t\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( !target[i] ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tsettings.object.rotation.boUseRotation = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst angle = settings.object.rotation[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\tsettings.object.rotation.boUseRotation = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\ttarget[i] = { sin: Math.sin( angle ), cos: Math.cos( angle ) };\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn target[i];\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tdefault: console.error( 'ND: settings.object.rotation Proxy. Invalid name: ' + name );\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\ttarget[name] = value;\r\n\t\t\t\t\t\t\t\t\t\tif ( isNaN( parseInt( name ) ) ) return true;\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\r\n\r\n\t\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn target.trigonometry;\r\n\t\t\t\t\t\tcase 'isRotation': return function () {\r\n\r\n\t\t\t\t\t\t\ttarget.boUseRotation = true;\r\n\t\t\t\t\t\t\tvar boRotation = false\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < n; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( settings.object.rotation[j] !== 0 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tboRotation = true;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttarget.boUseRotation = false;\r\n\t\t\t\t\t\t\treturn boRotation;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'clear': return function () {\r\n\r\n\t\t\t\t\t\t\ttarget.forEach( ( angle, i ) => target[i] = 0 );\r\n\t\t\t\t\t\t\ttarget.trigonometry = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase 'arguments': return;//for dat.GUI\r\n\t\t\t\t\t\tcase 'forEach': return target.forEach;\r\n\t\t\t\t\t\tcase 'length': return target.length;\r\n\t\t\t\t\t\tdefault: console.error( 'ND: settings.object.rotation Proxy. Invalid name: ' + name );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\ttarget[name] = value;\r\n\t\t\t\t\tif ( isNaN( parseInt( name ) ) ) return true;\r\n\r\n\t\t\t\t\tsettings.object.rotation.trigonometry[name].cos = Math.cos( value );\r\n\t\t\t\t\tsettings.object.rotation.trigonometry[name].sin = Math.sin( value );\r\n\r\n\t\t\t\t\tsettings.object.geometry.position.reset();\r\n\r\n\t\t\t\t\tif ( target.folders ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst input = target.folders[name].cRotation.domElement.querySelector( 'input' );\r\n\t\t\t\t\t\tif ( parseFloat( input.value ) !== value ) {\r\n\t\r\n\t\t\t\t\t\t\tinput.value = value;\r\n\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tupdate();\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t},\r\n\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tif ( !settings.object.rotation || !settings.object.rotation.isProxy ) {\r\n\r\n\t\t\tsettings.object.rotation = proxyRotation();\r\n\t\t\tsettings.object.rotation.boUseRotation = false;\r\n\r\n\t\t}\r\n\r\n\t\tif ( settings.object.geometry.position.target ) settings.object.geometry.position = settings.object.geometry.position.target;\r\n\t\tsettings.object.geometry.position.boPositionError = true;\r\n\t\tconst rotationAxes = [[]];//массив осей вращения\r\n\t\tfunction setRotationAxes() {\r\n\r\n\t\t\tif ( n < 2 ) return;\r\n\t\t\t\r\n\t\t\tif ( rotationAxes[0].length != 0 ) return;\r\n\r\n\t\t\t//create rotation axies\r\n\r\n\t\t\t//первый ряд\r\n\r\n\t\t\t//индексы рядов и колонок матрицы, в которые заносятся значения тригонометрических функций\r\n\t\t\t//Тригонометрические функци надо внестив следующие 4 ячейки матрицы:\r\n\t\t\t//m[tI[0], tI[0]] = cos, m[tI[0], tI[1]] = -sin, m[tI[1], tI[0]] = sin, m[tI[1], tI[1]] = cos.\r\n\t\t\t//const tI = [0,1];\r\n\t\t\t//Для первой матрицы получается\r\n\t\t\t//m[0, 0] = cos, m[0, 1] = -sin, m[1, 0] = sin, m[1, 1] = cos.\r\n\r\n\t\t\tif ( n === 2 ) rotationAxes[0].push( 2 );//в двумерном пространстве вращение вокруг оси 2\r\n\t\t\telse for ( var j = 0; j < ( n - 2 ); j++ ) rotationAxes[0].push( j );\r\n\t\t\trotationAxes[0].tI = [0, 1];\r\n\r\n\t\t\tconst iLastColumn = rotationAxes[0].length - 1;\r\n\r\n\t\t\tvar boLastRow = false;\r\n\r\n\t\t\twhile ( !boLastRow ) {\r\n\r\n\t\t\t\tconst iLastRow = rotationAxes.length - 1, lastRow = rotationAxes[iLastRow],\r\n\t\t\t\t\trow = [];\r\n\r\n\t\t\t\tfor ( var j = iLastColumn; j >= 0; j-- ) {\r\n\r\n\t\t\t\t\tconst prevColumn = lastRow[j];\r\n\t\t\t\t\tvar iAxis;//индекс оси\r\n\t\t\t\t\tif ( j === iLastColumn ) iAxis = prevColumn + 1;//увеличить на 1 последнюю колонку\r\n\t\t\t\t\telse iAxis = prevColumn;\r\n\t\t\t\t\tif ( iAxis >= n ) {\r\n\r\n\t\t\t\t\t\tfunction createRow( j ) {\r\n\r\n\t\t\t\t\t\t\tif ( j <= 0 ) return false;//последний ряд\r\n\t\t\t\t\t\t\t//если это последняя колонка и если индекс оси больше количества осей в n пространстве\r\n\t\t\t\t\t\t\t//увеличить индекс оси в предыдущей колонке\r\n\t\t\t\t\t\t\tconst prevRowColumn = lastRow[j - 1] + 1;\r\n\t\t\t\t\t\t\t//предыдущая колонка не может больше или рано текушей колонке в предыдущем ряде\r\n\t\t\t\t\t\t\tif ( prevRowColumn >= lastRow[j] ) return createRow( j - 1 );\r\n\t\t\t\t\t\t\trow[j - 1] = prevRowColumn;\r\n\t\t\t\t\t\t\t//индекс оси в текущей колонке равен индексу в предыдущей колонке плюс 1\r\n\t\t\t\t\t\t\trow[j] = row[j - 1] + 1;\r\n\r\n\t\t\t\t\t\t\t//все последующие колонки увеличиваются на единицу\r\n\t\t\t\t\t\t\tfor ( var k = j + 1; k <= iLastColumn; k++ ) row[k] = row[k - 1] + 1;\r\n\r\n\t\t\t\t\t\t\t//копируем из последнего ряда оставшиеся колонки слева \r\n\t\t\t\t\t\t\tj = j - 2;\r\n\t\t\t\t\t\t\twhile ( j >= 0 ) {\r\n\r\n\t\t\t\t\t\t\t\trow[j] = lastRow[j];\r\n\t\t\t\t\t\t\t\tj--;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tboLastRow = !createRow( j );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse row[j] = iAxis;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( !boLastRow ) {\r\n\r\n\t\t\t\t\trow.tI = [lastRow.tI[0]];\r\n\t\t\t\t\tvar tI1 = lastRow.tI[1] + 1;\r\n\t\t\t\t\tif ( tI1 >= n ) {\r\n\r\n\t\t\t\t\t\trow.tI[0]++;\r\n\t\t\t\t\t\ttI1 = row.tI[0] + 1;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\trow.tI[1] = tI1;\r\n\t\t\t\t\tif ( row.length === 0 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ND positionWorld get: row is empty' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\trotationAxes.push( row );\r\n\r\n\t\t\t\t\t//debug\r\n\t\t\t\t\tif ( iLastRow === rotationAxes.length - 1 ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ND positionWorld get: row is not added' );\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tconst positionWorld = new Proxy( settings.object.geometry.position ? settings.object.geometry.position : [], {\r\n\t\r\n\t\t\tget: function ( target, name ) {\r\n\r\n\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\tsettings.object.geometry.position.boPositionError = false;\r\n\t\t\t\t\tconst positionPoint = settings.object.geometry.position[i];\r\n\t\t\t\t\tif ( positionPoint.positionWorld ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//не надо снова вычислять мировые координатя точки если они уже вычислены\r\n\t\t\t\t\t\tsettings.object.geometry.position.boPositionError = true;\r\n\t\t\t\t\t\treturn positionPoint.positionWorld;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst array = [];\r\n\t\t\t\t\tif ( positionPoint !== undefined ) {\r\n\r\n\t\t\t\t\t\tif ( !( settings.object.position instanceof Array ) ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'ND positionWorld get: settings.object.position is not array' );\r\n\t\t\t\t\t\t\tsettings.object.position = [settings.object.position];\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( settings.object.rotation.isRotation() ) {\r\n\r\n\t\t\t\t\t\t\t//https://math.stackexchange.com/questions/1402362/can-rotations-in-4d-be-given-an-explicit-matrix-form\r\n\t\t\t\t\t\t\t//https://en.wikipedia.org/wiki/Rotation_matrix\r\n\t\t\t\t\t\t\tfunction getMatrix( index ) {\r\n\r\n\t\t\t\t\t\t\t\tconst cos = settings.object.rotation.trigonometry[index].cos, sin = settings.object.rotation.trigonometry[index].sin,\r\n\t\t\t\t\t\t\t\t\tarray = [];\r\n\t\t\t\t\t\t\t\tconst tI = rotationAxes[index].tI;\r\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < n; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst row = [];\r\n\t\t\t\t\t\t\t\t\tfor ( var j = 0; j < n; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( n === 3 ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst iR = n - i - 1, jR = n - j - 1;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( ( iR === tI[0] ) && ( jR === tI[0] ) ) row.push( cos );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( iR === tI[0] ) && ( jR === tI[1] ) ) row.push( sin );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( iR === tI[1] ) && ( jR === tI[0] ) ) row.push( -sin );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( iR === tI[1] ) && ( jR === tI[1] ) ) row.push( cos );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( iR === jR ) row.push( 1 );\r\n\t\t\t\t\t\t\t\t\t\t\telse row.push( 0 );\r\n\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ( ( i === tI[0] ) && ( j === tI[0] ) ) row.push( cos );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( i === tI[0] ) && ( j === tI[1] ) ) row.push( -sin );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( i === tI[1] ) && ( j === tI[0] ) ) row.push( sin );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( ( i === tI[1] ) && ( j === tI[1] ) ) row.push( cos );\r\n\t\t\t\t\t\t\t\t\t\t\telse if ( i === j ) row.push( 1 );\r\n\t\t\t\t\t\t\t\t\t\t\telse row.push( 0 );\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tarray.push( row );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn new MyMath.Matrix( array );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar m3;\r\n\r\n\t\t\t\t\t\t\tsetRotationAxes();\r\n\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t//test\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tconst a = [\r\n\t\t\t\t\t\t\t\t\t\t[1, 2],\r\n\t\t\t\t\t\t\t\t\t\t[3, 4],\r\n\t\t\t\t\t\t\t\t\t\t[5, 6],\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\tb = [\r\n\t\t\t\t\t\t\t\t\t\t[7,   8, 9 ,10],\r\n\t\t\t\t\t\t\t\t\t\t[11, 12, 13,14],\r\n\t\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\tv = [15, 16, 17, 18];\r\n\t\t\t\t\t\t\t\tconst c = new MyMath.Matrix( a ).multiply( b );\r\n\t\t\t\t\t\t\t\tconst cv = c * v;\r\n\t\t\t\t\t\t\t\t//const cv = c.multiply( v );\r\n\t\t\t\t\t\t\t\tconsole.log(cv);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst m1 = math.matrix( a ),\r\n\t\t\t\t\t\t\t\t\tm2 = math.matrix( b ),\r\n\t\t\t\t\t\t\t\t\tc2 = math.multiply( m1, m2 );\r\n\t\t\t\t\t\t\t\tconst cv2 = math.multiply( c2, v );\r\n\t\t\t\t\t\t\t\tconsole.log(cv2);\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\tif ( n === 2 ) m3 = getMatrix( 0 );//вращение только вокруг оси 2\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < rotationAxes.length; j++ ) {\r\n\r\n\t\t\t\t\t\t\t\tconst m = getMatrix( j );\r\n\t\t\t\t\t\t\t\tif ( m3 ) m3 = m3.multiply( m );//m3 = math.multiply( m3, m );\r\n\t\t\t\t\t\t\t\telse m3 = m;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvar position = [];\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < n; j++ ) position.push( positionPoint[j] );\r\n\t\t\t\t\t\t\tconst p = m3.multiply( position );\r\n\t\t\t\t\t\t\tp.forEach( ( value, i ) => {\r\n\r\n\t\t\t\t\t\t\t\tif ( value !== undefined ) {\r\n\r\n\t\t\t\t\t\t\t\t\tarray.push( value + settings.object.position[i] );\r\n\r\n\t\t\t\t\t\t\t\t} else console.error( 'ND: positionWorld get: invalig array item = ' + value );\r\n\r\n\t\t\t\t\t\t\t} )\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tpositionPoint.forEach( ( value, j ) => array.push( value + settings.object.position[j] ) );\r\n\t\t\t\t\t\t\tsetRotationAxes();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else console.error('ND positionWorld get index')\r\n\t\t\t\t\tif (settings.object.geometry.boRememberPosition === undefined) settings.object.geometry.boRememberPosition = true;\r\n\t\t\t\t\tif (settings.object.geometry.boRememberPosition) positionPoint.positionWorld = array;\r\n\t\t\t\t\tsettings.object.geometry.position.boPositionError = true;\r\n\t\t\t\t\treturn array;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\tcase 'target': return;// target; Если вершинрнуть target, то неверно сработает if ( settings.object.geometry.position.target ) и позиция intersection будет неверна\r\n\t\t\t\t\tcase 'copy': \r\n\t\t\t\t\t\treturn function () {\r\n\r\n\t\t\t\t\t\t\tconst v = [];\r\n\t\t\t\t\t\t\tsettings.object.geometry.position.boPositionError = false;\r\n\t\t\t\t\t\t\tsettings.object.geometry.position.forEach( ( value, i ) => {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tv[i] = positionWorld[i];\r\n\t\t\t\t\t\t\t\tsettings.object.geometry.position.boPositionError = false;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\tsettings.object.geometry.position.boPositionError = true;\r\n\t\t\t\t\t\t\treturn v;\r\n\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn settings.object.geometry.position[name];\r\n\r\n\t\t\t},\r\n\t\t\t\r\n\t\t} );\r\n\r\n\t\t//делаю как объект для совместимости с GuiIndices потому что в javascript нельзя передовать ссылки на переменные\r\n\t\t//https://stackoverflow.com/questions/7744611/pass-variables-by-reference-in-javascript\r\n\t\tconst _prevLine = {};\r\n\r\n\t\tfunction proxyGeometryPosition() {\r\n\r\n\t\t\tif ( settings.object.geometry.position && settings.object.geometry.position.isProxy ) return settings.object.geometry.position;\r\n\t\t\treturn new Proxy( settings.object.geometry.position ? settings.object.geometry.position : [], {\r\n\r\n\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\tconst positionId = i;\r\n\t\t\t\t\t\tif ( settings.object.geometry.position.boPositionError ) {\r\n\r\n\t\t\t\t\t\t\t//срабатывает когда меняется позиция вершины.\r\n\t\t\t\t\t\t\t//Не хочу менять boPositionError в этом случае, потому что это может происходить на веб странице пользователя\r\n\t\t\t\t\t\t\t//console.error( 'ND: Use positionWorld instread settings.object.geometry.position' );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( i >= target.length ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'ND get settings.object.geometry.position: invalid index = ' + i );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( target[i] instanceof Array ) {\r\n\r\n\t\t\t\t\t\t\treturn new Proxy( target[i], {\r\n\r\n\t\t\t\t\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ( i >= target.length ) return 0;\r\n\t\t\t\t\t\t\t\t\t\tconst axis = target[i];\r\n\t\t\t\t\t\t\t\t\t\tif ( isNaN( axis ) ) console.error( 'ND get settings.object.geometry.position[i][' + i + '] = ' + target[i] );\r\n\t\t\t\t\t\t\t\t\t\treturn axis;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'reset': return function() { delete target.positionWorld; }\r\n\t\t\t\t\t\t\t\t\t\tcase 'distanceTo': return (verticeTo) => {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\tconst vertice = target;\r\n\t\t\t\t\t\t\t\t\t\t\tif (vertice.length != verticeTo.length) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(sUniverse + ': settings.object.geometry.position[i].distanceTo(...). vertice.length != verticeTo.length');\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t//const distance = new three.THREE.Vector3(vertice[0], vertice[1], vertice[2], ).distanceTo(new three.THREE.Vector3(verticeTo[0], verticeTo[1], verticeTo[2], ));\r\n\t\t\t\t\t\t\t\t\t\t\tlet sum = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tvertice.forEach((axis, i) => {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst d = axis - verticeTo[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\tsum += d * d;\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\treturn Math.sqrt(sum);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn target[name];\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\t\t\t\ttarget[name] = value;\r\n\t\t\t\t\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n//\t\t\t\t\t\t\t\t\t\t_ND.bufferGeometry.userData.position[positionId][i] = value;\r\n\t\t\t\t\t\t\t\t\t\ttarget.positionWorld = undefined;\r\n\t\t\t\t\t\t\t\t\t\tif ( _prevLine.prevLine ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t_prevLine.prevLine.geometry.attributes.position.array = new THREE.BufferGeometry().setFromPoints( geometry.D3.points ).attributes.position.array;\r\n\t\t\t\t\t\t\t\t\t\t\t_prevLine.prevLine.geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tupdate();//изменилась позиция вершины\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconsole.error( 'ND: get settings.object.geometry.position is not array.' )\r\n\t\t\t\t\t\treturn [target[i]];\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\t\tcase 'boPositionError': return target.boPositionError;\r\n\t\t\t\t\t\tcase 'target': return target;\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t* Returns a new vector with the same values as this one.\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\tcase \"clone\":\r\n\t\t\t\t\t\t\treturn function ( i ) {\r\n\r\n\t\t\t\t\t\t\t\tconst v = [];\r\n\t\t\t\t\t\t\t\ttarget[i].forEach( ( value, j ) => v[j] = target[i][j] );\r\n\t\t\t\t\t\t\t\treturn v;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase \"reset\": return function () { target.forEach( item => delete item.positionWorld ); }\r\n\t\t\t\t\t\tdefault: return target[name];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\tif ( !isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\t//изменилась позиция вершины\r\n\t\t\t\t\t\ttarget[name].positionWorld = undefined;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[name] = value;\r\n\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tsettings.object.geometry.position = proxyGeometryPosition();\r\n\r\n\t\t//indices\r\n\r\n\t\tfunction setIndices() {\r\n\t\t\t\r\n\t\t\tif ( settings.object.geometry.indices ) return;\r\n\r\n\t\t\tsettings.object.geometry.indices = [];\r\n\t\t\tsettings.object.geometry.indices.boAddIndices = true;\r\n\t\t\t\r\n\t\t}\r\n\t\tsetIndices();\r\n\r\n\t\t//edges\r\n\t\tfunction proxyEdges( newEdges ) {\r\n\r\n\t\t\tedges = newEdges || edges;\r\n\t\t\tif ( edges && edges.isProxy ) return edges;\r\n\t\t\treturn new Proxy( edges ? edges : [],\r\n\t\t\t\t{\r\n\r\n\t\t\t\t\tget: function ( edges, name, value ) {\r\n\r\n\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\t\t\tconst edge = edges[i];\r\n\t\t\t\t\t\t\tedge.intersection = ( geometryIntersection/*, color*/ ) => {\r\n\r\n\t\t\t\t\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\t\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\t\t\t\t\tif (i.toString() !== name) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('ND: settings.object.geometry.indices[]intersection. invalid name = ' + name);\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (edges.length === 0) return;//no edges\r\n\t\t\t\t\t\t\t\t\tif (i >= edges.length) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('ND: settings.object.geometry.indices[]intersection. invalid length: ' + edges.length);\r\n\t\t\t\t\t\t\t\t\t\tthis.indices = { intersection: {} };\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tvar indices = edges[i];\r\n\r\n\t\t\t\t\t\t\t\t\t//Когда размерность графического оъекта меньше 3\r\n\t\t\t\t\t\t\t\t\t//и когда он создается из объета большей размерности\r\n\t\t\t\t\t\t\t\t\t//то indices это прокси\r\n\t\t\t\t\t\t\t\t\t//if (indices.indices) indices = indices.indices;\r\n\r\n\t\t\t\t\t\t\t\t\tif (indices.length !== 2) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('ND: settings.object.geometry.indices[]intersection. indices.length = ' + indices.length);\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (indices[0] === indices[1]) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error('ND: settings.object.geometry.indices[]intersection. indices[0] === indices[1] = ' + indices[0]);\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tconst position0 = new Vector(positionWorld[indices[0]]),\r\n\t\t\t\t\t\t\t\t\t\tposition1 = new Vector(positionWorld[indices[1]]);\r\n\t\t\t\t\t\t\t\t\tfunction indicesIntersection(position) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tswitch (n) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!position)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\tposition.push(vectorPlane[n - 1]);\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tindices.intersection = { position: position, }\r\n\t\t\t\t\t\t\t\t\t\tif (indices.intersection.position) indices.intersection.position.iEdge = i;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tswitch (n) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\t\t\t\tif (vectorPlane[0].between(position0[0], position1[0], true))\r\n\t\t\t\t\t\t\t\t\t\t\t\tgeometryIntersection.position.push([vectorPlane[0]]);\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t\t\tvar vector;\r\n\t\t\t\t\t\t\t\t\t\t\tif (vectorPlane[1].between(position0[1], position1[1], true)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst a = (position1[1] - position0[1]) / (position1[0] - position0[0]),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tb = position0[1] - a * position0[0],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tx = (a === 0) || isNaN(a) || (Math.abs(a) === Infinity) ?\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tposition1[0] :\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(vectorPlane[1] - b) / a;\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (isNaN(x) || (x === undefined)) { console.error('ND.intersection: x = ' + x + ' position1[0] = ' + position1[0] + ' position0[0] = ' + position0[0]); }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//Если x почти равно position0[0] и position0[0] то будем считать что x между ними\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst d = 1e-15;//-1.1102230246251565e-16 \r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!x.between(position0[0], position1[0], true)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (!((Math.abs(x - position0[0]) < d) && (Math.abs(x - position0[0]) < d))) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tindices.intersection = {};\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//else console.log('x почти равно position0[0] и position0[0]');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tvector = [x, vectorPlane[1]];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tindicesIntersection(vector);\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tcase 3:\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tvar pos;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//Если позиции вершины находится на этом расстоянии от панели, то будем считать, что она находится на панели\r\n\t\t\t\t\t\t\t\t\t\t\t//Для проверки запустить canvas 3D с geometry Variant 1 и проигрыватель в точке t = 0.6.\r\n\t\t\t\t\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\t\t\t\t\t//В примере canvas 3D с geometry.position Variant 2 вершина точно находится на панели\r\n\t\t\t\t\t\t\t\t\t\t\tconst d = 5.56e-17;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (Math.abs(vectorPlane[n - 1] - position1[n - 1]) < d) pos = position1;\r\n\t\t\t\t\t\t\t\t\t\t\telse if (Math.abs(vectorPlane[n - 1] - position0[n - 1]) < d) pos = position0;\r\n\t\t\t\t\t\t\t\t\t\t\tif (pos) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t//Вершина находится на панели.\r\n\t\t\t\t\t\t\t\t\t\t\t\t//Для проверки запустить canvas 3D и установить время проигрывателя t = 0.3 так чтобы вершина 2 пирамиды попала на панель\r\n\t\t\t\t\t\t\t\t\t\t\t\t//В этом случает треугольник пересечения сведется к трем точкам с одинаковыми координатами.\r\n\t\t\t\t\t\t\t\t\t\t\t\tindicesIntersection([pos[0], pos[1]]);\r\n\t\t\t\t\t\t\t\t\t\t\t\tindices.intersection.boVerticeOnPanel = true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst nD02 = new ND(n - 1, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplane: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tobject: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tposition: positionWorld.copy(),//settings.object.geometry.position,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindices: [[indices]],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tiAxes: [1, 2],\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvectorPlane: vectorPlane.array,\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tarrayIntersects02 = nD02.intersection();\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst nD12 = new ND(n - 1, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplane: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tobject: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tposition: positionWorld.copy(),//settings.object.geometry.position,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindices: [[indices]],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tiAxes: [0, 2],\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvectorPlane: vectorPlane.array,\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tarrayIntersects12 = nD12.intersection();\r\n\t\t\t\t\t\t\t\t\t\t\t\tindicesIntersection(arrayIntersects02.length && arrayIntersects12.length ?\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t[arrayIntersects12[0][0], arrayIntersects02[0][0]] : undefined);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\tdefault:\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tfunction intersectionAxis(axis) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst nD0 = new ND(2, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tplane: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tobject: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tposition: positionWorld,//settings.object.geometry.position,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindices: [[indices]],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tiAxes: [axis, n - 1],\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvectorPlane: vectorPlane.array,\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn nD0.intersection();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tconst arrayIntersections = [];\r\n\t\t\t\t\t\t\t\t\t\t\tvar boIntersect = true;\r\n\t\t\t\t\t\t\t\t\t\t\tfor (var iIntersection = 0; iIntersection < n - 1; iIntersection++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst item = intersectionAxis(iIntersection);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (boIntersect && (item.length === 0)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tboIntersect = false;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (item.length) arrayIntersections.push(item[0][0]);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tindicesIntersection(boIntersect ? arrayIntersections : undefined);\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t} else console.error('ND: settings.object.geometry.indices[]intersection. invalid name: ' + name);\r\n\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\treturn edge;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\tcase 'intersection': return undefined;\r\n\t\t\t\t\t\t\tcase 'edges': return edges;\r\n\t\t\t\t\t\t\tcase 'isProxy': return true;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn edges[name];\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset: function ( edges, prop, value ) {\r\n\r\n\t\t\t\t\t\tconst index = parseInt( prop );\r\n\t\t\t\t\t\tif ( isNaN( index ) ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( prop ) {\r\n\r\n\t\t\t\t\t\t\t\tcase 'length': break;\r\n\t\t\t\t\t\t\t\tcase 'edges': settings.object.geometry.indices[0] = proxyEdges( value ); break;\r\n\t\t\t\t\t\t\t\tcase 'selected': edges.selected = value; break;\r\n\t\t\t\t\t\t\t\tdefault: console.error( 'ND settings.object.geometry.indices[0].set: invalid prop: ' + prop );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( value instanceof Array ) {\r\n\r\n\t\t\t\t\t\t\t//Do not add a duplicate edge\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < edges.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\tconst edge = edges[i];\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t( ( edge[0] === value[0] ) && ( edge[1] === value[1] ) ) ||\r\n\t\t\t\t\t\t\t\t\t( ( edge[1] === value[0] ) && ( edge[0] === value[1] ) )\r\n\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t//console.error('ND.proxyEdges: Duplicate edge: ' + edge);//for http://localhost/anhr/egocentricUniverse/master/Examples/2D.html\r\n\t\t\t\t\t\t\t\t\tvalue.index = i;\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tedges[index] = value;\r\n\t\t\t\t\t\t\tvalue.index = index;\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst indices = value;\r\n\t\t\t\t\t\tif ( indices.length !== 2 ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'ND: settings.object.geometry.indices.push invalid indices.length = ' + indices.length );\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//find duplicate edge\r\n\t\t\t\t\t\tfor ( var i = 0; i < edges.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst edgeIndices = edges[i];\r\n\t\t\t\t\t\t\tif ( ( edgeIndices[0] === indices[0] ) && ( edgeIndices[1] === indices[1] ) ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( 'ND: settings.object.geometry.indices.push under constraction' );\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( ( edgeIndices[0] === indices[1] ) && ( edgeIndices[1] === indices[0] ) ) {\r\n\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( 'ND: settings.object.geometry.indices.push under constraction' );\r\n\t\t\t\t\t\t\t\t//у этого ребра есть ребро близнец, у которого индексы вершин поменены местами\r\n\t\t\t\t\t\t\t\t//Поэтому можно не искать точку пересечения а брать ее из близнеца\r\n\t\t\t\t\t\t\t\tindices[0] = settings.object.geometry.indices[i].indices[0];\r\n\t\t\t\t\t\t\t\tindices[1] = settings.object.geometry.indices[i].indices[1];\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tedges[index] = value;\r\n\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t}\r\n\t\tvar edges;\r\n\t\tfunction setEdges() {\r\n\t\t\t\r\n\t\t\tedges = settings.object.geometry.indices[0];\r\n\t\t\tvar boArray = edges instanceof Array;\r\n\t\t\tif ( !settings.object.geometry.indices[0] || boArray ) {\r\n\t\r\n\t\t\t\tconst indices = settings.object.geometry.indices;\r\n\t\t\t\tif ( boArray ) { if ( !indices[0].isProxy ) indices[0] = proxyEdges(); }\r\n\t\t\t\telse indices.push( proxyEdges() );\r\n\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tsetEdges();\r\n\t\t\r\n\t\t//Сгруппировать индексы ребер объета из settings.object.geometry.edges по сегментам обекта\r\n\t\t//Например если объект это линия:\r\n\t\t//n = 1\r\n\t\t//settings.object.geometry.indices = [0, 1]//одно ребро\r\n\t\t//settings.object.geometry.edges = [0, 1]\r\n\t\t//settings.object.geometry.iEdges = [0]\r\n\t\t//где\r\n\t\t// 0, //индекс ребра [0, 1] из settings.object.geometry.edges \r\n\t\t//\r\n\t\t//Объект это треугольник:\r\n\t\t//n = 2\r\n\t\t//settings.object.geometry.indices = [[0, 1], [1, 2], [0, 2]]//3 ребра\r\n\t\t//settings.object.geometry.edges = [[0, 1], [1, 2], [0, 2]]\r\n\t\t//settings.object.geometry.iEdges = [0, 1, 2]\r\n\t\t//где\r\n\t\t// 0, //индекс первого  ребра [0, 1] из settings.object.geometry.edges \r\n\t\t// 1, //индекс второго  ребра [0, 2] из settings.object.geometry.edges \r\n\t\t// 2, //индекс третьего ребра [1, 2] из settings.object.geometry.edges \r\n\t\t//\r\n\t\t//Объект это пирамида:\r\n\t\t//n = 3\r\n\t\t//settings.object.geometry.indices = [\r\n\t\t//\t[[0, 1], [1, 2], [2, 0]],\r\n\t\t//\t[[0, 1], [1, 3], [3, 0]],\r\n\t\t//\t[[0, 2], [2, 3], [3, 0]],\r\n\t\t//\t[[1, 2], [2, 3], [3, 1]]\r\n\t\t//]\r\n\t\t//4 грани 6 ребер. \r\n\t\t//settings.object.geometry.edges = 0: (2) [\r\n\t\t//\t[0, 1],//0\r\n\t\t//\t[1, 2],//1\r\n\t\t//\t[2, 0],//2\r\n\t\t//\t[1, 3],//3\r\n\t\t//\t[3, 0],//4\r\n\t\t//\t[2, 3]//5\r\n\t\t//]\r\n\t\t//ребра [0, 2] и [3, 1] заменяю на [2, 0] и [1, 3]\r\n\t\t//settings.object.geometry.iEdges = [[0, 1, 2], [0, 3, 4], [2, 5, 4], [1, 5, 3]]\r\n\t\t\r\n\t\tfunction addEdge( indices ) {\r\n\r\n\t\t\tif ( settings.object.geometry.position.length < 2 ) return;//одна точка не имеет ребер\r\n\t\t\tswitch ( n ) {\r\n\r\n\t\t\t\tcase 1://Example [[0,1]]\r\n\t\t\t\t\tconst edges = settings.object.geometry.indices[0];\r\n\t\t\t\t\tif ( settings.object.geometry.position ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tindices = [];\r\n\t\t\t\t\t\tpositionWorld.forEach( function ( indice, i ) { indices.push( i ) } );\r\n\t\t\t\t\t\tedges.push( indices );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error( 'ND: default edges failed! n = ' + n );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tfunction proxySegments() {\r\n\r\n\t\t\treturn new Proxy( [], {\r\n\r\n\t\t\t\tget: function ( target, name ) {\r\n\r\n\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\tif ( !isNaN( i ) )\r\n\t\t\t\t\t\treturn target[i];\r\n\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\tcase 'push': return target.push;\r\n\t\t\t\t\t\tcase 'length': return target.length;\r\n\t\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\t\tcase 'forEach': return target.forEach;\r\n\t\t\t\t\t\tcase 'selected': return target.selected;\r\n\t\t\t\t\t\tdefault: console.error( 'ND: settings.object.geometry.indices[' + name + ']. Invalid name: ' + name );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t},\r\n\t\t\t\tset: function ( target, name, value ) {\r\n\r\n\t\t\t\t\tconst index = parseInt( name );\r\n\t\t\t\t\tif ( isNaN( index ) ) {\r\n\r\n\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\tcase 'length': break;\r\n\t\t\t\t\t\t\tcase 'selected': target.selected = value; break;\r\n\t\t\t\t\t\t\tdefault: console.error( 'ND settings.object.geometry.indices[' + name + ']: invalid name: ' + name );\r\n\t\t\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( value instanceof Array === false ) {\r\n\r\n\t\t\t\t\t\tconsole.error( 'ND settings.object.geometry.indices[' + l + ']: invalid name: ' + name );\r\n\t\t\t\t\t\treturn false;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//remove duplicate indices from value\r\n\t\t\t\t\tfor ( var i = value.length - 1; i >= 0; i--  ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor ( var j = i - 1; j >= 0; j--  ) {\r\n\r\n\t\t\t\t\t\t\tif ( value[i] === value[j] ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( 'nD proxySegments() set: duplicate index = ' + value[i] );\r\n\t\t\t\t\t\t\t\tvalue.splice( i, 1 );\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Do not add a duplicate segment\r\n\t\t\t\t\tfor ( var i = 0; i < target.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst segment = target[i],\r\n\t\t\t\t\t\t\taDetected = [];//список индексов, которые уже встечались в текущем сегменте\r\n\t\t\t\t\t\tif ( segment.length !== value.length )\r\n\t\t\t\t\t\t\tcontinue;//segment не может быть дупликатным если его длинна не равно длинне value\r\n\t\t\t\t\t\tfor ( var j = 0; j < segment.length; j++ ) {\r\n\r\n\t\t\t\t\t\t\taDetected[j] = false;\r\n\t\t\t\t\t\t\tfor ( var k = 0; k < value.length; k++ ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( segment[j] === value[k] ) {\r\n\r\n\t\t\t\t\t\t\t\t\taDetected[j] = true;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar boDetected = true;\r\n\t\t\t\t\t\tfor ( var j = 0; j < aDetected.length; j++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( !aDetected[j] ) {\r\n\r\n\t\t\t\t\t\t\t\tboDetected = false;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( boDetected ) {\r\n\r\n\t\t\t\t\t\t\tvalue.index = i;\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttarget[index] = value;\r\n\t\t\t\t\tvalue.index = index;\r\n\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tfunction addEdges( level, geometry, positionIndices = [], levelIndices ) {\r\n\r\n\t\t\tif ( positionIndices.length === 0 ) positionWorld.forEach( function ( position, i ) { positionIndices.push( i ) } );\r\n\t\t\tgeometry = geometry || settings.object.geometry;\r\n\t\t\tif ( !geometry.indices[0] ) geometry.indices[0] = [];\r\n\t\t\tconst edges = geometry.indices[0];\r\n\t\t\tif ( ( n === 2 ) && ( geometry.position.length === 2 ) ) {\r\n\r\n\t\t\t\tedges.push( [0, 1] );\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\t\t\tif ( level === undefined ) return;\r\n\t\t\tif ( level > 2 ) { \r\n\t\t\t\t\r\n\t\t\t\tfor ( var i = 0; i < positionIndices.length; i++ ) {\r\n\r\n\t\t\t\t\tconst posIndices = [];\r\n\t\t\t\t\tpositionIndices.forEach( function ( indice, j ) { if ( positionIndices[i] !== positionIndices[j] ) posIndices.push( positionIndices[j] ); } );\r\n\t\t\t\t\tconst lIndices = [];//тут перечислены индексы всех индексов, котоые были добавлены в settings.object.geometry.indices\r\n\t\t\t\t\taddEdges( level - 1, undefined, posIndices, lIndices );\r\n\t\t\t\t\tif ( lIndices.length ) {\r\n\r\n\t\t\t\t\t\tconst l = level - 2;\r\n\t\t\t\t\t\tif ( l === 0 ) console.error( 'ND addEdges: invalid l = ' + 1 );\r\n\t\t\t\t\t\tsettings.object.geometry.indices[l] = settings.object.geometry.indices[l] === undefined ? proxySegments() : settings.object.geometry.indices[l];\r\n\t\t\t\t\t\tsettings.object.geometry.indices[l].push( lIndices );\r\n\t\t\t\t\t\tif ( levelIndices ) levelIndices.push( lIndices.index );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tswitch ( level ) {\r\n\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\t\r\n\t\t\t\t\t//перечислены индексы вершин, которые образуют грань и которые составляют замкнутую линию ребер грани.\r\n\t\t\t\t\t//По умолчанию для грани в виде треугольника индексы вершин совпадают с положением вершины в \r\n\t\t\t\t\t//settings.object.geometry.position т.е. positionIndices = [0, 1, 2]\r\n\t\t\t\t\tif ( !positionIndices ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tpositionIndices = [];\r\n\t\t\t\t\t\tsettings.object.geometry.position.forEach( function ( item, i ) { positionIndices.push( i ) } );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst length = positionIndices.length;\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction addItem( start = 0 ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor (var i = start; i < length; i++) {\r\n\r\n\t\t\t\t\t\t\tif (start === 0)\r\n\t\t\t\t\t\t\t\taddItem(i + 1);\r\n\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\tconst edge = [positionIndices[start - 1], positionIndices[i]];\r\n\t\t\t\t\t\t\t\tedges.push(edge);\r\n\t\t\t\t\t\t\t\tif (levelIndices) levelIndices.push(edge.index);\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/*Это было добавлено в commit 'Update ND.js' 'устранил бесконечный цикл добавления ребра'\r\n\t\t\t\t\t\t * Но при этом стало некорректно работать intersection\r\n\t\t\t\t\t\t * Смотри пример в http://localhost/anhr/commonNodeJS/master/nD/Examples/\r\n\t\t\t\t\t\t * Что то не получается воспроизвести бесконечный цикл добавления ребра\r\n\t\t\t\t\t\tfor ( var i = start; i < length; i++ ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( start === 0 ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif (!addItem( i + 1 )) return false;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst edge = [ positionIndices[start - 1], positionIndices[i] ], length = edges.length;\r\n\t\t\t\t\t\t\t\tedges.push( edge );\r\n\t\t\t\t\t\t\t\tif (length === edges.length) return false;//новое ребро не добавилось. Эта проверка появилась во время отладки http://localhost/anhr/egocentricUniverse/master/Examples/2D.html\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//Иначе будет бесконечный цикл\r\n\t\t\t\t\t\t\t\tif ( levelIndices ) levelIndices.push( edge.index );\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t*/\r\n\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\taddItem();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tfunction appendEdges() {\r\n\t\t\t\r\n\t\t\tswitch ( n ) {\r\n\t\r\n\t\t\t\tcase 1://[0, 1]\r\n\t\t\t\t\taddEdge();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: if ( settings.object.geometry.indices[0].length === 0 ) addEdges( n );\r\n\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tappendEdges();\r\n\r\n\t\tif ( settings.object.geometry.indices.boAddIndices ) {\r\n\r\n\t\t\t//В каждом сегменте geometry.indices[i] должно встечаться определенное количество индексов из передыдущего сегмента\r\n\t\t\t//geometry.indices[i - 1]. В противном случае в geometry.indices[i] добавляем новый элемент, в который добавляем\r\n\t\t\t//индексы из передыдущего сегмента geometry.indices[i - 1].\r\n\t\t\t//Это нужно для того, что бы во время пересечения объекта с plane появлялся замкнутый intersection.\r\n\t\t\t//Например после пересечения 3 мерного объекта с plane получалась замкнутая линия, тоесть начало и конец линии соединяем дополнительным ребром.\r\n\t\t\t//Для проверки в примере запускаем _4D и _3D\r\n\t\t\tconst indices = settings.object.geometry.indices;\r\n\t\t\tfor( var i = 1; i < indices.length; i++ ) {\r\n\t\r\n\t\t\t\tconst indice = indices[i];\r\n\t\t\t\tconst arrayIndices = [];//Каждый элемент этого массива показывает сколько раз встречается индекс в сегменте geometry.indices[i].\r\n\t\t\t\tvar max = 0;//максимальное количество сколько раз встречается индекс в сегменте geometry.indices[i].\r\n\t\t\t\tfor ( var j = 0; j < indice.length; j++ ) {\r\n\t\r\n\t\t\t\t\tconst segment = indice[j];\r\n\t\t\t\t\tfor ( var k = 0; k < segment.length; k++ ) {\r\n\t\r\n\t\t\t\t\t\tconst index = segment[k];\r\n\t\t\t\t\t\tif ( arrayIndices[index] === undefined ) arrayIndices[index] = 0;\r\n\t\t\t\t\t\tarrayIndices[index]++;\r\n\t\t\t\t\t\tif ( arrayIndices[index] > max ) max = arrayIndices[index];\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tconst arraySegment = [];//сюда добавляю все индексы, котоые встречаются меньше нужного\r\n\t\t\t\tfor ( var j = 0; j < arrayIndices.length; j++ ) {\r\n\t\r\n\t\t\t\t\tif ( arrayIndices[j] < max ) arraySegment.push( j );\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif ( arraySegment.length > 0 ) indice.push( arraySegment );\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\t\r\n\t\tvar vectorPlane;\r\n\r\n\t\tconst geometry = {\r\n\r\n\t\t\tget position() {\r\n\r\n\t\t\t\t//https://stackoverflow.com/questions/2449182/getter-setter-on-javascript-array\r\n\t\t\t\treturn new Proxy( this, {\r\n\r\n\t\t\t\t\tget: function ( target, name ) {\r\n\r\n\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\tcase 'length':\r\n\t\t\t\t\t\t\t\treturn settings.object.geometry.position.length;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\tif ( isNaN( i ) ) {\r\n\r\n\t\t\t\t\t\t\tconsole.error( 'ND.geometry.position: invalid name: ' + name );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn new Vector( positionWorld[i] );\r\n\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t},\r\n\t\t\tget copy() {\r\n\t\t\t\t\r\n\t\t\t\tconst copySettings = {\r\n\t\t\t\t\t\r\n\t\t\t\t\tgeometry: { position: [], indices: [] },\r\n\t\t\t\t\tposition: [],\r\n\t\t\t\t\trotation: [],\r\n\t\t\t\t\taObjects: settings.object.aObjects,\r\n\t\t\t\t\tname: settings.object.name,\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tsettings.object.geometry.position.forEach( vertice => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst copy = [];\r\n\t\t\t\t\tvertice.forEach( axis => copy.push(axis) );\r\n\t\t\t\t\tcopySettings.geometry.position.push( copy );\r\n\t\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\t\tsettings.object.geometry.indices.forEach( indexes => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst copy = [];\r\n\t\t\t\t\tindexes.forEach( arrayIndex => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst copyArrayIndex = [];\r\n\t\t\t\t\t\tif ( arrayIndex.indices ) arrayIndex = arrayIndex.indices;\r\n\t\t\t\t\t\tarrayIndex.forEach( index => copyArrayIndex.push(index) );\r\n\t\t\t\t\t\tcopy.push(copyArrayIndex);\r\n\t\t\t\t\t\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tcopySettings.geometry.indices.push( copy );\r\n\t\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\t\tfunction copyItem( array ){\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst copy = [];\r\n\t\t\t\t\tarray.forEach( item => { copy.push( item ); } );\r\n\t\t\t\t\treturn copy;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tcopySettings.position = copyItem( settings.object.position );\r\n\t\t\t\tsettings.object.rotation.boUseRotation = true;\r\n\t\t\t\tcopySettings.rotation = copyItem( settings.object.rotation );\r\n\t\t\t\tsettings.object.rotation.boUseRotation = false;\r\n\t\t\t\treturn copySettings;\r\n\t\t\t\r\n\t\t\t},\r\n\t\t\tget geometry() { return settings.object.geometry },\r\n\t\t\tset geometry( geometry ) {\r\n\t\t\t\t\r\n\t\t\t\tsettings.object.geometry.position = geometry.position;\r\n\t\t\t\tif ( geometry.indices ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tsettings.object.geometry.indices.length = 1;\r\n\t\t\t\t\tfor ( var i = 0; i < geometry.indices.length; i++ ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( i === 0 ) {\r\n\r\n\t\t\t\t\t\t\t//убрать edge.intersection, который был создан в ND более высокого уровня, а поэтому в нем указан неверный settings.object.geometry.iAxes, что приводит к перепутыванию осей\r\n\t\t\t\t\t\t\tsettings.object.geometry.indices[0].edges.length = 0;\r\n\t\t\t\t\t\t\tgeometry.indices[0].forEach( edge => settings.object.geometry.indices[0].edges.push( edge.indices === undefined ? edge : edge.indices ) );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else settings.object.geometry.indices[i] = geometry.indices[i];\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else delete settings.object.geometry.indices;\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//Projection of nD object to 3D space for visualization\r\n\t\t\tD3: {\r\n\t\t\t\t\r\n\t\t\t\t//Returns a points of projection\r\n\t\t\t\tget points() { return _ND.bufferGeometry.userData.position; },\r\n\t\t\t\t//returns indices of the faces vertices\r\n\t\t\t\tget faceIndices() {\r\n\r\n\t\t\t\t\tconst aFaceIndices = [];\r\n\t\t\t\t\tconst indices = settings.object.geometry.indices;\r\n\t\t\t\t\tif ( indices.length < 2 ) return aFaceIndices;\r\n\t\t\t\t\tindices[1].forEach( face => {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst faceVertices = [];\r\n\t\t\t\t\t\tface.forEach( ( edge, iEdge ) => {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( iEdge > 2 ) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error( 'ND: geometry.D3.faceIndices get. invalid face edges count.');\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst edgeVertices = indices[0][edge].indices;\r\n\t\t\t\t\t\t\tif ( faceVertices.length === 0 ) {\r\n\r\n\t\t\t\t\t\t\t\tfaceVertices.push( edgeVertices[0] );\r\n\t\t\t\t\t\t\t\tfaceVertices.push( edgeVertices[1] );\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tvar boVertice0 = false, boVertice1 = false;\r\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < faceVertices.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst faceVertice = faceVertices[i];\r\n\t\t\t\t\t\t\t\t\tif ( faceVertice === edgeVertices[0] ) boVertice1 = true;\r\n\t\t\t\t\t\t\t\t\telse if ( faceVertice === edgeVertices[1] ) boVertice0 = true;\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( !boVertice0 && !boVertice1 ) console.error( 'ND: geometry.D3.faceIndices get. Missing push');\r\n\t\t\t\t\t\t\t\telse if ( boVertice0 != boVertice1 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tfaceVertices.push( edgeVertices[boVertice0 ? 0 : 1] );\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}//else вершины третьего ребра совпадают с одной оз вершин первого и второго ребра\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif ( faceVertices.length === 3 ) aFaceIndices.push( faceVertices[0], faceVertices[1], faceVertices[2] );\r\n\t\t\t\t\t\telse console.error( 'ND: PolyhedronGeometry: subdivide. Invalid face vertices count');\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn aFaceIndices;\r\n\r\n\t\t\t\t},\r\n\t\t\t\t//Returns an indices of projection\r\n\t\t\t\tget indices() {\r\n\r\n\t\t\t\t\tconst indices = [], colors = [];\r\n\t\t\t\t\t//если объект не состоит из одной вершины и имеет ребера\r\n\t\t\t\t\tif ( settings.object.geometry.indices[0].length !== 0 ) {\r\n\r\n\t\t\t\t\t\tconst edges = settings.object.geometry.indices[0];\r\n\t\t\t\t\t\tfor ( var i = 0; i < edges.length; i++ ) {\r\n\t\r\n\t\t\t\t\t\t\tlet edge = edges[i];//.indices;\r\n\t\t\t\t\t\t\tif ( edge !== undefined ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif ( edge.length === undefined ) edge = [0, 1];//for compatibility with EgocentricUniverse\r\n\t\t\t\t\t\t\t\tif ( edge.length !== 2 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.error( 'ND.geometry.D3.get indices: invalid edge.length = ' + edge.length );\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( edge[0] === edge[1] ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tconsole.error( 'ND.geometry.D3.get indices: duplicate edge index = ' + edge[0] );\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//indices.push( ...edge );//incompatible with https://raw.githack.com/anhr/egocentricUniverse/dev/1D.html\r\n\t\t\t\t\t\t\t\tedge.forEach( vertice => indices.push( vertice ) );\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tif ( this.color && ( typeof this.color != \"object\") ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//одинаковый цвет для всех ребер\r\n\t\t\t\t\t\t\t\t\tconst color = new THREE.Color(this.color);\r\n\t\t\t\t\t\t\t\t\tfunction hexToRgb(hex) {\r\n\t\t\t\t\t\t\t\t\t  var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\r\n\t\t\t\t\t\t\t\t\t  return result ? {\r\n\t\t\t\t\t\t\t\t\t    r: parseInt(result[1], 16),\r\n\t\t\t\t\t\t\t\t\t    g: parseInt(result[2], 16),\r\n\t\t\t\t\t\t\t\t\t    b: parseInt(result[3], 16)\r\n\t\t\t\t\t\t\t\t\t  } : null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tconst rgb = hexToRgb( color.getHexString() );\r\n\t\t\t\t\t\t\t\t\tfunction push() {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tcolors.push( rgb.r );\r\n\t\t\t\t\t\t\t\t\t\tcolors.push( rgb.g );\r\n\t\t\t\t\t\t\t\t\t\tcolors.push( rgb.b );\r\n\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpush();\r\n\t\t\t\t\t\t\t\t\tif ( edges.length === 1 ) push();//Это линия. Надо установить цвет конца\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t} else console.error( 'ND.geometry.D3.get indices: invalid edge. Возможно вычислены не все точки пересечения' );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this.color && (typeof this.color === \"object\")) {\r\n\r\n\t\t\t\t\t\t\t//цвет вершин\r\n\t\t\t\t\t\t\tif ( colors.length != 0 ) console.error('ND.geometry.D3.get vrtices colors: Invalid colors.length = ' + colors.length);\r\n\t\t\t\t\t\t\tsettings.object.geometry.position.forEach( vertice => {\r\n\r\n\t\t\t\t\t\t\t\tconst rgb = settings.options.palette.toColor(vertice.w, settings.options.scales.w.min, settings.options.scales.w.max );\r\n\t\t\t\t\t\t\t\tcolors.push(rgb.r);\r\n\t\t\t\t\t\t\t\tcolors.push(rgb.g);\r\n\t\t\t\t\t\t\t\tcolors.push(rgb.b);\r\n\r\n\t\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn { indices: indices, colors: colors, };\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t}\r\n\t\tconst points = [];\r\n\t\tfor ( var i = 0; i < geometry.position.length; i++ )\r\n\t\t\tpoints.push( geometry.position[i].point );\r\n\t\tthis.getPoint = (i) => { return points[i]; }\r\n\t\tthis.setPositionAttributeFromPoints( points );\r\n\r\n\t\tvectorPlane = vectorPlane || new Vector( settings.vectorPlane );\r\n\t\tif ( !vectorPlane || !vectorPlane.point ) vectorPlane = new Vector( vectorPlane );\r\n\r\n\t\tvar objectIntersect;//порекция объека пересечения панеди с графическим объектом на 3D пространство.\r\n\r\n\t\tthis.opacity = ( object3D, transparent, opacity ) => { _ND.verticesOpacity( transparent, opacity ); }\r\n\r\n\t\t//The user has selected a segment of nD object\r\n\t\tconst selectSegment = {\r\n\r\n\t\t\tline: undefined,//segment of nD object, selected by user\r\n\t\t\tremoveLine: function (line) {\r\n\r\n\t\t\t\t\t\tif (line) {\r\n\r\n\t\t\t\t\t\t\tline.parent.remove(line);\r\n\t\t\t\t\t\t\tline = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\treturn line;\r\n\r\n\t\t\t},\r\n\t\t\topacityDefault: 0.3,\r\n\t\t\topacityItem: function (item, parentObject, transparent, opacity = selectSegment.opacityDefault) {\r\n\r\n\t\t\t\tif (!item.material) return;\r\n\t\t\t\tif (transparent && (opacity === 0) && (Object.is(item.parent, parentObject))) parentObject.remove(item);\r\n\t\t\t\telse {\r\n\r\n\t\t\t\t\tif (!item.parent) parentObject.add(item);\r\n\t\t\t\t\t_ND.opacity( item, transparent, opacity );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction create3DObject( geometry, settings3D = {} ) {\r\n\r\n\t\t\tlet nD;\r\n\t\t\tif ( !geometry.D3 ) {\r\n\r\n\t\t\t\tnD = new ND( n, {\r\n\t\t\t\t\t\r\n\t\t\t\t\tplane: true,\r\n\t\t\t\t\tobject: { geometry: geometry, color: settings3D.color, },\r\n\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\t\tgeometry = nD.geometry;\r\n\t\t\t\t\r\n\t\t\t} else nD = _ND;\r\n\t\t\tif (geometry.position.length === 0) return;\r\n\t\t\tconst color = settings3D.color || 'white';//0xffffff\r\n\t\t\tgeometry.D3.color = color;\r\n\t\t\tconst indices3D = geometry.D3.indices, indices = indices3D.indices;\r\n\r\n\t\t\tconst buffer = nD.bufferGeometry;\r\n\t\t\t\r\n\t\t\tif ( settings3D.faces ) {\r\n\r\n\t\t\t\tif ( settings3D.faces === true ) settings3D.faces = {};\r\n\t\t\t\tif ( settings3D.faces.color === undefined ) settings3D.faces.color = color;\r\n\t\t\t\tif ( settings3D.faces.opacity === undefined ) settings3D.faces.opacity = 0.5;\r\n\t\t\t\tif ( settings3D.faces.transparent === undefined ) settings3D.faces.transparent = true;\r\n\t\t\t\tbuffer.setIndex( geometry.D3.faceIndices );\r\n\t\t\t\tbuffer.computeVertexNormals ();\r\n\r\n\t\t\t} else buffer.setIndex( indices )\r\n\t\t\tlet lineBasicMaterialParameters;\r\n\t\t\t\r\n\t\t\tlineBasicMaterialParameters = {\r\n\t\t\t\t\r\n\t\t\t\tvertexColors: true,\r\n\t\t\t\ttoneMapped: false,\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( settings.object.geometry.opacity ) lineBasicMaterialParameters.transparent = true;//установлена прозрачность вершин\r\n\t\t\t\r\n\t\t\tconst object = indices.length > 1 ?\r\n\t\t\t\tsettings3D.faces ?\r\n\t\t\t\t\tnew THREE.Mesh(buffer, new THREE.MeshLambertMaterial({\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcolor: color,\r\n\t\t\t\t\t\topacity: settings3D.faces.opacity,\r\n\t\t\t\t\t\ttransparent: settings3D.faces.transparent,\r\n\t\t\t\t\t\tside: THREE.DoubleSide\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} ) ) :\r\n\t\t\t\t\tnew THREE.LineSegments( buffer, new THREE.LineBasicMaterial( lineBasicMaterialParameters ) ) :\r\n\t\t\t\tnew THREE.Points( buffer, new THREE.PointsMaterial( {\r\n\t\t\t\t\t\r\n\t\t\t\t\tcolor: color,\r\n\t\t\t\t\tsizeAttenuation: false,\r\n\t\t\t\t\tsize: options.point.size / ( options.point.sizePointsMaterial * 2 ),\r\n\t\t\t\t\t\r\n\t\t\t\t} ) );\r\n\t\t\tif ( settings3D.name )\r\n\t\t\t\tobject.name = settings3D.name;\r\n\t\t\t\r\n\t\t\tscene.add( object );\r\n\r\n\t\t\tobject.userData.myObject = nD;\r\n\t\t\tobject.userData.geometry = geometry.geometry;\r\n\t\t\tobject.userData.onMouseDown = function ( intersection ) {\r\n\r\n\t\t\t\tconst indices = geometry.geometry.indices, segmentIndex = 0,//edges\r\n\t\t\t\t\tsegment = indices[segmentIndex], selectedIndex = segment.selected;\r\n\r\n\t\t\t\tselectSegment.line = selectSegment.removeLine(selectSegment.line );\r\n\t\t\t\tconst opacityDefault = intersection.event && intersection.event.button === 0 ? selectSegment.opacityDefault : 1, parentObject = object;\r\n\t\t\t\tfunction opacity( transparent = true, opacity = opacityDefault ) {\r\n\r\n\t\t\t\t\tscene.children.forEach(item => selectSegment.opacityItem(item, parentObject, transparent, opacity));\r\n\r\n\t\t\t\t}\r\n\t\t\t\topacity();\r\n\t\t\t\t\r\n\t\t\t\tconst buffer = new THREE.BufferGeometry().setFromPoints( geometry.D3.points );\r\n\t\t\t\tconst lineIndices = [];\r\n\t\t\t\tfunction createIndices( item, level ) {\r\n\r\n\t\t\t\t\tif ( level > 0 ) {\r\n\r\n\t\t\t\t\t\tlevel--;\r\n\t\t\t\t\t\tfor ( var i = 0; i < item.length; i++ ) createIndices( indices[level][item[i]], level );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst itemIndices = item.indices || item;\r\n\t\t\t\t\tif ( itemIndices.length !== 2 ) console.error( 'ND: createIndices. Invalid itemIndices.length = ' + itemIndices.length );\r\n\t\t\t\t\tvar boDetected = false;\r\n\t\t\t\t\tfor ( var lineIndicesIndex = 0; lineIndicesIndex < lineIndices.length; lineIndicesIndex += 2 ) {\r\n\r\n\t\t\t\t\t\tif ( ( lineIndices[lineIndicesIndex] === itemIndices[0] ) && ( lineIndices[lineIndicesIndex + 1] === itemIndices[1] ) ) {\r\n\r\n\t\t\t\t\t\t\tboDetected = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( !boDetected ) itemIndices.forEach( i => { lineIndices.push( i ); } );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tcreateIndices( segment[selectedIndex], segmentIndex );\r\n\t\t\t\t\r\n\t\t\t\tselectSegment.line = new THREE.LineSegments( buffer.setIndex( lineIndices ), new THREE.LineBasicMaterial( { color: object.material.color, } ) );\r\n\r\n\t\t\t\tparentObject.add( selectSegment.line );\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tobject.userData.nd = function ( fParent, dat, gui = false, boUpdate = false ) {\r\n\r\n\t\t\t\tif ( !object.userData.nd.update )object.userData.nd.update = function(){ object.userData.nd( fParent, dat, gui, true ) }\r\n\r\n\t\t\t\tif ( !boUpdate ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( fParent.parent.fCustom ) {\r\n\t\r\n\t\t\t\t\t\tfParent.parent.fCustom.parent.removeFolder( fParent.parent.fCustom );\r\n\t\t\t\t\t\tfParent.parent.fCustom = undefined;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t\tif ( !gui && geometry.geometry.gui )\r\n\t\t\t\t\t\tfParent.parent.fCustom = geometry.geometry.gui( fParent, dat, settings.options, _ND );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//Localization\r\n\r\n\t\t\t\tconst getLanguageCode = options.getLanguageCode;\r\n\r\n\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\tvertices: 'Vertices',\r\n\t\t\t\t\tverticesTitle: 'Vertices.',\r\n\r\n\t\t\t\t\tedges: 'Edges',\r\n\t\t\t\t\tedgesTitle: 'The selected edge lists the vertex indices of the edge.',\r\n\t\t\t\t\tdistance: 'Distance',\r\n\t\t\t\t\tdistanceTitle: 'Distance between edge vertices.',\r\n\r\n\t\t\t\t\tfaces: 'Faces',\r\n\t\t\t\t\tfacesTitle: 'The selected face lists the indexes of the edges of that face.',\r\n\t\t\t\t\tbodies: 'Bodies',\r\n\t\t\t\t\tbodiesTitle: 'The selected body lists the indexes of the faces of this body.',\r\n\t\t\t\t\tobjects: 'Objects',\r\n\t\t\t\t\tobjectsTitle: 'The selected object lists the indexes of the objects that this object consists of. It can be indexes of bodies.',\r\n\r\n\t\t\t\t\tposition: 'Position',\r\n\r\n\t\t\t\t\trotation: 'Rotation',\r\n\t\t\t\t\trotationPointTitle: 'Rotation point',\r\n\t\t\t\t\trotationAxisTitle: 'Rotation axis',\r\n\t\t\t\t\trotationPlaneTitle: 'Axes of plane of rotation.',\r\n\t\t\t\t\trotationSpaceTitle: 'Axes of space of rotation.',\r\n\t\t\t\t\trotationnDSpaceTitle: 'Axes of multi dimensional space of rotation.',\r\n\r\n\t\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\t\tdefaultPositionTitle: 'Restore default position',\r\n\t\t\t\t\tdefaultRotationTitle: 'Restore default rotation',\r\n\r\n\t\t\t\t\tnotSelected: 'Not selected',\r\n\r\n\t\t\t\t};\r\n\r\n\t\t\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\t\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\tlang.vertices = 'Вершины';\r\n\t\t\t\t\t\tlang.verticesTitle = 'Вершины.';\r\n\r\n\t\t\t\t\t\tlang.edges = 'Ребра';\r\n\t\t\t\t\t\tlang.edgesTitle = 'В выбранном ребре перечислены индексы вершин ребра.';\r\n\t\t\t\t\t\tlang.distance = 'Расстояние';\r\n\t\t\t\t\t\tlang.distanceTitle = 'Расстояние между вершинами ребра.';\r\n\r\n\t\t\t\t\t\tlang.faces = 'Грани';\r\n\t\t\t\t\t\tlang.facesTitle = 'В выбранной грани перечислены индексы ребер этой грани.';\r\n\t\t\t\t\t\tlang.bodies = 'Тела';\r\n\t\t\t\t\t\tlang.bodiesTitle = 'В выбранном теле перечислены индексы граней этого тела.';\r\n\t\t\t\t\t\tlang.objects = 'Объекты';\r\n\t\t\t\t\t\tlang.objectsTitle = 'В выбранном объекте перечислены индексы объектов, из которого состоит этот объект. Это могут быть индексы тел.';\r\n\r\n\t\t\t\t\t\tlang.position = 'Позиция';\r\n\r\n\t\t\t\t\t\tlang.rotation = 'Вращение';\r\n\t\t\t\t\t\tlang.rotationPointTitle = 'Точка вращения.';\r\n\t\t\t\t\t\tlang.rotationAxisTitle = 'Ось вращения.';\r\n\t\t\t\t\t\tlang.rotationPlaneTitle = 'Оси плоскости вращения.';\r\n\t\t\t\t\t\tlang.rotationSpaceTitle = 'Оси пространства вращения.';\r\n\t\t\t\t\t\tlang.rotationnDSpaceTitle = 'Оси многомерного пространства вращения..';\r\n\r\n\t\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\t\tlang.defaultPositionTitle = 'Восстановить позицию объекта по умолчанию';\r\n\t\t\t\t\t\tlang.defaultRotationTitle = 'Восстановить вращение объекта по умолчанию';\r\n\r\n\t\t\t\t\t\tlang.notSelected = 'Не выбран';\r\n\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tfor ( var i = fParent.__controllers.length - 1; i >= 0; i-- ) { fParent.remove( fParent.__controllers[i] ); }\r\n\t\t\t\t\r\n\t\t\t\tconst indices = geometry.geometry.indices, segmentIndex = indices.length - 1;\r\n\t\t\t\tfunction addController(\r\n\t\t\t\t\tsegmentIndex,//settings.object.geometry.indices index\r\n\t\t\t\t\tfParent,\r\n\t\t\t\t\tsegmentItems,//массив индексов элементов текущего segment, которые выбрал пользователь\r\n\t\t\t\t\tprevLine//выбранный пользователем сегмент объекта на более высоком уровне. Например если пользователь выбрал ребро то prevLine указывает на выбранную пользователем грань\r\n\t\t\t\t) {\r\n\r\n\t\t\t\t\t_prevLine.prevLine = prevLine;\r\n\t\t\t\t\tvar segment;\r\n\t\t\t\t\tif ( segmentItems ) {\r\n\r\n\t\t\t\t\t\tfunction addItem( item, i ) {\r\n\r\n\t\t\t\t\t\t\titem.i = i;\r\n\t\t\t\t\t\t\tsegment.push( item );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsegment = [];\r\n\t\t\t\t\t\tif ( segmentIndex === -1 ) {\r\n\r\n\t\t\t\t\t\t\t//vertices\r\n\t\t\t\t\t\t\t//непонятно почему, но для 2D вершины перечислены в segmentItems.indices\r\n\t\t\t\t\t\t\tif ( segmentItems.forEach )\r\n\t\t\t\t\t\t\t\tsegmentItems.forEach( i => addItem( geometry.geometry.position[i], i ) );\r\n\t\t\t\t\t\t\telse segmentItems.indices.forEach( i => addItem( geometry.geometry.position[i], i ) );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//indices\r\n\t\t\t\t\t\t\tconst index = indices[segmentIndex];\r\n\t\t\t\t\t\t\tsegmentItems.forEach( i => addItem( index[i].indices ? index[i].indices : index[i], i ) );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}else segment = indices[segmentIndex];\r\n\t\t\t\t\tconst items = { Items: [lang.notSelected] };\r\n\t\t\t\t\tvar fChildSegment, line;\r\n\t\t\t\t\tvar name, title;\r\n\t\t\t\t\tswitch ( segmentIndex ) {\r\n\r\n\t\t\t\t\t\tcase -1: name = lang.vertices; title = lang.verticesTitle; break;\r\n\t\t\t\t\t\tcase 0: name = lang.edges; title = lang.edgesTitle; break;\r\n\t\t\t\t\t\tcase 1: name = lang.faces; title = lang.facesTitle; break;\r\n\t\t\t\t\t\tcase 2: name = lang.bodies; title = lang.bodiesTitle; break;\r\n\t\t\t\t\t\tdefault: name = lang.objects; title = lang.objectsTitle;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst fSegment = fParent.addFolder( name );\r\n\t\t\t\t\tlet cDistance;\r\n\t\t\t\t\tfSegment.userData = { objectItems: true, }\r\n\t\t\t\t\tdat.folderNameAndTitle( fSegment, name, title );\r\n\t\t\t\t\tswitch ( segmentIndex ) {\r\n\r\n\t\t\t\t\t\tcase 0://edges\r\n\t\t\t\t\t\t\tcDistance = dat.controllerZeroStep( fSegment, { value: 0, }, 'value' );\r\n\t\t\t\t\t\t\tcDistance.domElement.querySelector( 'input' ).readOnly = true;\r\n\t\t\t\t\t\t\tdat.controllerNameAndTitle( cDistance, lang.distance, lang.distanceTitle );\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst cSegment = fSegment.add( items, 'Items', { [lang.notSelected]: -1 } ).onChange( function ( value ) {\r\n\r\n\t\t\t\t\t\tif ( fChildSegment ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfChildSegment.__controllers.forEach( ( item, i ) => {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tconst controller = fChildSegment.__controllers[i];\r\n\t\t\t\t\t\t\t\tif ( controller.__select && ( controller.__select.selectedIndex != 0 ) ) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tcontroller.__select.selectedIndex = 0;\r\n\t\t\t\t\t\t\t\t\tcontroller.__onChange();\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\tfSegment.removeFolder( fChildSegment );\r\n\t\t\t\t\t\t\tfChildSegment = undefined;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst selectedIndex = cSegment.__select.selectedIndex - 1;\r\n\t\t\t\t\t\tline = selectSegment.removeLine(line);\r\n\t\t\t\t\t\tconst parentObject = object;\r\n\t\t\t\t\t\tfunction opacity(transparent = true, opacity = selectSegment.opacityDefault ) {\r\n\r\n\t\t\t\t\t\t\tscene.children.forEach(item => selectSegment.opacityItem(item, parentObject, transparent, opacity));\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//Непонятно почему, но прозрачность линии зависит от индекса текущего сегмента segmentIndex.\r\n\t\t\t\t\t\t//Для проверки открыть холст 5D.\r\n\t\t\t\t\t\t//Если в 5D прозрачность делать постоянной 0.3, то при выборе тела (body) из объета, объект буден практически непрозрачным\r\n\t\t\t\t\t\tfunction getOpacity() {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\treturn -0.1 * segmentIndex + selectSegment.opacityDefault;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfunction removeVerticeControls(){\r\n\r\n\t\t\t\t\t\t\tif ( segmentIndex !== -1 ) return;\r\n\t\t\t\t\t\t\tfor ( var i = fSegment.__controllers.length - 1; i >=0 ; i-- ) {\r\n\r\n\t\t\t\t\t\t\t\tconst controller = fSegment.__controllers[i];\r\n\t\t\t\t\t\t\t\tif ( Object.is(cSegment, controller) ) continue;\r\n\t\t\t\t\t\t\t\tfSegment.remove(controller);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( selectedIndex === -1 ) {\r\n\r\n\t\t\t\t\t\t\tswitch ( segmentIndex ) {\r\n\t\t\t\r\n\t\t\t\t\t\t\t\tcase 0://edges\r\n\t\t\t\t\t\t\t\t\tcDistance.setValue( '' );\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tremoveVerticeControls();\r\n\t\t\t\t\t\t\tif ( prevLine ) {\r\n\r\n\t\t\t\t\t\t\t\tselectSegment.opacityItem(prevLine, parentObject, false);\r\n\t\t\t\t\t\t\t\tif (prevLine.userData.prevLine) selectSegment.opacityItem(prevLine.userData.prevLine, parentObject, true, getOpacity() );\r\n\t\t\t\t\t\t\t\telse opacity( true );\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\topacity( false );\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( prevLine ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\topacity(true, 0);\r\n\t\t\t\t\t\t\tselectSegment.opacityItem(prevLine, parentObject, true, getOpacity() );\r\n\t\t\t\t\t\t\tif (prevLine.userData.prevLine) selectSegment.opacityItem(prevLine.userData.prevLine, parentObject, true, 0 );\r\n\r\n\t\t\t\t\t\t} else opacity();\r\n\t\t\t\t\t\tif ( segmentIndex === -1 ) {\r\n\r\n\t\t\t\t\t\t\t//Vertices\r\n\t\t\t\t\t\t\tremoveVerticeControls();\r\n\r\n\t\t\t\t\t\t\t//если так сделать, то при выборе объекта пересечения почемуто исчезают _prevLine.prevLine и object3D\r\n\t\t\t\t\t\t\t//и как результат появляется ошибка когда пользователь изменяет положение вершины\r\n//\t\t\t\t\t\t\tconst vertice = geometry.geometry.position[segment[selectedIndex].i];\r\n\r\n\t\t\t\t\t\t\tconst vertice = settings.object.geometry.position[segment[selectedIndex].i];\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < vertice.length; i++ ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tswitch(i){\r\n\r\n\t\t\t\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\t\t\tvar axis;\r\n\t\t\t\t\t\t\t\t\t\tswitch(i){\r\n\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tcase 0: axis = options.scales.x; break;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 1: axis = options.scales.y; break;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 2: axis = options.scales.z; break;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfSegment.add( vertice, i, axis.min, axis.max, ( axis.max - axis.min ) / 100 );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault: dat.controllerZeroStep( fSegment, vertice, i );\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst buffer = new THREE.BufferGeometry().setFromPoints( geometry.D3.points );\r\n\t\t\t\t\t\t\tconst lineIndices = [];\r\n\t\t\t\t\t\t\tfunction createIndices( item, level ) {\r\n\t\r\n\t\t\t\t\t\t\t\tif ( level > 0 ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tlevel--;\r\n\t\t\t\t\t\t\t\t\tfor ( var i = 0; i < item.length; i++ ) createIndices( indices[level][item[i]], level );\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tconst itemIndices = item.indices || item;\r\n\t\t\t\t\t\t\t\tif ( itemIndices.length !== 2 ) console.error( 'ND: createIndices. Invalid itemIndices.length = ' + itemIndices.length );\r\n\t\t\t\t\t\t\t\tvar boDetected = false;\r\n\t\t\t\t\t\t\t\tfor ( var lineIndicesIndex = 0; lineIndicesIndex < lineIndices.length; lineIndicesIndex += 2 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( ( lineIndices[lineIndicesIndex] === itemIndices[0] ) && ( lineIndices[lineIndicesIndex + 1] === itemIndices[1] ) ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tboDetected = true;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( !boDetected ) itemIndices.forEach( i => { lineIndices.push( i ); } );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcreateIndices(segment[selectedIndex], segmentIndex);\r\n\t\t\t\t\t\t\tline = new THREE.LineSegments(buffer.setIndex(lineIndices), new THREE.LineBasicMaterial({ color: object.material.color }));\r\n\r\n\t\t\t\t\t\t\tswitch ( segmentIndex ) {\r\n\t\t\t\r\n\t\t\t\t\t\t\t\tcase 0://edges\r\n\r\n\t\t\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\t\t\tif ( lineIndices.length != 2 ) {\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tconsole.error( 'ND: Select edge. Invalid lineIndices.length = ' + lineIndices.length );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tconst position0 = geometry.geometry.position[lineIndices[0]],\r\n\t\t\t\t\t\t\t\t\t\tposition1 = settings.object.geometry.position[lineIndices[1]];\r\n\t\t\t\t\t\t\t\t\tif (position0.length && position1.length) cDistance.setValue( position0.distanceTo(position1) );\r\n\t\t\t\t\t\t\t\t\telse console.error(\"ND: Select edge. Invalid edge's vertices distance\");\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t//debug\r\n\t\t\t\t\t\t\tline.userData.name = fSegment.name + ' ' + value;\r\n\r\n\t\t\t\t\t\t\tparentObject.add( line );\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (prevLine && line) line.userData.prevLine = prevLine;\r\n\t\t\t\t\t\tif (segmentIndex >= 0) fChildSegment = addController(segmentIndex - 1, fSegment, segment[selectedIndex], line);\r\n\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tdat.controllerNameAndTitle(cSegment, '');\r\n\t\t\t\t\tvar selectedItem = 0;\r\n\r\n\t\t\t\t\tconst selected = segmentIndex >= 0 ? indices[segmentIndex].selected : undefined;\r\n\t\t\t\t\tvar selectedOpt;//debug\r\n\t\t\t\t\tfor ( var i = 0; i < segment.length; i++ ) {\r\n\r\n\t\t\t\t\t\tconst item = segment[i], opt = document.createElement( 'option' ),\r\n\t\t\t\t\t\t\titemIndex = item.index != undefined ? item.index : item.i != undefined ? item.i : i;\r\n\t\t\t\t\t\topt.innerHTML = '(' + (item.i === undefined ? i : item.i) + ') ' + (segmentIndex === -1 ? '' : ( item.indices ? item.indices : item ).toString() );\r\n\t\t\t\t\t\topt.item = item;\r\n\t\t\t\t\t\tif ( ( selected != undefined) && ( selected === itemIndex ) ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tselectedOpt = opt;//debug\r\n\t\t\t\t\t\t\tselectedItem = i + 1;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcSegment.__select.appendChild( opt );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( selected && !selectedOpt ) console.error( 'ND: addController. Selected item was not detected' );\r\n\t\t\t\t\tcSegment.__select[selectedItem].selected = true;\r\n\t\t\t\t\tif ( selectedItem != 0 ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcSegment.__select.selectedIndex = selectedItem;\r\n\t\t\t\t\t\tcSegment.setValue( cSegment.__select[selectedItem].innerHTML );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fSegment;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst childFolders = Object.keys(fParent.__folders);\r\n\t\t\t\tchildFolders.forEach( folderName => {\r\n\r\n\t\t\t\t\tconst childFolder = fParent.__folders[folderName];\r\n\t\t\t\t\tchildFolder.__controllers.forEach( ( item, i ) => {\r\n\r\n\t\t\t\t\t\tvar controller;\r\n\t\t\t\t\t\tif ( childFolder.userData && childFolder.userData.objectItems ) controller = childFolder.__controllers[i];\r\n\t\t\t\t\t\telse if ( folderName === 'indices' ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//ищем controller в GuiIndices\r\n\t\t\t\t\t\t\tObject.keys( childFolder.__folders ).forEach( folderName => {\r\n\t\r\n\t\t\t\t\t\t\t\tif ( !controller ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tconst folder = childFolder.__folders[folderName];\r\n\t\t\t\t\t\t\t\t\tif ( folder.userData && folder.userData.objectItems ) controller = folder.__controllers[i];\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( controller && controller.__select && controller.__select.selectedIndex != 0 ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tcontroller.__select.selectedIndex = 0;\r\n\t\t\t\t\t\t\tcontroller.__onChange();\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tif ( !childFolder.customFolder )  fParent.removeFolder( childFolder );\r\n\t\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\t\tconst fPosition = fParent.addFolder( lang.position ),\r\n\t\t\t\t\tfRotation = n < 2 ? undefined : fParent.addFolder( lang.rotation );\r\n\t\t\t\tfunction rotation( i ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( rotationAxes[i].length === 0 ) return;\r\n\t\t\t\t\tsettings.object.rotation.boUseRotation = true;\r\n\t\t\t\t\tsettings.object.rotation.folders[i] = {\r\n\r\n\t\t\t\t\t\tcRotation: fRotation.add( settings.object.rotation, i, 0, Math.PI * 2, 0.01 ).onChange( function ( value ) { update(); } ),\r\n\t\t\t\t\t\tdefault: settings.object.rotation[i],\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar name = '', title = '';\r\n\t\t\t\t\trotationAxes[i].forEach( axis => name = name + ( name.length === 0 ? '' : ',' ) + axis );\r\n\t\t\t\t\tswitch( n ){\r\n\r\n\t\t\t\t\t\tcase 2: title = lang.rotationPointTitle; break;\r\n\t\t\t\t\t\tcase 3: title = lang.rotationAxisTitle; break;\r\n\t\t\t\t\t\tcase 4: title = lang.rotationPlaneTitle; break;\r\n\t\t\t\t\t\tcase 5: title = lang.rotationSpaceTitle; break;\r\n\t\t\t\t\t\tdefault: title = lang.rotationnDSpaceTitle; break;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdat.controllerNameAndTitle( settings.object.rotation.folders[i].cRotation, n === 2 ? '2' : name, title );\r\n\t\t\t\t\tsettings.object.rotation.boUseRotation = false;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tfor ( var i = 0; i < n; i++ ) {\r\n\r\n\t\t\t\t\tconst axisName = i;\r\n\r\n\t\t\t\t\t//position\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst f = fPosition.addFolder( axisName );\r\n\t\t\t\t\t\tsettings.object.position.folders[i] = {\r\n\t\r\n\t\t\t\t\t\t\tpositionController: new PositionController( function ( shift ) { settings.object.position[axisName] += shift; },\r\n\t\t\t\t\t\t\t\t{ getLanguageCode: options.getLanguageCode, } ),\r\n\t\t\t\t\t\t\tdefault: settings.object.position[i],\r\n\t\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tf.add( settings.object.position.folders[i].positionController );\r\n\t\r\n\t\t\t\t\t\tsettings.object.position.folders[i].cPosition = dat.controllerZeroStep( f, settings.object.position, i, function ( value ) { update(); } );\r\n\t\t\t\t\t\tdat.controllerNameAndTitle( settings.object.position.folders[i].cPosition, axisName );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//rotation\r\n\t\t\t\tif ( n === 2 ) rotation( 0 );//поворот только вокруг оси 2\r\n\t\t\t\telse rotationAxes.forEach( (item, i ) => rotation( i ) );\r\n\r\n\r\n\t\t\t\t//Restore default position.\r\n\t\t\t\tconst buttonPositionDefault = fPosition.add( {\r\n\t\r\n\t\t\t\t\tdefaultF: function ( value ) { settings.object.position.folders.forEach( item => item.cPosition.setValue( item.default ) ); },\r\n\t\r\n\t\t\t\t}, 'defaultF' );\r\n\t\t\t\tdat.controllerNameAndTitle( buttonPositionDefault, lang.defaultButton, lang.defaultPositionTitle );\r\n\r\n\t\t\t\t//Restore default rotation.\r\n\t\t\t\tif ( fRotation ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst buttonRotationDefault = fRotation.add( {\r\n\t\r\n\t\t\t\t\t\tdefaultF: function ( value ) { settings.object.rotation.folders.forEach( item => item.cRotation.setValue( item.default ) ); },\r\n\t\r\n\t\t\t\t\t}, 'defaultF' );\r\n\t\t\t\t\tdat.controllerNameAndTitle( buttonRotationDefault, lang.defaultButton, lang.defaultRotationTitle );\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\taddController( segmentIndex, fParent );\r\n\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.addMesh( object );\r\n\r\n\t\t\t//raycaster\r\n\r\n\t\t\tobject.userData.raycaster = {\r\n\r\n\t\t\t\tonIntersection: function ( intersection, mouse ) {\r\n\r\n\t\t\t\t\tintersection.indexNew = intersection.index;\r\n\t\t\t\t\t//если убрать строку ниже, то будет ошибка\r\n\t\t\t\t\t//Cannot read properties of undefined (reading 'cameraTarget')\r\n\t\t\t\t\t//в строке\r\n\t\t\t\t\t//if (!func.cameraTarget)\r\n\t\t\t\t\t//в функции this.changeTarget класса Player.cameraTarget в файле player.js\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//Но зато будут видны иденксы точек, ребер, граней и т.д. если навести мышку на многомерную фигуру\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//Лень разбираться почему так сделал.\r\n\t\t\t\t\t//Для решения проблемы создаю новую переменную intersection.indexNew. Смотри строку выше.\r\n\t\t\t\t\t//\r\n\t\t\t\t\t//Для тестирования запусить http://localhost/anhr/commonNodeJS/master/nD/Examples/\r\n\t\t\t\t\t//На холсте 5D щелкнуть мышкой на Object или Intersection.\r\n\t\t\t\t\tdelete intersection.index;\r\n\r\n\t\t\t\t\tOptions.raycaster.onIntersection( intersection, options, scene, options.camera, options.renderer );\r\n\r\n\t\t\t\t},\r\n\t\t\t\tonIntersectionOut: function () {\r\n\t\t\t\t\t\r\n\t\t\t\t\t//когда мышка покидает объект, нужно удалить индексы ребер, граней и т.д., над которыми была мышка.\r\n\t\t\t\t\t//В противном случае, когда выбираешь объект в dat.GUI, \r\n\t\t\t\t\t//автоматически веберется ребро, грань и т.д. над которыми последний раз была мышка\r\n\t\t\t\t\t//Визуально это вызывает недоумение у пользователя\r\n\t\t\t\t\tgeometry.geometry.indices.forEach( indice => indice.selected = undefined );\r\n\t\t\t\t\t\r\n\t\t\t\t\tOptions.raycaster.onIntersectionOut( scene, options.renderer );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\tonMouseDown: function ( intersection, event ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tintersection.event = event;//Теперь можно выполнять разные действия в зависимости от нажатой кнопки мыши\r\n\t\t\t\t\tOptions.raycaster.onMouseDown( intersection, options );\r\n\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\ttext: settings.object.raycaster ? settings.object.raycaster.text : undefined,\r\n\r\n\t\t\t}\r\n\t\t\tif ( options.eventListeners ) options.eventListeners.addParticle( object );\r\n\r\n\t\t\treturn object;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * @returns an array of intersection points of <b>vectorPlane</b> and <b>geometry</b>. See constructor for details.\r\n\t\t * @param {geometryIntersection} [geometryIntersection = { position: [], indices: [[]] }] Arrays of vertices and indexes of the result of the intersection of the panel and the nD object. See <b>settings.object.geometry</b> of <b>ND</b> constructor for details.\r\n\t\t * @param {array} [geometryIntersection.position] Array of vertices of the result of the intersection. See <b>settings.object.geometry.position</b> of <b>ND</b> constructor for details.\r\n\t\t * @param {array} [geometryIntersection.indices] Array of <b>indices</b> of vertices of the result of the intersection. See <b>settings.object.geometry.indices</b> of <b>ND</b> constructor for details.\r\n\t\t * @param {array} [iIntersections] Array of indices that have been added to <b>geometryIntersection.indices</b>\r\n\t\t */\r\n\t\tthis.intersection = function ( geometryIntersection = { position: [], indices: [[]] }, iIntersections ) {\r\n\r\n\t\t\tif ( settings.plane === false ) return;\r\n\t\t\t\r\n\t\t\tfunction intersection( iEdge, aEdge ) {\r\n\t\t\t\t\r\n\t\t\t\tfor ( var i = 0; i < geometryIntersection.position.length; i++ ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( geometryIntersection.position[i].iEdge === iEdge ) {\r\n\r\n\t\t\t\t\t\t//duplicate position\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\taEdge &&\r\n\t\t\t\t\t\t\t( aEdge.length < 2 )//Длинна ребра линии пересечения получается больше 2 если ребро объекта лежит на пенели.\r\n\t\t\t\t\t\t\t\t\t\t\t\t//Для проверки на canvas 3D сделать две вершины по оси z равными -0.4\r\n\t\t\t\t\t\t\t\t\t\t\t\t//И проиграть проигрыватель на t = 0.3.\r\n\t\t\t\t\t\t) aEdge.push( i );\r\n\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst edge = settings.object.geometry.indices[0][iEdge];\r\n\t\t\t\tedge.intersection( geometryIntersection );//, settings.object.color );\r\n\t\t\t\tconst position = edge.intersection.position;\r\n\t\t\t\tif ( position ) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar boAdd = true;\r\n\t\t\t\t\tif ( edge.intersection.boVerticeOnPanel ) {\r\n\r\n\t\t\t\t\t\t//Вершина на панели. В этом случае все ребра, сходящиеся к этой вершине буду выдвать одну и ту же точку пересечения\r\n\t\t\t\t\t\t//Не нужно добавлять повторяющиеся точки.\r\n\t\t\t\t\t\tfor ( var i = 0; i < geometryIntersection.position.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tif ( position.equals( geometryIntersection.position[i] ) ) {\r\n\r\n\t\t\t\t\t\t\t\tboAdd = false;\r\n\t\t\t\t\t\t\t\taEdge.boVerticeOnPanel = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( boAdd ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tgeometryIntersection.position.push( position );\r\n\t\t\t\t\t\tif ( aEdge ) aEdge.push( geometryIntersection.position.length - 1 );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\t\tif ( !geometryIntersection.position.isProxy )\r\n\t\t\t\tgeometryIntersection.position = new Proxy( geometryIntersection.position, {\r\n\t\t\r\n\t\t\t\t\tget: function ( target, name, args ) {\r\n\r\n\t\t\t\t\t\tswitch ( name ) {\r\n\r\n\t\t\t\t\t\t\tcase 'isProxy': return true;\r\n\t\t\t\t\t\t\tcase 'target': return target;\r\n\t\t\t\t\t\t\tcase \"reset\":\r\n\t\t\t\t\t\t\t\treturn function () {\r\n\t\r\n\t\t\t\t\t\t\t\t\ttarget.forEach( item => item.positionWorld = undefined );\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn  target[name];\r\n\t\t\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset: function ( target, name, value ) {\r\n\t\r\n\t\t\t\t\t\tconst i = parseInt( name );\r\n\t\t\t\t\t\tif ( isNaN( i ) ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ( name === \"boPositionError\" ) {\r\n\r\n\t\t\t\t\t\t\t\ttarget[name] = value;\r\n\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn target[name];\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ( i >= target.length ) {\r\n\t\r\n\t\t\t\t\t\t\t//find duplicate item\r\n\t\t\t\t\t\t\tvar boDuplicate  = false;\r\n\t\t\t\t\t\t\tfor ( var j = 0; j < i; j++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tboDuplicate = true;\r\n\t\t\t\t\t\t\t\tfor ( var k = 0; k < target[j].length; k++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( target[j][k] !== value[k] ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tboDuplicate = false;\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( boDuplicate ) break;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( !boDuplicate ) target.push( value );\r\n\t\t\t\t\t\t\treturn target.length;\r\n\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttarget[i] = value;\r\n\t\t\t\t\t\treturn true;\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\tswitch ( n ) {\r\n\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tif ( settings.object.geometry.indices.length !== 1 ) console.error( 'ND.intersection: under constraction. Это не линия.' );\r\n\t\t\t\t\tconst edge = settings.object.geometry.indices[0][0];\r\n\t\t\t\t\tedge.intersection( geometryIntersection );\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tconst iFaces = settings.object.geometry.indices[1];\r\n\t\t\t\t\tif ( iFaces ) settings.object.geometry.indices[1].forEach( function ( iFace ) { iFace.forEach( function ( iEdge ) { intersection( iEdge ) } ); } );\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tfor ( var i = 0; i < settings.object.geometry.indices[0].length; i++ ) { intersection( i ); }\r\n\t\t\t\t\t\taddEdges( undefined, geometryIntersection );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: {\r\n\r\n\t\t\t\t\tvar iSegments = settings.iSegments || ( n - 2 ),//Индекс массива индексов сегментов settings.object.geometry.indices[iSegments]\r\n\t\t\t\t\t\t\t\t\t\t\t//для которого получаем вершины и индексы\r\n\t\t\t\t\t\tsegments;//массив индексов сегментов для которого получаем вершины и индексы\r\n\t\t\t\t\twhile( iSegments >= 0 ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tsegments = settings.object.geometry.indices[iSegments];\r\n\t\t\t\t\t\tif ( segments ) break;\r\n\t\t\t\t\t\tiSegments--;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//settings.indice индекс сегмента в текущем массиве индексов сегментов settings.object.geometry.indices[iSegments][settings.indice]\r\n\t\t\t\t\tif ( settings.indice === undefined ) {\r\n\r\n\t\t\t\t\t\tfor ( var i = 0; i < segments.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\tconst nd = new ND( n, {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tplane: true,\r\n\t\t\t\t\t\t\t\tobject: { geometry: {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tindices: settings.object.geometry.indices,\r\n\t\t\t\t\t\t\t\t\t\tposition: positionWorld.copy(),\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t},\r\n//\t\t\t\t\t\t\t\t\tcolor: 'white',\r\n\t\t\t\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t\t}, indice: i, iSegments: iSegments, } ),\r\n\t\t\t\t\t\t\t\ts = iSegments - 1;\r\n\t\t\t\t\t\t\tvar iIntersections;\r\n\t\t\t\t\t\t\tif ( s !== 0 ) {//Не создавать iIntersections для ребер\r\n\r\n\t\t\t\t\t\t\t\tiIntersections = [];\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnd.intersection( geometryIntersection, iIntersections );\r\n\t\t\t\t\t\t\tif ( iIntersections && iIntersections.length ) {\r\n\r\n\t\t\t\t\t\t\t\tgeometryIntersection.indices[s] = geometryIntersection.indices[s] || proxySegments();\r\n\t\t\t\t\t\t\t\tgeometryIntersection.indices[s].push( iIntersections );\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t//Ищем ребра с одной вершиной. Такие ребра появляются если вершина находится на панели\r\n\t\t\t\t\t\t//Это нужно когда объект пересекается панелью и одна из вершин находтся на панели\r\n\t\t\t\t\t\t//Тода появляется два ребра с одной вершиной. Я их удаляю и объединяю в одно ребро.\r\n\t\t\t\t\t\t//Для проверки запустить canvas 3D с geometry Variant 1 и проигрыватель установить на t = 0.6\r\n\t\t\t\t\t\tconst edges = geometryIntersection.indices[0];\r\n\t\t\t\t\t\tvar vertices = [];//список вершин ребер с одной вершиной.\r\n\t\t\t\t\t\tfor ( var i = edges.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\t\t\tconst edge = edges[i];\r\n\t\t\t\t\t\t\tif ( edge.boVerticeOnPanel && ( edge.length === 1 ) ) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvertices.push( edge[0] );\r\n\t\t\t\t\t\t\t\tedges.splice( i, 1 ); \r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tswitch( vertices.length ) {\r\n\r\n\t\t\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\t\tcase 1://одна вершина находится на панели\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\t\t\tedges.push( vertices );\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault: console.error( 'ND.intersection: invalid edge.' );\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ( edges.length > 1 ) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t//ищем вершины с одним ребром и объединяем такие вершины в новое ребро.\r\n\t\t\t\t\t\t\t//Это нужно чтобы линия грани была замкнутая.\r\n\t\t\t\t\t\t\t//Для проверки создаем в примере _4D и _3D\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < geometryIntersection.position.length; i++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tvar verticesCount = 0;\r\n\t\t\t\t\t\t\t\tfor ( var j = 0; j < edges.length; j++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tconst edge = edges[j];\r\n\t\t\t\t\t\t\t\t\tfor ( var k = 0; k < edge.length; k++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\t\tif ( edge[k] === i ) verticesCount++;\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( verticesCount < 2 ) {\r\n\t\r\n\t\t\t\t\t\t\t\t\tif ( verticesCount === 0 ) console.error( 'ND.intersection: Invalid verticesCount = ' + verticesCount );\r\n\t\t\t\t\t\t\t\t\telse vertices.push( i );\r\n\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( vertices.length > 0 ) {\r\n\t\r\n\t\t\t\t\t\t\t\tif ( vertices.length != 2 ) console.error( 'ND.intersection: invalid edge.' );\r\n\t\t\t\t\t\t\t\telse edges.push( vertices );\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tvar segment = segments[settings.indice];\r\n\t\t\t\t\t\tif ( iSegments > 1 ) {\r\n\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < segment.length; i++ ) {\r\n\t\r\n\t\t\t\t\t\t\t\tconst nd = new ND( n, {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tplane: true,\r\n\t\t\t\t\t\t\t\t\tobject: settings.object, indice: segment[i], iSegments: iSegments - 1,\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\tif ( n > 4 ) {\r\n\r\n\t\t\t\t\t\t\t\t\tif ( n === 5 ) {\r\n\t\t\t\t\t\t\t\t\t\tvar iIntersect = [];\r\n\t\t\t\t\t\t\t\t\t\tnd.intersection( geometryIntersection, iIntersect );\r\n\t\t\t\t\t\t\t\t\t\tif ( iIntersect.length ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\tif ( iIntersect.length === 1 ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\tiIntersect = iIntersect[0];\r\n\t\t\t\t\t\t\t\t\t\t\t\tiIntersections.push( iIntersect );\r\n\t\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst ind = n - 4;\r\n\t\t\t\t\t\t\t\t\t\t\t\tgeometryIntersection.indices[ind] = geometryIntersection.indices[ind] || proxySegments();\r\n\t\t\t\t\t\t\t\t\t\t\t\tgeometryIntersection.indices[ind].push( iIntersect );\r\n\t\t\t\t\t\t\t\t\t\t\t\tif ( iIntersections ) iIntersections.push( iIntersect.index );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\r\n\t\t\t\t\t\t\t\t\t} else console.error( 'ND.intersection: n = ' + n + ' under constraction' );\r\n\r\n\t\t\t\t\t\t\t\t} else nd.intersection( geometryIntersection, iIntersections );\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\tconst edge = [];\r\n\t\t\t\t\t\t\tif ( segment.indices ) segment = segment.indices;\r\n\t\t\t\t\t\t\tfor ( var i = 0; i < segment.length; i++ ) { intersection( segment[i], edge ); }\r\n\t\t\t\t\t\t\tif ( edge.length > 0 ) {\r\n\r\n\t\t\t\t\t\t\t\tif ( ( edge.length !== 2 ) || ( edge[0] === edge[1] ) ) {\r\n\r\n\t\t\t\t\t\t\t\t\t//длинна массива edge может быть меньше 2 если всего одна вершина находится на панели\r\n\t\t\t\t\t\t\t\t\t//В этом случае линия пересечения geometryIntersection состоит из одной точки и невозможно создать ребро\r\n\t\t\t\t\t\t\t\t\tif ( !edge.boVerticeOnPanel ) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst error = 'ND.intersection: invalid edge';\r\n\t\t\t\t\t\t\t\t\t\tconsole.error( error );\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tconst intersectionEdges = geometryIntersection.indices[0];\r\n\t\t\t\t\t\t\t\tvar duplicateEdge = false;\r\n\t\t\t\t\t\t\t\tfor ( var i = 0; i < intersectionEdges.length; i++ ) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst intersectionEdge = intersectionEdges[i];\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t( intersectionEdge[0] === edge[0] ) && ( intersectionEdge[1] === edge[1] ) ||\r\n\t\t\t\t\t\t\t\t\t\t( intersectionEdge[0] === edge[1] ) && ( intersectionEdge[1] === edge[0] )\r\n\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tduplicateEdge = true;\r\n\t\t\t\t\t\t\t\t\t\tif ( iIntersections ) iIntersections.push( i );\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif ( !duplicateEdge ) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tif ( iIntersections ) iIntersections.push( intersectionEdges.length );\r\n\t\t\t\t\t\t\t\t\tintersectionEdges.push( edge );\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tif ( settings.onIntersection )\r\n\t\t\t\tsettings.onIntersection( geometryIntersection );\r\n\t\t\tif ( scene ) {\r\n\r\n\t\t\t\tif ( objectIntersect ) {\r\n\r\n\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.removeMesh( objectIntersect );\r\n\t\t\t\t\tscene.remove( objectIntersect );\r\n\t\t\t\t\tif (options.eventListeners) options.eventListeners.removeParticle( objectIntersect );\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif ( geometryIntersection.position.length )\r\n\t\t\t\t\tobjectIntersect = create3DObject( geometryIntersection, { name: 'Intersection', color: 'white' } );\r\n\r\n\t\t\t}\r\n\t\t\treturn geometryIntersection.position;\r\n\r\n\t\t}\r\n\r\n\t\tconst THREE = three.THREE, scene = settings.scene;\r\n\r\n\t\tif ( scene ) {\r\n\r\n\t\t\t//Если есть scene, обязательно должен быть options. Здесь создать options неполучится\r\n\t\t\tif ( n <= 1 ) options.scales.y = undefined;\r\n\t\t\tif ( n <= 2 ) options.scales.z = undefined;\r\n\t\t\toptions.scales.text.rect = options.scales.text.rect || {}\r\n\t\t\toptions.scales.text.rect.displayRect = false;\r\n\t\t\toptions.scales.text.precision = 2;\r\n\r\n\t\t}\r\n\r\n\t\tvar object3D;\r\n\t\tfunction projectTo3D() {\r\n\r\n\t\t\tif ( !scene ) return;\r\n\r\n\t\t\t//Graphic object. Currenyly is line\r\n\t\t\tif ( object3D ) {\r\n\r\n\t\t\t\tfor ( var i = object3D.children.length - 1; i >= 0; i-- ) {\r\n\r\n\t\t\t\t\tconst child = object3D.children[i];\r\n\t\t\t\t\tif ( child instanceof THREE.Sprite ) {\r\n\r\n\t\t\t\t\t\tobject3D.remove( child );\r\n\t\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.removeMesh( child );\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tscene.remove( object3D );\r\n\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.removeMesh( object3D );\r\n\t\t\t\toptions.eventListeners.removeParticle( object3D );\r\n\t\t\t\tobject3D = undefined;\r\n\r\n\t\t\t}\r\n\t\t\tobject3D = create3DObject( geometry, {\r\n\t\t\t\t\r\n\t\t\t\tname: settings.object.name,\r\n\t\t\t\tfaces: settings.object.faces,\r\n\t\t\t\tcolor: settings.object.color || _ND.defaultColor,//'lime',//0x00ff00,//'green'\r\n\t\t\t\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t\tprojectTo3D();\r\n\r\n\t\t//Plane\r\n\r\n\t\t/* * @class\r\n\t\t * @description \r\n\t\t * <pre>\r\n\t\t * N-dimensional intersection plane.\r\n\t\t * Used to create a section with an n-dimensional graphic object.\r\n\t\t * For 1 dimensional space <b>ND.Plane</b> is point.\r\n\t\t * For 2 dimensional space <b>ND.Plane</b> is line.\r\n\t\t * For 3 dimensional space <b>ND.Plane</b> is plane.\r\n\t\t * For n-dimensional space <b>ND.Plane</b> is n-dimensional plane.\r\n\t\t * </pre>\r\n\t\t */\r\n\t\tclass Plane {\r\n\r\n\t\t\tconstructor() {\r\n\r\n\t\t\t\tvar mesh;\r\n\t\t\t\tthis.createMesh = function () {\r\n\r\n\t\t\t\t\tif ( !scene ) return;\r\n\t\t\t\t\tconst color = 0x0000FF;//blue\r\n\t\t\t\t\tswitch ( n ) {\r\n\r\n\t\t\t\t\t\tcase 1://point\r\n\t\t\t\t\t\t\toptions.point.size = ( options.scales.x.max - options.scales.x.min ) * 500;//10\r\n\t\t\t\t\t\t\tmesh = new THREE.Points( new THREE.BufferGeometry().setFromPoints( [\r\n\t\t\t\t\t\t\t\tnew THREE.Vector3( 0, 0, 0 )\r\n\t\t\t\t\t\t\t], 3 ),\r\n\t\t\t\t\t\t\t\tnew THREE.PointsMaterial( {\r\n\r\n\t\t\t\t\t\t\t\t\tcolor: color,\r\n\t\t\t\t\t\t\t\t\tsizeAttenuation: false,\r\n\r\n\t\t\t\t\t\t\t\t} ) );\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 2://line\r\n\t\t\t\t\t\t\tmesh = new THREE.Line( new THREE.BufferGeometry().setFromPoints( [\r\n\t\t\t\t\t\t\t\tnew THREE.Vector3( options.scales.x.min, 0, 0 ), new THREE.Vector3( options.scales.x.max, 0, 0 )\r\n\t\t\t\t\t\t\t] ), new THREE.LineBasicMaterial( { color: color } ) );\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 3://plane\r\n\t\t\t\t\t\t\tmesh = new THREE.GridHelper( 2, 10, color, color );\r\n\t\t\t\t\t\t\tmesh.rotation.x = Math.PI / 2;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: {\r\n\r\n\t\t\t\t\t\t\treturn;//I can not render 4D and higher panel\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmesh.name = 'Plane';\r\n\t\t\t\t\tscene.add( mesh );\r\n\t\t\t\t\tif ( options.guiSelectPoint ) options.guiSelectPoint.addMesh( mesh );\r\n\r\n\t\t\t\t\tmesh.position.copy( vectorPlane.point );\r\n\r\n\t\t\t\t\t//raycaster\r\n\r\n\t\t\t\t\tmesh.userData.raycaster = {\r\n\r\n\t\t\t\t\t\tonIntersection: function ( intersection, mouse ) {\r\n\r\n\t\t\t\t\t\t\tdelete intersection.index;\r\n\t\t\t\t\t\t\tOptions.raycaster.onIntersection( intersection, options, scene, options.camera, options.renderer );\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonIntersectionOut: function () { Options.raycaster.onIntersectionOut( scene, options.renderer ); },\r\n\t\t\t\t\t\tonMouseDown: function ( intersection ) { Options.raycaster.onMouseDown( intersection, options ); },\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptions.eventListeners.addParticle( mesh );\r\n\r\n\t\t\t\t\t//\r\n\r\n\t\t\t\t\tvectorPlane.onChange = function () {\r\n\r\n\t\t\t\t\t\tmesh.position.copy( vectorPlane.point );\r\n\t\t\t\t\t\tmesh.updateMatrix();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tif ( settings.plane === undefined ) settings.plane = false;\r\n\t\tif ( settings.plane ) {\r\n\t\t\t\r\n\t\t\tconst plane = new Plane();\r\n\t\t\tplane.createMesh();\r\n\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t* @description\r\n\t\t* Returns N-dimensional vector of the plane that intersects nD object.\r\n\t\t*/\r\n\t\tthis.vectorPlane;\r\n\t\t/**\r\n\t\t* @description\r\n\t\t* <pre>\r\n\t\t* returns geometry of N-dimensional object. See <b>settings.object.geometry</b> parameter of <a href=\"./module-ND-ND.html\" target=\"_blank\">ND</a>.\r\n\t\t*\tkey <b>geometry</b> - get or set a geometry of nD object. See See <b>settings.object.geometry</b> parameter of <a href=\"./module-ND-ND.html\" target=\"_blank\">ND</a>.\r\n\t\t*\tkey <b>D3</b> - Projection of nD object to 3D space for visualization.\r\n\t\t*\t\t<b>D3.points</b> - Points of projection. See <a href=\"https://threejs.org/docs/index.html?q=BufferGeometry#api/en/core/BufferGeometry.setFromPoints\" target=\"_blank\">.setFromPoints</a> of <a href=\"https://threejs.org/docs/index.html?q=BufferGeometry#api/en/core/BufferGeometry\" target=\"_blank\">THREE.BufferGeometry</a>.\r\n\t\t*\t\t<b>D3.indices</b> - Indices of points of projection. See <a href=\"https://threejs.org/docs/index.html?q=BufferGeometry#api/en/core/BufferGeometry.setIndex\" target=\"_blank\">.setIndex</a> of <a href=\"https://threejs.org/docs/index.html?q=BufferGeometry#api/en/core/BufferGeometry\" target=\"_blank\">THREE.BufferGeometry</a>.\r\n\t\t*\t\t<b>D3.color</b> - color of projection.\r\n\t\t* </pre>\r\n\t\t*/\r\n\t\tthis.geometry;\r\n\r\n\t\tObject.defineProperties( this, {\r\n\r\n\t\t\tvectorPlane: {\r\n\r\n\t\t\t\tget: function () { return vectorPlane; }\r\n\r\n\t\t\t},\r\n\r\n\t\t\tgeometry: {\r\n\r\n\t\t\t\tget: function () { return geometry; },\r\n\t\t\t\tset: function ( geometryNew ) {\r\n\r\n\t\t\t\t\tgeometry.geometry = geometryNew;\r\n\t\t\t\t\tsettings.object.name = 'Object';\r\n\t\t\t\t\tsettings.object.rotation.clear();\r\n\t\t\t\t\tsettings.object.position.clear();\r\n\t\t\t\t\tprojectTo3D();\r\n\t\t\t\t\tthis.intersection()\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t\tobject3D: {\r\n\r\n\t\t\t\tget: () => { return object3D; },\r\n\t\t\t\t\r\n\t\t\t},\r\n\r\n\t\t\tobject: {\r\n\r\n\t\t\t\tget: function () { return settings.object; },\r\n\t\t\t\tset: function ( object ) {\r\n\r\n\t\t\t\t\tif ( !object ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconsole.error( 'ND.object set: invalid object' );\r\n\t\t\t\t\t\treturn;//отсутствует холст с размерностью пространства верхнего уровня\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( !object.update )\r\n\t\t\t\t\t\tsettings.object = object;\r\n\t\t\t\t\tconst p = object.position;\r\n\t\t\t\t\tif ( p ) settings.object.position = [...p];\r\n\t\t\t\t\tconst r = object.rotation;\r\n\t\t\t\t\tif ( r ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tif ( r instanceof Array ) settings.object.rotation = [...r];\r\n\t\t\t\t\t\telse settings.object.rotation = r;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsettings.object.name = settings.object.name || 'Object';\r\n\t\t\t\t\t\r\n\t\t\t\t\t//copy indices\r\n\t\t\t\t\tif ( object.geometry.indices ) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst indices = [];\r\n\t\t\t\t\t\tobject.geometry.indices.forEach( array => {\r\n\r\n\t\t\t\t\t\t\tconst item = [];\r\n\t\t\t\t\t\t\tindices.push( item );\r\n\t\t\t\t\t\t\tarray.forEach( index => {\r\n\r\n\t\t\t\t\t\t\t\tif ( index.indices ) item.push( index.indices );\r\n\t\t\t\t\t\t\t\telse item.push( index );\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t\tsettings.object.geometry.indices = indices;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetIndices();\r\n\t\t\t\t\tsetEdges();\r\n\t\t\t\t\tif ( !settings.object.geometry.indices[0].isProxy ) settings.object.geometry.indices[0] = proxyEdges( object.geometry.indices[0] );\r\n\r\n\t\t\t\t\tsettings.object.position = proxyPosition();\r\n\t\t\t\t\tsettings.object.rotation = proxyRotation();\r\n\t\t\t\t\tsettings.object.geometry.position = proxyGeometryPosition();\r\n\t\t\t\t\tsettings.object.geometry.position.reset();\r\n\t\t\t\t\t\r\n\t\t\t\t\tappendEdges();\r\n\t\t\t\t\t\r\n\t\t\t\t\tif ( object.update ) {\r\n\r\n\t\t\t\t\t\tobject3D.geometry.setFromPoints( geometry.D3.points ).setIndex( geometry.D3.indices.indices );\r\n\t\t\t\t\t\tif ( settings.options && settings.options.guiSelectPoint ) settings.options.guiSelectPoint.updatePoints();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprojectTo3D();\r\n\t\t\t\t\tthis.intersection()\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t},\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\tget defaultColor() { return 'lime'; }\r\n\r\n}\r\n\r\nND.gui = class {\r\n\r\n\t/**\r\n\t * Custom controllers for N-dimensional graphic object\r\n\t * @param {Options} options See <b>options</b> parameter of <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">MyThree</a> class.\r\n\t * @param {GUI} dat [dat.GUI()]{@link https://github.com/dataarts/dat.gui}.\r\n\t * @param {GUI} fParent parent folder.\r\n\t * @example new ND.gui( options, dat, fMesh );\r\n\t */\r\n\tconstructor( options, dat, fParent ) {\r\n\r\n\t\t//Localization\r\n\r\n\t\tconst getLanguageCode = options.getLanguageCode;\r\n\r\n\t\tconst lang = {\r\n\r\n\t\t\tnD: 'nD',\r\n\t\t\tnDTitle: 'n-dimensional object',\r\n\r\n\t\t};\r\n\r\n\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\tswitch ( _languageCode ) {\r\n\r\n\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\tlang.nDTitle = 'n-мерный объект';\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\t\tconst fND = fParent.addFolder( lang.nD );\r\n\t\tdat.folderNameAndTitle( fND, lang.nD, lang.nDTitle );\r\n\r\n\t\tthis.object = function( object, dat ) {\r\n\r\n\t\t\tvar display = 'none';\r\n\t\t\tif ( object && object.userData.nd ) {\r\n\r\n\t\t\t\tdisplay = 'block';\r\n\t\t\t\tobject.userData.nd( fND, dat );\r\n\t\t\t\t\r\n\t\t\t} else Object.keys( fND.__folders ).forEach( key => {\r\n\r\n\t\t\t\tconst folder = fND.__folders[key];\r\n\t\t\t\tif ( !folder.userData || ( folder.userData.objectItems === undefined ) ) return;\r\n\t\t\t\tfolder.__controllers.forEach( cSegment => {\r\n\r\n\t\t\t\t\tif (cSegment.__select) {\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst selectedItem = 0;\r\n\t\t\t\t\t\tcSegment.__select.selectedIndex = selectedItem;\r\n\t\t\t\t\t\tcSegment.setValue( cSegment.__select[selectedItem].innerHTML );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t} );\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t} );\r\n\t\t\tif (object) fND.domElement.style.display =  display;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t}\r\n\r\n}\r\n\r\nND.VectorN = class {\r\n\r\n\t/**\r\n\t * base class for n-dimensional vector.\r\n\t * @param {number} n dimension of the vector.\r\n\t * @param {Array} array array of the values of the vector.\r\n\t */\r\n\tconstructor(n, array) {\r\n\t\t\r\n\t\tif (array.isVector) return array;\r\n\t\tif (array instanceof Array === false) {\r\n\r\n\t\t\tif (typeof array === 'number') array = [array];\r\n\t\t\telse if (array.array) array = array.array;\r\n\t\t\telse console.error('FermatSpiral: Vector: invalid array type');\r\n\r\n\t\t}\r\n\t\tif (n !== undefined) while (array.length < n) array.push(0);\r\n\r\n\t\t//https://stackoverflow.com/questions/2449182/getter-setter-on-javascript-array\r\n\t\treturn new Proxy(array, {\r\n\r\n\t\t\tget: function (target, name) {\r\n\r\n\t\t\t\tvar i = parseInt(name);\r\n\t\t\t\tif (isNaN(i)) {\r\n\r\n\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\tcase \"array\": return array;\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t* Adds v to this vector.\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t\tcase \"add\":\r\n\t\t\t\t\t\t\treturn function (v) {\r\n\r\n\t\t\t\t\t\t\t\ttarget.forEach((value, i) => target[i] += v[i]);\r\n\t\t\t\t\t\t\t\treturn this;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\tcase \"index\": return vectorSettings.index;\r\n\t\t\t\t\t\tcase \"isVector\": return true;\r\n\t\t\t\t\t\tdefault: console.error('ND: Vector get. Invalid name: ' + name);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tif (i >= n)\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\tif ((array.length > n) && settings.object.geometry.iAxes && (i < settings.object.geometry.iAxes.length))\r\n\t\t\t\t\ti = settings.object.geometry.iAxes[i];\r\n\t\t\t\treturn array[i];\r\n\r\n\t\t\t},\r\n\r\n\t\t});\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport default ND;\r\n\r\n//https://stackoverflow.com/a/18881828/5175935\r\nif ( !Number.prototype.between )\r\n\tNumber.prototype.between = function ( a, b, inclusive ) {\r\n\r\n\t\tvar min = Math.min.apply( Math, [a, b] ),\r\n\t\t\tmax = Math.max.apply( Math, [a, b] );\r\n\t\treturn inclusive ? this >= min && this <= max : this > min && this < max;\r\n\r\n\t};\r\n\r\n//Comparing arrays https://stackoverflow.com/a/14853974/5175935\r\n// Warn if overriding existing method\r\nif ( Array.prototype.equals )\r\n\tconsole.warn( \"Overriding existing Array.prototype.equals. Possible causes: New API defines the method, there's a framework conflict or you've got double inclusions in your code.\" );\r\n// attach the .equals method to Array's prototype to call it on any array\r\nArray.prototype.equals = function (array) {\r\n\r\n\t// if the other array is a falsy value, return\r\n\tif ( !array )\r\n\t\treturn false;\r\n\r\n\t// compare lengths - can save a lot of time \r\n\tif ( this.length != array.length )\r\n\t\treturn false;\r\n\r\n\tfor (var i = 0, l = this.length; i < l; i++) {\r\n\r\n\t\t// Check if we have nested arrays\r\n\t\tif (this[i] instanceof Array && array[i] instanceof Array) {\r\n\r\n\t\t\t// recurse into the nested arrays\r\n\t\t\tif ( !this[i].equals( array[i] ) )\r\n\t\t\t\treturn false;\r\n\r\n\t\t}\r\n\t\telse if (this[i] != array[i]) {\r\n\r\n\t\t\t// Warning - two different object instances will never be equal: {x:20} != {x:20}\r\n\t\t\treturn false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\treturn true;\r\n}\r\n// Hide method from for-in loops\r\nObject.defineProperty( Array.prototype, \"equals\", { enumerable: false } );\r\n","/**\r\n * @module HuperSphere\r\n * @description Base class for n dimensional [hupersphere]{@link https://en.wikipedia.org/wiki/N-sphere}.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n\r\nimport ND from '../nD/nD.js';\r\n//Эти строки не позволяют выполнить команду npm run build\r\n//import ND from '../nD/build/nD.module.js';\r\n//import ND from '../nD/build/nD.module.min.js';\r\n//import ND from 'https://raw.githack.com/anhr/commonNodeJS/master/nD/nD.js';\r\n//import ND from 'https://raw.githack.com/anhr/commonNodeJS/master/nD/build/nD.module.js';\r\n//import ND from 'https://raw.githack.com/anhr/commonNodeJS/master/nD/build/nD.module.min.js';\r\n\r\n//если использовать эту строку, появится ошибка:\r\n//Error: Illegal reassignment to import 'ND'\r\n//При выполнении npm run build\r\n//if (ND.default) ND = ND.default;\r\n\r\n//Когда хочу вывести на холст точки вместо ребер то использую MyPoints вместо ND\r\n//При этом ребра не создаются что дает экономию времени\r\nimport MyPoints from '../myPoints/myPoints.js';\r\nimport ColorPicker from '../colorpicker/colorpicker.js';\r\n\r\n//Получаю ошибку\r\n//myThree: duplicate myThree. Please use one instance of the myThree class.\r\n//если на веб странце импортировать import MyThree from '../../../commonNodeJS/master/myThree/build/myThree.module.js';\r\n//import MyThree from '../myThree/myThree.js';\r\nimport three from '../three.js'\r\n\r\nimport ProgressBar from '../ProgressBar/ProgressBar.js'\r\n//import WebGPU from '../../../WebGPU/master/WebGPU.js';\r\nimport PositionController from '../PositionController.js';\r\nimport MyObject from '../myObject.js'\r\n\r\nconst sHuperSphere = 'HuperSphere', sOverride = sHuperSphere + ': Please override the %s method in your child class.',\r\n\tπ = Math.PI;\r\n\r\nclass HuperSphere extends MyObject {\r\n\r\n\t/**\r\n\t * Base class for n dimensional [hupersphere]{@link https://en.wikipedia.org/wiki/N-sphere}.\r\n\t * @param {Options} options See <a href=\"../../../master/jsdoc/Options/Options.html\" target=\"_blank\">Options</a>.\r\n\t * @param {object} [classSettings] <b>HuperSphere</b> class settings.\r\n\t * @param {object} [classSettings.intersection] HuperSphere intersection.\r\n\t * <pre>\r\n\t *\tFor Circle intersector is line.\r\n\t *\tFor Sphere intersector is plane.\r\n\t *\tFor HuperSphere intersector is sphere.\r\n\t * </pre>\r\n\t * @param {float} [classSettings.intersection.position=0.0] Position of the intersector.\r\n\t * <pre>\r\n\t *\tFor Circle <b>position</b> is Y coordinate of the intersection line.\r\n\t *\tFor Sphere <b>position</b> is Z coordinate of the intersection plane.\r\n\t *\tFor HuperSphere <b>position</b> is radius of the intersection sphere.\r\n\t * </pre>\r\n\t * @param {number|string} [classSettings.intersection.color=0x0000FF] Color of the intersector. Example: 'red'.\r\n\t * @param {object} [classSettings.projectParams] Parameters of project the hupersphere onto the canvas.\r\n\t * @param {THREE.Scene} classSettings.projectParams.scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}\r\n\t * @param {object} [classSettings.projectParams.params={}] The following parameters are available\r\n\t * @param {object} [classSettings.projectParams.params.center={x: 0.0, y: 0.0, z: 0.0}] center of the hupersphere\r\n\t * @param {float} [classSettings.projectParams.params.center.x=0.0] X axis of the center\r\n\t * @param {float} [classSettings.projectParams.params.center.y=0.0] Y axis of the center\r\n\t * @param {float} [classSettings.projectParams.params.center.z=0.0] Z axis of the center\r\n\t * @param {float} [classSettings.r=1.0] HuperSphere radius.\r\n\t * @param {boolean|object} [classSettings.edges={}] HuperSphere edges\r\n\t * <pre>\r\n\t *\tfalse - Doesn't create edges to reduce the creation time of the hupersphere\r\n\t * </pre>\r\n\t * @param {boolean} [classSettings.edges.project=true] false - Doesn't project edges onto canvas\r\n\t * @param {enum} [classSettings.edges.creationMethod=edgesCreationMethod.Random] method for creating edges. See <a href=\"./module-HuperSphere-HuperSphere.html#.edgesCreationMethod\" target=\"_blank\">edgesCreationMethod</a>\r\n\t * @param {object} [classSettings.settings] The following settings are available\r\n\t * @param {object} [classSettings.settings.object] HuperSphere object.\r\n\t * @param {String} [classSettings.settings.object.name] name of hupersphere.\r\n\t * @param {String|number} [classSettings.settings.object.color='lime'] color of edges or vertices.\r\n\t * <pre>\r\n\t * String - color name. See list of available color names in the <b>_colorKeywords</b> object in the [Color.js]{@link https://github.com/mrdoob/three.js/blob/dev/src/math/Color.js} file.\r\n\t * number - color [Hex triplet]{@link https://en.wikipedia.org/wiki/Web_colors#Hex_triplet}. Example: 0x0000ff - blue color.\r\n\t * Default color is lime for <a href=\"./module-Circle-Circle.html\" target=\"_blank\">Circle</a> and <a href=\"./module-Sphere-Sphere.html\" target=\"_blank\">Sphere</a>.\r\n\t * Default color of vertice of the <a href=\"./module-HuperSphere3D-HuperSphere3D.html\" target=\"_blank\">Hypersphere3D</a> is depends from the altitude angle of the vertice according the <a href=\"../../myThree/jsdoc/module-MyThree-MyThree.html\" target=\"_blank\">options.palette</a> parameter.\r\n\t * See <b>classSettings.settings.object.geometry.angles</b> for details. For example if <b>options.palette</b> is <b>MyThree.ColorPicker.paletteIndexes.BGYW</b>, then:\r\n\t * <table>\r\n\t\t <tr><td>Vertice Altitude</td><td>Vertice Color</td></tr>\r\n\t\t <tr><td>0</td><td>white</td></tr>\r\n\t\t <tr><td>π / 2</td><td>lime</td></tr>\r\n\t\t <tr><td>π</td><td>blue</td></tr>\r\n\t\t</table>\r\n\t * <b>MyThree.ColorPicker.paletteIndexes.BGYW</b> palette parameter is default.\r\n\t * Note: You can define color of the each vertice separately in the <b>classSettings.settings.object.geometry.colors</b> parameter.\r\n\t * <pre>\r\n\t * @param {object} [classSettings.settings.object.geometry] HuperSphere geometry.\r\n\t * @param {array|object} [classSettings.settings.object.geometry.angles] n-dimensional hupersphere vertice angles.\r\n\t * <pre>\r\n\t * array - array of vertex angles.\r\n\t *\tEvery item of array is n-dimensional array of vertex angles.\r\n\t *\t\r\n\t *\tAll the vertices of the <b><a href=\"module-Circle.html\" target=\"_blank\">Circle</a></b> form a circle.\r\n\t *\tFor <b><a href=\"module-Circle.html\" target=\"_blank\">Circle</a></b> every vertice is array of one angle.\r\n\t *\t\tVertex angle is the longitude of the circle of the hupersphere in the range from <b>- π</b> to <b>π</b>.\r\n\t *\t\tVertex angle is angle of rotation around of <b>Z</b> axis in 3D space.\r\n\t *\t\tAngle is begin from <b>X = 0, Y = 1</b>.\r\n\t *\t\tEvery vertex is <b>[\r\n\t\t\t\tMath.cos(θ),//x\r\n\t\t\t\tMath.sin(θ)//y\r\n\t\t\t]</b> array. <b>θ</b> is vertex angle.\r\n\t *\t\tExample of Circle with three vertices is triangle:\r\n\t *\t\t<b>classSettings.settings.object.geometry.angles: angles: [\r\n\t *\t\t\t[],                 //vertice[0] = [0                   ,1]\r\n\t *\t\t\t[Math.PI * 2 / 3],  //vertice[1] = [0.8660254037844387\t,-0.4999999999999998]\r\n\t *\t\t\t[- Math.PI * 2 / 3] //vertice[2] = [-0.8660254037844387\t,-0.4999999999999998]\r\n\t *\t\t]</b>,\r\n\t *\t\t\r\n\t *\tAll the vertices of the <b><a href=\"module-Sphere.html\" target=\"_blank\">Sphere</a></b> form a sphere.\r\n\t *\tFor <b><a href=\"module-Sphere.html\" target=\"_blank\">Sphere</a></b> every vertice is array of two angles.\r\n\t *\t\tThe first vertex angle is the latitude of the sphere of the hupersphere in the range from <b>- π / 2</b> to <b>π / 2</b>.\r\n\t *\t\tZero latitude is located at the equator.\r\n\t *\t\t\r\n\t *\t\tThe second vertex angle is the longitude of the sphere of the hupersphere in the range from <b>- π</b> to <b>π</b>.\r\n\t *\t\tThe second vertex angle is angle of rotation of the cross section around of <b>Y</b> axis.\r\n\t *\t\t\r\n\t *\t\tExample of Sphere with 4 vertices is pyramid:\r\n\t *\t\t<b>classSettings.settings.object.geometry.angles: [\r\n\t *\t\t\r\n\t *\t\t\t[ Math.PI / 2,  0                  ],//vertice[0] = [ 0                 , 1  , 0   ]\r\n\t *\t\t\t[-Math.PI / 6,  Math.PI * 2 * 0 / 3],//vertice[1] = [-0.8660254037844387,-0.5, 0   ]\r\n\t *\t\t\t[-Math.PI / 6,  Math.PI * 2 * 1 / 3],//vertice[2] = [ 0.4330127018922192,-0.5,-0.75]\r\n\t *\t\t\t[-Math.PI / 6, -Math.PI * 2 * 1 / 3,//vertice[3] = [ 0.4330127018922195,-0.5, 0.75]\r\n\t *\t\t\t\r\n\t *\t\t]</b>,\r\n\t *\t\t\r\n\t *\tAll the vertices of the <a href=\"module-HuperSphere3D.html\" target=\"_blank\">HuperSphere3D</a></b> form a [hupersphere]{@link https://en.wikipedia.org/wiki/N-sphere}.\r\n\t *\tFor <b><a href=\"module-HuperSphere3D.html\" target=\"_blank\">HuperSphere3D</a></b> every vertice is array of three angles.\r\n\t *\t\tThe first vertex angle is the altitude of the hupersphere of the hupersphere in the range from <b>0</b> to <b>π / 2</b>.\r\n\t *\t\tZero altitude is located at the center of the hupersphere.\r\n\t *\t\t\r\n\t *\t\tThe second vertex angle is the latitude of the hupersphere of the hupersphere in the range from <b>- π / 2</b> to <b>π / 2</b>.\r\n\t *\t\tZero latitude is located at the equator.\r\n\t *\t\t\r\n\t *\t\tThe third vertex angle is the longitude of the hupersphere of the hupersphere in the range from <b>- π</b> to <b>π</b>.\r\n\t *\t\tThe third vertex angle is angle of rotation of the cross section around of <b>Y</b> axis.\r\n\t *\t\t\r\n\t *\t\tExample of HuperSphere with 5 vertices is [pentahedroid]{@link https://en.wikipedia.org/wiki/5-cell}:\r\n\t *\t\t<b>classSettings.settings.object.geometry.angles: [\r\n\t *\t\t\t[],\r\n\t *\t\t\t[Math.PI / 2, Math.PI / 2],\r\n\t *\t\t\t[\r\n\t *\t\t\t\t  Math.PI / 2,//Altitude\r\n\t *\t\t\t\t- Math.PI / 6,//Latitude\r\n\t *\t\t\t\t  Math.PI * 0,//Longitude\r\n\t *\t\t\t],\r\n\t *\t\t\t[Math.PI / 2, - Math.PI / 6,   Math.PI * 2 * 1 / 3],\r\n\t *\t\t\t[Math.PI / 2, - Math.PI / 6, - Math.PI * 2 * 1 / 3],\r\n\t\t\t]</b>,\r\n\t * object - see below:\r\n\t * </pre>\r\n\t * @param {number} [classSettings.settings.object.geometry.angles.count=3|4|5] Count of vertices with random position.\r\n\t * <pre>\r\n\t * Default values:\r\n\t *\t3 for <b><a href=\"module-Circle.html\" target=\"_blank\">Circle</a></b> - triangle.\r\n\t *\t4 for <b><a href=\"module-Sphere.html\" target=\"_blank\">Sphere</a></b> - pyramid.\r\n\t *\t5 for <b><a href=\"module-HuperSphere3D.html\" target=\"_blank\">HuperSphere3D</a></b> - [pentahedroid]{@link https://en.wikipedia.org/wiki/5-cell}.\r\n\t * </pre>\r\n\t * @param {array} [classSettings.settings.object.geometry.colors] array of colors of vertices.\r\n\t * <pre>\r\n \t * Color of the each vertice is group of three (RGB) items of the colors array in range from 0 to 1. See [THREE.Color]{@link https://threejs.org/docs/?q=Color#api/en/math/Color} for details.\r\n\t * Example:\r\n\t * [\r\n\t * \t1, 0, 0,//First vertice is red.\r\n\t * \t0, 1, 0,//Second vertice green.\r\n\t * \t0, 0, 1,//Third vertice blue.\r\n\t * ]\r\n\t * </pre>\r\n\t * Note: Color of vertice is defined in the <b>classSettings.settings.object.color</b> parameter if it not exists in the colors array.\r\n\t * @param {array} [classSettings.settings.object.geometry.opacity] array of opacities of each vertice. Each item of array is float value in the range of 0.0 - 1.0 indicating how transparent the material is. A value of 0.0 indicates fully transparent, 1.0 is fully opaque.\r\n\t * @param {object} [classSettings.settings.object.geometry.indices] Array of <b>indices</b> of edges of hupersphere.\r\n\t * @param {array|object} [classSettings.settings.object.geometry.indices.edges] HuperSphere edges.\r\n\t * <pre>\r\n\t * array - array of edges.\r\n\t *\tEvery edge is array of indices of vertices from\r\n\t *\t<b>classSettings.settings.object.geometry.position</b>\r\n\t *\tExample: <b>[[0,1], [1,2], [2,0]],//triangle</b>\r\n\t * object - see below:\r\n\t * </pre>\r\n\t * @param {number} [classSettings.settings.object.geometry.indices.edges.count=3] edges count.\r\n\t * @param {boolean|object} [classSettings.debug=false] Debug mode.\r\n\t * <pre>\r\n\t *\ttrue - Diagnoses your code and display detected errors to console.\r\n\t *\tobject - Diagnoses your code and display detected errors to console.\r\n\t * </pre>\r\n\t * @param {boolean|Array} [classSettings.debug.probabilityDensity=[]] Probability density of distribution of vertices over the surface of the hupersphere.\r\n\t * <pre>\r\n\t *\tfalse - do not calculate probability density.\r\n\t *\t[] - calculate probability density.\r\n\t * </pre>\r\n\t * @param {boolean} [classSettings.debug.testVertice=true]\r\n\t * <pre>\r\n\t * Test of converting of the vertice coordinates from Cartesian Coordinates to Polar Coordinates\r\n\t * and Polar Coordinates to Cartesian Coordinates\r\n\t * and display detected errors to console.\r\n\t * </pre>\r\n\t * @param {boolean} [classSettings.debug.middleVertice=true] Middle vertice log.\r\n\t * @param {boolean} [classSettings.debug.log=true] Vertices and edges log.\r\n\t * @param {function} [classSettings.continue] Callback function that called after hupersphere edges was created.\r\n\t * @param {boolean} [classSettings.boRemove] false - do not delete the previous hupersphere while projecting a new hupersphere on scene.\r\n\t * @param {boolean} [classSettings.boGui] false - do not include hupersphere GUI.\r\n\t **/\r\n\tconstructor(options, classSettings = {}) {\r\n\r\n\t\tclassSettings.settings = classSettings.settings || {};\r\n\t\tsuper( classSettings.settings );\r\n\t\t//this.rotateLatitude = 0;\r\n\t\tthis.rotateLatitude = - π / 2;//Поворачиваем широту на 90 градусов что бы начало координат широты находилось на экваторе;\r\n\t\tconst _this = this, THREE = three.THREE;\r\n\t\tif (classSettings.debug === undefined) classSettings.debug = true;\r\n\t\tif (classSettings.debug === true) classSettings.debug = {};\r\n\t\tif (classSettings.debug) {\r\n\r\n\t\t\tclassSettings.debug.timestamp = window.performance.now();\r\n\t\t\tclassSettings.debug.logTimestamp = (text = '', timestamp) =>\r\n\t\t\t\tconsole.log('time: ' + text + ((window.performance.now() - (timestamp ? timestamp : classSettings.debug.timestamp)) / 1000) + ' sec.');\r\n\t\t\tif (classSettings.debug.testVertice != false) classSettings.debug.testVertice = true;\r\n\t\t\tif (classSettings.debug.middleVertice != false) classSettings.debug.middleVertice = true;\r\n\r\n\t\t}\r\n\t\tthis.classSettings = classSettings;\r\n\r\n\t\tconst cookieOptions = {};\r\n\t\tif (options.dat) options.dat.cookie.getObject(this.cookieName, cookieOptions);\r\n\r\n\t\tlet edgesOld = cookieOptions.edgesOld || { project: true, };\r\n\t\tclassSettings.edges = cookieOptions.edges === false ? false : cookieOptions.edges || classSettings.edges;\r\n\t\tif (classSettings.edges != false) classSettings.edges = classSettings.edges || {};\r\n\t\tif ((classSettings.edges != false) && (classSettings.edges.project === undefined)) classSettings.edges.project = true;\r\n\r\n\t\tif (classSettings.r === undefined) classSettings.r = 1.0;\r\n\t\tclassSettings.settings = classSettings.settings || {};\r\n\t\tconst settings = classSettings.settings;\r\n\t\tsettings.options = options;\r\n\t\tsettings.object = settings.object || {};\r\n\t\tsettings.object.name = settings.object.name || this.name(options.getLanguageCode);\r\n\r\n\t\t//не получается сменить имя оси\r\n\t\t//if (options.scales.w.name === 'w') options.scales.w.name = 't';\r\n\r\n\t\tsettings.object.geometry = settings.object.geometry || {};\r\n\r\n\t\t//for debug\r\n\t\t//для 2D гиперсферы это плотность вероятности распределения вершин по поверхности сферы в зависимости от третьей координаты вершины z = vertice.[2]\r\n\t\t//Плотности разбил на несколько диапазонов в зависимости от третьей координаты вершины z = vertice.[2]\r\n\t\t//Разбил сферу на sc = 5 сегментов от 0 до 4.\r\n\t\t//Границы сегментов вычисляю по фомулам:\r\n\t\t//Высота сегмента hs = d / sc = 2 / 5 = 0.4\r\n\t\t//Нижняя граница сегмента hb = hs * i - r\r\n\t\t//Верхняя граница сегмента ht = hs * (i + 1) - r\r\n\t\t//где r = 1 - радиус сферыб d = 2 * r = 2 - диаметр сферы, i - индекс сегмента\r\n\t\tif (classSettings.debug && (classSettings.debug.probabilityDensity != false)) classSettings.debug.probabilityDensity = [\r\n\r\n\t\t\t/*\r\n\t\t\t{ count: 0, },//0. From -1 to -0.6\r\n\t\t\t{ count: 0, },//1. From -0.6 to -0.2\r\n\t\t\t{ count: 0, },//2. From -0.2 to 0.2\r\n\t\t\t{ count: 0, },//3. From 0.2 to 0.6\r\n\t\t\t{ count: 0, },//4. From 0.6 to 1\r\n\t\t\t*/\r\n\r\n\t\t];\r\n\t\tconst probabilityDensity = classSettings.debug.probabilityDensity;\r\n\t\tif (probabilityDensity) {\r\n\r\n\t\t\tfor (let i = 0; i < 5; i++) probabilityDensity.push({ count: 0, });\r\n\t\t\tprobabilityDensity.options = { d: classSettings.r * 2, };\r\n\t\t\tprobabilityDensity.options.sc = probabilityDensity.length;//Количество сегментов\r\n\t\t\tprobabilityDensity.options.hs = probabilityDensity.options.d / probabilityDensity.options.sc;//Высота сегмента\r\n\t\t\tlet sectorsValue = 0;\r\n\t\t\tprobabilityDensity.forEach((sector, i) => {\r\n\r\n\t\t\t\tsector.hb = probabilityDensity.options.hs * i - classSettings.r;//Нижняя граница сегмента\r\n\t\t\t\tsector.ht = probabilityDensity.options.hs * (i + 1) - classSettings.r;//Верхняя граница сегмента\r\n\t\t\t\tsectorsValue += _this.probabilityDensity.sectorValue(probabilityDensity, i);\r\n\r\n\t\t\t});\r\n\t\t\tlet unverseValue = this.probabilityDensity.unverseValue;\r\n\t\t\tif (unverseValue === undefined) {\r\n\r\n\t\t\t\tunverseValue = π;\r\n\t\t\t\tconst r = classSettings.r;\r\n\t\t\t\tfor (let i = 0; i < (_this.dimension - 1); i++) unverseValue *= 2 * r;\r\n\r\n\t\t\t}\r\n\t\t\tif (unverseValue != sectorsValue) console.error(sHuperSphere + ': Unverse value = ' + unverseValue + '. Sectors value = ' + sectorsValue);\r\n\r\n\t\t}\r\n\t\tsettings.object.geometry.angles = settings.object.geometry.angles || this.defaultAngles();\r\n\t\tif (!(settings.object.geometry.angles instanceof Array)) {\r\n\r\n\t\t\tconst angles = [];\r\n\t\t\tObject.keys(settings.object.geometry.angles).forEach((key) => angles[key] = settings.object.geometry.angles[key]);\r\n\t\t\tsettings.object.geometry.angles = angles;\r\n\r\n\t\t}\r\n\r\n\t\tsettings.object.geometry.angles = new Proxy(settings.object.geometry.angles || this.defaultAngles(), {\r\n\r\n\t\t\tget: (angles, name) => {\r\n\r\n\t\t\t\tconst verticeId = parseInt(name);\r\n\t\t\t\tif (!isNaN(verticeId)) {\r\n\r\n\t\t\t\t\treturn new Proxy(angles[verticeId], {\r\n\r\n\t\t\t\t\t\tget: (verticeAngles, name) => {\r\n\r\n\t\t\t\t\t\t\tconst angleId = parseInt(name);\r\n\t\t\t\t\t\t\tif (!isNaN(angleId)) {\r\n\r\n\t\t\t\t\t\t\t\tif (angleId >= verticeAngles.length) return 0.0;\r\n\t\t\t\t\t\t\t\tlet angle = verticeAngles[angleId];\r\n\t\t\t\t\t\t\t\treturn angle;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\tcase 'length': return _this.dimension - 1;\r\n\t\t\t\t\t\t\t\tcase 'length': return _this.dimension - 1;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn verticeAngles[name];\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset: (verticeAngles, name, value) => {\r\n\r\n\t\t\t\t\t\t\tconst angleId = parseInt(name);\r\n\t\t\t\t\t\t\tif (!isNaN(angleId)) {\r\n\r\n\t\t\t\t\t\t\t\tconst angle = value;\r\n\t\t\t\t\t\t\t\tif (verticeAngles[angleId] != angle) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst range = angles.ranges[angleId];\r\n\t\t\t\t\t\t\t\t\tif ((angle < range.min) || (angle > range.max)) console.error(sHuperSphere + ': Set angle[' + angleId + '] = ' + angle + ' of the vertice ' + verticeId + ' is out of range from ' + range.min + ' to ' + range.max);\r\n\r\n\t\t\t\t\t\t\t\t\tverticeAngles[angleId] = angle;\r\n\t\t\t\t\t\t\t\t\t_this.setPositionAttributeFromPoint(verticeId);//обновляем geometry.attributes\r\n\t\t\t\t\t\t\t\t\t//если тут обновлять гиперсферу, то будет тратиться лишнее время, когда одновременно изменяется несколько вершин\r\n\t\t\t\t\t\t\t\t\t//Сейчас я сначала изменяю все вершины, а потом обновляю гиперсферу\r\n\t\t\t\t\t\t\t\t\t//_this.update(verticeId);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t} else verticeAngles[name] = value;\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\tcase 'pushRandomAngle': return () => {\r\n\r\n\t\t\t\t\t\tconst verticeAngles = [];\r\n\t\t\t\t\t\t_this.pushRandomAngle(verticeAngles);\r\n\t\t\t\t\t\tangles.push(verticeAngles);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'push': return (verticeAngles) => {\r\n\r\n\t\t\t\t\t\tfor (let angleId = 0; angleId < verticeAngles.length; angleId++) {\r\n\r\n\t\t\t\t\t\t\tconst angle = verticeAngles[angleId], range = angles.ranges[angleId];\r\n\t\t\t\t\t\t\tif ((angle < range.min) || (angle > range.max)) console.error(sHuperSphere + ': Vertice angle[' + angleId + '] = ' + angle + ' is out of range from ' + range.min + ' to ' + range.max);\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tangles.push(verticeAngles);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'guiLength': return angles.length;\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn angles[name];\r\n\r\n\t\t\t},\r\n\t\t\t//set settings.object.geometry.angles\r\n\t\t\tset: (aAngles, name, value) => {\r\n\r\n\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\tcase 'guiLength'://изменилось количество вершин\r\n\t\t\t\t\t\tif (value < 2) return true;\r\n\t\t\t\t\t\tfor (let i = aAngles.length; i < value; i++) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tangles.pushRandomAngle();//add vertices\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taAngles.length = value;//remove vertice\r\n\r\n\t\t\t\t\t\t//update buffer\r\n\t\t\t\t\t\tthis.setPositionAttributeFromPoints(angles, true);\r\n\t\t\t\t\t\taAngles.length = value;//remove vertices\r\n\t\t\t\t\t\tif (classSettings.edges) {//Для экономии времени не добавляю ребра если на холст вывожу только вершины\r\n\r\n\t\t\t\t\t\t\t_this.removeMesh();\r\n\t\t\t\t\t\t\t_this.pushEdges();\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse _this.project();\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\tcase 'length':\r\n\t\t\t\t\t\tconsole.warn(sHuperSphere + ': set geometry.angles.length. Use guiLength instead')\r\n\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\taAngles[i] = value;\r\n\t\t\t\t\tconst object = _this.object();\r\n\t\t\t\t\tif (object) object.userData.myObject.setPositionAttributeFromPoint(i, _this.angles2Vertice(value));\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse aAngles[name] = value;\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\tconst angles = settings.object.geometry.angles;\r\n\r\n\t\t//Angles range\r\n\t\tangles.ranges = [];\r\n\t\tfor (let angleId = 0; angleId < this.dimension - 1; angleId++) {\r\n\r\n\t\t\tconst range = {}\r\n\t\t\tswitch (this.dimension - 2 - angleId) {\r\n\r\n\t\t\t\tcase 0:\r\n\t\t\t\t\trange.angleName = 'Longitude';\r\n\t\t\t\t\trange.min = - π;\r\n\t\t\t\t\trange.max = π;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\trange.angleName = 'Latitude';\r\n\t\t\t\t\trange.min = 0 + this.rotateLatitude;//- π / 2;\r\n\t\t\t\t\trange.max = π + this.rotateLatitude;//π / 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\trange.angleName = this.altitudeRange.angleName;//'Altitude';\r\n\t\t\t\t\trange.min = this.altitudeRange.min;//0;\r\n\t\t\t\t\trange.max = this.altitudeRange.max;//π / 2;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: console.error(sHuperSphere + ': vertice angles ranges. Invalid angleId = ' + angleId);\r\n\r\n\t\t\t}\r\n\t\t\tangles.ranges.push(range);\r\n\r\n\t\t}\r\n\r\n\t\t//angles[0][0] = 10;//error huperSphere.js:548 HuperSphere: Set angle[0] = 10 of the vertice 0 is out of range from -1.5707963267948966 to 1.5707963267948966\r\n\t\tif (angles.count != undefined)\r\n\t\t\tfor (let i = angles.length; i < angles.count; i++) angles.pushRandomAngle();\r\n\t\tsettings.object.geometry.position = new Proxy(settings.object.geometry.position, {\r\n\r\n\t\t\tget: (target, name) => {\r\n\r\n\t\t\t\tconst _position = angles;\r\n\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\tif (i > _position.length) console.error(sHuperSphere + ': position get. Invalid index = ' + i + ' position.length = ' + _position.length);\r\n\t\t\t\t\telse if (i === _position.length)\r\n\t\t\t\t\t\tsettings.object.geometry.angles.pushRandomAngle();\r\n\t\t\t\t\tconst _vertice = _position[i];\r\n\t\t\t\t\tconst angle2Vertice = () => {\r\n\r\n\t\t\t\t\t\tconst vertice = _this.angles2Vertice(i);\r\n\t\t\t\t\t\t//Эта проверка не проходит для HuperSphere3D\r\n\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\tlet sum = 0;\r\n\t\t\t\t\t\t\tvertice.forEach(axis => sum += axis * axis);\r\n\t\t\t\t\t\t\tconst r = classSettings.r;\r\n\t\t\t\t\t\t\tif (Math.abs((Math.sqrt(sum) - r)) > 9.5e-8)\r\n\t\t\t\t\t\t\t\tconsole.error(sHuperSphere + ': Invalid vertice[' + i + '] sum = ' + sum);\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn vertice;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn new Proxy(angle2Vertice(), {\r\n\r\n\t\t\t\t\t\tget: (vertice, name) => {\r\n\r\n\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\t//дуга между вершинами\r\n\t\t\t\t\t\t\t\tcase 'arcTo': return (verticeTo) => {\r\n\r\n\t\t\t\t\t\t\t\t\t//Calculate the arc length between two points over a hyper-sphere\r\n\t\t\t\t\t\t\t\t\t//Reference: https://www.physicsforums.com/threads/calculate-the-arc-length-between-two-points-over-a-hyper-sphere.658661/post-4196208\r\n\t\t\t\t\t\t\t\t\tconst a = vertice, b = verticeTo, R = 1, acos = Math.acos;\r\n\t\t\t\t\t\t\t\t\tlet ab = 0;//dot product\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < a.length; i++) ab += a[i] * b[i];\r\n\t\t\t\t\t\t\t\t\treturn R * acos(ab / (R * R))\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t//расстояние между вершинами по прямой в декартой системе координат\r\n\t\t\t\t\t\t\t\t//Если надо получить расстояние между вершинами по дуге в полярной системе координат, то надо вызвать \r\n\t\t\t\t\t\t\t\t//classSettings.settings.object.geometry.position.angles[verticeId].distanceTo\r\n\t\t\t\t\t\t\t\tcase 'distanceTo': return (verticeTo) => {\r\n\r\n\t\t\t\t\t\t\t\t\tif (verticeTo.length != vertice.length) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconsole.error(sHuperSphere + ': vertice.distanceTo. Invalid vertice.length.');\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tlet distance = 0;\r\n\t\t\t\t\t\t\t\t\tvertice.forEach((axis, i) => distance += Math.pow(axis - verticeTo[i], 2));\r\n\t\t\t\t\t\t\t\t\treturn Math.sqrt(distance);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcase 'edges':\r\n\r\n\t\t\t\t\t\t\t\t\t_vertice.edges = _vertice.edges || new Proxy([], {\r\n\r\n\t\t\t\t\t\t\t\t\t\tget: (edges, name) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'push': return (edgeId, verticeId) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst sPush = sHuperSphere + ': Vertice' + (verticeId === undefined ? '' : '[' + verticeId + ']') + '.edges.push(' + edgeId + '):';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (edges.length >= _this.verticeEdgesLength) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(sPush + ' invalid edges.length = ' + edges.length);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//find for duplicate edgeId\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let j = 0; j < edges.length; j++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (edges[j] === edgeId) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(sPush + ' duplicate edgeId: ' + edgeId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tedges.push(edgeId);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn edges[name];\r\n\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn _vertice.edges;\r\n\r\n\t\t\t\t\t\t\t\tcase 'angles': return _vertice;\r\n\t\t\t\t\t\t\t\tcase 'vector':\r\n\t\t\t\t\t\t\t\t\t//для совместимости с Player.getPoints. Туда попадает когда хочу вывести на холст точки вместо ребер и использую дя этого MyPoints вместо ND\r\n\t\t\t\t\t\t\t\t\tconst vertice2 = vertice[2], vertice3 = vertice[3];\r\n\t\t\t\t\t\t\t\t\t//Если вернуть THREE.Vector4 то будет неправильно отображаться цвет точки\r\n\t\t\t\t\t\t\t\t\tif (vertice3 === undefined)\r\n\t\t\t\t\t\t\t\t\t\treturn new three.THREE.Vector3(vertice[0], vertice[1], vertice2 === undefined ? 0 : vertice2);\r\n\t\t\t\t\t\t\t\t\treturn new three.THREE.Vector4(vertice[0], vertice[1], vertice2 === undefined ? 0 : vertice2, vertice3 === undefined ? 1 : vertice3);\r\n\t\t\t\t\t\t\t\tcase 'x': return vertice[0];\r\n\t\t\t\t\t\t\t\tcase 'y': return vertice[1];\r\n\t\t\t\t\t\t\t\tcase 'z': return vertice[2];\r\n\t\t\t\t\t\t\t\tcase 'w': return vertice[3];//для совместимости с Player.getColors. Туда попадает когда хочу вывести на холст точки вместо ребер и использую для этого MyPoints вместо ND\r\n\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!isNaN(parseInt(name))) return vertice[name] === undefined ? 0 : vertice[name];\r\n\t\t\t\t\t\t\treturn vertice[name];\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset: (vertice, name, value) => {\r\n\r\n\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\tcase 'edges':\r\n\t\t\t\t\t\t\t\t\t_vertice[name] = value;\r\n\t\t\t\t\t\t\t\t\tif (value === undefined) delete _vertice[name];\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvertice[name] = value;\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\tcase 'angles': return new Proxy(_position, {\r\n\r\n\t\t\t\t\t\tget: (angles, name) => {\r\n\r\n\t\t\t\t\t\t\tconst verticeId = parseInt(name);\r\n\t\t\t\t\t\t\tif (isNaN(verticeId)) {\r\n\r\n\t\t\t\t\t\t\t\tconsole.error(sHuperSphere + ': Get vertice angles failed. Invalid verticeId = ' + verticeId);\r\n\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst vertice = new Proxy(angles[name], {\r\n\r\n\t\t\t\t\t\t\t\tget: (angles, name) => {\r\n\r\n\t\t\t\t\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tcase 'middleVertice': return (oppositeVerticesId = vertice.oppositeVerticesId) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//find middle vertice between opposite vertices\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//https://wiki5.ru/wiki/Mean_of_circular_quantities#Mean_of_angles Среднее значение углов\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//массив для хранения сумм декартовых координат противоположных вершин\r\n\t\t\t\t\t\t\t\t\t\t\t//для 1D гиперсферы это: aSum[0] = x, aSum[1] = y.\r\n\t\t\t\t\t\t\t\t\t\t\t//для 2D гиперсферы это: aSum[0] = x, aSum[1] = y, aSum[2] = z.\r\n\t\t\t\t\t\t\t\t\t\t\t//для 3D гиперсферы это: aSum[0] = x, aSum[1] = y, aSum[2] = z, aSum[3] = w.\r\n\t\t\t\t\t\t\t\t\t\t\tconst aSum = [];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\toppositeVerticesId.forEach(oppositeAngleId => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst oppositeVertice = position[oppositeAngleId];\r\n\t\t\t\t\t\t\t\t\t\t\t\toppositeVertice.forEach((axis, i) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (aSum[i] === undefined) aSum[i] = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\taSum[i] += axis\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tconst muddleVertice = _this.vertice2angles(aSum);\r\n\t\t\t\t\t\t\t\t\t\t\tif (classSettings.debug && classSettings.debug.middleVertice) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('');\r\n\t\t\t\t\t\t\t\t\t\t\t\toppositeVerticesId.forEach(oppositeVerticeId => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst verticeAngles = position[oppositeVerticeId].angles;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('vertice[' + oppositeVerticeId + '] anlges: ' + JSON.stringify(verticeAngles));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('Middle vertice angles: ' + JSON.stringify(muddleVertice));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn muddleVertice;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t//идентификаторы всех вершин, которые связаны с текущей вершиной через ребра\r\n\t\t\t\t\t\t\t\t\t\tcase 'oppositeVerticesId': return new Proxy(angles.edges, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tget: (verticeEdges, name) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst edge = settings.object.geometry.indices.edges[verticeEdges[i]];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (verticeId === edge[0]) return edge[1];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (verticeId === edge[1]) return edge[0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(sHuperSphere + ': Get oppositeVerticesId failed.');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn verticeEdges[name];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn angles[name];\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn vertice;\r\n\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tset: (angles, name, value) => {\r\n\r\n\t\t\t\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\t\t\t\tconst verticeAngles = angles[i];\r\n\t\t\t\t\t\t\t\tif (classSettings.debug && ((verticeAngles.length != (_this.dimension - 1)) || (value.length != (_this.dimension - 1)))) console.error(sHuperSphere + ': Set vertice[' + i + '] angles failed. Invalid angles count.')\r\n\t\t\t\t\t\t\t\tfor (let j = 0; j < value.length; j++) verticeAngles[j] = value[j];\r\n\r\n\t\t\t\t\t\t\t} else angles[name] = value;\r\n\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tcase 'count': return _position.count === undefined ? _position.length : _position.count;\r\n\t\t\t\t\tcase 'forEach': return (item) => { for (let verticeId = 0; verticeId < position.length; verticeId++) item(position[verticeId], verticeId); }\r\n\t\t\t\t\tcase 'length': return _position.length;\r\n\t\t\t\t\tcase 'push': return (position) => { console.error(sHuperSphere + ': deprecated push vertice. Use \"settings.object.geometry.angles.pushRandomAngle()\" instead.'); };\r\n\r\n\t\t\t\t\t//for debug\r\n\t\t\t\t\tcase 'test': return () => {\r\n\r\n\t\t\t\t\t\tif (!classSettings.debug) return;\r\n\r\n\t\t\t\t\t\t_position.forEach((verticeAngles, verticeId) => {\r\n\r\n\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t//for testing please uncommet the \"//test for angles range\" in the http://localhost/anhr/commonNodeJS/master/HuperSphere/Examples/huperSphere.html page\r\n\t\t\t\t\t\t\tlet sLog = 'vertice[' + verticeId + '] angles test:\\n   verticeAngles[';\r\n\t\t\t\t\t\t\tverticeAngles.forEach(angle => sLog = sLog + angle + ', ');\r\n\t\t\t\t\t\t\tsLog = sLog + ']\\nnormalizedAngles['\r\n\t\t\t\t\t\t\t_this.normalizeVerticeAngles(verticeAngles).forEach(angle => sLog = sLog + angle + ', ');\r\n\t\t\t\t\t\t\tconsole.log(sLog + ']');\r\n\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tfor (let angleId = 0; angleId < verticeAngles.length; angleId++) {\r\n\r\n\t\t\t\t\t\t\t\tconst angle = verticeAngles[angleId];\r\n\t\t\t\t\t\t\t\tconst range = angles.ranges[angleId];\r\n\t\t\t\t\t\t\t\tif ((angle < range.min) || (angle > range.max)) {\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\tconsole.error(sHuperSphere + ': ' + range.angleName + ' angle[' + angleId + '] = ' + angle + ' of the vertice ' + verticeId + ' is out of range from ' + range.min + ' to ' + range.max);\r\n\t\t\t\t\t\t\t\t\t_position[verticeId] = _this.normalizeVerticeAngles(verticeAngles);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst vertice = settings.object.geometry.position[verticeId], strVerticeId = 'vertice[' + verticeId + ']'\r\n\t\t\t\t\t\t\t_this.TestVertice(vertice, strVerticeId);\r\n\t\t\t\t\t\t\tvertice.edges.forEach(edgeId => {\r\n\r\n\t\t\t\t\t\t\t\tif (typeof edgeId !== \"number\") console.error(sHuperSphere + ': position.test()', strVerticeId = 'position(' + verticeId + ')' + '. ' + strVerticeId + '. Invalid edgeId = ' + edgeId);\r\n\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn target[name];//Обращение к settings.object.geometry.position Proxy низшего уровня\r\n\r\n\t\t\t},\r\n\t\t\t//set settings.object.geometry.position\r\n\t\t\tset: (target, name, value) => {\r\n\r\n\t\t\t\tconst _position = angles;\r\n\t\t\t\tconst i = parseInt(name);\r\n\t\t\t\tif (!isNaN(i)) {\r\n\r\n\t\t\t\t\tif (value instanceof Array === true) {//для совместимости с Player.getPoints. Туда попадает когда хочу вывести на холст точки вместо ребер и использую дя этого MyPoints вместо ND\r\n\r\n\t\t\t\t\t\tconsole.warn(sHuperSphere + ': Set vertice was deprecated. Use set angle instead.')\r\n\t\t\t\t\t\tconst angles = this.vertice2angles(value);\r\n\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\tconst angles2vertice = this.angles2Vertice(angles);\r\n\t\t\t\t\t\t\tif (angles2vertice.length != value.length) console.error(sHuperSphere + ': Set vertice failed. angles2vertice.length = ' + angles2vertice.length + ' is not equal value.length = ' + value.length);\r\n\t\t\t\t\t\t\tconst d = 0;\r\n\t\t\t\t\t\t\tangles2vertice.forEach((axis, i) => { if (Math.abs(axis - value[i]) > d) console.error(sHuperSphere + ': Set vertice failed. axis = ' + axis + ' is not equal to value[' + i + '] = ' + value[i]) });\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsettings.object.geometry.position[i].angles(angles);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else _position[name] = value;\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\tconst position = settings.object.geometry.position;\r\n\r\n\t\tthis.pointLength = () => { return this.dimension > 2 ? this.dimension : 3; }//itemSize of the buiffer.attributes.position должен быть больше 2. Иначе при копировании из буфера в THREE.Vector3 координата z = undefined\r\n\t\tthis.getPoint = (anglesId) => {\r\n\t\t\t\r\n\t\t\tconst angles = typeof anglesId === \"number\" ? this.classSettings.settings.object.geometry.angles[anglesId] : anglesId,\r\n\t\t\t\ta2v = (angles) => {\r\n\t\r\n\t\t\t\t//https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates\r\n\t\t\t\tconst n = this.dimension, φ = [],//angles,\r\n\t\t\t\t\tx = [], cos = Math.cos, sin = Math.sin;\r\n\t\t\t\t//нужно для того, чтобы начало координат широты находилось на экваторе\r\n\t\t\t\tfor (let i = 0; i < angles.length; i++) {\r\n\t\r\n\t\t\t\t\tconst rotateLatitude = this.getRotateLatitude(i);\r\n\t\t\t\t\tφ.push((rotateLatitude === 0 ? 1 : - 1) * angles[i] - rotateLatitude);//Для широты меняем знак угола что бы положительная широта была в северном полушарии\r\n\t\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\t//добавляем оси\r\n\t\t\t\t\r\n\t\t\t\tfor (let index = 0; index < n; index++) {\r\n\t\r\n\t\t\t\t\tlet axis = 1.0;\r\n\t\t\t\t\tconst i = this.axes.indices[index],\r\n\t\t\t\t\t\tmulCount = //количество множителей для данной оси\r\n\t\t\t\t\t\ti < (n - 1) ?\r\n\t\t\t\t\t\t\ti + 1: //на один больше порядкового номера оси\r\n\t\t\t\t\t\t\ti;//или равно порядковому номеру оси если это последняя ось\r\n\t\t\t\t\tfor (let j = 0; j < mulCount; j++) {\r\n\t\r\n\t\t\t\t\t\tif(j === (mulCount - 1)){\r\n\t\r\n\t\t\t\t\t\t\t//Это последний множитель для текущей оси\r\n\t\t\t\t\t\t\tif (i != (n - 1)) {\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//Это не последняя ось\r\n\t\t\t\t\t\t\t\taxis *= cos(φ[j]);\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\taxis *= sin(φ[j]);\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tx.push(axis);\r\n\t\r\n\t\t\t\t}\r\n\t\t\t\treturn x;\r\n\t\r\n\t\t\t}\r\n\t\t\tconst vertice = a2v(angles);\r\n\t\t\tif (this.classSettings.debug && this.classSettings.debug.testVertice){\r\n\t\r\n\t\t\t\tconst vertice2angles = this.vertice2angles(vertice),\r\n\t\t\t\t\tangles2vertice = a2v(vertice2angles);\r\n\t\t\t\tconst value = vertice;\r\n\t\t\t\tif (angles2vertice.length != value.length) console.error(sHuperSphere + ': Set vertice failed. angles2vertice.length = ' + angles2vertice.length + ' is not equal value.length = ' + value.length);\r\n\t\t\t\tconst d = 6e-16;\r\n\t\t\t\tangles2vertice.forEach((axis, i) => { if(Math.abs(axis - value[i]) > d) console.error(sHuperSphere + ': Set vertices[' + anglesId + '] failed. axis = ' + axis + ' is not equal to value[' + i + '] = ' + value[i]) } );\r\n\t\t\t\t\r\n\t\t\t}\r\n\t\r\n\t\t\tvertice.forEach((axis, i) => vertice[i] *= this.classSettings.r);\r\n\t\t\treturn new Proxy(vertice, {\r\n\r\n\t\t\t\tget: (vertice, name) => {\r\n\r\n\t\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\t\tcase 'x': return vertice[0];\r\n\t\t\t\t\t\tcase 'y': return vertice[1];\r\n\t\t\t\t\t\tcase '2':\r\n\t\t\t\t\t\tcase 'z':\r\n\t\t\t\t\t\t\tconst axisZ = vertice[2];\r\n\t\t\t\t\t\t\treturn axisZ != undefined ? axisZ : 0;//В двумерной гиперсфере (окружности) координата Z = 0\r\n\t\t\t\t\t\tcase 'w': return vertice[3];\r\n\t\t\t\t\t\tcase 'length':\r\n\t\t\t\t\t\t\tconst length = vertice.length;\r\n\t\t\t\t\t\t\treturn length > 2 ? length : 3;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn vertice[name];\r\n\r\n\t\t\t\t},\r\n\r\n\t\t\t});\r\n\t\t\r\n\t\t}\r\n\t\tthis.getRotateLatitude = (i) => i === (this.dimension - 3) ? this.rotateLatitude : 0;\r\n\t\tthis.setPositionAttributeFromPoints(angles);//itemSize of the buiffer.attributes.position должен быть больше 2. Иначе при копировании из буфера в THREE.Vector3 координата z = undefined\r\n\r\n\t\tsettings.object.geometry.indices = settings.object.geometry.indices || [];\r\n\t\tif (!(settings.object.geometry.indices instanceof Array)) {\r\n\r\n\t\t\tconst indices = [];\r\n\t\t\tObject.keys(settings.object.geometry.indices).forEach((key) => indices[key] = settings.object.geometry.indices[key]);\r\n\t\t\tsettings.object.geometry.indices = indices;\r\n\r\n\t\t}\r\n\t\tconst indices = settings.object.geometry.indices;\r\n\t\tindices[0] = indices[0] || [];\r\n\t\tif (indices.edges)\r\n\t\t\tif (indices.edges instanceof Array) {\r\n\r\n\t\t\t\tindices[0] = indices.edges;\r\n\t\t\t\tindices[0].count = indices.edges.length;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tconst edges = indices[0];\r\n\t\t\t\tObject.keys(indices.edges).forEach((key) => edges[key] = indices.edges[key]);\r\n\t\t\t\tindices.edges = edges;\r\n\r\n\t\t\t}\r\n\t\tindices.edges = new Proxy(indices[0], {\r\n\r\n\t\t\tget: (_edges, name) => {\r\n\r\n\t\t\t\tconst edgeId = parseInt(name);\r\n\t\t\t\tif (!isNaN(edgeId)) {\r\n\r\n\t\t\t\t\tlet edge = _edges[edgeId];\r\n\t\t\t\t\treturn edge;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst setVertice = (edge, edgeVerticeId, verticeId, edgeId) => {\r\n\r\n\t\t\t\t\tif (verticeId >= position.length) verticeId = 0;\r\n\t\t\t\t\tconst vertice = position[verticeId];//push random vertice if not exists\r\n\t\t\t\t\tif (edgeVerticeId != undefined) edge[edgeVerticeId] = verticeId;\r\n\r\n\t\t\t\t\tvertice.edges.push(edgeId === undefined ? _edges.length : edgeId, verticeId);\r\n\r\n\t\t\t\t}\r\n\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\tcase 'setVertices': return () => {\r\n\r\n\t\t\t\t\t\tif (_edges.length > 0) _this.boTestVertice = false;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'push': return (edge = []) => {\r\n\r\n\t\t\t\t\t\tlet vertice0Id = edge[0] === undefined ? _edges.length : edge[0],\r\n\t\t\t\t\t\t\tvertice1Id = edge[1] === undefined ? _edges.length + 1 : edge[1];\r\n\t\t\t\t\t\tconst sPushEdge = ': Push edge. '\r\n\t\t\t\t\t\tif ((vertice0Id >= position.length) || (vertice1Id >= position.length)) {\r\n\r\n\t\t\t\t\t\t\tconsole.error(sHuperSphere + sPushEdge + 'edge[' + vertice0Id + ', ' + vertice1Id + ']. Invalid vertice range from 0 to ' + (position.length - 1));\r\n\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif ((position[vertice0Id].edges.length >= _this.verticeEdgesLength) || (position[vertice1Id].edges.length >= _this.verticeEdgesLength))\r\n\t\t\t\t\t\t\treturn;//Не добавлять новое ребро если у его вершин количество ребер больше или равно _this.verticeEdgesLength\r\n\t\t\t\t\t\tsetVertice(edge, 0, vertice0Id);\r\n\t\t\t\t\t\tsetVertice(edge, 1, vertice1Id);\r\n\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\tif (edge.length != 2) console.error(sHuperSphere + sPushEdge + 'Invalid edge.length = ' + edge.length);\r\n\t\t\t\t\t\t\telse if (edge[0] === edge[1]) console.error(sHuperSphere + sPushEdge + 'edge = [' + edge + '] Duplicate vertices.');\r\n\t\t\t\t\t\t\t_edges.forEach((edgeCur, i) => { if (((edgeCur[0] === edge[0]) && (edgeCur[1] === edge[1])) || ((edgeCur[0] === edge[1]) && (edgeCur[1] === edge[0]))) console.error(sHuperSphere + sPushEdge + 'edges[' + i + ']. Duplicate edge[' + edge + ']') });\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn _edges.push(edge);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcase 'pushEdges': return (edge = []) => {\r\n\r\n\t\t\t\t\t\t_edges.count = _edges.count || 3;\r\n\t\t\t\t\t\tfor (let i = 0; i < _edges.count; i++) {\r\n\r\n\t\t\t\t\t\t\tconst edge = _edges[i];\r\n\t\t\t\t\t\t\tif (edge) {\r\n\r\n\t\t\t\t\t\t\t\tsetVertice(edge, 0, edge[0], i);\r\n\t\t\t\t\t\t\t\tsetVertice(edge, 1, edge[1], i);\r\n\r\n\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\tif (i === (_edges.count - 1)) indices.edges.push([settings.object.geometry.position.length - 1, 0])//loop edges\r\n\t\t\t\t\t\t\t\telse indices.edges.push();\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\treturn _edges[name];\r\n\r\n\t\t\t},\r\n\t\t\t//set indices.edges\r\n\t\t\tset: (_edges, name, value) => {\r\n\r\n\t\t\t\tswitch (name) {\r\n\r\n\t\t\t\t\tcase 'length':\r\n\t\t\t\t\t\tconst position = settings.object.geometry.position;\r\n\t\t\t\t\t\tfor (let i = value; i < settings.object.geometry.position.length; i++) position[i].edges = undefined;//delete position[i].edges;\r\n\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t_edges[name] = value;\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t\tindices.edges.setVertices();\r\n\r\n\t\t//Эту функцию надо содать до вызова this.pushEdges(); потому что когда используется MyPoints для вывода на холст вершин вместо ребер,\r\n\t\t//вызывается this.project вместо this.pushEdges()\r\n\t\t/**\r\n\t\t * Projects the hupersphere onto the canvas \r\n\t\t * @param {THREE.Scene} scene [THREE.Scene]{@link https://threejs.org/docs/index.html?q=sce#api/en/scenes/Scene}\r\n\t\t * @param {object} [params={}] The following parameters are available\r\n\t\t * @param {object} [params.center={x: 0.0, y: 0.0, z: 0.0}] center of the hupersphere\r\n\t\t * @param {float} [params.center.x=0.0] X axis of the center\r\n\t\t * @param {float} [params.center.y=0.0] Y axis of the center\r\n\t\t * @param {float} [params.center.z=0.0] Z axis of the center\r\n\t\t */\r\n\t\tthis.project = (scene, params = {}) => {\r\n\r\n\t\t\tif (scene) {\r\n\r\n\t\t\t\t_this.classSettings.projectParams = _this.classSettings.projectParams || {};\r\n\t\t\t\t_this.classSettings.projectParams.scene = scene;\r\n\r\n\t\t\t} else scene = _this.classSettings.projectParams.scene;\r\n\r\n\t\t\tlet nd, myPoints;\r\n\t\t\tthis.object = () => { return nd && nd.object3D ? nd.object3D : myPoints ? myPoints : undefined; }\r\n\t\t\tconst aAngleControls = [];\r\n\r\n\t\t\tthis.objectOpacity = 0.3;\r\n\t\t\tthis.opacity = (transparent = true, opacity = this.objectOpacity) => {\r\n\r\n\t\t\t\tif (!nd) myPoints.userData.opacity(transparent ? opacity : 1);\r\n\t\t\t\telse nd.opacity(nd.object3D, transparent, opacity);\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst removeObject = (object) => {\r\n\r\n\t\t\t\tif (!object) return;\r\n\t\t\t\tscene.remove(object);\r\n\t\t\t\tif (options.guiSelectPoint) options.guiSelectPoint.removeMesh(object);\r\n\r\n\t\t\t}\r\n\t\t\tthis.remove(scene);\r\n\t\t\tthis.removeHuperSphere = () => {\r\n\r\n\t\t\t\tconst object = _this.object();\r\n\t\t\t\tif (nd) nd = undefined;\r\n\t\t\t\tif (myPoints) myPoints = undefined;\r\n\t\t\t\tremoveObject(object);\r\n\r\n\t\t\t}\r\n\t\t\tthis.removeMesh = () => {\r\n\r\n\t\t\t\tsettings.object.geometry.indices.edges.length = 0;\r\n\t\t\t\t_this.remove(classSettings.projectParams.scene);\r\n\t\t\t\tif (nd) nd = undefined;\r\n\t\t\t\tif (myPoints) myPoints = undefined;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tthis.Test();\r\n\r\n\t\t\tthis.color();\r\n\r\n\t\t\tif (this.setW) this.setW();\r\n\r\n\t\t\tthis.isUpdate = true;\r\n\t\t\tthis.update = (verticeId, changedAngleId) => {\r\n\r\n\t\t\t\tif (!this.isUpdate) return;\r\n\t\t\t\tconst points = nd && (nd.object3D.visible === true) ? nd.object3D : myPoints;\r\n\t\t\t\tconst vertice = settings.object.geometry.position[verticeId];\r\n\t\t\t\tthis.setPositionAttributeFromPoint(verticeId, vertice);\r\n\t\t\t\tthis.bufferGeometry.attributes.position.needsUpdate = true;\r\n\t\t\t\tthis.bufferGeometry.attributes.color.needsUpdate = true;\r\n\t\t\t\tif (settings.options.axesHelper)\r\n\t\t\t\t\tsettings.options.axesHelper.updateAxes();\r\n\t\t\t\tconst guiSelectPoint = settings.options.guiSelectPoint;\r\n\t\t\t\tif (guiSelectPoint) {\r\n\r\n\t\t\t\t\tguiSelectPoint.update(true);\r\n\t\t\t\t\tguiSelectPoint.exposePosition();\r\n\t\t\t\t\tconst setControl = (control) => {\r\n\r\n\t\t\t\t\t\tif (!control || !control.getValue()) return;\r\n\t\t\t\t\t\tcontrol.setValue(false);\r\n\t\t\t\t\t\tcontrol.setValue(true);\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetControl(aAngleControls.cHighlightEdges);\r\n\t\t\t\t\tsetControl(aAngleControls.cMiddleVertice);\r\n\r\n\t\t\t\t\tif (aAngleControls.cross) {\r\n\r\n\t\t\t\t\t\taAngleControls.cross.position.copy(settings.object.geometry.position[aAngleControls.oppositeVerticeId]);\r\n\t\t\t\t\t\tif (aAngleControls.cross.position.z === undefined) aAngleControls.cross.position.z = 0;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (aAngleControls.arc) aAngleControls.createArc();\r\n\r\n\t\t\t\t\tif (aAngleControls.planes) aAngleControls.planes.update(changedAngleId);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.projectGeometry = () => {\r\n\r\n\t\t\t\tthis.line = (settings) => {\r\n\r\n\t\t\t\t\treturn this.newHuperSphere(\r\n\t\t\t\t\t\tclassSettings.settings.options,\r\n\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\tcookieName: settings.cookieName,\r\n\t\t\t\t\t\t\tboRemove: false,\r\n\t\t\t\t\t\t\tboGui: false,\r\n\t\t\t\t\t\t\tedges: settings.edges === undefined ? {\r\n\r\n\t\t\t\t\t\t\t\tproject: true,//Если линия создается в виде ребер, то отображать ребра на холсте\r\n\t\t\t\t\t\t\t\tcreationMethod: HuperSphere.edgesCreationMethod.Random,\r\n\r\n\t\t\t\t\t\t\t} : settings.edges,\r\n\t\t\t\t\t\t\tprojectParams: { scene: classSettings.projectParams.scene, },\r\n\t\t\t\t\t\t\tr: classSettings.r,\r\n\t\t\t\t\t\t\tdebug: classSettings.debug,\r\n\t\t\t\t\t\t\tsettings: {\r\n\r\n\t\t\t\t\t\t\t\tobject: {\r\n\r\n\t\t\t\t\t\t\t\t\tname: settings.object.name,\r\n\t\t\t\t\t\t\t\t\tcolor: settings.object.color,\r\n\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\tMAX_POINTS: settings.object.geometry.MAX_POINTS,\r\n\t\t\t\t\t\t\t\t\t\tangles: settings.object.geometry.angles,\r\n\t\t\t\t\t\t\t\t\t\topacity: settings.object.geometry.opacity,\r\n\t\t\t\t\t\t\t\t\t\tindices: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tedges: settings.object.geometry.indices.edges,\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst intersection = (parent) => {\r\n\r\n\t\t\t\t\tif (!classSettings.intersection) return;\r\n\r\n\t\t\t\t\tif (classSettings.intersection.position === undefined) classSettings.intersection.position = 0;\r\n\t\t\t\t\tconst mesh = this.intersection(classSettings.intersection.color === undefined ? \"lightgray\" ://0x0000FF : //blue\r\n\t\t\t\t\t\tclassSettings.intersection.color, scene);\r\n\r\n\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\t\tintersector: 'Intersector',\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tswitch (options.getLanguageCode()) {\r\n\r\n\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\tlang.intersector = 'Сечение';\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmesh.name = lang.intersector;\r\n\t\t\t\t\tparent.add(mesh);\r\n\t\t\t\t\tif (options.guiSelectPoint) options.guiSelectPoint.addMesh(mesh);\r\n\r\n\t\t\t\t},\r\n\t\t\t\t\tguiSelectPoint = settings.options.guiSelectPoint,\r\n\t\t\t\t\tgui = (object) => {\r\n\r\n\t\t\t\t\t\tconst anglesDefault = [];\r\n\t\t\t\t\t\tobject.userData.gui = {\r\n\r\n\t\t\t\t\t\t\tget isLocalPositionReadOnly() { return true; },\r\n\t\t\t\t\t\t\tsetValues: (verticeId) => {\r\n\r\n\t\t\t\t\t\t\t\t//пользователь выбрал вершину\r\n\r\n\t\t\t\t\t\t\t\tanglesDefault.length = 0;\r\n\t\t\t\t\t\t\t\tconst verticeAngles = angles[verticeId];\r\n\r\n\t\t\t\t\t\t\t\tfor (let i = (aAngleControls.cEdges.__select.length - 1); i > 0; i--)\r\n\t\t\t\t\t\t\t\t\taAngleControls.cEdges.__select.remove(i);\r\n\t\t\t\t\t\t\t\t_display(aAngleControls.fOppositeVertice.domElement, false);\r\n\r\n\t\t\t\t\t\t\t\tif (verticeAngles.edges) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst edges = settings.object.geometry.indices.edges;\r\n\t\t\t\t\t\t\t\t\tverticeAngles.edges.forEach(edgeId => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst opt = document.createElement('option'),\r\n\t\t\t\t\t\t\t\t\t\t\tedge = edges[edgeId];\r\n\t\t\t\t\t\t\t\t\t\topt.innerHTML = '(' + edgeId + ') ' + verticeId + ', ' + (edge[0] === verticeId ? edge[1] : edge[1] === verticeId ? edge[0] : console.error(sHuperSphere + ': Vertice edges GUI. Invalid edge vertices: ' + edge));\r\n\t\t\t\t\t\t\t\t\t\topt.setAttribute('value', edgeId);\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.cEdges.__select.appendChild(opt);\r\n\r\n\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t//Не нужно показывать список ребер, выреление ребер и среднюю вершину для этой вершины если у вершины нет ребер\r\n\t\t\t\t\t\t\t\t\t//У вершины нет ребер если пользователь убрал галочку в 'Ребра' в настройках гиперсферы\r\n\t\t\t\t\t\t\t\t\tconst boDisplay = verticeAngles.edges.length === 0 ? false : true;\r\n\t\t\t\t\t\t\t\t\t_display(aAngleControls.cEdges.domElement.parentElement.parentElement, boDisplay);\r\n\t\t\t\t\t\t\t\t\t_display(aAngleControls.cHighlightEdges.domElement.parentElement.parentElement, boDisplay);\r\n\t\t\t\t\t\t\t\t\t_display(aAngleControls.cMiddleVertice.domElement.parentElement.parentElement, boDisplay);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\taAngleControls.verticeId = verticeId;\r\n\r\n\t\t\t\t\t\t\t\t//если оставить эту линию то если угол выходит за пределы допустимого,\r\n\t\t\t\t\t\t\t\t//то этот угол автоматически возвращается в пределы допустимого с помощью органа управления gui\r\n\t\t\t\t\t\t\t\t//Но это не отображается на изображении гиперсферы\r\n\t\t\t\t\t\t\t\t//_this.isUpdate = false;\r\n\r\n\t\t\t\t\t\t\t\tfor (let i = 0; i < verticeAngles.length; i++) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst angle = verticeAngles[i], cAngle = aAngleControls[i], min = cAngle.__min, max = cAngle.__max;\r\n\t\t\t\t\t\t\t\t\tcAngle.setValue(angle);\r\n\t\t\t\t\t\t\t\t\tif ((angle < min) || (angle > max)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\terror: '%n = %s  of the %v vertice is out of range from %min to %max',\r\n\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\t\t\tswitch (options.getLanguageCode()) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tlang.error = '%n = %s вершины %v выходит из допустимого диапазона от %min до %max';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst sError = lang.error.replace('%s', angle).\r\n\t\t\t\t\t\t\t\t\t\t\treplace('%n', cAngle.__li.querySelector(\".property-name\").innerHTML).\r\n\t\t\t\t\t\t\t\t\t\t\treplace('%v', verticeId).\r\n\t\t\t\t\t\t\t\t\t\t\treplace('%min', min).\r\n\t\t\t\t\t\t\t\t\t\t\treplace('%max', max);\r\n\t\t\t\t\t\t\t\t\t\tconsole.error(sError);\r\n\t\t\t\t\t\t\t\t\t\talert(sError);\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tanglesDefault.push(angle);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\treset: (verticeId) => {\r\n\r\n\t\t\t\t\t\t\t\tconst resetControl = (control) => {\r\n\r\n\t\t\t\t\t\t\t\t\tif (!control) return;\r\n\t\t\t\t\t\t\t\t\tconst boValue = control.getValue();\r\n\t\t\t\t\t\t\t\t\tcontrol.setValue(false);//Убрать выделенные ребра.\r\n\t\t\t\t\t\t\t\t\tif ((verticeId != -1) && boValue) control.setValue(boValue);//если у предыдущей вершины выделялись ребра, то и у новой вершины выделять ребра\r\n\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\tresetControl(aAngleControls.cHighlightEdges);\r\n\t\t\t\t\t\t\t\tresetControl(aAngleControls.cMiddleVertice);\r\n\t\t\t\t\t\t\t\tresetControl(aAngleControls.cPlanes);\r\n\r\n\t\t\t\t\t\t\t\tif (aAngleControls.removeCross) aAngleControls.removeCross();\r\n\t\t\t\t\t\t\t\tif (aAngleControls.removeArc) aAngleControls.removeArc();\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\taddControllers: (fParent) => {\r\n\r\n\t\t\t\t\t\t\t\tsettings.options.guiSelectPoint.setReadOnlyPosition(true);\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\t\t\t\tconst getLanguageCode = options.getLanguageCode;\r\n\r\n\t\t\t\t\t\t\t\tconst lang = {\r\n\r\n\t\t\t\t\t\t\t\t\tadvansed: 'Advansed',\r\n\r\n\t\t\t\t\t\t\t\t\tangles: 'Angles',\r\n\t\t\t\t\t\t\t\t\tanglesTitle: 'Polar coordinates.',\r\n\r\n\t\t\t\t\t\t\t\t\tangle: 'Angle',\r\n\r\n\t\t\t\t\t\t\t\t\tedges: 'Edges',\r\n\t\t\t\t\t\t\t\t\tedgesTitle: 'Edges indexes of the vertice',\r\n\t\t\t\t\t\t\t\t\toppositeVertice: 'Opposite vertice',\r\n\r\n\t\t\t\t\t\t\t\t\thighlightEdges: 'Highlight',\r\n\t\t\t\t\t\t\t\t\thighlightEdgesTitle: 'Highlight edges of the vertice.',\r\n\r\n\t\t\t\t\t\t\t\t\tmiddleVertice: 'Middle vertice',\r\n\t\t\t\t\t\t\t\t\tmiddleVerticeTitle: 'Find middle vertice between opposite vertices.',\r\n\r\n\t\t\t\t\t\t\t\t\tplane: 'Plane',\r\n\t\t\t\t\t\t\t\t\tplanes: 'Planes',\r\n\t\t\t\t\t\t\t\t\tplanesTitle: 'Planes of rotation of angles.',\r\n\r\n\t\t\t\t\t\t\t\t\tdefaultButton: 'Default',\r\n\t\t\t\t\t\t\t\t\tdefaultAnglesTitle: 'Restore default angles.',\r\n\r\n\t\t\t\t\t\t\t\t\tnotSelected: 'not selected',\r\n\t\t\t\t\t\t\t\t\tarc: 'Arc',\r\n\r\n\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\t\t\t\t\t\t\tswitch (_languageCode) {\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.advansed = 'Дополнительно';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.angles = 'Углы';\r\n\t\t\t\t\t\t\t\t\t\tlang.anglesTitle = 'Полярные координаты.';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.angle = 'Угол';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.edges = 'Ребра';\r\n\t\t\t\t\t\t\t\t\t\tlang.edgesTitle = 'Индексы ребер, имеющих эту вершину';\r\n\t\t\t\t\t\t\t\t\t\tlang.oppositeVertice = 'Противоположная вершина';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.highlightEdges = 'Выделить';\r\n\t\t\t\t\t\t\t\t\t\tlang.highlightEdgesTitle = 'Выделить ребра этой вершины.';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.middleVertice = 'Средняя';\r\n\t\t\t\t\t\t\t\t\t\tlang.middleVerticeTitle = 'Найти среднюю вершину между противоположными вершинами.';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.plane = 'Плоскость';\r\n\t\t\t\t\t\t\t\t\t\tlang.planes = 'Плоскости';\r\n\t\t\t\t\t\t\t\t\t\tlang.planesTitle = 'Плоскости вращения углов.';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.defaultButton = 'Восстановить';\r\n\t\t\t\t\t\t\t\t\t\tlang.defaultAnglesTitle = 'Восстановить углы по умолчанию';\r\n\r\n\t\t\t\t\t\t\t\t\t\tlang.notSelected = 'Не выбрано';\r\n\t\t\t\t\t\t\t\t\t\tlang.arc = 'Дуга';\r\n\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\tdefault://Custom language\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tconst geometry = settings.object.geometry,\r\n\t\t\t\t\t\t\t\t\tposition = geometry.position,\r\n\t\t\t\t\t\t\t\t\tedges = geometry.indices.edges,\r\n\t\t\t\t\t\t\t\t\tdat = three.dat,\r\n\t\t\t\t\t\t\t\t\tfAdvansed = fParent.addFolder(lang.advansed);\r\n\r\n\t\t\t\t\t\t\t\t//Angles\r\n\r\n\t\t\t\t\t\t\t\tconst createAnglesControls = (fParent, aAngleControls, anglesDefault) => {\r\n\r\n\t\t\t\t\t\t\t\t\tconst fAngles = fParent.addFolder(lang.angles);\r\n\t\t\t\t\t\t\t\t\tdat.folderNameAndTitle(fAngles, lang.angles, lang.anglesTitle);\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < (_this.dimension - 1); i++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst range = angles.ranges[i];\r\n\t\t\t\t\t\t\t\t\t\tconst cAngle = fAngles.add({ angle: 0, }, 'angle', range.min, range.max, 2 * π / 360).onChange((angle) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tangles[aAngleControls.verticeId][i] = angle;\r\n\t\t\t\t\t\t\t\t\t\t\t_this.update(aAngleControls.verticeId, i);\r\n\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tconst name = (i) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst lang = [\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t'Altitude',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'Latitude',\r\n\t\t\t\t\t\t\t\t\t\t\t\t'Longitude',\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t]\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tswitch (options.getLanguageCode()) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlang[0] = 'Высота';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlang[1] = 'Широта';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlang[2] = 'Долгота';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn lang[i + 4 - _this.dimension];\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(cAngle, name(i));\r\n\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.push(cAngle);\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t//Restore default angles.\r\n\t\t\t\t\t\t\t\t\tconst cRestoreDefaultAngles = fAngles.add({\r\n\r\n\t\t\t\t\t\t\t\t\t\tdefaultF: () => { aAngleControls.forEach((cAngle, i) => cAngle.setValue(anglesDefault[i])); },\r\n\r\n\t\t\t\t\t\t\t\t\t}, 'defaultF');\r\n\t\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(cRestoreDefaultAngles, lang.defaultButton, lang.defaultAnglesTitle);\r\n\r\n\t\t\t\t\t\t\t\t\treturn fAngles;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcreateAnglesControls(fAdvansed, aAngleControls, anglesDefault);\r\n\r\n\r\n\t\t\t\t\t\t\t\t//Edges\r\n\r\n\t\t\t\t\t\t\t\taAngleControls.cEdges = fAdvansed.add({ Edges: lang.notSelected }, 'Edges', { [lang.notSelected]: -1 }).onChange((edgeId) => {\r\n\r\n\t\t\t\t\t\t\t\t\tedgeId = parseInt(edgeId);\r\n\t\t\t\t\t\t\t\t\t_display(aAngleControls.fOppositeVertice.domElement, edgeId === -1 ? false : true);\r\n\t\t\t\t\t\t\t\t\taAngleControls.removeArc = () => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (aAngleControls.arc && aAngleControls.arc.removeHuperSphere) aAngleControls.arc.removeHuperSphere();\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.arc = undefined;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\taAngleControls.removeCross = () => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (aAngleControls.cross) classSettings.projectParams.scene.remove(aAngleControls.cross);\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.cross = undefined;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tlet boTransparent;\r\n\t\t\t\t\t\t\t\t\tif (edgeId === -1) {\r\n\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.removeCross();\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.removeArc();\r\n\t\t\t\t\t\t\t\t\t\taEdgeAngleControls.verticeId = undefined;\r\n\t\t\t\t\t\t\t\t\t\tboTransparent = false;\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst sChangeVerticeEdge = ': Change vertice edge. ',\r\n\t\t\t\t\t\t\t\t\t\t\tedge = edges[edgeId],\r\n\t\t\t\t\t\t\t\t\t\t\toppositeVerticeId = edge[0] === aAngleControls.verticeId ? edge[1] : edge[1] === aAngleControls.verticeId ? edge[0] : console.error(sHuperSphere + sChangeVerticeEdge + 'Invalid edge vertices: ' + edge),\r\n\t\t\t\t\t\t\t\t\t\t\toppositeVerticeAngles = position[oppositeVerticeId].angles;\r\n\t\t\t\t\t\t\t\t\t\tif (oppositeVerticeAngles.length != aEdgeAngleControls.length) console.error(sHuperSphere + sChangeVerticeEdge + 'Invalid opposite vertice angles length = ' + oppositeVerticeAngles.length);\r\n\t\t\t\t\t\t\t\t\t\taEdgeAngleControls.verticeId = oppositeVerticeId;\r\n\t\t\t\t\t\t\t\t\t\tedgeAnglesDefault.length = 0;\r\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < oppositeVerticeAngles.length; i++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst angle = oppositeVerticeAngles[i];\r\n\t\t\t\t\t\t\t\t\t\t\taEdgeAngleControls[i].setValue(angle);\r\n\t\t\t\t\t\t\t\t\t\t\tedgeAnglesDefault.push(angle);\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t//рисуем крестик на противоположной вершине выбранного ребра\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.removeCross();\r\n\t\t\t\t\t\t\t\t\t\tvertices.length = 0;\r\n\t\t\t\t\t\t\t\t\t\tconst oppositeVertice = position[oppositeVerticeId],\r\n\t\t\t\t\t\t\t\t\t\t\tcrossSize = 0.05;\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([0, 0, crossSize]);\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([0, 0, -crossSize]);\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([-crossSize, -crossSize, 0]);\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([crossSize, crossSize, 0]);\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([crossSize, -crossSize, 0]);\r\n\t\t\t\t\t\t\t\t\t\tpushVertice([-crossSize, crossSize, 0]);\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.cross = addObject2Scene(vertices, 'white');\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.cross.position.copy(oppositeVertice);\r\n\t\t\t\t\t\t\t\t\t\tif (aAngleControls.cross.position.z === undefined) aAngleControls.cross.position.z = 0;\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.oppositeVerticeId = oppositeVerticeId;\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.MAX_POINTS = 1 + 2 * 2 * 2 * 2;// * 2 * 2 * 2;//17;//количество вершин дуги когда угол между крайними вершинами дуги 180 градусов. https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically/31411794#31411794\r\n\r\n\t\t\t\t\t\t\t\t\t\t//Create arc between edge's vertices i.e between vertice and opposite vertice.\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.createArc = () => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tlet verticeId = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tconst arcAngles = [],//массив вершин в полярной системе координат, которые образуют дугу\r\n\t\t\t\t\t\t\t\t\t\t\t\t//если не копировать каждый угол в отделности, то в новой вершине останутся старые ребра\r\n\t\t\t\t\t\t\t\t\t\t\t\tcopyVertice = (vertice) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst verticeAngles = _this.vertice2angles(vertice)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (aAngleControls.arc) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\taAngleControls.arc.classSettings.settings.object.geometry.angles[verticeId] = verticeAngles;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tverticeId++;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else arcAngles.push(verticeAngles);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t\tarcVerticesCount = 2,\r\n\t\t\t\t\t\t\t\t\t\t\t\td = π / arcVerticesCount,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcd = 1 / Math.sin(d),//Поправка для координат вершин что бы они равномерно располагались по дуге\r\n\t\t\t\t\t\t\t\t\t\t\t\tvertice = position[aAngleControls.verticeId], oppositeVertice = position[aAngleControls.oppositeVerticeId],\r\n\t\t\t\t\t\t\t\t\t\t\t\tdistance = vertice.arcTo(oppositeVertice),\r\n\t\t\t\t\t\t\t\t\t\t\t\tarcCount = distance * (aAngleControls.MAX_POINTS - 1) / π;\r\n\t\t\t\t\t\t\t\t\t\t\t//Не получилось равномерно разделить дугу на части.\r\n\t\t\t\t\t\t\t\t\t\t\t//Если начало и конец дуги расположены напротив друг друга на окружности или на сфере или на 4D hypersphere\r\n\t\t\t\t\t\t\t\t\t\t\t//то все вершины стягиваются к началу и концу дуги за исключением вершины, расположенной посередине дуги\r\n\t\t\t\t\t\t\t\t\t\t\t//Поэтому вершины на дуге получаю путем деления дуги на пополам. Полученные половинки снова делю пополам и т.д.\r\n\t\t\t\t\t\t\t\t\t\t\tlet maxLevel = 1;//на сколько частей делить дугу.\r\n\t\t\t\t\t\t\t\t\t\t\t//если maxLevel = 1 то дуга делится на 2 части с одной вершиной посередине\r\n\t\t\t\t\t\t\t\t\t\t\t//если maxLevel = 2 то дуга делится на 4 части с тремя вершинами посередине\r\n\t\t\t\t\t\t\t\t\t\t\t//если maxLevel = 3 то дуга делится на 8 частей с 7 вершинами посередине\r\n\t\t\t\t\t\t\t\t\t\t\t//Таким образом дугу можно разделит только на 2 в степени maxLevel частей\r\n\t\t\t\t\t\t\t\t\t\t\tlet count = 2;\r\n\t\t\t\t\t\t\t\t\t\t\twhile (count < arcCount) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tcount *= 2;\r\n\t\t\t\t\t\t\t\t\t\t\t\tmaxLevel++;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tlet level = 1;//текущий уровень деления дуги\r\n\t\t\t\t\t\t\t\t\t\t\tcopyVertice(vertice);\r\n\t\t\t\t\t\t\t\t\t\t\tlet i = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tlet halfArcParams = { vertice: vertice, oppositeVertice: oppositeVertice, level: level };\r\n\t\t\t\t\t\t\t\t\t\t\tif (aAngleControls.progressBar) aAngleControls.progressBar.boStop = true;\r\n\t\t\t\t\t\t\t\t\t\t\taAngleControls.progressBar = new ProgressBar(\r\n\t\t\t\t\t\t\t\t\t\t\t\tundefined,//settings.options.renderer.domElement.parentElement,\r\n\t\t\t\t\t\t\t\t\t\t\t\t(progressBar, index, callback) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (progressBar.boStop) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//Этот процес вычисления дуги нужно остановть потому что начался другой процесс вычисления дуги\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.value = i;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ti++;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//делить дугу на две части\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (callback) halfArcParams = callback;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst vertice = halfArcParams.vertice,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toppositeVertice = halfArcParams.oppositeVertice;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet level = halfArcParams.level;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst arcVerticeStep = [];//Шаги, с которым изменяются углы при построении дуги в полярной системе координат\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let k = 0; k < vertice.length; k++)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tarcVerticeStep.push((oppositeVertice[k] - vertice[k]) / arcVerticesCount);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst arcVerice = [];//Координаты вершины в полярной системе координат\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let j = 0; j < vertice.length; j++) arcVerice.push(vertice[j] + arcVerticeStep[j] * cd);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlevel++;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (level <= maxLevel) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//если не делать это преобразование,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//то когда начало и конец дуги на ходятся на противоположных концах гиперсферы,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//средняя точка попадает в центр окружности или сферы или гиперсферы,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//а это находится вне гиперсферы.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t//В этом случае все вершины дуги, кроме средней вершины, стягиваются к началу или концу дуги.\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst halfVertice = _this.angles2Vertice(_this.vertice2angles(arcVerice));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.step({\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvertice: vertice, oppositeVertice: halfVertice, level: level,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnext: { vertice: halfVertice, oppositeVertice: oppositeVertice, level: level, next: halfArcParams.next }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (halfArcParams.next)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.step(halfArcParams.next);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcopyVertice(arcVerice);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcopyVertice(oppositeVertice);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (!halfArcParams.next) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (aAngleControls.arc) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst geometry = aAngleControls.arc.object().geometry;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (geometry.attributes.position.count < verticeId) console.error(sHuperSphere + '.aAngleControls.createArc: Invalid geometry.attributes.position.count = ' + geometry.attributes.position.count);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry.setDrawRange(0, verticeId * 2 - 1);//geometry.attributes.position.itemSize);//Непонятно почему draw count так вычисляется. Еще смотри class ND.constructor.create3DObject\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(' maxLevel = ' + maxLevel + ' position.count = ' + aAngleControls.arc.object().geometry.attributes.position.count + ' drawRange.count = ' + aAngleControls.arc.object().geometry.drawRange.count + ' Vertices count = ' + verticeId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry.attributes.position.needsUpdate = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry.attributes.color.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (this.child) this.child.arc(aAngleControls, lang, arcAngles);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst arcEdges = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < (aAngleControls.MAX_POINTS - 1); i++) arcEdges.push([i, i + 1]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taAngleControls.arc = this.line({\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcookieName: 'arc',//если не задать cookieName, то настройки дуги будут браться из настроек гиперсферы\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//edges: false,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tobject: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tname: lang.arc,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tMAX_POINTS: aAngleControls.MAX_POINTS,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tangles: arcAngles,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t//opacity: 0.3,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tindices: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tedges: arcEdges,\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(' maxLevel = ' + maxLevel + ' position.count = ' + aAngleControls.arc.object().geometry.attributes.position.count + ' drawRange.count = ' + aAngleControls.arc.object().geometry.drawRange.count + ' Vertices count = ' + verticeId);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst distance = position[aAngleControls.verticeId].arcTo(position[aAngleControls.oppositeVerticeId]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet vertice, distanceDebug = 0;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst position = aAngleControls.arc.classSettings.settings.object.geometry.position;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < (verticeId === 0 ? position.length : verticeId); i++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst verticeCur = position[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (vertice)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdistanceDebug += vertice.distanceTo(verticeCur);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvertice = verticeCur;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('distance = ' + distance + ' distanceDebug = ' + distanceDebug + ' error = ' + (distanceDebug - distance) + ' arcAngles.length = ' + arcAngles.length);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\taAngleControls.progressBar = undefined;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}, {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tsTitle: 'Long time iteration process',\r\n\t\t\t\t\t\t\t\t\t\t\t\tmax: maxLevel * maxLevel - 2,\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.createArc();\r\n\t\t\t\t\t\t\t\t\t\tboTransparent = true;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t_this.opacity(boTransparent);\r\n\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\taAngleControls.cEdges.__select[0].selected = true;\r\n\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(aAngleControls.cEdges, lang.edges, lang.edgesTitle);\r\n\t\t\t\t\t\t\t\tconst aEdgeAngleControls = [], edgeAnglesDefault = [];\r\n\t\t\t\t\t\t\t\taAngleControls.fOppositeVertice = fAdvansed.addFolder(lang.oppositeVertice);\r\n\t\t\t\t\t\t\t\t_display(aAngleControls.fOppositeVertice.domElement, false);\r\n\t\t\t\t\t\t\t\tcreateAnglesControls(aAngleControls.fOppositeVertice, aEdgeAngleControls, edgeAnglesDefault);\r\n\r\n\t\t\t\t\t\t\t\tconst itemSize = this.bufferGeometry.attributes.position.itemSize,\r\n\t\t\t\t\t\t\t\t\tvertices = [],\r\n\t\t\t\t\t\t\t\t\tpushVertice = (vertice) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tvertice.forEach(axis => vertices.push(axis))\r\n\t\t\t\t\t\t\t\t\t\tfor (let i = vertice.length; i < itemSize; i++) vertices.push(0);\r\n\r\n\t\t\t\t\t\t\t\t\t\t//Каждая вершина должна иметь не меньше 3 координат что бы не поучить ошибку:\r\n\t\t\t\t\t\t\t\t\t\t//THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values. \r\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < (3 - itemSize); i++) vertices.push(0);\r\n\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\taddObject2Scene = (vertices, color) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst buffer = new THREE.BufferGeometry().setAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), itemSize > 3 ? itemSize : 3)),\r\n\t\t\t\t\t\t\t\t\t\t\tlineSegments = new THREE.LineSegments(buffer, new THREE.LineBasicMaterial({ color: color, }));\r\n\t\t\t\t\t\t\t\t\t\tclassSettings.projectParams.scene.add(lineSegments);\r\n\t\t\t\t\t\t\t\t\t\treturn lineSegments;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t//highlight edges Подсветить ребра для этой вершины\r\n\r\n\t\t\t\t\t\t\t\tlet oppositeVerticeEdges;\r\n\t\t\t\t\t\t\t\taAngleControls.cHighlightEdges = fAdvansed.add({ boHighlightEdges: false }, 'boHighlightEdges').onChange((boHighlightEdges) => {\r\n\r\n\t\t\t\t\t\t\t\t\t_this.opacity(boHighlightEdges);\r\n\t\t\t\t\t\t\t\t\tif (boHighlightEdges) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst verticeId = aAngleControls.verticeId,\r\n\t\t\t\t\t\t\t\t\t\t\tangles = position.angles[verticeId];\r\n\t\t\t\t\t\t\t\t\t\tvertices.length = 0;\r\n\t\t\t\t\t\t\t\t\t\tangles.edges.forEach(edgeId => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst edge = geometry.indices.edges[edgeId];\r\n\t\t\t\t\t\t\t\t\t\t\tedge.forEach(edgeVerticeId => { pushVertice(position[edgeVerticeId]); });\r\n\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\toppositeVerticeEdges = addObject2Scene(vertices, 'white');\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (oppositeVerticeEdges) classSettings.projectParams.scene.remove(oppositeVerticeEdges);\r\n\t\t\t\t\t\t\t\t\t\toppositeVerticeEdges = undefined;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(aAngleControls.cHighlightEdges, lang.highlightEdges, lang.highlightEdgesTitle);\r\n\r\n\t\t\t\t\t\t\t\t//Middle vertice\r\n\r\n\t\t\t\t\t\t\t\tlet middleVerticeEdges;\r\n\t\t\t\t\t\t\t\taAngleControls.cMiddleVertice = fAdvansed.add({ boMiddleVertice: false }, 'boMiddleVertice').onChange((boMiddleVertice) => {\r\n\r\n\t\t\t\t\t\t\t\t\t_this.opacity(boMiddleVertice);\r\n\t\t\t\t\t\t\t\t\tif (boMiddleVertice) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst verticeId = aAngleControls.verticeId,\r\n\t\t\t\t\t\t\t\t\t\t\tangles = position.angles[verticeId],\r\n\t\t\t\t\t\t\t\t\t\t\toppositeVerticesId = angles.oppositeVerticesId,\r\n\t\t\t\t\t\t\t\t\t\t\tmiddleVertice = _this.angles2Vertice(angles.middleVertice(oppositeVerticesId));\r\n\t\t\t\t\t\t\t\t\t\tvertices.length = 0;\r\n\t\t\t\t\t\t\t\t\t\toppositeVerticesId.forEach(oppositeVerticeId => {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tpushVertice(middleVertice);\r\n\t\t\t\t\t\t\t\t\t\t\tpushVertice(position[oppositeVerticeId]);\r\n\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tmiddleVerticeEdges = addObject2Scene(vertices, 'blue');\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (middleVerticeEdges) classSettings.projectParams.scene.remove(middleVerticeEdges);\r\n\t\t\t\t\t\t\t\t\t\tmiddleVerticeEdges = undefined;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(aAngleControls.cMiddleVertice, lang.middleVertice, lang.middleVerticeTitle);\r\n\r\n\t\t\t\t\t\t\t\t//Planes of rotation of angles.\r\n\r\n\t\t\t\t\t\t\t\taAngleControls.cPlanes = fAdvansed.add({ boPlanes: false }, 'boPlanes').onChange((boPlanes) => {\r\n\r\n\r\n\t\t\t\t\t\t\t\t\tif (!boPlanes) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (aAngleControls.planes) aAngleControls.planes.forEach((plane) => plane.removeHuperSphere())\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.planes = undefined;\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tconst vertice = position.angles[aAngleControls.verticeId],\r\n\t\t\t\t\t\t\t\t\t\tlongitudeId = this.dimension - 2, latitudeId = longitudeId - 1, altitudeId = latitudeId - 1;\r\n\t\t\t\t\t\t\t\t\tconst planeGeometry = (verticeAngleId, planeAngles) => {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst plane = aAngleControls.planes ? aAngleControls.planes[verticeAngleId] : undefined;\r\n\t\t\t\t\t\t\t\t\t\tplaneAngles = planeAngles || plane.classSettings.settings.object.geometry.angles;\r\n\t\t\t\t\t\t\t\t\t\tlet planeVerticeId = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t\tlet start, stop;\r\n\t\t\t\t\t\t\t\t\t\tswitch (verticeAngleId) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcase latitudeId:\r\n\t\t\t\t\t\t\t\t\t\t\tcase longitudeId:\r\n\t\t\t\t\t\t\t\t\t\t\t\tstart = -π; stop = π;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase altitudeId:\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst altitudeRange = settings.object.geometry.angles.ranges[verticeAngleId];\r\n\t\t\t\t\t\t\t\t\t\t\t\tstart = altitudeRange.min; stop = altitudeRange.max;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tdefault: console.error(sHuperSphere + ': Planes of rotation of angles. Invalid verticeAngleId = ' + verticeAngleId);\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tfor (let i = start; i <= stop; i = i + (π / 20)) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst planeAngle = [];\r\n\t\t\t\t\t\t\t\t\t\t\tconst vertice = position.angles[aAngleControls.verticeId];\r\n\t\t\t\t\t\t\t\t\t\t\tfor (let verticeAngleId = 0; verticeAngleId < vertice.length; verticeAngleId++) planeAngle.push(vertice[verticeAngleId]);\r\n\t\t\t\t\t\t\t\t\t\t\tplaneAngle[verticeAngleId] = i;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t//if (this.classSettings.debug) console.log(sHuperSphere + ': ' + settings.object.geometry.angles.ranges[verticeAngleId].angleName + '. VerticeId = ' + planeAngles.length);\r\n\t\t\t\t\t\t\t\t\t\t\tplaneAngles[planeVerticeId++] = this.normalizeVerticeAngles(planeAngle);\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (plane) plane.object().geometry.attributes.position.needsUpdate = true;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tfor (let verticeAngleId = 0; verticeAngleId < vertice.length; verticeAngleId++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst planeAngles = [], angleName = settings.object.geometry.angles.ranges[verticeAngleId].angleName;\r\n\t\t\t\t\t\t\t\t\t\tplaneGeometry(verticeAngleId, planeAngles);\r\n\t\t\t\t\t\t\t\t\t\tconst planeEdges = [];\r\n\t\t\t\t\t\t\t\t\t\tfor (let i = 0; i < (planeAngles.length - 1); i++) planeEdges.push([i, i + 1]);\r\n\t\t\t\t\t\t\t\t\t\tif (!aAngleControls.planes) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\taAngleControls.planes = [];\r\n\t\t\t\t\t\t\t\t\t\t\taAngleControls.planes.update = (changedAngleId) => { this.planesGeometry(changedAngleId, aAngleControls, planeGeometry, longitudeId); }\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\taAngleControls.planes[verticeAngleId] = this.line({\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcookieName: 'plane_' + verticeAngleId,//если не задать cookieName, то настройки дуги будут браться из настроек гиперсферы\r\n\t\t\t\t\t\t\t\t\t\t\tobject: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tname: angleName,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcolor: 'white',\r\n\t\t\t\t\t\t\t\t\t\t\t\tgeometry: {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tangles: planeAngles,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\topacity: 0.3,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindices: { edges: planeEdges, }\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tconst plane = aAngleControls.planes[verticeAngleId];\r\n\t\t\t\t\t\t\t\t\t\tplane.opacity();\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tdat.controllerNameAndTitle(aAngleControls.cPlanes, lang.planes, lang.planesTitle);\r\n\r\n\t\t\t\t\t\t\t\treturn fAdvansed;\r\n\r\n\t\t\t\t\t\t\t},\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\tif ((classSettings.edges != false) && classSettings.edges.project) {\r\n\r\n\t\t\t\t\tif (myPoints) {\r\n\r\n\t\t\t\t\t\tmyPoints.visible = false;\r\n\t\t\t\t\t\tif (options.eventListeners) options.eventListeners.removeParticle(myPoints);\r\n\t\t\t\t\t\tif (guiSelectPoint) {\r\n\r\n\t\t\t\t\t\t\tguiSelectPoint.removeMesh(myPoints, false);\r\n\t\t\t\t\t\t\tmyPoints.children.forEach(child => guiSelectPoint.removeMesh(child, false));\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (nd) {\r\n\r\n\t\t\t\t\t\tnd.object3D.visible = true;\r\n\t\t\t\t\t\tif (options.eventListeners) options.eventListeners.addParticle(nd.object3D);\r\n\t\t\t\t\t\tif (guiSelectPoint) {\r\n\r\n\t\t\t\t\t\t\tguiSelectPoint.addMesh(nd.object3D);\r\n\t\t\t\t\t\t\tnd.object3D.children.forEach(child => guiSelectPoint.addMesh(child));\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tsettings.scene = scene;\r\n\t\t\t\t\t\tif ((settings.object.geometry.indices.edges.length === 0)) this.pushEdges();\r\n\t\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t\tif ((settings.object.geometry.position[0].length > 3) && (!settings.object.color)) settings.object.color = {};//Color of vertice from palette\r\n\t\t\t\t\t\t\tnd = new ND(this.dimension, settings);\r\n\r\n\t\t\t\t\t\t\tparams.center = params.center || {}\r\n\t\t\t\t\t\t\tnd.object3D.position.x = params.center.x || 0;\r\n\t\t\t\t\t\t\tnd.object3D.position.y = params.center.y || 0;\r\n\t\t\t\t\t\t\tnd.object3D.position.z = params.center.z || 0;\r\n\r\n\t\t\t\t\t\t\tgui(nd.object3D);\r\n\r\n\t\t\t\t\t\t\tintersection(nd.object3D);\r\n\r\n\t\t\t\t\t\t\tif (this.onSelectScene) this.onSelectScene();\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif (nd) {\r\n\r\n\t\t\t\t\t\tnd.object3D.visible = false;\r\n\t\t\t\t\t\tif (options.eventListeners) options.eventListeners.removeParticle(nd.object3D);\r\n\t\t\t\t\t\tif (guiSelectPoint) {\r\n\r\n\t\t\t\t\t\t\tguiSelectPoint.removeMesh(nd.object3D);\r\n\t\t\t\t\t\t\tnd.object3D.children.forEach(child => guiSelectPoint.removeMesh(child, false));\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (myPoints) {\r\n\r\n\t\t\t\t\t\tif (myPoints.visible != true) {\r\n\r\n\t\t\t\t\t\t\tmyPoints.visible = true;\r\n\t\t\t\t\t\t\tif (options.eventListeners) options.eventListeners.addParticle(myPoints);\r\n\t\t\t\t\t\t\tif (guiSelectPoint) {\r\n\r\n\t\t\t\t\t\t\t\tguiSelectPoint.addMesh(myPoints);\r\n\t\t\t\t\t\t\t\tmyPoints.children.forEach(child => guiSelectPoint.addMesh(child));\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tlet points = settings.object.geometry.position;\r\n\r\n\t\t\t\t\t\t//for debug\r\n\t\t\t\t\t\t//Выводим углы вместо вершин. Нужно для отладки равномерного распределения вершин в гиперсфре\r\n\t\t\t\t\t\t//См. randomPosition()\r\n\t\t\t\t\t\t/*\r\n\t\t\t\t\t\tpoints = [];\r\n\t\t\t\t\t\tsettings.object.geometry.position.forEach(vertive => points.push(vertive.angles));\r\n\t\t\t\t\t\t*/\r\n\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t(classSettings.settings.object.color != undefined) &&\r\n\t\t\t\t\t\t\t(typeof classSettings.settings.object.color != \"object\")\r\n\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\tconst color = new three.THREE.Color(classSettings.settings.object.color);\r\n\t\t\t\t\t\t\tclassSettings.settings.options.setPalette(new ColorPicker.palette({ palette: [{ percent: 0, r: color.r * 255, g: color.g * 255, b: color.b * 255, },] }));\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tnew MyPoints(points, scene, {\r\n\r\n\t\t\t\t\t\t\tpointsOptions: {\r\n\r\n\t\t\t\t\t\t\t\tname: settings.object.name,\r\n\t\t\t\t\t\t\t\tcolor: this.color(),//settings.object.color,\r\n\t\t\t\t\t\t\t\tcolors: settings.object.geometry.colors,\r\n\t\t\t\t\t\t\t\topacity: settings.object.geometry.opacity,\r\n\t\t\t\t\t\t\t\tonReady: (points) => {\r\n\r\n\t\t\t\t\t\t\t\t\tmyPoints = points;\r\n\t\t\t\t\t\t\t\t\tgui(myPoints);\r\n\t\t\t\t\t\t\t\t\tintersection(points);\r\n\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t//shaderMaterial: false,\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\toptions: settings.options,\r\n\t\t\t\t\t\t\tobject: settings.object,\r\n\t\t\t\t\t\t\tbufferGeometry: settings.bufferGeometry,\r\n\t\t\t\t\t\t\tisPositionControllerReadOnly: true,\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t\tthis.projectGeometry();\r\n\r\n\t\t\t//шаг проигрывателя player\r\n\t\t\t//Вычислем middle vertices\r\n\t\t\toptions.onSelectScene = (index, t) => {\r\n\r\n\t\t\t\tif (index === 0) return;\r\n\t\t\t\tconst geometry = settings.object.geometry, position = geometry.position, edges = geometry.indices.edges;\r\n\t\t\t\tif (edges.length === 0) {\r\n\r\n\t\t\t\t\t//Create edges\r\n\t\t\t\t\tthis.onSelectScene = () => {\r\n\r\n\t\t\t\t\t\toptions.onSelectScene(index, t);\r\n\t\t\t\t\t\tdelete this.onSelectScene;\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (cEdges) cEdges.setValue(true);\r\n\t\t\t\t\telse {\r\n\r\n\t\t\t\t\t\t//нет ручной настройки\r\n\t\t\t\t\t\tclassSettings.edges = cookieOptions.edgesOld || edgesOld;\r\n\t\t\t\t\t\t_this.projectGeometry();\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tlet progressBar, verticeId = 0;\r\n\t\t\t\tif ((typeof WebGPU != 'undefined') && WebGPU.isSupportWebGPU()) {\r\n\r\n\t\t\t\t\tconst firstMatrix = [\r\n\t\t\t\t\t\t[1, 2, 3, 4],\r\n\t\t\t\t\t\t[5, 6, 7, 8]\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\tsecondMatrix = [\r\n\t\t\t\t\t\t\t[1, 2],\r\n\t\t\t\t\t\t\t[3, 4],\r\n\t\t\t\t\t\t\t[5, 6],\r\n\t\t\t\t\t\t\t[7, 8],\r\n\t\t\t\t\t\t];\r\n\t\t\t\t\tnew WebGPU({\r\n\r\n\t\t\t\t\t\tinput: { matrices: [firstMatrix, secondMatrix] },\r\n\r\n\t\t\t\t\t\t//shaderCode: shaderCode,\r\n\t\t\t\t\t\tshaderCodeFile: '../Shader.c',\r\n\r\n\t\t\t\t\t\tresults: [\r\n\r\n\t\t\t\t\t\t\t{\r\n\r\n\t\t\t\t\t\t\t\tcount: firstMatrix.length * secondMatrix[0].length +\r\n\r\n\t\t\t\t\t\t\t\t\t//result matrix has reserved three elements in the head of the matrix for size of the matrix.\r\n\t\t\t\t\t\t\t\t\t//First element is dimension of result matrix.\r\n\t\t\t\t\t\t\t\t\t//Second element is rows count of the matrix.\r\n\t\t\t\t\t\t\t\t\t//Third element is columns count of the matrix.\r\n\t\t\t\t\t\t\t\t\t//See settings.size of out2Matrix method in https://raw.githack.com/anhr/WebGPU/master/jsdoc/module-WebGPU-WebGPU.html\r\n\t\t\t\t\t\t\t\t\t3,\r\n\t\t\t\t\t\t\t\tout: out => {\r\n\r\n\t\t\t\t\t\t\t\t\tconsole.log('out:');\r\n\t\t\t\t\t\t\t\t\tconsole.log(new Float32Array(out));\r\n\t\t\t\t\t\t\t\t\tconst matrix = WebGPU.out2Matrix(out);\r\n\t\t\t\t\t\t\t\t\tconsole.log('matrix:');\r\n\t\t\t\t\t\t\t\t\tconsole.log(matrix);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t],\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst vertices = [],\r\n\t\t\t\t\ttimestamp = classSettings.debug ? window.performance.now() : undefined,\r\n\t\t\t\t\tstep = () => {\r\n\r\n\t\t\t\t\t\tprogressBar.value = verticeId;\r\n\t\t\t\t\t\tconst stepItem = () => {\r\n\r\n\t\t\t\t\t\t\tvertices.push(position.angles[verticeId].middleVertice());\r\n\t\t\t\t\t\t\tverticeId += 1;\r\n\t\t\t\t\t\t\tif (verticeId >= position.length) {\r\n\r\n\t\t\t\t\t\t\t\tprogressBar.remove();\r\n\r\n\t\t\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\t\t\tclassSettings.debug.logTimestamp('Play step. ', timestamp);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tthis.isUpdate = false;//для ускорения\r\n\t\t\t\t\t\t\t\tfor (verticeId = 0; verticeId < position.length; verticeId++)\r\n\t\t\t\t\t\t\t\t\tposition.angles[verticeId] = vertices[verticeId];//Обновление текущей вершины без обновления холста для экономии времени\r\n\t\t\t\t\t\t\t\tthis.isUpdate = true;\r\n\r\n\t\t\t\t\t\t\t\t//обновляю позицию первой вершины что бы обновить холст\r\n\t\t\t\t\t\t\t\tposition[0][0] = position[0][0];\r\n\r\n\t\t\t\t\t\t\t\tif (classSettings.debug) {\r\n\r\n\t\t\t\t\t\t\t\t\tclassSettings.debug.logTimestamp('Copy vertices. ', timestamp);\r\n\t\t\t\t\t\t\t\t\tthis.logHuperSphere();\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\toptions.player.continue();\r\n\t\t\t\t\t\t\t\treturn true;\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!stepItem()) progressBar.step();\r\n\r\n\t\t\t\t\t};\r\n\t\t\t\tprogressBar = new ProgressBar(options.renderer.domElement.parentElement, step, {\r\n\r\n\t\t\t\t\tsTitle: 't = ' + t + '<br> Take middle vertices',\r\n\t\t\t\t\tmax: position.length - 1,\r\n\r\n\t\t\t\t});\r\n\t\t\t\treturn true;//player pause\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (classSettings.debug)\r\n\t\t\t\tclassSettings.debug.logTimestamp('Project. ');\r\n\r\n\t\t}\r\n\t\tif (classSettings.mode === undefined) classSettings.mode = 0;//решил оставить режим, в котором сначала добавляются ребра а потом уже создаются вершины для них\r\n\t\tswitch (classSettings.mode) {\r\n\r\n\t\t\t//connect vertices by edges\r\n\t\t\tcase 0:\r\n\r\n\t\t\t\t//default vertices\r\n\t\t\t\tif (this.verticesCountMin === undefined) {\r\n\r\n\t\t\t\t\tconsole.error(sHuperSphere + ': Please define verticesCountMin in your child class.');\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t}\r\n\t\t\t\tconst count = position.count === undefined ? this.verticesCountMin : position.count;\r\n\t\t\t\tif (count < 2) {\r\n\r\n\t\t\t\t\tconsole.error(sHuperSphere + ': Invalid classSettings.settings.object.geometry.position.count < 2');\r\n\t\t\t\t\t//return;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (probabilityDensity) {\r\n\r\n\t\t\t\t\t//для 2D гиперсферы это плотность вероятности распределения вершин по поверхости сферы в зависимости от третьей координаты вершины z = vertice.[2]\r\n\t\t\t\t\t//Плотности разбил на несколько диапазонов в зависимости от третьей координаты вершины z = vertice.[2]\r\n\t\t\t\t\t//Разбил сферу на sc = 5 сегментов от 0 до 4.\r\n\t\t\t\t\t//Границы сегментов вычисляю по фомулам:\r\n\t\t\t\t\t//Высота сегмента hs = d / sc = 2 / 5 = 0.4\r\n\t\t\t\t\t//Нижняя граница hb = hs * i - r\r\n\t\t\t\t\t//Верхняя граница ht = hs * (i + 1) - r\r\n\t\t\t\t\t//где r = 1 - радиус сферыб d = 2 * r = 2 - диаметр сферы, i - индекс сегмента\r\n\t\t\t\t\t//0. From -1 to -0.6\r\n\t\t\t\t\t//1. From -0.6 to -0.2\r\n\t\t\t\t\t//2. From -0.2 to 0.2\r\n\t\t\t\t\t//3. From 0.2 to 0.6\r\n\t\t\t\t\t//4. From 0.6 to 1\r\n\t\t\t\t\tconsole.log('');\r\n\t\t\t\t\tconsole.log('Probability density.');\r\n\t\t\t\t\tconst table = [];\r\n\t\t\t\t\tprobabilityDensity.forEach((segment, segmentId) => {\r\n\r\n\t\t\t\t\t\tsegment.density = segment.count / segment[_this.probabilityDensity.sectorValueName];//segment.square;\r\n\t\t\t\t\t\tsegment.height = segment.ht - segment.hb;\r\n\t\t\t\t\t\ttable.push(segment);\r\n\r\n\t\t\t\t\t})\r\n\t\t\t\t\tconst sectorValueName = _this.probabilityDensity.sectorValueName;\r\n\t\t\t\t\tif (!sectorValueName) console.error(sHuperSphere + ': Invalid sectorValueName = ' + sectorValueName);\r\n\t\t\t\t\tconsole.table(table, ['count', 'hb', 'ht', 'height',\r\n\t\t\t\t\t\tsectorValueName,\r\n\t\t\t\t\t\t'density']);\r\n\t\t\t\t\tconsole.log('');\r\n\t\t\t\t\tclassSettings.debug.logTimestamp('Push positions. ');\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//remove previous hupersphere\r\n\t\t\t\tthis.remove = (scene) => {\r\n\t\r\n\t\t\t\t\tif (classSettings.boRemove === false) return;\r\n\t\t\t\t\tfor (var i = scene.children.length - 1; i >= 0; i--) {\r\n\t\r\n\t\t\t\t\t\tconst child = scene.children[i];\r\n\t\t\t\t\t\tthis.remove(child);\r\n\t\t\t\t\t\tremoveObject(child);\r\n\t\r\n\t\t\t\t\t}\r\n\t\r\n\t\t\t\t}\r\n\t\t\t\tthis.pushEdges = () => {\r\n\r\n\t\t\t\t\tconst geometry = this.classSettings.settings.object.geometry, edges = geometry.indices.edges, position = geometry.position;\r\n\r\n\t\t\t\t\t//Localization\r\n\r\n\t\t\t\t\tconst lang = { progressTitle: \"Creating edges.<br>Vertice's edges %s from \" + this.verticeEdgesLength, };\r\n\r\n\t\t\t\t\tswitch (settings.options.getLanguageCode()) {\r\n\r\n\t\t\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\t\t\tlang.progressTitle = 'Создание ребер.<br>Ребер у вершины %s из ' + this.verticeEdgesLength;\r\n\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (classSettings.edges.creationMethod === undefined) classSettings.edges.creationMethod = edgesCreationMethod.Random;//.NearestVertice;\r\n\t\t\t\t\tswitch (classSettings.edges.creationMethod) {\r\n\r\n\t\t\t\t\t\tcase edgesCreationMethod.Random:\r\n\t\t\t\t\t\t\tlet verticeEdgesCur = 1, verticeId = 0,\r\n\t\t\t\t\t\t\t\tboCompleted = false;//Кажется это не нужно\r\n\t\t\t\t\t\t\tconst progressBar = new ProgressBar(settings.options.renderer.domElement.parentElement, () => {\r\n\r\n\t\t\t\t\t\t\t\tconst nextVertice = () => {\r\n\r\n\t\t\t\t\t\t\t\t\tprogressBar.value = verticeId;\r\n\r\n\t\t\t\t\t\t\t\t\t//цикл поиска вершины, в которую можно добавить еще одно ребро\r\n\t\t\t\t\t\t\t\t\tconst verticeIdStart = verticeId;\r\n\t\t\t\t\t\t\t\t\tdo {\r\n\r\n\t\t\t\t\t\t\t\t\t\tverticeId++;\r\n\t\t\t\t\t\t\t\t\t\tif (verticeId >= position.length) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tverticeEdgesCur++;\r\n\t\t\t\t\t\t\t\t\t\t\tprogressBar.title(lang.progressTitle.replace('%s', verticeEdgesCur + 1));\r\n\t\t\t\t\t\t\t\t\t\t\tif (verticeEdgesCur >= this.verticeEdgesLength) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (this.projectGeometry) this.projectGeometry();\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (this.classSettings.debug) this.classSettings.debug.logTimestamp('Push edges. ');\r\n\t\t\t\t\t\t\t\t\t\t\t\tprogressBar.remove();\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (this.classSettings.projectParams) this.project(this.classSettings.projectParams.scene, this.classSettings.projectParams.params);\r\n\t\t\t\t\t\t\t\t\t\t\t\tboCompleted = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn;// true;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tverticeId = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t} while ((position[verticeId].edges.length >= this.verticeEdgesLength) && (verticeIdStart != verticeId));\r\n\t\t\t\t\t\t\t\t\tprogressBar.step();\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (boCompleted) return;\r\n\t\t\t\t\t\t\t\tlet oppositeVerticeId = verticeId + 1;\r\n\t\t\t\t\t\t\t\tif (oppositeVerticeId >= position.length) oppositeVerticeId = 0;\r\n\t\t\t\t\t\t\t\t//Поиск вершины у которой ребер меньше максимального количества ребер и у которой нет нового ребра\r\n\t\t\t\t\t\t\t\tconst oppositeVerticeIdFirst = oppositeVerticeId;\r\n\t\t\t\t\t\t\t\twhile (true) {\r\n\r\n\t\t\t\t\t\t\t\t\tconst oppositeVerticeEdges = position[oppositeVerticeId].edges;\r\n\t\t\t\t\t\t\t\t\tif (oppositeVerticeEdges.length < this.verticeEdgesLength) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t//поиск нового ребра в списке ребер этой вершины\r\n\t\t\t\t\t\t\t\t\t\tlet boContinue = false;\r\n\t\t\t\t\t\t\t\t\t\tfor (let oppositeVerticeEdgeId = 0; oppositeVerticeEdgeId < oppositeVerticeEdges.length; oppositeVerticeEdgeId++) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst oppositeVerticeEdge = edges[oppositeVerticeEdges[oppositeVerticeEdgeId]];\r\n\t\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t\t(oppositeVerticeEdge[0] === verticeId) && (oppositeVerticeEdge[1] === oppositeVerticeId) ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t(oppositeVerticeEdge[1] === verticeId) && (oppositeVerticeEdge[0] === oppositeVerticeId)\r\n\t\t\t\t\t\t\t\t\t\t\t) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tboContinue = true;//это ребро уже существует\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tif (boContinue) {\r\n\r\n\t\t\t\t\t\t\t\t\t\t\toppositeVerticeId++;\r\n\t\t\t\t\t\t\t\t\t\t\tif (oppositeVerticeId >= position.length) oppositeVerticeId = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tcontinue;//Новое ребро уже есть в текущей вершине. Перейти на следующую вершину\r\n\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tbreak;//нашел противоположное ребро\r\n\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t\t\t\toppositeVerticeId++;\r\n\t\t\t\t\t\t\t\t\t\tif (oppositeVerticeId >= position.length) oppositeVerticeId = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (oppositeVerticeIdFirst === oppositeVerticeId) break;\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t//Возможно был пройден полный круг поиска противолположной вершины и ничего найдено не было\r\n\t\t\t\t\t\t\t\tif (verticeId != oppositeVerticeId) edges.push([verticeId, oppositeVerticeId]);\r\n\r\n\t\t\t\t\t\t\t\tnextVertice();\r\n\r\n\t\t\t\t\t\t\t}, {\r\n\r\n\t\t\t\t\t\t\t\tsTitle: lang.progressTitle.replace('%s', verticeEdgesCur + 1),\r\n\t\t\t\t\t\t\t\tmax: position.length,\r\n\t\t\t\t\t\t\t\ttimeoutPeriod: 3,\r\n\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault: console.error(sHuperSphere + ': pushEdges. Invalid classSettings.edges.creationMethod = ' + classSettings.edges.creationMethod);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t\tthis._verticeEdgesLength = this.verticeEdgesLengthMax;\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tclassSettings.edges &&\r\n\t\t\t\t\t(classSettings.settings.object.geometry.indices.edges.length === 0)//ребер нет\r\n\t\t\t\t) this.pushEdges();//Для экономии времени не добавляю ребра если на холст вывожу только вершины\r\n\t\t\t\telse if (this.classSettings.projectParams) this.project(this.classSettings.projectParams.scene, this.classSettings.projectParams.params);\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 1: indices.edges.pushEdges(); break;//push edges. сначала добавляются ребра а потом уже создаются вершины для них\r\n\t\t\tdefault: console.error(sHuperSphere + ': Unknown mode: ' + classSettings.mode); return;\r\n\r\n\t\t}\r\n\r\n\t\tlet cEdges;\r\n\t\tif (options.dat && options.dat.gui && (classSettings.boGui != false)) {\r\n\r\n\t\t\tconst getLanguageCode = options.getLanguageCode;\r\n\r\n\t\t\t//Localization\r\n\r\n\t\t\tconst lang = {\r\n\r\n\t\t\t\tvertices: 'Vertices',\r\n\t\t\t\tverticesCount: 'Count',\r\n\t\t\t\tverticesCountTitle: 'Vertices count',\r\n\r\n\t\t\t\tedges: 'Edges',\r\n\t\t\t\tedgesTitle: 'Create edges',\r\n\r\n\t\t\t\tedge: 'Edge',\r\n\r\n\t\t\t\tverticeEdgesCountTitle: 'Количество ребер у вершины',\r\n\r\n\t\t\t\tproject: 'Project',\r\n\t\t\t\tprojectTitle: 'Project edges onto canvas',\r\n\r\n\t\t\t};\r\n\r\n\t\t\tconst _languageCode = getLanguageCode();\r\n\r\n\t\t\tswitch (_languageCode) {\r\n\r\n\t\t\t\tcase 'ru'://Russian language\r\n\r\n\t\t\t\t\tlang.vertices = 'Вершины';\r\n\t\t\t\t\tlang.verticesCount = 'Количество';\r\n\t\t\t\t\tlang.verticesCountTitle = 'Количество вершин';\r\n\r\n\t\t\t\t\tlang.edges = 'Ребра';\r\n\t\t\t\t\tlang.edgesTitle = 'Создать ребра';\r\n\r\n\t\t\t\t\tlang.edge = 'Ребро';\r\n\r\n\t\t\t\t\tlang.verticeEdgesCountTitle = 'Количество ребер у вершины';\r\n\r\n\t\t\t\t\tlang.project = 'Отображать';\r\n\t\t\t\t\tlang.projectTitle = 'Отображать ребра на холсте';\r\n\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tconst fHuperSphere = options.dat.gui.addFolder(this.name(getLanguageCode)), dat = three.dat;\r\n\r\n\t\t\t//vertices\r\n\r\n\t\t\tconst fVertices = fHuperSphere.addFolder(lang.vertices);\r\n\t\t\tfVertices.add(new PositionController((shift) => { cVerticesCount.setValue(angles.length + shift); },\r\n\t\t\t\t{ settings: { offset: 1, }, min: 1, max: 1000, step: 1, getLanguageCode: options.getLanguageCode }));\r\n\r\n\t\t\t//Vertices count\r\n\t\t\tconst cVerticesCount = dat.controllerZeroStep(fVertices, angles, 'guiLength');\r\n\t\t\tdat.controllerNameAndTitle(cVerticesCount, lang.verticesCount, lang.verticesCountTitle);\r\n\r\n\t\t\t//vertice edges\r\n\r\n\t\t\tconst fVerticeEdges = fVertices.addFolder(lang.edges);\r\n\t\t\tfVerticeEdges.add(new PositionController((shift) => { cVerticeEdgesCount.setValue(this.verticeEdgesLength + shift); },\r\n\t\t\t\t{ settings: { offset: 1, }, min: 1, max: 10, step: 1, getLanguageCode: options.getLanguageCode }));\r\n\r\n\t\t\t//Vertice edges count\r\n\t\t\tconst cVerticeEdgesCount = dat.controllerZeroStep(fVerticeEdges, this, 'verticeEdgesLength');\r\n\t\t\tdat.controllerNameAndTitle(cVerticeEdgesCount, lang.verticesCount, lang.verticeEdgesCountTitle);\r\n\r\n\t\t\t//edges\r\n\r\n\t\t\tclassSettings.edges = cookieOptions === false ? false : cookieOptions.edges || classSettings.edges;\r\n\r\n\t\t\tconst objectEdges = { boEdges: ((typeof classSettings.edges) === 'object') || (classSettings.edges === true) ? true : false },\r\n\t\t\t\tsetCockie = () => { options.dat.cookie.setObject(_this.cookieName, { edges: classSettings.edges, edgesOld: edgesOld, }); };\r\n\t\t\tcEdges = fHuperSphere.add(objectEdges, 'boEdges').onChange((boEdges) => {\r\n\r\n\t\t\t\tif (boEdges) {\r\n\r\n\t\t\t\t\tclassSettings.edges = edgesOld;\r\n\t\t\t\t\tcProject.setValue(classSettings.edges.project);\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tedgesOld = classSettings.edges;\r\n\t\t\t\t\tclassSettings.edges = false;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdisplayEdge();\r\n\t\t\t\t_this.projectGeometry();\r\n\t\t\t\tsetCockie();\r\n\r\n\t\t\t});\r\n\t\t\tconst fEdge = fHuperSphere.addFolder(lang.edge),\r\n\t\t\t\tobjectEdge = { boProject: ((typeof classSettings.edges) === 'object') ? classSettings.edges.project : false },\r\n\t\t\t\tcProject = fEdge.add(objectEdge, 'boProject').onChange((boProject) => {\r\n\r\n\t\t\t\t\tif (classSettings.edges.project === boProject) return;\r\n\t\t\t\t\tclassSettings.edges.project = boProject;\r\n\t\t\t\t\t_this.projectGeometry();\r\n\t\t\t\t\tsetCockie();\r\n\r\n\t\t\t\t}),\r\n\t\t\t\tdisplayEdge = () => { _display(fEdge.domElement, classSettings.edges); };\r\n\t\t\tdisplayEdge();\r\n\t\t\tdat.controllerNameAndTitle(cEdges, lang.edges, lang.edgesTitle);\r\n\t\t\tdat.controllerNameAndTitle(cProject, lang.project, lang.projectTitle);\r\n\r\n\t\t}\r\n\t\tthis._verticeEdgesLength;\r\n\t\tthis.boTestVertice = true;\r\n\r\n\t}\r\n\r\n\t\r\n\t\r\n\tget defaultColor() { return 'lime'; }\r\n\r\n\tget verticeEdgesLength() { return this._verticeEdgesLength; }\r\n\tset verticeEdgesLength(length) {\r\n\r\n\t\tthis._verticeEdgesLength = length;\r\n\t\tif (this.removeMesh) this.removeMesh();\r\n\t\tthis.pushEdges();\r\n\r\n\t}\r\n\r\n\t//base methods\r\n\r\n\tpushRandomLongitude(verticeAngles) {\r\n\r\n\t\tconst ranges = this.classSettings.settings.object.geometry.angles.ranges, longitudeRange = ranges[ranges.length - 1];\r\n\t\tverticeAngles.push(Math.random() * (longitudeRange.max - longitudeRange.min) + longitudeRange.min);\r\n\t\t\r\n\t}\r\n/*\t\r\n//\tcolor() { if (this.classSettings.settings.object.color === undefined) this.classSettings.settings.object.color = 'lime'; }\r\n\tcolor() {\r\n\r\n\t\tconst color = this.classSettings.settings.object.color;\r\n\t\treturn (color != undefined) ? color : 'lime';\r\n\t\r\n\t}\r\n*/\t\r\n\tname() { console.error(sOverride.replace('%s', 'name')); }\r\n\tlogHuperSphere() {\r\n\r\n\t\tif (!this.classSettings.debug || (this.classSettings.debug.log === false)) return;\r\n\t\tconsole.log(this.cookieName);\r\n\t\tlet i = 0, progressBarValue = 0,\r\n\t\t\tlog = 0;//position log\r\n\t\tconst settings = this.classSettings.settings, geometry = settings.object.geometry, position = geometry.position, edges = geometry.indices.edges,\r\n\t\t\tsLogHuperSphere = sHuperSphere + ': logHuperSphere()',\r\n\t\t\tprogressBar = new ProgressBar(settings.options.renderer.domElement.parentElement, () => {\r\n\r\n\t\t\t\tswitch (log){\r\n\t\t\t\t\tcase 0://vertices log\r\n\t\t\t\t\t\tconst vertice = position[i];\r\n\t\t\t\t\t\tconsole.log('vertice[' + i + '] = ' + JSON.stringify(vertice) + ' angles = ' + JSON.stringify(vertice.angles) + ' edges = ' + JSON.stringify(vertice.edges));\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1://edges log\r\n\t\t\t\t\t\tconst edge = edges[i];\r\n\t\t\t\t\t\tconsole.log('edges[' + i + '] = ' + JSON.stringify(edge))\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error(sLogHuperSphere + '. Invalid log = ' + log);\r\n\t\t\t\t}\r\n\t\t\t\tprogressBar.value = progressBarValue;\r\n\t\t\t\tprogressBarValue++;\r\n\t\t\t\ti++;\r\n\t\t\t\tswitch (log){\r\n\t\t\t\t\tcase 0://position log\r\n\t\t\t\t\t\tif (i === position.length) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tlog++;//edges log\r\n\t\t\t\t\t\t\ti = 0;\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tprogressBar.step();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1://edges log\r\n\t\t\t\t\t\tif (i >= edges.length) {\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tprogressBar.remove();\r\n\t\t\t\t\t\t\tif (this.classSettings.debug)\r\n\t\t\t\t\t\t\t\tthis.classSettings.debug.logTimestamp('Geometry log. ');\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t} else progressBar.step();\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault: console.error(sLogHuperSphere + '. Invalid log = ' + log);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t}, {\r\n\r\n\t\t\tsTitle: 'Geometry log',\r\n\t\t\tmax: position.length - 1 + edges.length - 1,\r\n\r\n\t\t});\r\n\t\t\r\n\t}\r\n\tTest(){\r\n\r\n\t\tif (!this.classSettings.debug) return;\r\n\t\t\r\n\t\tconst geometry = this.classSettings.settings.object.geometry;\r\n\t\tgeometry.position.test();\r\n\r\n\t\t//for future using\r\n\t\tif (geometry.indices.faces) geometry.indices.faces.test();\r\n\t\t\r\n\t}\r\n\tTestVertice(vertice, strVerticeId){\r\n\r\n\t\tif (!this.boTestVertice) return;\r\n\t\tif (this.classSettings.edges === false) return;\r\n\t\tif (vertice.edges.length < (this.verticeEdgesLength - 1))//Допускается количество ребер на одно меньше максимального значения потому что при опреденном количестве вершин для некоротых вершин не хватает противоположных вершин\r\n\t\t\tconsole.error(sHuperSphere + ': Test(). Invalid ' + strVerticeId + '.edges.length = ' + vertice.edges.length);\r\n\t\t\r\n\t}\r\n\tangles2Vertice(anglesId) {\r\n\r\n\t\tif (typeof anglesId === \"number\") {\r\n\t\t\t\r\n\t\t\tif (anglesId >= this.bufferGeometry.userData.position.length) console.error(sHuperSphere + '.angles2Vertice: Invalid anglesId = ' + anglesId);\r\n\t\t\treturn this.bufferGeometry.userData.position[anglesId];\r\n\t\t\t\r\n\t\t}\r\n\t\treturn this.getPoint(anglesId);\r\n\r\n\t}\r\n\tvertice2angles(vertice) {\r\n\t\t\r\n\t\t//https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates\r\n\t\t//тангенс — отношение стороны противолежащего катета vertice[1] к стороне прилежащегоvertice[0], (tg или tan);\r\n\t\tconst x = [],//для разных размерностей гиперсферы координаты вершины расположены в разном порядке в соответствии с this.axes.indices\r\n\t\t\tn = this.dimension - 1, φ = [], atan2 = Math.atan2, sqrt = Math.sqrt;\r\n\r\n\t\tif (vertice.length <= n) {\r\n\r\n\t\t\tconsole.error(sHuperSphere + ': vertice2angles. Invalid vertice.length = ' + vertice.length);\r\n\t\t\treturn;\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tfor (let index = 0; index < vertice.length; index++) x.push(vertice[this.axes.indices[index]]);\r\n\r\n\t\tfor (let i = 0; i < n; i++) {\r\n\r\n\t\t\tconst axes = {};\r\n\t\t\tif (i === (n - 1)) {\r\n\t\t\t\t\r\n\t\t\t\taxes.y = x[n]; axes.x = x[n - 1];\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\t\r\n\t\t\t\tlet sum = 0;\r\n\t\t\t\tfor(let j = (i + 1); j <= n; j++) sum += x[j] * x[j];\r\n\t\t\t\taxes.y = sqrt(sum); axes.x = x[i];\r\n\r\n\t\t\t}\r\n\t\t\tconst rotateLatitude = this.getRotateLatitude(i);\r\n\t\t\tφ.push((rotateLatitude === 0 ? 1 : -1) * atan2(axes.y, axes.x) - rotateLatitude);//Для широты меняем знак угола что бы положительная широта была в северном полушарии\r\n\t\t\t\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\t//установить углы так, что бы они влезли допустимый диапазон органов управления углов, когда пользователь захочет посмотреть или изменить эти углы\r\n\t\tconst longitudeId = φ.length - 1, latitudeId = longitudeId - 1, altitudeId = latitudeId - 1,\r\n\t\t\tranges = this.classSettings.settings.object.geometry.angles.ranges;\r\n\t\tlet latitude = φ[latitudeId], longitude = φ[longitudeId], altitude = φ[altitudeId];\r\n\t\tif (altitude != undefined) {//у одномерной и двумернй гиперсферы нет высоты\r\n\r\n\t\t\tconst altitudeRange = ranges[altitudeId];\r\n\t\t\tif (altitude > altitudeRange.max) {//π / 2\r\n\t\t\t\t\r\n\t\t\t} else if (altitude < altitudeRange.min) {//0\r\n\t\t\t\t\r\n\t\t\t\tconsole.error('Under constraction')\r\n\t\t\t\taltitude -= π;\r\n\t\r\n\t\t\t}\r\n\t\t\tφ[altitudeId] = altitude;\r\n\t\t\t\r\n\t\t}\r\n\t\tif (latitude != undefined) {//у одномерной гиперсферы нет широты\r\n\t\t\t\r\n\t\t\tconst latitudeRange = ranges[latitudeId];//, longitudeRange = ranges[longitudeId];\r\n\t\t\tif (latitude > latitudeRange.max) {//π / 2\r\n\t\t\t\t\r\n\t\t\t\tlatitude = π - latitude;\r\n\t\r\n\t\t\t\t//долготу развернуть на 180 градусов\r\n\t\t\t\tif (longitude > 0) longitude -= π;\r\n\t\t\t\telse if (longitude < 0) longitude += π;\r\n\t\t\t\t\r\n\t\t\t} else if (latitude < latitudeRange.min) {//- π / 2\r\n\t\t\t\t\r\n\t\t\t\tconsole.error('Under constraction')\r\n\t\t\t\tlatitude -= π;\r\n\t\r\n\t\t\t}\r\n\t\t\tφ[latitudeId] = latitude;\r\n\t\t\tφ[longitudeId] = longitude;\r\n\r\n\t\t}\r\n\t\t\r\n\t\treturn φ;\r\n\r\n\t}\r\n\tnormalizeVerticeAngles(verticeAngles){ return this.vertice2angles(this.angles2Vertice(verticeAngles)); }\r\n\r\n}\r\n\r\nconst edgesCreationMethod = {\r\n\t\r\n\tRandom: 0,//'Random',\r\n\tNearestVertice: 1,//'NearestVertice',\r\n\t\r\n}\r\nObject.freeze(edgesCreationMethod);\r\n/**\r\n * Enums a methods for creating edges:\r\n * <pre>\r\n * Random: every vertice of the edge have random position.\r\n * NearestVertice: Vertices of the edge have nearest position.\r\n * </pre>\r\n * */\r\nHuperSphere.edgesCreationMethod = edgesCreationMethod;\r\n\r\n/**\r\n * <a href=\"../../../master/nD/jsdoc/\" target=\"_blank\">ND</a>\r\n * */\r\nHuperSphere.ND = ND;\r\n\r\nexport default HuperSphere;\r\n\r\nconst _display = (element, boDisplay) => { element.style.display = boDisplay === false ? 'none' : 'block'; }\r\n","/**\r\n * @module Universe\r\n * @description Base class for n dimensional hypersphere universe.\r\n *\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n*/\r\n\r\n//import * as THREE from '../../three.js/dev/src/Three.js';\r\n//import * as THREE from '../../three.js/dev/build/three.module.js';\r\n//import * as THREE from 'https://threejs.org/build/three.module.js';\r\n//import * as THREE from 'https://raw.githack.com/anhr/three.js/dev/build/three.module.js';\r\n\r\nimport MyThree from '../../commonNodeJS/master/myThree/myThree.js';\r\n//import MyThree from '../../../commonNodeJS/master/myThree/build/myThree.module.js';\r\n//import MyThree from '../../../commonNodeJS/master/myThree/build/myThree.module.min.js';\r\n//import MyThree from 'https://raw.githack.com/anhr/commonNodeJS/master/myThree/myThree.js';\r\n//import MyThree from 'https://raw.githack.com/anhr/commonNodeJS/master/myThree/build/myThree.module.js';\r\n//import MyThree from 'https://raw.githack.com/anhr/commonNodeJS/master/myThree/build/myThree.module.min.js';\r\nMyThree.three.THREE = THREE;\r\n\r\nimport HuperSphere from '../../commonNodeJS/master/HuperSphere/huperSphere.js';\r\n\r\nclass Universe// extends HuperSphere\r\n{\r\n\r\n\tconstructor(universeSettings = {}, myThreeOptions = {}) {\r\n\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\nexport default Universe;\r\n\r\n","/**\r\n * @module ND\r\n * @description N-dimensional graphics\r\n * @author [Andrej Hristoliubov]{@link https://github.com/anhr}\r\n *\r\n * @copyright 2011 Data Arts Team, Google Creative Lab\r\n *\r\n * @license under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n * \r\n*/\r\n\r\nimport Universe from '../universe.js';\r\n\r\nclass CircularUniverse {\r\n\r\n\tconstructor() {\r\n\r\n\r\n\t}\r\n\r\n}\r\nexport default CircularUniverse;\r\n\r\n"],"names":["requestAnimationFrame","requestAnimationFrame$1","three","___$insertStyle","colorToString","ARR_EACH","ARR_SLICE","Common","INTERPRETATIONS","result","toReturn","interpret","tmpComponent","ColorMath","_typeof","classCallCheck","createClass","get","inherits","possibleConstructorReturn","Color","defineRGBComponent","defineHSVComponent","Controller","EVENT_MAP","EVENT_MAP_INV","CSS_VALUE_PIXELS","cssValueToPixels","dom","BooleanController","OptionController","StringController","numDecimals","NumberController","roundToDecimal","NumberControllerBox","map","NumberControllerSlider","FunctionController","ColorController","linearGradient","hueGradient","vendors","ControllerFactory","CustomController","css","saveDialogContents","CenteredDiv","styleSheet","CSS_NAMESPACE","HIDE_KEY_CODE","CLOSE_BUTTON_HEIGHT","DEFAULT_DEFAULT_PRESET_NAME","SUPPORTS_LOCAL_STORAGE","SAVE_DIALOGUE","autoPlaceVirgin","autoPlaceContainer","hide","hideableGuis","GUI","getLocalStorageHash","setPresetSelectIndex","setWidth","addRow","addResizeHandle","_add","removeListeners","addSaveMenu","getCurrentPreset","markPresetModified","addPresetOption","recallSavedValue","updateDisplays","augmentController","showHideExplain","controllers","sync","loadFileSync","async","SpriteText","ColorPicker","Player","cookie","Cookie","assign","THREE","lang","getCurrentScript","getCurrentScriptPath","currentScriptPath","optionsStyle","clearThree","index"],"mappings":"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"}